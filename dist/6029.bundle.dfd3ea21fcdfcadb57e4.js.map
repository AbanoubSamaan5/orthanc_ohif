{"version":3,"file":"6029.bundle.dfd3ea21fcdfcadb57e4.js","mappings":"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GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CA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","sources":["webpack:///../../../node_modules/@cornerstonejs/calculate-suv/dist/calculate-suv.esm.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/config.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/constants/COLOR_LUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/MouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/elementCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/ImageMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGCursorDescriptor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/setCursorForElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipse.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipseByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHandle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPath.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPolyline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRectByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawTextBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHeight.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawArrow.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRedactionRect.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setAttributesIfNecessary.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setNewAttributesIfValid.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/annotationInterpolationEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraModifiedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraResetEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageRenderedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageSpacingCalibratedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/keyboardToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationCompleted.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/touch/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/wheel/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/labelmap/onLabelmapSegmentationDataModified.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/labelmap/performVolumeLabelmapUpdate.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/labelmap/performStackLabelmapUpdate.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationDataModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/imageChangeEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationCompletedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationSelectionListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationRemovedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationRemoved.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationRepresentationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/init.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/FrameOfReferenceSpecificAnnotationManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationSelection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/ToolStyle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/helpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getFont.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/helpers/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationStateManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/activeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setActiveSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentationRepresentationsToViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/normalizeSegmentationInput.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationColor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getActiveSegmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getCurrentLabelmapImageIdForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportIdsWithSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/computeStackLabelmapFromVolume.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/computeVolumeLabelmapFromStack.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/getSegmentationActor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setSegmentationRepresentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/styleHelpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/clearSegmentValue.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegment.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getLabelmapImageIds.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/internalAddSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentationRepresentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getStackSegmentationImageIdsForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateLabelmapSegmentationImageReferences.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/Synchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/createSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroySynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getAllSynchronizers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizersForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/ToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/createToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroyToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getAllToolGroups.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroupsWithToolName.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/cancelActiveManipulations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/removeEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/svgNodeCache.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/areViewportsCoplanar.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/cameraSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/imageSliceSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/presentationViewSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/slabThicknessSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/voiSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/zoomPanSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createCameraPositionSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createImageSliceSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createPresentationViewSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createSlabThicknessSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createVOISynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createZoomPanSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AdvancedMagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AnnotationEraserTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/CrosshairsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MIPJumpToClickTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OrientationMarkerTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OverlayGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PanTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PlanarRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceCursors.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceLinesTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ScaleOverlayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SculptorTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SegmentationIntersectionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/StackScrollTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/TrackballRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/VolumeRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelRegionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ZoomTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/AngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ArrowAnnotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/BidirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CircleROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CobbAngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/DragProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ETDRSGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/EllipticalROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/HeightTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/KeyImageTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LabelTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LengthTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/RegionSegmentPlusTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/RegionSegmentTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/UltrasoundDirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/VideoRedactionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/WholeBodySegmentTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/BSpline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/CardinalSpline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/CatmullRomSpline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/CubicSpline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/LinearSpline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/QuadraticBezier.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/QuadraticSpline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/splines/Spline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/AnnotationDisplayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/BaseTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Contour/contourDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Labelmap/labelmapDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Surface/surfaceDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/BrushTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/PaintFillTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SegmentBidirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SegmentSelectTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SphereScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/strategies/compositions/ensureImageVolume.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/strategies/compositions/ensureSegmentationVolume.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/strategies/fillCircle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/strategies/fillRectangle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/types/ContourAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/AnnotationMultiSlice.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/annotationHydration.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/boundingBox/extend2DBoundingBoxInViewAxis.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/boundingBox/getBoundingBoxAroundShape.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/calibrateImageSpacing.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/cine/events.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/cine/playClip.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/cine/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contourSegmentation/areSameSegment.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contourSegmentation/isContourSegmentationAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contourSegmentation/removeContourSegmentationAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/calculatePerimeter.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/contourFinder.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/findHandlePolylineIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/getContourHolesDataCanvas.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/getContourHolesDataWorld.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/getDeduplicatedVTKPolyDataPoints.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/areCoplanarContours.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/detectContourHoles.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/generateContourSetsFromLabelmap.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/AnnotationToPointData.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/interpolation/acceptAutogeneratedInterpolations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/contours/updateContourPolyline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/dynamicVolume/generateImageFromTimeData.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/dynamicVolume/getDataInTime.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getAnnotationNearPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getCalibratedUnits.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getPixelValueUnits.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getSphereBoundsInfo.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getViewportsForAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/vec2/findClosestPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/moveAnnotationToViewPlane.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/normalizeViewportPlane.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/orientation/getOrientationStringLPS.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/orientation/invertOrientationStringLPS.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/planarFreehandROITool/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/pointInSurroundingSphereCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/pointToString.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/polyData/utils.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/rectangleROITool/getBoundsIJKFromRectangleAnnotations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/registerComputeWorker.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/InterpolationManager/InterpolationManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/SegmentStatsCalculator.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/VolumetricCalculator.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/brushSizeForToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/brushThresholdForToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/computeMetabolicStats.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getReferenceVolumeForSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/contourAndFindLargestBidirectional.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/createBidirectionalToolData.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/createLabelmapMemo.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/createLabelmapVolumeForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/createMergedLabelmapForIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/findLargestBidirectional.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/floodFill.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getBrushToolInstances.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getHoveredContourSegmentationAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getOrCreateImageVolume.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getOrCreateSegmentationVolume.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getReferenceVolumeForSegmentationVolume.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getSegmentIndexAtLabelmapBorder.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getSegmentIndexAtWorldPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getSegmentLargestBidirectional.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getStatistics.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getUniqueSegmentIndices.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/growCut/growCutShader.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/growCut/runGrowCut.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/growCut/runGrowCutForBoundingBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/growCut/runGrowCutForSphere.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/growCut/runOneClickGrowCut.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/invalidateBrushCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/isLineInSegment.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/islandRemoval.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/rectangleROIThresholdVolumeByRange.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/segmentContourAction.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/thresholdSegmentationByRange.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/thresholdVolumeByRange.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/utilities.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/utilsForWorker.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/validateLabelmap.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/setAnnotationLabel.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/stackPrefetch/stackContextPrefetch.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/stackPrefetch/stackPrefetch.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/touch/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/triggerAnnotationRender.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/triggerAnnotationRenderForToolGroupIds.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/triggerAnnotationRenderForViewportIds.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/viewportFilters/filterViewportsWithFrameOfReferenceUID.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/viewportFilters/filterViewportsWithParallelNormals.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/viewportFilters/filterViewportsWithToolEnabled.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/Colorbar.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/ViewportColorbar.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/enums/ColorbarRangeTextPosition.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/windowlevel/calculateMinMaxMean.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/windowlevel/extractWindowLevelRegionToolData.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/windowlevel/getLuminanceFromRegion.js","webpack:///../../../node_modules/@icons/material/CheckIcon.js","webpack:///../../../node_modules/@icons/material/UnfoldMoreHorizontalIcon.js","webpack:///../../../node_modules/@kitware/vtk.js/Filters/General/ImageMarchingSquares.js","webpack:///../../../node_modules/dicomweb-client/build/dicomweb-client.es.js","webpack:///../../../node_modules/lodash.get/index.js","webpack:///../../../node_modules/lodash.uniqby/index.js","webpack:///../../../node_modules/lodash/_DataView.js","webpack:///../../../node_modules/lodash/_Hash.js","webpack:///../../../node_modules/lodash/_ListCache.js","webpack:///../../../node_modules/lodash/_Map.js","webpack:///../../../node_modules/lodash/_MapCache.js","webpack:///../../../node_modules/lodash/_Promise.js","webpack:///../../../node_modules/lodash/_Set.js","webpack:///../../../node_modules/lodash/_SetCache.js","webpack:///../../../node_modules/lodash/_Stack.js","webpack:///../../../node_modules/lodash/_Uint8Array.js","webpack:///../../../node_modules/lodash/_WeakMap.js","webpack:///../../../node_modules/lodash/_arrayEach.js","webpack:///../../../node_modules/lodash/_arrayFilter.js","webpack:///../../../node_modules/lodash/_arrayLikeKeys.js","webpack:///../../../node_modules/lodash/_arrayMap.js","webpack:///../../../node_modules/lodash/_arrayPush.js","webpack:///../../../node_modules/lodash/_arraySome.js","webpack:///../../../node_modules/lodash/_assignValue.js","webpack:///../../../node_modules/lodash/_assocIndexOf.js","webpack:///../../../node_modules/lodash/_baseAssign.js","webpack:///../../../node_modules/lodash/_baseAssignIn.js","webpack:///../../../node_modules/lodash/_baseAssignValue.js","webpack:///../../../node_modules/lodash/_baseClone.js","webpack:///../../../node_modules/lodash/_baseCreate.js","webpack:///../../../node_modules/lodash/_baseEach.js","webpack:///../../../node_modules/lodash/_baseFor.js","webpack:///../../../node_modules/lodash/_baseForOwn.js","webpack:///../../../node_modules/lodash/_baseGet.js","webpack:///../../../node_modules/lodash/_baseGetAllKeys.js","webpack:///../../../node_modules/lodash/_baseHasIn.js","webpack:///../../../node_modules/lodash/_baseIsArguments.js","webpack:///../../../node_modules/lodash/_baseIsEqual.js","webpack:///../../../node_modules/lodash/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash/_baseIsMap.js","webpack:///../../../node_modules/lodash/_baseIsMatch.js","webpack:///../../../node_modules/lodash/_baseIsNative.js","webpack:///../../../node_modules/lodash/_baseIsSet.js","webpack:///../../../node_modules/lodash/_baseIsTypedArray.js","webpack:///../../../node_modules/lodash/_baseIteratee.js","webpack:///../../../node_modules/lodash/_baseKeys.js","webpack:///../../../node_modules/lodash/_baseKeysIn.js","webpack:///../../../node_modules/lodash/_baseMap.js","webpack:///../../../node_modules/lodash/_baseMatches.js","webpack:///../../../node_modules/lodash/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash/_baseProperty.js","webpack:///../../../node_modules/lodash/_basePropertyDeep.js","webpack:///../../../node_modules/lodash/_baseTimes.js","webpack:///../../../node_modules/lodash/_baseToString.js","webpack:///../../../node_modules/lodash/_baseUnary.js","webpack:///../../../node_modules/lodash/_cacheHas.js","webpack:///../../../node_modules/lodash/_castFunction.js","webpack:///../../../node_modules/lodash/_castPath.js","webpack:///../../../node_modules/lodash/_cloneArrayBuffer.js","webpack:///../../../node_modules/lodash/_cloneBuffer.js","webpack:///../../../node_modules/lodash/_cloneDataView.js","webpack:///../../../node_modules/lodash/_cloneRegExp.js","webpack:///../../../node_modules/lodash/_cloneSymbol.js","webpack:///../../../node_modules/lodash/_cloneTypedArray.js","webpack:///../../../node_modules/lodash/_copyArray.js","webpack:///../../../node_modules/lodash/_copyObject.js","webpack:///../../../node_modules/lodash/_copySymbols.js","webpack:///../../../node_modules/lodash/_copySymbolsIn.js","webpack:///../../../node_modules/lodash/_coreJsData.js","webpack:///../../../node_modules/lodash/_createBaseEach.js","webpack:///../../../node_modules/lodash/_createBaseFor.js","webpack:///../../../node_modules/lodash/_defineProperty.js","webpack:///../../../node_modules/lodash/_equalArrays.js","webpack:///../../../node_modules/lodash/_equalByTag.js","webpack:///../../../node_modules/lodash/_equalObjects.js","webpack:///../../../node_modules/lodash/_getAllKeys.js","webpack:///../../../node_modules/lodash/_getAllKeysIn.js","webpack:///../../../node_modules/lodash/_getMapData.js","webpack:///../../../node_modules/lodash/_getMatchData.js","webpack:///../../../node_modules/lodash/_getNative.js","webpack:///../../../node_modules/lodash/_getPrototype.js","webpack:///../../../node_modules/lodash/_getSymbols.js","webpack:///../../../node_modules/lodash/_getSymbolsIn.js","webpack:///../../../node_modules/lodash/_getTag.js","webpack:///../../../node_modules/lodash/_getValue.js","webpack:///../../../node_modules/lodash/_hasPath.js","webpack:///../../../node_modules/lodash/_hashClear.js","webpack:///../../../node_modules/lodash/_hashDelete.js","webpack:///../../../node_modules/lodash/_hashGet.js","webpack:///../../../node_modules/lodash/_hashHas.js","webpack:///../../../node_modules/lodash/_hashSet.js","webpack:///../../../node_modules/lodash/_initCloneArray.js","webpack:///../../../node_modules/lodash/_initCloneByTag.js","webpack:///../../../node_modules/lodash/_initCloneObject.js","webpack:///../../../node_modules/lodash/_isIndex.js","webpack:///../../../node_modules/lodash/_isKey.js","webpack:///../../../node_modules/lodash/_isKeyable.js","webpack:///../../../node_modules/lodash/_isMasked.js","webpack:///../../../node_modules/lodash/_isPrototype.js","webpack:///../../../node_modules/lodash/_isStrictComparable.js","webpack:///../../../node_modules/lodash/_listCacheClear.js","webpack:///../../../node_modules/lodash/_listCacheDelete.js","webpack:///../../../node_modules/lodash/_listCacheGet.js","webpack:///../../../node_modules/lodash/_listCacheHas.js","webpack:///../../../node_modules/lodash/_listCacheSet.js","webpack:///../../../node_modules/lodash/_mapCacheClear.js","webpack:///../../../node_modules/lodash/_mapCacheDelete.js","webpack:///../../../node_modules/lodash/_mapCacheGet.js","webpack:///../../../node_modules/lodash/_mapCacheHas.js","webpack:///../../../node_modules/lodash/_mapCacheSet.js","webpack:///../../../node_modules/lodash/_mapToArray.js","webpack:///../../../node_modules/lodash/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash/_memoizeCapped.js","webpack:///../../../node_modules/lodash/_nativeCreate.js","webpack:///../../../node_modules/lodash/_nativeKeys.js","webpack:///../../../node_modules/lodash/_nativeKeysIn.js","webpack:///../../../node_modules/lodash/_nodeUtil.js","webpack:///../../../node_modules/lodash/_overArg.js","webpack:///../../../node_modules/lodash/_setCacheAdd.js","webpack:///../../../node_modules/lodash/_setCacheHas.js","webpack:///../../../node_modules/lodash/_setToArray.js","webpack:///../../../node_modules/lodash/_stackClear.js","webpack:///../../../node_modules/lodash/_stackDelete.js","webpack:///../../../node_modules/lodash/_stackGet.js","webpack:///../../../node_modules/lodash/_stackHas.js","webpack:///../../../node_modules/lodash/_stackSet.js","webpack:///../../../node_modules/lodash/_stringToPath.js","webpack:///../../../node_modules/lodash/_toKey.js","webpack:///../../../node_modules/lodash/_toSource.js","webpack:///../../../node_modules/lodash/cloneDeep.js","webpack:///../../../node_modules/lodash/eq.js","webpack:///../../../node_modules/lodash/forOwn.js","webpack:///../../../node_modules/lodash/get.js","webpack:///../../../node_modules/lodash/hasIn.js","webpack:///../../../node_modules/lodash/identity.js","webpack:///../../../node_modules/lodash/isArguments.js","webpack:///../../../node_modules/lodash/isArray.js","webpack:///../../../node_modules/lodash/isArrayLike.js","webpack:///../../../node_modules/lodash/isBuffer.js","webpack:///../../../node_modules/lodash/isFunction.js","webpack:///../../../node_modules/lodash/isLength.js","webpack:///../../../node_modules/lodash/isMap.js","webpack:///../../../node_modules/lodash/isPlainObject.js","webpack:///../../../node_modules/lodash/isSet.js","webpack:///../../../node_modules/lodash/isString.js","webpack:///../../../node_modules/lodash/isTypedArray.js","webpack:///../../../node_modules/lodash/keys.js","webpack:///../../../node_modules/lodash/keysIn.js","webpack:///../../../node_modules/lodash/map.js","webpack:///../../../node_modules/lodash/memoize.js","webpack:///../../../node_modules/lodash/property.js","webpack:///../../../node_modules/lodash/stubArray.js","webpack:///../../../node_modules/lodash/stubFalse.js","webpack:///../../../node_modules/lodash/toString.js","webpack:///../../../node_modules/react-color/es/helpers/checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Alpha.js","webpack:///../../../node_modules/react-color/es/helpers/alpha.js","webpack:///../../../node_modules/react-color/es/components/common/EditableInput.js","webpack:///../../../node_modules/react-color/es/helpers/hue.js","webpack:///../../../node_modules/react-color/es/components/common/Hue.js","webpack:///../../../node_modules/lodash-es/_listCacheClear.js","webpack:///../../../node_modules/lodash-es/eq.js","webpack:///../../../node_modules/lodash-es/_assocIndexOf.js","webpack:///../../../node_modules/lodash-es/_listCacheDelete.js","webpack:///../../../node_modules/lodash-es/_listCacheGet.js","webpack:///../../../node_modules/lodash-es/_listCacheHas.js","webpack:///../../../node_modules/lodash-es/_listCacheSet.js","webpack:///../../../node_modules/lodash-es/_ListCache.js","webpack:///../../../node_modules/lodash-es/_stackClear.js","webpack:///../../../node_modules/lodash-es/_stackDelete.js","webpack:///../../../node_modules/lodash-es/_stackGet.js","webpack:///../../../node_modules/lodash-es/_stackHas.js","webpack:///../../../node_modules/lodash-es/_freeGlobal.js","webpack:///../../../node_modules/lodash-es/_root.js","webpack:///../../../node_modules/lodash-es/_Symbol.js","webpack:///../../../node_modules/lodash-es/_getRawTag.js","webpack:///../../../node_modules/lodash-es/_objectToString.js","webpack:///../../../node_modules/lodash-es/_baseGetTag.js","webpack:///../../../node_modules/lodash-es/isObject.js","webpack:///../../../node_modules/lodash-es/isFunction.js","webpack:///../../../node_modules/lodash-es/_coreJsData.js","webpack:///../../../node_modules/lodash-es/_isMasked.js","webpack:///../../../node_modules/lodash-es/_toSource.js","webpack:///../../../node_modules/lodash-es/_baseIsNative.js","webpack:///../../../node_modules/lodash-es/_getValue.js","webpack:///../../../node_modules/lodash-es/_getNative.js","webpack:///../../../node_modules/lodash-es/_Map.js","webpack:///../../../node_modules/lodash-es/_nativeCreate.js","webpack:///../../../node_modules/lodash-es/_hashClear.js","webpack:///../../../node_modules/lodash-es/_hashDelete.js","webpack:///../../../node_modules/lodash-es/_hashGet.js","webpack:///../../../node_modules/lodash-es/_hashHas.js","webpack:///../../../node_modules/lodash-es/_hashSet.js","webpack:///../../../node_modules/lodash-es/_Hash.js","webpack:///../../../node_modules/lodash-es/_mapCacheClear.js","webpack:///../../../node_modules/lodash-es/_isKeyable.js","webpack:///../../../node_modules/lodash-es/_getMapData.js","webpack:///../../../node_modules/lodash-es/_mapCacheDelete.js","webpack:///../../../node_modules/lodash-es/_mapCacheGet.js","webpack:///../../../node_modules/lodash-es/_mapCacheHas.js","webpack:///../../../node_modules/lodash-es/_mapCacheSet.js","webpack:///../../../node_modules/lodash-es/_MapCache.js","webpack:///../../../node_modules/lodash-es/_stackSet.js","webpack:///../../../node_modules/lodash-es/_Stack.js","webpack:///../../../node_modules/lodash-es/_defineProperty.js","webpack:///../../../node_modules/lodash-es/_baseAssignValue.js","webpack:///../../../node_modules/lodash-es/_assignMergeValue.js","webpack:///../../../node_modules/lodash-es/_baseFor.js","webpack:///../../../node_modules/lodash-es/_createBaseFor.js","webpack:///../../../node_modules/lodash-es/_cloneBuffer.js","webpack:///../../../node_modules/lodash-es/_Uint8Array.js","webpack:///../../../node_modules/lodash-es/_cloneArrayBuffer.js","webpack:///../../../node_modules/lodash-es/_cloneTypedArray.js","webpack:///../../../node_modules/lodash-es/_copyArray.js","webpack:///../../../node_modules/lodash-es/_baseCreate.js","webpack:///../../../node_modules/lodash-es/_overArg.js","webpack:///../../../node_modules/lodash-es/_getPrototype.js","webpack:///../../../node_modules/lodash-es/_isPrototype.js","webpack:///../../../node_modules/lodash-es/_initCloneObject.js","webpack:///../../../node_modules/lodash-es/isObjectLike.js","webpack:///../../../node_modules/lodash-es/_baseIsArguments.js","webpack:///../../../node_modules/lodash-es/isArguments.js","webpack:///../../../node_modules/lodash-es/isArray.js","webpack:///../../../node_modules/lodash-es/isLength.js","webpack:///../../../node_modules/lodash-es/isArrayLike.js","webpack:///../../../node_modules/lodash-es/isArrayLikeObject.js","webpack:///../../../node_modules/lodash-es/stubFalse.js","webpack:///../../../node_modules/lodash-es/isBuffer.js","webpack:///../../../node_modules/lodash-es/isPlainObject.js","webpack:///../../../node_modules/lodash-es/_baseIsTypedArray.js","webpack:///../../../node_modules/lodash-es/_baseUnary.js","webpack:///../../../node_modules/lodash-es/_nodeUtil.js","webpack:///../../../node_modules/lodash-es/isTypedArray.js","webpack:///../../../node_modules/lodash-es/_safeGet.js","webpack:///../../../node_modules/lodash-es/_assignValue.js","webpack:///../../../node_modules/lodash-es/_copyObject.js","webpack:///../../../node_modules/lodash-es/_baseTimes.js","webpack:///../../../node_modules/lodash-es/_isIndex.js","webpack:///../../../node_modules/lodash-es/_arrayLikeKeys.js","webpack:///../../../node_modules/lodash-es/_nativeKeysIn.js","webpack:///../../../node_modules/lodash-es/_baseKeysIn.js","webpack:///../../../node_modules/lodash-es/keysIn.js","webpack:///../../../node_modules/lodash-es/toPlainObject.js","webpack:///../../../node_modules/lodash-es/_baseMergeDeep.js","webpack:///../../../node_modules/lodash-es/_baseMerge.js","webpack:///../../../node_modules/lodash-es/identity.js","webpack:///../../../node_modules/lodash-es/_apply.js","webpack:///../../../node_modules/lodash-es/_overRest.js","webpack:///../../../node_modules/lodash-es/constant.js","webpack:///../../../node_modules/lodash-es/_baseSetToString.js","webpack:///../../../node_modules/lodash-es/_shortOut.js","webpack:///../../../node_modules/lodash-es/_setToString.js","webpack:///../../../node_modules/lodash-es/_baseRest.js","webpack:///../../../node_modules/lodash-es/_isIterateeCall.js","webpack:///../../../node_modules/lodash-es/merge.js","webpack:///../../../node_modules/lodash-es/_createAssigner.js","webpack:///../../../node_modules/react-color/es/components/common/Raised.js","webpack:///../../../node_modules/lodash-es/now.js","webpack:///../../../node_modules/lodash-es/_trimmedEndIndex.js","webpack:///../../../node_modules/lodash-es/_baseTrim.js","webpack:///../../../node_modules/lodash-es/isSymbol.js","webpack:///../../../node_modules/lodash-es/toNumber.js","webpack:///../../../node_modules/lodash-es/debounce.js","webpack:///../../../node_modules/lodash-es/throttle.js","webpack:///../../../node_modules/react-color/es/helpers/saturation.js","webpack:///../../../node_modules/react-color/es/components/common/Saturation.js","webpack:///../../../node_modules/lodash-es/_arrayEach.js","webpack:///../../../node_modules/lodash-es/_nativeKeys.js","webpack:///../../../node_modules/lodash-es/_baseKeys.js","webpack:///../../../node_modules/lodash-es/keys.js","webpack:///../../../node_modules/lodash-es/_baseEach.js","webpack:///../../../node_modules/lodash-es/_createBaseEach.js","webpack:///../../../node_modules/lodash-es/_baseForOwn.js","webpack:///../../../node_modules/lodash-es/_castFunction.js","webpack:///../../../node_modules/lodash-es/forEach.js","webpack:///../../../node_modules/tinycolor2/esm/tinycolor.js","webpack:///../../../node_modules/react-color/es/helpers/color.js","webpack:///../../../node_modules/react-color/es/components/common/ColorWrap.js","webpack:///../../../node_modules/react-color/es/helpers/interaction.js","webpack:///../../../node_modules/react-color/es/components/common/Swatch.js","webpack:///../../../node_modules/react-color/es/components/alpha/AlphaPointer.js","webpack:///../../../node_modules/react-color/es/components/alpha/Alpha.js","webpack:///../../../node_modules/lodash-es/_arrayMap.js","webpack:///../../../node_modules/lodash-es/_setCacheAdd.js","webpack:///../../../node_modules/lodash-es/_setCacheHas.js","webpack:///../../../node_modules/lodash-es/_SetCache.js","webpack:///../../../node_modules/lodash-es/_arraySome.js","webpack:///../../../node_modules/lodash-es/_cacheHas.js","webpack:///../../../node_modules/lodash-es/_equalArrays.js","webpack:///../../../node_modules/lodash-es/_mapToArray.js","webpack:///../../../node_modules/lodash-es/_setToArray.js","webpack:///../../../node_modules/lodash-es/_equalByTag.js","webpack:///../../../node_modules/lodash-es/_arrayPush.js","webpack:///../../../node_modules/lodash-es/_baseGetAllKeys.js","webpack:///../../../node_modules/lodash-es/_arrayFilter.js","webpack:///../../../node_modules/lodash-es/stubArray.js","webpack:///../../../node_modules/lodash-es/_getSymbols.js","webpack:///../../../node_modules/lodash-es/_getAllKeys.js","webpack:///../../../node_modules/lodash-es/_equalObjects.js","webpack:///../../../node_modules/lodash-es/_DataView.js","webpack:///../../../node_modules/lodash-es/_Promise.js","webpack:///../../../node_modules/lodash-es/_Set.js","webpack:///../../../node_modules/lodash-es/_WeakMap.js","webpack:///../../../node_modules/lodash-es/_getTag.js","webpack:///../../../node_modules/lodash-es/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash-es/_baseIsEqual.js","webpack:///../../../node_modules/lodash-es/_baseIsMatch.js","webpack:///../../../node_modules/lodash-es/_isStrictComparable.js","webpack:///../../../node_modules/lodash-es/_getMatchData.js","webpack:///../../../node_modules/lodash-es/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash-es/_baseMatches.js","webpack:///../../../node_modules/lodash-es/_isKey.js","webpack:///../../../node_modules/lodash-es/memoize.js","webpack:///../../../node_modules/lodash-es/_stringToPath.js","webpack:///../../../node_modules/lodash-es/_memoizeCapped.js","webpack:///../../../node_modules/lodash-es/_baseToString.js","webpack:///../../../node_modules/lodash-es/toString.js","webpack:///../../../node_modules/lodash-es/_castPath.js","webpack:///../../../node_modules/lodash-es/_toKey.js","webpack:///../../../node_modules/lodash-es/_baseGet.js","webpack:///../../../node_modules/lodash-es/get.js","webpack:///../../../node_modules/lodash-es/_baseHasIn.js","webpack:///../../../node_modules/lodash-es/_hasPath.js","webpack:///../../../node_modules/lodash-es/hasIn.js","webpack:///../../../node_modules/lodash-es/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash-es/_baseProperty.js","webpack:///../../../node_modules/lodash-es/_basePropertyDeep.js","webpack:///../../../node_modules/lodash-es/property.js","webpack:///../../../node_modules/lodash-es/_baseIteratee.js","webpack:///../../../node_modules/lodash-es/_baseMap.js","webpack:///../../../node_modules/lodash-es/map.js","webpack:///../../../node_modules/react-color/es/components/block/BlockSwatches.js","webpack:///../../../node_modules/react-color/es/components/block/Block.js","webpack:///../../../node_modules/material-colors/dist/colors.es2015.js","webpack:///../../../node_modules/react-color/es/components/circle/CircleSwatch.js","webpack:///../../../node_modules/react-color/es/components/circle/Circle.js","webpack:///../../../node_modules/lodash-es/isUndefined.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromeFields.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointer.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/chrome/Chrome.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactColor.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactFields.js","webpack:///../../../node_modules/react-color/es/components/compact/Compact.js","webpack:///../../../node_modules/react-color/es/components/github/GithubSwatch.js","webpack:///../../../node_modules/react-color/es/components/github/Github.js","webpack:///../../../node_modules/react-color/es/components/hue/HuePointer.js","webpack:///../../../node_modules/react-color/es/components/hue/Hue.js","webpack:///../../../node_modules/react-color/es/components/material/Material.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopFields.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointerCircle.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointer.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopButton.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPreviews.js","webpack:///../../../node_modules/react-color/es/components/photoshop/Photoshop.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchFields.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchPresetColors.js","webpack:///../../../node_modules/react-color/es/components/sketch/Sketch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatches.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderPointer.js","webpack:///../../../node_modules/react-color/es/components/slider/Slider.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesColor.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesGroup.js","webpack:///../../../node_modules/react-color/es/components/swatches/Swatches.js","webpack:///../../../node_modules/react-color/es/components/twitter/Twitter.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointer.js","webpack:///../../../node_modules/react-color/es/components/google/GoogleFields.js","webpack:///../../../node_modules/react-color/es/components/google/Google.js","webpack:///../../../node_modules/react-window/dist/index.esm.js","webpack:///../../../node_modules/reactcss/lib/autoprefix.js","webpack:///../../../node_modules/reactcss/lib/components/active.js","webpack:///../../../node_modules/reactcss/lib/components/hover.js","webpack:///../../../node_modules/reactcss/lib/flattenNames.js","webpack:///../../../node_modules/reactcss/lib/index.js","webpack:///../../../node_modules/reactcss/lib/loop.js","webpack:///../../../node_modules/reactcss/lib/mergeClasses.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js","webpack:///../../../node_modules/use-sync-external-store/shim/index.js","webpack:///../../../node_modules/use-sync-external-store/shim/with-selector.js","webpack:///../../../node_modules/zustand/esm/vanilla.mjs","webpack:///../../../node_modules/zustand/esm/index.mjs","webpack:///../../../node_modules/zustand/esm/middleware.mjs"],"sourcesContent":["/**\r\n * Javascript object that handles dates and compute the time.\r\n *\r\n * @export\r\n * @class FullDateInterface\r\n */\nclass FullDateInterface {\n  /**\r\n   * Creates an instance of FullDateInterface.\r\n   * @param {string} date formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n   * @memberof FullDateInterface\r\n   */\n  constructor(date) {\n    this.fullDate = date;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in sec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInSec() {\n    // yyyy-mm-ddTHH:MM:SS.FFFFFFZ\n    const dateString = this.fullDate.substring(0, 10);\n    const timeString = this.fullDate.substring(11, 28); // yyyy-mm-dd\n\n    const yyyy = parseInt(dateString.substring(0, 4), 10);\n    const mm = dateString.length >= 7 ? parseInt(dateString.substring(5, 7), 10) : undefined;\n    const dd = dateString.length >= 10 ? parseInt(dateString.substring(8, 10), 10) : undefined;\n\n    if (isNaN(yyyy) || mm !== undefined && isNaN(mm) || dd !== undefined && isNaN(dd) || yyyy > 3000 || mm && (mm < 1 || mm > 12) || dd && (dd < 1 || dd > 31)) {\n      throw new Error(`invalid date '${dateString}'`);\n    }\n\n    const dateJS = new Date(`${dateString}T00:00:00.000000Z`); // HHMMSS.FFFFFF\n\n    const HH = parseInt(timeString.substring(0, 2), 10);\n    const MM = timeString.length >= 5 ? parseInt(timeString.substring(3, 5), 10) : undefined;\n    const SS = timeString.length >= 8 ? parseInt(timeString.substring(6, 8), 10) : undefined;\n    const fractionalStr = timeString.substring(9, 15);\n    const FFFFFF = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, -fractionalStr.length) : undefined;\n\n    if (isNaN(HH) || MM !== undefined && isNaN(MM) || SS !== undefined && isNaN(SS) || FFFFFF !== undefined && isNaN(FFFFFF) || HH < 0 || HH > 23 || MM && (MM < 0 || MM > 59) || SS && (SS < 0 || SS > 59) || FFFFFF && (FFFFFF < 0 || FFFFFF > 999999)) {\n      throw new Error(`invalid time '${timeString}'`);\n    }\n\n    let timeInSec = dateJS.getTime() / 1000;\n    timeInSec += HH * 3600;\n\n    if (MM !== undefined) {\n      timeInSec += MM * 60;\n    }\n\n    if (SS !== undefined) {\n      timeInSec += SS;\n    }\n\n    if (FFFFFF !== undefined) {\n      timeInSec += FFFFFF;\n    }\n\n    return timeInSec;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in microsec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInMicroSec() {\n    const timeInMicroSec = this.getTimeInSec() * 1e6;\n    return timeInMicroSec;\n  }\n\n}\n/**\r\n * Combines two javascript objects containing the date and time information\r\n *\r\n * @export\r\n * @param {DateInterface} date\r\n * @param {TimeInterface} time\r\n * @returns {FullDateInterface}\r\n */\n\nfunction combineDateTime(date, time) {\n  const hours = `${time.hours || '00'}`.padStart(2, '0');\n  const minutes = `${time.minutes || '00'}`.padStart(2, '0');\n  const seconds = `${time.seconds || '00'}`.padStart(2, '0');\n  const month = `${date.month}`.padStart(2, '0');\n  const day = `${date.day}`.padStart(2, '0');\n  const fractionalSeconds = `${time.fractionalSeconds || '000000'}`.padEnd(6, '0');\n  const dateString = `${date.year}-${month}-${day}`;\n  const timeString = `T${hours}:${minutes}:${seconds}.${fractionalSeconds}Z`;\n  const fullDateString = `${dateString}${timeString}`;\n  return new FullDateInterface(fullDateString);\n}\n\n/**\r\n * Check the number of days for a picked month and year\r\n * algorithm based on http://stackoverflow.com/questions/1433030/validate-number-of-days-in-a-given-month\r\n *\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {number} number of days\r\n */\nfunction daysInMonth(m, y) {\n  // m is 0 indexed: 0-11\n  switch (m) {\n    case 2:\n      return y % 4 === 0 && y % 100 || y % 400 === 0 ? 29 : 28;\n\n    case 9:\n    case 4:\n    case 6:\n    case 11:\n      return 30;\n\n    default:\n      return 31;\n  }\n}\n/**\r\n * Check if the date is valid\r\n *\r\n * @param {number} d\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {boolean} boolean result\r\n */\n\n\nfunction isValidDate(d, m, y) {\n  // make year is a number\n  if (isNaN(y)) {\n    return false;\n  }\n\n  return m > 0 && m <= 12 && d > 0 && d <= daysInMonth(m, y);\n}\n/**\r\n * Parses a DA formatted string into a Javascript object\r\n * @param {string} date a string in the DA VR format\r\n * @param {boolean} [validate] - true if an exception should be thrown if the date is invalid\r\n * @returns {DateInterface} Javascript object with properties year, month and day or undefined if not present or not 8 bytes long\r\n */\n\n\nfunction parseDA(date) {\n  if (date === undefined || date === null || date.length !== 8 || typeof date !== 'string') {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  const yyyy = parseInt(date.substring(0, 4), 10);\n  const mm = parseInt(date.substring(4, 6), 10);\n  const dd = parseInt(date.substring(6, 8), 10);\n\n  if (isValidDate(dd, mm, yyyy) !== true) {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  return {\n    year: yyyy,\n    month: mm,\n    day: dd\n  };\n}\n\n/**\r\n * Parses a TM formatted string into a javascript object with properties for hours, minutes, seconds and fractionalSeconds\r\n * @param {string} time - a string in the TM VR format\r\n * @returns {string} javascript object with properties for hours, minutes, seconds and fractionalSeconds or undefined if no element or data.  Missing fields are set to undefined\r\n */\nfunction parseTM(time) {\n  if (time === null || time === undefined || time.length < 2 || typeof time !== 'string') {\n    // must at least have HH\n    throw new Error(`invalid TM '${time}'`);\n  } // 0123456789\n  // HHMMSS.FFFFFF\n\n\n  const hh = parseInt(time.substring(0, 2), 10);\n  const mm = time.length >= 4 ? parseInt(time.substring(2, 4), 10) : undefined;\n  const ss = time.length >= 6 ? parseInt(time.substring(4, 6), 10) : undefined;\n  const fractionalStr = time.length >= 8 ? time.substring(7, 13) : undefined;\n  const ffffff = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, 6 - fractionalStr.length) : undefined;\n\n  if (isNaN(hh) || mm !== undefined && isNaN(mm) || ss !== undefined && isNaN(ss) || ffffff !== undefined && isNaN(ffffff) || hh < 0 || hh > 23 || mm && (mm < 0 || mm > 59) || ss && (ss < 0 || ss > 59) || ffffff && (ffffff < 0 || ffffff > 999999)) {\n    throw new Error(`invalid TM '${time}'`);\n  }\n\n  return {\n    hours: hh,\n    minutes: mm,\n    seconds: ss,\n    fractionalSeconds: ffffff\n  };\n}\n\n/**\r\n * Utility to create a FullDateInterface object given a string formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n *\r\n * @export\r\n * @param {string} dateTime\r\n * @returns {FullDateInterface}\r\n */\n\nfunction dateTimeToFullDateInterface(dateTime) {\n  if (dateTime === undefined || dateTime === null) {\n    throw new Error('dateTimeToFullDateInterface : dateTime not defined.');\n  }\n\n  const date = parseDA(dateTime.substring(0, 8));\n  const time = parseTM(dateTime.substring(8));\n  return combineDateTime(date, time);\n}\n\n/**\r\n * Calculate the scan times\r\n *\r\n * @export\r\n * @param {InstanceMetadataForScanTimes[]} instances\r\n * @returns {FullDateInterface[]}\r\n */\n\nfunction calculateScanTimes(instances) {\n  const {\n    SeriesDate,\n    SeriesTime,\n    GEPrivatePostInjectionDateTime\n  } = instances[0];\n  const results = new Array(instances.length);\n  const seriesDate = parseDA(SeriesDate);\n  const seriesTime = parseTM(SeriesTime);\n  const seriesDateTime = combineDateTime(seriesDate, seriesTime);\n  let earliestAcquisitionDateTime = new FullDateInterface(`3000-01-01T00:00:00.000000Z`);\n  let timeError = earliestAcquisitionDateTime.getTimeInSec();\n  instances.forEach(instance => {\n    const {\n      AcquisitionDate,\n      AcquisitionTime\n    } = instance;\n    const acquisitionDate = parseDA(AcquisitionDate);\n    const acquisitionTime = parseTM(AcquisitionTime);\n    const acquisitionDateTime = combineDateTime(acquisitionDate, acquisitionTime);\n\n    if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n      earliestAcquisitionDateTime = acquisitionDateTime;\n    } else {\n      earliestAcquisitionDateTime = acquisitionDateTime.getTimeInSec() < earliestAcquisitionDateTime.getTimeInSec() ? acquisitionDateTime : earliestAcquisitionDateTime;\n    }\n  });\n\n  if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n    throw new Error('Earliest acquisition time or date could not be parsed.');\n  }\n\n  if (seriesDateTime.getTimeInSec() <= earliestAcquisitionDateTime.getTimeInSec()) {\n    return results.fill(seriesDateTime);\n  } else {\n    if (GEPrivatePostInjectionDateTime) {\n      // GE Private scan\n      return results.fill(dateTimeToFullDateInterface(GEPrivatePostInjectionDateTime));\n    } else {\n      /*const hasValidFrameTimes = instances.every(instance => {\r\n        return (\r\n          instance.FrameReferenceTime &&\r\n          instance.FrameReferenceTime > 0 &&\r\n          instance.ActualFrameDuration &&\r\n          instance.ActualFrameDuration > 0\r\n        );\r\n      });*/\n      // TODO: Temporarily commented out the checks and logic below to\n      // investigate the BQML_AC_DT_lessThan_S_DT_SIEMENS-instances case\n      //if (!hasValidFrameTimes) {\n      return results.fill(earliestAcquisitionDateTime); //}\n\n      /* Siemens PETsyngo\t3.x\tmulti-injection logic\r\n      - backcompute\tfrom\tcenter\t(average\tcount\trate\t)\tof\ttime\twindow\tfor\tbed\tposition\t(frame)\tin\tseries (reliable\tin\tall\tcases)\r\n      - Acquisition\tDate\t(0x0008,0x0022)\tand\tTime\t(0x0008,0x0032) are\tthe\tstart\tof\tthe\tbed\tposition\t(frame)\r\n      - Frame\tReference\tTime\t(0x0054,0x1300) is\tthe\toffset\t(ms)\tfrom\tthe\tscan\tDate\tand\tTime we\twant\tto\tthe\taverage\tcount\trate\ttime\r\n      */\n\n      /*return instances.map(instance => {\r\n        const {\r\n          FrameReferenceTime,\r\n          ActualFrameDuration,\r\n          RadionuclideHalfLife,\r\n          AcquisitionDate,\r\n          AcquisitionTime,\r\n        } = instance;\r\n        // Some of these checks are only here because the compiler is complaining\r\n        // We could potentially use the ! operator instead\r\n        if (!FrameReferenceTime || FrameReferenceTime <= 0) {\r\n          throw new Error(\r\n            `FrameReferenceTime is invalid: ${FrameReferenceTime}`\r\n          );\r\n        }\r\n               if (!ActualFrameDuration || ActualFrameDuration <= 0) {\r\n          throw new Error(\r\n            `ActualFrameDuration is invalid: ${ActualFrameDuration}`\r\n          );\r\n        }\r\n               if (!RadionuclideHalfLife) {\r\n          throw new Error('RadionuclideHalfLife is required');\r\n        }\r\n               if (!AcquisitionDate) {\r\n          throw new Error('AcquisitionDate is required');\r\n        }\r\n               if (!AcquisitionTime) {\r\n          throw new Error('AcquisitionTime is required');\r\n        }\r\n               const acquisitionDate: DateInterface = parseDA(AcquisitionDate);\r\n        const acquisitionTime: TimeInterface = parseTM(AcquisitionTime);\r\n        const acquisitionDateTime: FullDateInterface = combineDateTime(\r\n          acquisitionDate,\r\n          acquisitionTime\r\n        );\r\n               const frameDurationInSec = ActualFrameDuration / 1000;\r\n        const decayConstant = Math.log(2) / RadionuclideHalfLife;\r\n        const decayDuringFrame = decayConstant * frameDurationInSec;\r\n        // TODO: double check this is correctly copied from QIBA pseudocode\r\n        const averageCountRateTimeWithinFrameInSec =\r\n          (1 / decayConstant) *\r\n          Math.log(decayDuringFrame / (1 - Math.exp(-decayConstant)));\r\n        const scanDateTimeAsNumber =\r\n          Number(acquisitionDateTime) -\r\n          FrameReferenceTime / 1000 +\r\n          averageCountRateTimeWithinFrameInSec;\r\n               const scanDate = new Date(scanDateTimeAsNumber);\r\n        console.log('SIEMENS PATH');\r\n        console.log(new Date(scanDateTimeAsNumber));\r\n        return scanDate;\r\n      });*/\n    }\n  }\n}\n\nfunction calculateSUVlbmScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const weightSizeFactor = Math.pow(PatientWeight / (PatientSize * 100), 2); // reference: https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n  if (PatientSex === 'F') {\n    LBM = 1.07 * PatientWeight - 148 * weightSizeFactor;\n  } else if (PatientSex === 'M') {\n    LBM = 1.1 * PatientWeight - 120 * weightSizeFactor;\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n/**\r\n * From https://link.springer.com/article/10.1007/s00259-014-2961-x\r\n * and https://link.springer.com/article/10.2165/00003088-200544100-00004\r\n * and\r\n * @param inputs\r\n * @returns\r\n */\n\n\nfunction calculateSUVlbmJanmahasatianScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const bodyMassIndex = PatientWeight / Math.pow(PatientSize, 2);\n\n  if (PatientSex === 'F') {\n    LBM = 9270 * PatientWeight / (8780 + 244 * bodyMassIndex);\n  } else if (PatientSex === 'M') {\n    LBM = 9270 * PatientWeight / (6680 + 216 * bodyMassIndex);\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n\nfunction calculateSUVbsaScalingFactor(inputs) {\n  const {\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let BSA = Math.pow(PatientWeight, 0.425) * Math.pow(PatientSize * 100, 0.725) * 71.84;\n  return BSA;\n}\n\n/**\r\n * Calculate start time\r\n *\r\n * @export\r\n * @param {{\r\n *   RadiopharmaceuticalStartDateTime?: string;\r\n *   RadiopharmaceuticalStartTime?: string;\r\n *   SeriesDate?: string;\r\n * }} input\r\n * @returns {FullDateInterface}\r\n */\n\nfunction calculateStartTime(input) {\n  const {\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = input;\n  let time;\n  let date;\n\n  if (RadiopharmaceuticalStartDateTime) {\n    return dateTimeToFullDateInterface(RadiopharmaceuticalStartDateTime);\n  } else if (RadiopharmaceuticalStartTime && SeriesDate) {\n    // start Date\tis not explicit - assume\tsame as\tSeries Date;\n    // but consider\tspanning midnight\n    // TODO: do we need some logic to check if the scan went over midnight?\n    time = parseTM(RadiopharmaceuticalStartTime);\n    date = parseDA(SeriesDate);\n    return combineDateTime(date, time);\n  }\n\n  throw new Error(`Invalid input: ${input}`);\n}\n\n/**\r\n * The injected dose used to calculate SUV is corrected for the\r\n * decay that occurs between the time of injection and the start of the scan\r\n *\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {number[]}\r\n */\n\nfunction calculateDecayCorrection(instances) {\n  const {\n    RadionuclideTotalDose,\n    RadionuclideHalfLife,\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = instances[0];\n\n  if (RadionuclideTotalDose === undefined || RadionuclideTotalDose === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideTotalDose value not found.');\n  }\n\n  if (RadionuclideHalfLife === undefined || RadionuclideHalfLife === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideHalfLife value not found.');\n  }\n\n  const scanTimes = calculateScanTimes(instances);\n  const startTime = calculateStartTime({\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  });\n  return instances.map((_, index) => {\n    const scanTime = scanTimes[index];\n    const decayTimeInSec = scanTime.getTimeInSec() - startTime.getTimeInSec();\n\n    if (decayTimeInSec < 0) {\n      throw new Error('Decay time cannot be less than zero');\n    }\n\n    const decayedDose = RadionuclideTotalDose * Math.pow(2, -decayTimeInSec / RadionuclideHalfLife);\n    return 1 / decayedDose;\n  });\n}\n/**\r\n *\r\n * @param a Simple value or array of simple values\r\n * @param b Simple value or array of simple values\r\n * @returns boolean true if the values are equal.\r\n */\n\n\nconst deepEquals = (a, b) => {\n  return a === b || Array.isArray(a) && Array.isArray(b) && a.length === b.length && a.every((val, index) => val === b[index]);\n};\n/**\r\n * Calculate the SUV factor\r\n *\r\n * Note: Rescale Slope / Intercept must still be applied. These must be applied\r\n *       on a per-Frame basis, since some scanners may have different values per Frame.\r\n *\r\n * @export\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {ScalingFactorResult[]}\r\n */\n\n\nfunction calculateSUVScalingFactors(instances) {\n  const {\n    CorrectedImage,\n    Units,\n    PhilipsPETPrivateGroup,\n    PatientWeight,\n    PatientSex,\n    PatientSize\n  } = instances[0];\n\n  if (!CorrectedImage.includes('ATTN') || !CorrectedImage.includes('DECY')) {\n    throw new Error(`CorrectedImage must contain \"ATTN\" and \"DECY\": ${CorrectedImage}`);\n  } // Sanity check that every instance provided has identical\n  // values for series-level metadata. If not, the provided\n  // data is invalid.\n\n\n  const isSingleSeries = instances.every(instance => {\n    return instance.Units === Units && deepEquals(instance.CorrectedImage, CorrectedImage) && instance.PatientWeight === PatientWeight && instance.PatientSex === PatientSex && instance.PatientSize === PatientSize && instance.RadionuclideHalfLife === instances[0].RadionuclideHalfLife && instance.RadionuclideTotalDose === instances[0].RadionuclideTotalDose && instance.DecayCorrection === instances[0].DecayCorrection && instance.SeriesDate === instances[0].SeriesDate && instance.SeriesTime === instances[0].SeriesTime;\n  });\n\n  if (!isSingleSeries) {\n    throw new Error('The set of instances does not appear to come from one Series. Every instance must have identical values for series-level metadata properties');\n  } // Treat null, undefined and zero as a missing PatientWeight.\n\n\n  if (!PatientWeight) {\n    throw new Error('PatientWeight value is missing. It is not possible to calculate the SUV factors');\n  }\n\n  let decayCorrectionArray = new Array(instances.length);\n  decayCorrectionArray = calculateDecayCorrection(instances);\n  let results = new Array(instances.length);\n  const weightInGrams = PatientWeight * 1000;\n\n  if (Units === 'BQML') {\n    results = decayCorrectionArray.map(function (value) {\n      return value * weightInGrams;\n    });\n  } else if (Units === 'CNTS') {\n    const hasValidSUVScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP, _instance$PhilipsPETP2, _instance$PhilipsPETP3;\n\n      return instance.PhilipsPETPrivateGroup && ((_instance$PhilipsPETP = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP === void 0 ? void 0 : _instance$PhilipsPETP.SUVScaleFactor) !== null && ((_instance$PhilipsPETP2 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP2 === void 0 ? void 0 : _instance$PhilipsPETP2.SUVScaleFactor) !== undefined && ((_instance$PhilipsPETP3 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP3 === void 0 ? void 0 : _instance$PhilipsPETP3.SUVScaleFactor) !== 0;\n    });\n    const hasValidActivityConcentrationScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP4, _instance$PhilipsPETP5, _instance$PhilipsPETP6;\n\n      return instance.PhilipsPETPrivateGroup && !((_instance$PhilipsPETP4 = instance.PhilipsPETPrivateGroup) !== null && _instance$PhilipsPETP4 !== void 0 && _instance$PhilipsPETP4.SUVScaleFactor) && ((_instance$PhilipsPETP5 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP5 === void 0 ? void 0 : _instance$PhilipsPETP5.ActivityConcentrationScaleFactor) !== undefined && ((_instance$PhilipsPETP6 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP6 === void 0 ? void 0 : _instance$PhilipsPETP6.ActivityConcentrationScaleFactor) !== 0;\n    }); //console.log(`hasValidSUVScaleFactor: ${hasValidSUVScaleFactor}`);\n    //console.log(`hasValidActivityConcentrationScaleFactor: ${hasValidActivityConcentrationScaleFactor}`);\n\n    if (hasValidSUVScaleFactor) {\n      results = instances.map( // Added ! to tell Typescript that this can't be undefined, since we are testing it\n      // in the .every loop above.\n      instance => instance.PhilipsPETPrivateGroup.SUVScaleFactor);\n    } else if (hasValidActivityConcentrationScaleFactor) {\n      // if (0x7053,0x1000) not present, but (0x7053,0x1009) is present, then (0x7053,0x1009) * Rescale Slope,\n      // scales pixels to Bq/ml, and proceed as if Units are BQML\n      results = instances.map((instance, index) => {\n        // Added ! to tell Typescript that this can't be undefined, since we are testing it\n        // in the .every loop above.\n        return instance.PhilipsPETPrivateGroup.ActivityConcentrationScaleFactor * decayCorrectionArray[index] * weightInGrams;\n      });\n    } else {\n      throw new Error(`Units are in CNTS, but PhilipsPETPrivateGroup has invalid values: ${JSON.stringify(PhilipsPETPrivateGroup)}`);\n    }\n  } else if (Units === 'GML') {\n    // assumes that GML indicates SUVbw instead of SUVlbm\n    results.fill(1);\n  } else {\n    throw new Error(`Units has an invalid value: ${Units}`);\n  } // get BSA\n\n\n  let suvbsaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV bsa factors');\n  } else {\n    const sulInputs = {\n      PatientWeight,\n      PatientSize\n    };\n    suvbsaFactor = calculateSUVbsaScalingFactor(sulInputs);\n  } // get LBM\n\n\n  let suvlbmFactor;\n  let suvlbmJenmaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV lbm factors');\n  } else if (PatientSex === null || PatientSex === undefined) {\n    console.warn('PatientSex value is missing. It is not possible to calculate the SUV lbm factors');\n  } else {\n    const suvlbmInputs = {\n      PatientWeight,\n      PatientSex,\n      PatientSize\n    };\n    suvlbmFactor = calculateSUVlbmScalingFactor(suvlbmInputs);\n    suvlbmJenmaFactor = calculateSUVlbmJanmahasatianScalingFactor(suvlbmInputs);\n  }\n\n  return results.map(function (result, index) {\n    const factors = {\n      suvbw: result\n    };\n\n    if (suvbsaFactor) {\n      // multiply for BSA\n      factors.suvbsa = decayCorrectionArray[index] * suvbsaFactor;\n    }\n\n    if (suvlbmFactor) {\n      // multiply for LBM\n      factors.suvlbm = decayCorrectionArray[index] * suvlbmFactor;\n    }\n\n    if (suvlbmJenmaFactor) {\n      factors.suvlbmJanma = decayCorrectionArray[index] * suvlbmJenmaFactor;\n    } // factor formulaes taken from:\n    // https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n\n    return factors;\n  });\n}\n\nexport { calculateSUVScalingFactors };\n//# sourceMappingURL=calculate-suv.esm.js.map\n","let config = {};\nexport function getConfig() {\n    return config;\n}\nexport function setConfig(newConfig) {\n    config = newConfig;\n}\nexport function getAddOns() {\n    return config.addons;\n}\nlet polysegInitialized = false;\nexport function getPolySeg() {\n    if (!config.addons?.polySeg) {\n        console.warn('PolySeg add-on not configured. This will prevent automatic conversion between segmentation representations (labelmap, contour, surface). To enable these features, install @cornerstonejs/polymorphic-segmentation and register it during initialization: cornerstoneTools.init({ addons: { polySeg } }).');\n        return null;\n    }\n    const polyseg = config.addons.polySeg;\n    if (!polysegInitialized) {\n        polyseg.init();\n        polysegInitialized = true;\n    }\n    return polyseg;\n}\n","const CORNERSTONE_COLOR_LUT = [\n    [0, 0, 0, 0],\n    [221, 84, 84, 255],\n    [77, 228, 121, 255],\n    [166, 70, 235, 255],\n    [189, 180, 116, 255],\n    [109, 182, 196, 255],\n    [204, 101, 157, 255],\n    [123, 211, 94, 255],\n    [93, 87, 218, 255],\n    [225, 128, 80, 255],\n    [73, 232, 172, 255],\n    [181, 119, 186, 255],\n    [176, 193, 112, 255],\n    [105, 153, 200, 255],\n    [208, 97, 120, 255],\n    [90, 215, 101, 255],\n    [135, 83, 222, 255],\n    [229, 178, 76, 255],\n    [122, 183, 181, 255],\n    [190, 115, 171, 255],\n    [149, 197, 108, 255],\n    [100, 118, 205, 255],\n    [212, 108, 93, 255],\n    [86, 219, 141, 255],\n    [183, 79, 226, 255],\n    [233, 233, 72, 255],\n    [118, 167, 187, 255],\n    [194, 111, 146, 255],\n    [116, 201, 104, 255],\n    [115, 96, 209, 255],\n    [216, 147, 89, 255],\n    [82, 223, 188, 255],\n    [230, 75, 224, 255],\n    [163, 184, 121, 255],\n    [114, 143, 191, 255],\n    [198, 107, 114, 255],\n    [99, 206, 122, 255],\n    [153, 92, 213, 255],\n    [220, 192, 85, 255],\n    [78, 215, 227, 255],\n    [234, 71, 173, 255],\n    [141, 188, 117, 255],\n    [110, 113, 195, 255],\n    [202, 128, 103, 255],\n    [95, 210, 157, 255],\n    [195, 88, 217, 255],\n    [206, 224, 81, 255],\n    [74, 166, 231, 255],\n    [185, 120, 139, 255],\n    [113, 192, 113, 255],\n    [133, 106, 199, 255],\n    [207, 162, 98, 255],\n    [91, 214, 198, 255],\n    [221, 84, 198, 255],\n    [159, 228, 77, 255],\n    [70, 111, 235, 255],\n    [189, 119, 116, 255],\n    [109, 196, 138, 255],\n    [165, 101, 204, 255],\n    [211, 201, 94, 255],\n    [87, 191, 218, 255],\n    [225, 80, 153, 255],\n    [106, 232, 73, 255],\n    [124, 119, 186, 255],\n    [193, 142, 112, 255],\n    [105, 200, 168, 255],\n    [203, 97, 208, 255],\n    [184, 215, 90, 255],\n    [83, 147, 222, 255],\n    [229, 76, 101, 255],\n    [122, 183, 130, 255],\n    [146, 115, 190, 255],\n    [197, 171, 108, 255],\n    [100, 205, 205, 255],\n    [212, 93, 177, 255],\n    [141, 219, 86, 255],\n    [79, 97, 226, 255],\n    [233, 99, 72, 255],\n    [118, 187, 150, 255],\n    [173, 111, 194, 255],\n    [197, 201, 104, 255],\n    [96, 171, 209, 255],\n    [216, 89, 137, 255],\n    [94, 223, 82, 255],\n    [107, 75, 230, 255],\n    [184, 153, 121, 255],\n    [114, 191, 175, 255],\n    [198, 107, 191, 255],\n    [166, 206, 99, 255],\n    [92, 132, 213, 255],\n    [220, 85, 91, 255],\n    [78, 227, 115, 255],\n    [159, 71, 234, 255],\n    [188, 176, 117, 255],\n    [110, 185, 195, 255],\n    [202, 103, 161, 255],\n    [129, 210, 95, 255],\n    [88, 88, 217, 255],\n    [224, 123, 81, 255],\n    [74, 231, 166, 255],\n    [177, 120, 185, 255],\n    [179, 192, 113, 255],\n    [106, 156, 199, 255],\n    [207, 98, 125, 255],\n    [91, 214, 96, 255],\n    [130, 84, 221, 255],\n    [228, 171, 77, 255],\n    [70, 235, 221, 255],\n    [189, 116, 174, 255],\n    [153, 196, 109, 255],\n    [101, 123, 204, 255],\n    [211, 104, 94, 255],\n    [87, 218, 136, 255],\n    [177, 80, 225, 255],\n    [232, 225, 73, 255],\n    [119, 169, 186, 255],\n    [193, 112, 149, 255],\n    [121, 200, 105, 255],\n    [111, 97, 208, 255],\n    [215, 142, 90, 255],\n    [83, 222, 181, 255],\n    [229, 76, 229, 255],\n    [165, 183, 122, 255],\n    [115, 146, 190, 255],\n    [197, 108, 119, 255],\n    [100, 205, 118, 255],\n    [148, 93, 212, 255],\n    [219, 186, 86, 255],\n    [79, 220, 226, 255],\n    [233, 72, 179, 255],\n    [144, 187, 118, 255],\n    [111, 118, 194, 255],\n    [201, 124, 104, 255],\n    [96, 209, 153, 255],\n    [189, 89, 216, 255],\n    [211, 223, 82, 255],\n    [75, 172, 230, 255],\n    [184, 121, 142, 255],\n    [117, 191, 114, 255],\n    [130, 107, 198, 255],\n    [206, 157, 99, 255],\n    [92, 213, 193, 255],\n    [220, 85, 203, 255],\n    [165, 227, 78, 255],\n    [71, 118, 234, 255],\n    [188, 117, 117, 255],\n    [110, 195, 135, 255],\n    [161, 103, 202, 255],\n    [210, 195, 95, 255],\n    [88, 195, 217, 255],\n    [224, 81, 158, 255],\n    [113, 231, 74, 255],\n    [123, 120, 185, 255],\n    [192, 139, 113, 255],\n    [106, 199, 164, 255],\n    [198, 98, 207, 255],\n    [188, 214, 91, 255],\n    [84, 153, 221, 255],\n    [228, 77, 108, 255],\n    [70, 235, 84, 255],\n    [143, 116, 189, 255],\n    [196, 167, 109, 255],\n    [101, 204, 199, 255],\n    [211, 94, 182, 255],\n    [147, 218, 87, 255],\n    [80, 104, 225, 255],\n    [232, 93, 73, 255],\n    [119, 186, 147, 255],\n    [170, 112, 193, 255],\n    [200, 200, 105, 255],\n    [97, 175, 208, 255],\n    [215, 90, 142, 255],\n    [100, 222, 83, 255],\n    [101, 76, 229, 255],\n    [183, 150, 122, 255],\n    [115, 190, 171, 255],\n    [197, 108, 194, 255],\n    [170, 205, 100, 255],\n    [93, 138, 212, 255],\n    [219, 86, 97, 255],\n    [79, 226, 110, 255],\n    [153, 72, 233, 255],\n    [187, 173, 118, 255],\n    [111, 187, 194, 255],\n    [201, 104, 165, 255],\n    [134, 209, 96, 255],\n    [89, 95, 216, 255],\n    [223, 117, 82, 255],\n    [75, 230, 159, 255],\n    [174, 121, 184, 255],\n    [182, 191, 114, 255],\n    [107, 160, 198, 255],\n    [206, 99, 130, 255],\n    [92, 213, 92, 255],\n    [124, 85, 220, 255],\n    [227, 165, 78, 255],\n    [71, 234, 214, 255],\n    [188, 117, 176, 255],\n    [156, 195, 110, 255],\n    [103, 128, 202, 255],\n    [210, 100, 95, 255],\n    [88, 217, 131, 255],\n    [170, 81, 224, 255],\n    [231, 218, 74, 255],\n    [120, 172, 185, 255],\n    [192, 113, 153, 255],\n    [125, 199, 106, 255],\n    [107, 98, 207, 255],\n    [214, 137, 91, 255],\n    [84, 221, 175, 255],\n    [222, 77, 228, 255],\n    [194, 235, 70, 255],\n    [116, 149, 189, 255],\n    [196, 109, 123, 255],\n    [101, 204, 114, 255],\n    [143, 94, 211, 255],\n    [218, 180, 87, 255],\n    [80, 225, 225, 255],\n    [232, 73, 186, 255],\n    [147, 186, 119, 255],\n    [112, 122, 193, 255],\n    [200, 121, 105, 255],\n    [97, 208, 148, 255],\n    [184, 90, 215, 255],\n    [216, 222, 83, 255],\n    [76, 178, 229, 255],\n    [183, 122, 145, 255],\n    [121, 190, 115, 255],\n    [126, 108, 197, 255],\n    [205, 153, 100, 255],\n    [93, 212, 187, 255],\n    [219, 86, 208, 255],\n    [171, 226, 79, 255],\n    [72, 126, 233, 255],\n    [187, 118, 121, 255],\n    [111, 194, 132, 255],\n    [157, 104, 201, 255],\n    [209, 190, 96, 255],\n    [89, 200, 216, 255],\n    [223, 82, 164, 255],\n    [120, 230, 75, 255],\n    [121, 121, 184, 255],\n    [191, 136, 114, 255],\n    [107, 198, 160, 255],\n    [192, 99, 206, 255],\n    [193, 213, 92, 255],\n    [85, 158, 220, 255],\n    [227, 78, 115, 255],\n    [71, 234, 78, 255],\n    [141, 117, 188, 255],\n    [195, 163, 110, 255],\n    [103, 202, 194, 255],\n    [210, 95, 186, 255],\n    [153, 217, 88, 255],\n    [81, 111, 224, 255],\n];\nexport default CORNERSTONE_COLOR_LUT;\n","const DEFINED_CURSORS = Symbol('DefinedCursors');\nconst STANDARD_CURSORS = new Set([\n    'alias',\n    'all-scroll',\n    'auto',\n    'cell',\n    'col-resize',\n    'context-menu',\n    'copy',\n    'crosshair',\n    'default',\n    'e-resize',\n    'ew-resize',\n    'grab',\n    'grabbing',\n    'help',\n    'move',\n    'ne-resize',\n    'nesw-resize',\n    'no-drop',\n    'none',\n    'not-allowed',\n    'n-resize',\n    'ns-resize',\n    'nw-resize',\n    'nwse-resize',\n    'pointer',\n    'progress',\n    'row-resize',\n    'se-resize',\n    's-resize',\n    'sw-resize',\n    'text',\n    'vertical-text',\n    'wait',\n    'w-resize',\n    'zoom-in',\n    'zoom-out',\n]);\nexport default class MouseCursor {\n    constructor(name, fallback) {\n        this.name = name + '';\n        this.fallback = fallback;\n    }\n    getName() {\n        return this.name + '';\n    }\n    addFallbackStyleProperty(style) {\n        const { fallback } = this;\n        if (fallback instanceof MouseCursor) {\n            return `${style}, ${fallback.getStyleProperty()}`;\n        }\n        return style + '';\n    }\n    getStyleProperty() {\n        return this.addFallbackStyleProperty(this.name) + '';\n    }\n    static getDefinedCursor(name) {\n        const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n        let mouseCursor = definedCursors.get(name);\n        if (mouseCursor instanceof MouseCursor) {\n            return mouseCursor;\n        }\n        if (STANDARD_CURSORS.has(name)) {\n            mouseCursor = new MouseCursor(name);\n            definedCursors.set(name, mouseCursor);\n            return mouseCursor;\n        }\n    }\n    static setDefinedCursor(name, cursor) {\n        if (cursor instanceof MouseCursor) {\n            const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n            definedCursors.set(name, cursor);\n            return true;\n        }\n        return false;\n    }\n}\nfunction getDefinedCursors(context, symbol) {\n    let definedCursors = context[symbol];\n    if (!(definedCursors instanceof Map)) {\n        definedCursors = new Map();\n        Object.defineProperty(context, symbol, { value: definedCursors });\n    }\n    return definedCursors;\n}\nconst standardCursorNames = STANDARD_CURSORS.values();\nexport { standardCursorNames };\n","import MouseCursor from './MouseCursor';\nconst ELEMENT_CURSORS_MAP = Symbol('ElementCursorsMap');\nfunction initElementCursor(element, cursor) {\n    _getElementCursors(element)[0] = cursor;\n    _setElementCursor(element, cursor);\n}\nfunction _setElementCursor(element, cursor) {\n    const cursors = _getElementCursors(element);\n    cursors[1] = cursors[0];\n    cursors[0] = cursor;\n    element.style.cursor = (cursor instanceof MouseCursor\n        ? cursor\n        : MouseCursor.getDefinedCursor('auto')).getStyleProperty();\n}\nfunction resetElementCursor(element) {\n    _setElementCursor(element, _getElementCursors(element)[1]);\n}\nfunction hideElementCursor(element) {\n    _setElementCursor(element, MouseCursor.getDefinedCursor('none'));\n}\nfunction _getElementCursors(element) {\n    let map = _getElementCursors[ELEMENT_CURSORS_MAP];\n    if (!(map instanceof WeakMap)) {\n        map = new WeakMap();\n        Object.defineProperty(_getElementCursors, ELEMENT_CURSORS_MAP, {\n            value: map,\n        });\n    }\n    let cursors = map.get(element);\n    if (!cursors) {\n        cursors = [null, null];\n        map.set(element, cursors);\n    }\n    return cursors;\n}\nexport { initElementCursor, resetElementCursor, hideElementCursor, _setElementCursor as setElementCursor, };\n","import { utilities } from '@cornerstonejs/core';\nimport MouseCursor from './MouseCursor';\nconst DEFAULT_NAME = 'image-cursor';\nexport default class ImageMouseCursor extends MouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(name || ImageMouseCursor.getUniqueInstanceName(DEFAULT_NAME), fallback);\n        this.url = url;\n        this.x = Number(x) || 0;\n        this.y = Number(y) || 0;\n    }\n    getStyleProperty() {\n        const { url, x, y } = this;\n        let style = `url('${url}')`;\n        if (x >= 0 && y >= 0 && (x > 0 || y > 0)) {\n            style += ` ${x} ${y}`;\n        }\n        return this.addFallbackStyleProperty(style);\n    }\n    static getUniqueInstanceName(prefix) {\n        return `${prefix}-${utilities.getRuntimeId(ImageMouseCursor)}`;\n    }\n}\n","const BASE = {\n    iconContent: '',\n    iconSize: 16,\n    viewBox: {\n        x: 16,\n        y: 16,\n    },\n    mousePoint: {\n        x: 8,\n        y: 8,\n    },\n    mousePointerGroupString: `\n    <path stroke=\"{{color}}\" d=\"M8 16L8 0\"></path>\n    <path stroke=\"{{color}}\" d=\"M16 8L0 8\"></path>\n  `,\n};\nconst SEGMENTATION_CURSOR_BOUNDARIES = {\n    x: 127,\n    y: 60,\n};\nconst MINUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n`;\nconst PLUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n<rect fill=\"{{color}}\" x=\"95.84\" y=\"9.38\" width=\"15.85\" height=\"47.14\"/>\n`;\nconst SCISSOR_ICON = `<path fill=\"{{color}}\" d=\"M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z\" transform=\"translate(-1.17 -0.96)\"/>`;\nconst RECTANGLE_ICON = `<path fill=\"{{color}}\" d=\"M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CIRCLE_ICON = `<path fill=\"{{color}}\" d=\"M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CursorSVG = {\n    Angle: extend(BASE, {\n        name: 'Angle',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n    50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n    10l50 50q10 10 10 23z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    ArrowAnnotate: extend(BASE, {\n        name: 'ArrowAnnotate',\n        iconContent: `<g id=\"arrowAnnotate-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"arrowAnnotate-arrow\" d=\"M23,7 l-15,15 M7,17 l0,6 6,0\" stroke-width=\"2\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Bidirectional: extend(BASE, {\n        name: 'Bidirectional',\n        iconContent: `<g fill=\"{{color}}\" stroke-width=\"3\" stroke=\"{{color}}\">\n    <path d=\"M27.63 3.21L3.12 28.81\"></path>\n    <path d=\"M27.63 15.75L15.27 4.43\"></path>\n    <path d=\"M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z\" ></path>\n    <path d=\"M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z\"></path>\n    <path d=\"M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z\"></path>\n    <path d=\"M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z\"></path>\n  </g>`,\n        viewBox: {\n            x: 48,\n            y: 48,\n        },\n    }),\n    CobbAngle: extend(BASE, {\n        name: 'CobbAngle',\n        iconContent: `<g stroke=\"{{color}}\" stroke-width=\"3\">\n    <path d=\"M28.59 2.34L3.82 12.32\"></path>\n    <path d=\"M28.59 29.66L3.82 19.68\"></path>\n    <path stroke-dasharray=\"2\" fill-opacity=\"0\" d=\"M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63\">\n    </path>\n  </g>`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    CircleROI: extend(BASE, {\n        name: 'CircleROI',\n        iconContent: `<circle stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" cx=\"16\" cy=\"16\" r=\"14\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    EllipticalROI: extend(BASE, {\n        name: 'EllipticalROI',\n        iconContent: `<path stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" d=\"M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    FreehandROI: extend(BASE, {\n        name: 'FreehandROI',\n        iconContent: `<g fill=\"{{color}}\" stroke=\"{{color}}\" stroke-width=\"2\">\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_3\" cy=\"4.240343\" cx=\"14.306499\"/>\n    <line id=\"svg_4\" y2=\"3.58462\" x2=\"12.242186\" y1=\"3.997482\" x1=\"13.432202\"/>\n    <line id=\"svg_5\" y2=\"3.268901\" x2=\"10.857882\" y1=\"3.608906\" x1=\"12.387902\"/>\n    <line id=\"svg_6\" y2=\"3.147471\" x2=\"9.740724\" y1=\"3.293187\" x1=\"10.955026\"/>\n    <line id=\"svg_7\" y2=\"3.147471\" x2=\"8.089274\" y1=\"3.196043\" x1=\"9.983585\"/>\n    <line id=\"svg_8\" y2=\"3.268901\" x2=\"6.874972\" y1=\"3.123185\" x1=\"8.307848\"/>\n    <line id=\"svg_9\" y2=\"3.657478\" x2=\"5.587812\" y1=\"3.220329\" x1=\"7.020688\"/>\n    <line id=\"svg_10\" y2=\"4.046054\" x2=\"4.737801\" y1=\"3.560334\" x1=\"5.854959\"/>\n    <line id=\"svg_11\" y2=\"4.337487\" x2=\"4.300652\" y1=\"3.997482\" x1=\"4.834945\"/>\n    <line id=\"svg_12\" y2=\"4.726063\" x2=\"3.88779\" y1=\"4.191771\" x1=\"4.470655\"/>\n    <line id=\"svg_15\" y2=\"5.3575\" x2=\"3.377783\" y1=\"4.604633\" x1=\"3.960648\"/>\n    <line id=\"svg_16\" y2=\"6.183226\" x2=\"2.916348\" y1=\"5.138926\" x1=\"3.547785\"/>\n    <line id=\"svg_17\" y2=\"6.960379\" x2=\"2.770632\" y1=\"5.867507\" x1=\"3.037779\"/>\n    <line id=\"svg_18\" y2=\"7.713246\" x2=\"2.673488\" y1=\"6.741804\" x1=\"2.819204\"/>\n    <line id=\"svg_19\" y2=\"8.684687\" x2=\"2.697774\" y1=\"7.616102\" x1=\"2.673488\"/>\n    <line id=\"svg_20\" y2=\"9.753273\" x2=\"2.892062\" y1=\"8.611829\" x1=\"2.697774\"/>\n    <line id=\"svg_21\" y2=\"10.724714\" x2=\"3.134923\" y1=\"9.534698\" x1=\"2.84349\"/>\n    <line id=\"svg_23\" y2=\"11.647583\" x2=\"3.596357\" y1=\"10.578998\" x1=\"3.086351\"/>\n    <line id=\"svg_25\" y2=\"12.521881\" x2=\"4.276366\" y1=\"11.501867\" x1=\"3.499213\"/>\n    <line id=\"svg_26\" y2=\"13.930471\" x2=\"5.830673\" y1=\"12.376165\" x1=\"4.13065\"/>\n    <line id=\"svg_28\" y2=\"14.707624\" x2=\"7.263549\" y1=\"13.881899\" x1=\"5.733528\"/>\n    <line id=\"svg_29\" y2=\"15.339061\" x2=\"8.963571\" y1=\"14.61048\" x1=\"7.06926\"/>\n    <line id=\"svg_30\" y2=\"15.581921\" x2=\"10.882168\" y1=\"15.314775\" x1=\"8.817855\"/>\n    <line id=\"svg_31\" y2=\"15.460491\" x2=\"12.023612\" y1=\"15.581921\" x1=\"10.785024\"/>\n    <line id=\"svg_33\" y2=\"15.120487\" x2=\"13.092197\" y1=\"15.484777\" x1=\"11.877895\"/>\n    <line id=\"svg_34\" y2=\"14.586194\" x2=\"13.86935\" y1=\"15.217631\" x1=\"12.897909\"/>\n    <line id=\"svg_35\" y2=\"13.833327\" x2=\"14.597931\" y1=\"14.756196\" x1=\"13.699348\"/>\n    <line id=\"svg_37\" y2=\"12.716169\" x2=\"15.180796\" y1=\"13.881899\" x1=\"14.549359\"/>\n    <line id=\"svg_39\" y2=\"11.429009\" x2=\"15.520801\" y1=\"12.813313\" x1=\"15.15651\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_40\" cy=\"10.967574\" cx=\"15.520801\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    FreehandROISculptor: extend(BASE, {\n        name: 'FreehandROISculptor',\n        iconContent: `<g id=\"icon-freehand-sculpt\" fill=\"none\" stroke-width=\"1.5\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <line id=\"svg_1\" y2=\"2.559367\" x2=\"10.184807\" y1=\"4.467781\" x1=\"8.81711\"/>\n    <line id=\"svg_4\" y2=\"1.493836\" x2=\"11.727442\" y1=\"2.766112\" x1=\"10.089386\"/>\n    <line id=\"svg_7\" y2=\"1.080346\" x2=\"13.047428\" y1=\"1.748291\" x1=\"11.345759\"/>\n    <line id=\"svg_8\" y2=\"1.000829\" x2=\"14.351511\" y1=\"1.112153\" x1=\"12.77707\"/>\n    <line id=\"svg_9\" y2=\"1.350705\" x2=\"15.242104\" y1=\"0.905408\" x1=\"13.969828\"/>\n    <line id=\"svg_10\" y2=\"2.098167\" x2=\"15.862339\" y1=\"1.14396\" x1=\"14.955842\"/>\n    <line id=\"svg_11\" y2=\"3.195505\" x2=\"16.41896\" y1=\"1.939133\" x1=\"15.766918\"/>\n    <line id=\"svg_12\" y2=\"4.292843\" x2=\"16.530284\" y1=\"2.925147\" x1=\"16.387153\"/>\n    <line id=\"svg_16\" y2=\"5.644637\" x2=\"16.196311\" y1=\"3.831643\" x1=\"16.593898\"/>\n    <line id=\"svg_18\" y2=\"7.266789\" x2=\"15.623787\" y1=\"5.19934\" x1=\"16.275829\"/>\n    <line id=\"svg_19\" y2=\"10.813258\" x2=\"14.526449\" y1=\"6.726071\" x1=\"15.766918\"/>\n    <line id=\"svg_20\" y2=\"5.056209\" x2=\"8.085552\" y1=\"4.181519\" x1=\"8.976145\"/>\n    <line id=\"svg_23\" y2=\"5.326568\" x2=\"7.481221\" y1=\"4.78585\" x1=\"8.403621\"/>\n    <line id=\"svg_24\" y2=\"5.565119\" x2=\"6.749662\" y1=\"5.294761\" x1=\"7.624352\"/>\n    <line id=\"svg_25\" y2=\"5.994512\" x2=\"5.429675\" y1=\"5.533312\" x1=\"6.956407\"/>\n    <line id=\"svg_27\" y2=\"6.551133\" x2=\"4.284627\" y1=\"5.962706\" x1=\"5.572807\"/>\n    <line id=\"svg_28\" y2=\"7.584858\" x2=\"3.044158\" y1=\"6.392099\" x1=\"4.427758\"/>\n    <line id=\"svg_29\" y2=\"8.84123\" x2=\"2.185372\" y1=\"7.489437\" x1=\"3.219096\"/>\n    <line id=\"svg_31\" y2=\"10.606513\" x2=\"1.644654\" y1=\"8.602678\" x1=\"2.280792\"/>\n    <line id=\"svg_32\" y2=\"13.214679\" x2=\"1.48562\" y1=\"10.352058\" x1=\"1.724171\"/>\n    <line id=\"svg_33\" y2=\"14.375631\" x2=\"1.676461\" y1=\"12.992031\" x1=\"1.453813\"/>\n    <line id=\"svg_34\" y2=\"15.298031\" x2=\"2.264889\" y1=\"14.152983\" x1=\"1.517427\"/>\n    <line id=\"svg_35\" y2=\"16.172721\" x2=\"3.521261\" y1=\"14.948155\" x1=\"1.915013\"/>\n    <line id=\"svg_36\" y2=\"16.824762\" x2=\"5.207027\" y1=\"15.997783\" x1=\"3.28271\"/>\n    <line id=\"svg_38\" y2=\"17.063314\" x2=\"7.035924\" y1=\"16.745245\" x1=\"4.968475\"/>\n    <line id=\"svg_39\" y2=\"16.888376\" x2=\"9.278311\" y1=\"17.047411\" x1=\"6.733758\"/>\n    <line id=\"svg_40\" y2=\"16.284045\" x2=\"10.661911\" y1=\"16.983797\" x1=\"8.992048\"/>\n    <line id=\"svg_41\" y2=\"15.313934\" x2=\"11.647925\" y1=\"16.395369\" x1=\"10.455166\"/>\n    <line id=\"svg_44\" y2=\"13.898527\" x2=\"12.82478\" y1=\"15.425259\" x1=\"11.504794\"/>\n    <line id=\"svg_45\" y2=\"12.037824\" x2=\"14.144766\" y1=\"14.312017\" x1=\"12.522614\"/>\n    <line id=\"svg_47\" y2=\"10.59061\" x2=\"14.605966\" y1=\"12.228665\" x1=\"13.953925\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_48\" cy=\"3.982726\" cx=\"13.460918\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Length: extend(BASE, {\n        name: 'Length',\n        iconContent: `<g id=\"length-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"length-dashes\" d=\"m22.5,6 -16.5,16.5\" stroke-width=\"3\" stroke-dasharray=\"0.6666,5\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Height: extend(BASE, {\n        name: 'Height',\n        iconContent: `<path d=\"m 6 22 l 8.5 0 v -16 h 8\" stroke-width=\"3\" fill=\"none\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Probe: extend(BASE, {\n        name: 'Probe',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    RectangleROI: extend(BASE, {\n        name: 'RectangleROI',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Label: extend(BASE, {\n        name: 'Label',\n        iconContent: `<path fill=\"{{color}}\" d=\"M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Crosshairs: extend(BASE, {\n        name: 'Crosshairs',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Eraser: extend(BASE, {\n        name: 'Eraser',\n        iconContent: `<path transform=\"translate(0,1792) scale(1,-1)\" fill=\"{{color}}\" d=\"M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n    34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n    0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n    0 69.5 20.5t47.5 54.5z\" />`,\n        viewBox: {\n            x: 2048,\n            y: 1792,\n        },\n    }),\n    Magnify: extend(BASE, {\n        name: 'Magnify',\n        iconContent: `<path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />`,\n        viewBox: {\n            x: 512,\n            y: 512,\n        },\n    }),\n    Pan: extend(BASE, {\n        name: 'Pan',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n    39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n    355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n    39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n    0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n    144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n    45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Rotate: extend(BASE, {\n        name: 'Rotate',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n    14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n    163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n    225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n    132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n    164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n    39 17 39 59z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    StackScroll: extend(BASE, {\n        name: 'StackScroll',\n        iconContent: `<path fill=\"{{color}}\" d=\"M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n    0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n    0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z\" />`,\n        viewBox: {\n            x: 24,\n            y: 28,\n        },\n    }),\n    WindowLevelRegion: extend(BASE, {\n        name: 'WindowLevelRegion',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    WindowLevel: extend(BASE, {\n        name: 'WindowLevel',\n        iconContent: `\n    <path fill=\"{{color}}\" d=\"M14.5,3.5 a1 1 0 0 1 -11,11 Z\" stroke=\"none\" opacity=\"0.8\" />\n    <circle cx=\"9\" cy=\"9\" r=\"8\" fill=\"none\" stroke-width=\"2\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Zoom: extend(BASE, {\n        name: 'Zoom',\n        iconContent: `\n  <path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />\n  <path fill=\"{{color}}\" transform=\"scale(0.22,0.22) translate(1400,0)\" d=\"M1216\n    320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n    19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n    0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z\" />`,\n        viewBox: {\n            x: 640,\n            y: 512,\n        },\n    }),\n    SegmentationFreeHandEraseInside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseInside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillInside: extend(BASE, {\n        name: 'SegmentationFreeHandFillInside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandEraseOutside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseOutside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillOutside: extend(BASE, {\n        name: 'SegmentationFreeHandFillOutside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationRectangleEraseInside: extend(BASE, {\n        name: 'SegmentationRectangleEraseInside',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    RectangleScissor: extend(BASE, {\n        name: 'RectangleScissor',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    CircleScissor: extend(BASE, {\n        name: 'CircleScissor',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_INSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.ERASE_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n};\nfunction extend(base, values) {\n    return Object.assign(Object.create(base), {\n        ...values,\n        name: values.name || base.name,\n    });\n}\nfunction registerCursor(toolName, iconContent, viewBox) {\n    CursorSVG[toolName] = extend(BASE, {\n        iconContent,\n        viewBox,\n    });\n}\nfunction getDefinedSVGCursorDescriptor(name) {\n    return CursorSVG[name];\n}\nconst svgCursorNames = Object.keys(CursorSVG);\nexport { getDefinedSVGCursorDescriptor, registerCursor, svgCursorNames, CursorSVG, };\n","import { ToolModes, AnnotationStyleStates } from '../enums';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport { getDefinedSVGCursorDescriptor } from './SVGCursorDescriptor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nconst PROPERTY = 'color';\nconst STATE = AnnotationStyleStates.Highlighted;\nconst MODE = ToolModes.Active;\nexport default class SVGMouseCursor extends ImageMouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(url, x, y, name, fallback);\n    }\n    static getDefinedCursor(name, pointer = false, color) {\n        if (!color) {\n            color = getStyleProperty(PROPERTY, {}, STATE, MODE);\n        }\n        const urn = getCursorURN(name, pointer, color);\n        let cursor = super.getDefinedCursor(urn);\n        if (!cursor) {\n            const descriptor = getDefinedSVGCursorDescriptor(name);\n            if (descriptor) {\n                cursor = createSVGMouseCursor(descriptor, urn, pointer, color, super.getDefinedCursor('default'));\n                super.setDefinedCursor(urn, cursor);\n            }\n        }\n        return cursor;\n    }\n}\nfunction format(template, dictionary) {\n    const dict = Object(dictionary);\n    const defined = Object.prototype.hasOwnProperty.bind(dict);\n    return (template + '').replace(/\\{\\{(\\w+)\\}\\}/g, (match, key) => {\n        return defined(key) ? dict[key] + '' : '';\n    });\n}\nfunction getCursorURN(name, pointer, color) {\n    const type = pointer ? 'pointer' : 'cursor';\n    return `${type}:${name}/${color}`;\n}\nfunction createSVGMouseCursor(descriptor, name, pointer, color, fallback) {\n    const { x, y } = descriptor.mousePoint;\n    return new SVGMouseCursor(createSVGIconUrl(descriptor, pointer, { color }), x, y, name, fallback);\n}\nfunction createSVGIconUrl(descriptor, pointer, options) {\n    const blob = createSVGIconBlob(descriptor, pointer, options);\n    const url = URL.createObjectURL(blob);\n    const urn = `${url}#${descriptor.name || 'unknown'}-${pointer ? 'pointer' : 'cursor'}`;\n    return urn;\n}\nfunction createSVGIconBlob(descriptor, pointer, options) {\n    const svgString = (pointer ? createSVGIconWithPointer : createSVGIcon)(descriptor, options);\n    return new Blob([svgString], { type: 'image/svg+xml' });\n}\nfunction createSVGIcon(descriptor, options) {\n    const { iconContent, iconSize, viewBox } = descriptor;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${iconSize}\" height=\"${iconSize}\" viewBox=\"0 0\n      ${viewBox.x} ${viewBox.y}\">\n      ${iconContent}\n    </svg>`;\n    return format(svgString, options);\n}\nfunction createSVGIconWithPointer(descriptor, options) {\n    const { iconContent, iconSize, viewBox, mousePointerGroupString } = descriptor;\n    const scale = iconSize / Math.max(viewBox.x, viewBox.y, 1);\n    const svgSize = 16 + iconSize;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${svgSize}\" height=\"${svgSize}\" viewBox=\"0 0 ${svgSize} ${svgSize}\">\n      <g>${mousePointerGroupString}</g>\n      <g transform=\"translate(16, 16) scale(${scale})\">${iconContent}</g>\n    </svg>`;\n    return format(svgString, options);\n}\n","import { setElementCursor } from './elementCursor';\nimport MouseCursor from './MouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nfunction setCursorForElement(element, cursorName) {\n    let cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n    if (!cursor) {\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    if (!cursor) {\n        console.log(`Cursor ${cursorName} is not defined either as SVG or as a standard cursor.`);\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    setElementCursor(element, cursor);\n}\nexport default setCursorForElement;\n","import MouseCursor, { standardCursorNames } from './MouseCursor';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nimport * as elementCursor from './elementCursor';\nimport setCursorForElement from './setCursorForElement';\nimport { registerCursor, svgCursorNames, CursorSVG, } from './SVGCursorDescriptor';\nconst CursorNames = [...svgCursorNames, ...standardCursorNames];\nexport { MouseCursor, ImageMouseCursor, SVGMouseCursor, elementCursor, registerCursor, CursorNames, CursorSVG, setCursorForElement, };\n","import _getHash from './_getHash';\nimport drawEllipseByCoordinates from './drawEllipseByCoordinates';\nfunction drawEllipse(svgDrawingHelper, annotationUID, ellipseUID, corner1, corner2, options = {}, dataId = '') {\n    const top = [(corner1[0] + corner2[0]) / 2, corner1[1]];\n    const bottom = [(corner1[0] + corner2[0]) / 2, corner2[1]];\n    const left = [corner1[0], (corner1[1] + corner2[1]) / 2];\n    const right = [corner2[0], (corner1[1] + corner2[1]) / 2];\n    drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, [bottom, top, left, right], (options = {}), (dataId = ''));\n}\nexport default drawEllipse;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nfunction drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'ellipse', ellipseUID);\n    const existingEllipse = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [bottom, top, left, right] = canvasCoordinates;\n    const w = Math.hypot(left[0] - right[0], left[1] - right[1]);\n    const h = Math.hypot(top[0] - bottom[0], top[1] - bottom[1]);\n    const angle = (Math.atan2(left[1] - right[1], left[0] - right[0]) * 180) / Math.PI;\n    const center = [(left[0] + right[0]) / 2, (top[1] + bottom[1]) / 2];\n    const radiusX = w / 2;\n    const radiusY = h / 2;\n    const attributes = {\n        cx: `${center[0]}`,\n        cy: `${center[1]}`,\n        rx: `${radiusX}`,\n        ry: `${radiusY}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingEllipse) {\n        setAttributesIfNecessary(attributes, existingEllipse);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgEllipseElement = document.createElementNS(svgns, 'ellipse');\n        if (dataId !== '') {\n            svgEllipseElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgEllipseElement);\n        svgDrawingHelper.appendNode(svgEllipseElement, svgNodeHash);\n    }\n}\nexport default drawEllipseByCoordinates;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawHandle(svgDrawingHelper, annotationUID, handleGroupUID, handle, options = {}, uniqueIndex) {\n    const { color, handleRadius, width, lineWidth, fill, type, opacity } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        handleRadius: '6',\n        width: '2',\n        lineWidth: undefined,\n        fill: 'transparent',\n        type: 'circle',\n        opacity: 1,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'handle', `hg-${handleGroupUID}-index-${uniqueIndex}`);\n    let attributes;\n    if (type === 'circle') {\n        attributes = {\n            cx: `${handle[0]}`,\n            cy: `${handle[1]}`,\n            r: handleRadius,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            opacity: opacity,\n        };\n    }\n    else if (type === 'rect') {\n        const handleRadiusFloat = parseFloat(handleRadius);\n        const side = handleRadiusFloat * 1.5;\n        const x = handle[0] - side * 0.5;\n        const y = handle[1] - side * 0.5;\n        attributes = {\n            x: `${x}`,\n            y: `${y}`,\n            width: `${side}`,\n            height: `${side}`,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            rx: `${side * 0.1}`,\n            opacity: opacity,\n        };\n    }\n    else {\n        throw new Error(`Unsupported handle type: ${type}`);\n    }\n    const existingHandleElement = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingHandleElement) {\n        setAttributesIfNecessary(attributes, existingHandleElement);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newHandleElement = document.createElementNS(svgns, type);\n        setNewAttributesIfValid(attributes, newHandleElement);\n        svgDrawingHelper.appendNode(newHandleElement, svgNodeHash);\n    }\n}\nexport default drawHandle;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, options = {}, dataId = '') {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color = 'rgb(0, 255, 0)', width = 10, lineWidth, lineDash, markerStartId = null, markerEndId = null, shadow = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'line', lineUID);\n    const existingLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const layerId = svgDrawingHelper.svgLayerElement.id;\n    const dropShadowStyle = shadow ? `filter:url(#shadow-${layerId});` : '';\n    const attributes = {\n        x1: `${start[0]}`,\n        y1: `${start[1]}`,\n        x2: `${end[0]}`,\n        y2: `${end[1]}`,\n        stroke: color,\n        style: dropShadowStyle,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n        'marker-start': markerStartId ? `url(#${markerStartId})` : '',\n        'marker-end': markerEndId ? `url(#${markerEndId})` : '',\n    };\n    if (existingLine) {\n        setAttributesIfNecessary(attributes, existingLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newLine = document.createElementNS(svgns, 'line');\n        if (dataId !== '') {\n            newLine.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, newLine);\n        svgDrawingHelper.appendNode(newLine, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPath(svgDrawingHelper, annotationUID, pathUID, points, options) {\n    const hasSubArrays = points.length && points[0].length && Array.isArray(points[0][0]);\n    const pointsArrays = hasSubArrays ? points : [points];\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'path', pathUID);\n    const existingNode = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (let i = 0, numArrays = pointsArrays.length; i < numArrays; i++) {\n        const points = pointsArrays[i];\n        const numPoints = points.length;\n        if (numPoints < 2) {\n            continue;\n        }\n        for (let j = 0; j < numPoints; j++) {\n            const point = points[j];\n            const cmd = j ? 'L' : 'M';\n            pointsAttribute += `${cmd} ${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n        }\n        if (closePath) {\n            pointsAttribute += 'Z ';\n        }\n    }\n    if (!pointsAttribute) {\n        return;\n    }\n    const attributes = {\n        d: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingNode) {\n        setAttributesIfNecessary(attributes, existingNode);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newNode = document.createElementNS(svgns, 'path');\n        setNewAttributesIfValid(attributes, newNode);\n        svgDrawingHelper.appendNode(newNode, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPolyline(svgDrawingHelper, annotationUID, polylineUID, points, options) {\n    if (points.length < 2) {\n        return;\n    }\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, markerStartId = null, markerEndId = null, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'polyline', polylineUID);\n    const existingPolyLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (const point of points) {\n        pointsAttribute += `${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n    }\n    if (closePath) {\n        const firstPoint = points[0];\n        pointsAttribute += `${firstPoint[0]}, ${firstPoint[1]}`;\n    }\n    const attributes = {\n        points: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n        'marker-start': markerStartId ? `url(#${markerStartId})` : '',\n        'marker-end': markerEndId ? `url(#${markerEndId})` : '',\n    };\n    if (existingPolyLine) {\n        setAttributesIfNecessary(attributes, existingPolyLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newPolyLine = document.createElementNS(svgns, 'polyline');\n        setNewAttributesIfValid(attributes, newPolyLine);\n        svgDrawingHelper.appendNode(newPolyLine, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRectByCoordinates(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [topLeft, topRight, bottomLeft, bottomRight] = canvasCoordinates;\n    const width = Math.hypot(topLeft[0] - topRight[0], topLeft[1] - topRight[1]);\n    const height = Math.hypot(topLeft[0] - bottomLeft[0], topLeft[1] - bottomLeft[1]);\n    const center = [\n        (bottomRight[0] + topLeft[0]) / 2,\n        (bottomRight[1] + topLeft[1]) / 2,\n    ];\n    const leftEdgeCenter = [\n        (bottomLeft[0] + topLeft[0]) / 2,\n        (bottomLeft[1] + topLeft[1]) / 2,\n    ];\n    const angle = (Math.atan2(center[1] - leftEdgeCenter[1], center[0] - leftEdgeCenter[0]) *\n        180) /\n        Math.PI;\n    const attributes = {\n        x: `${center[0] - width / 2}`,\n        y: `${center[1] - height / 2}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        if (dataId !== '') {\n            svgRectElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawTextBox(svgDrawingHelper, annotationUID, textUID, textLines, position, options = {}) {\n    const mergedOptions = Object.assign({\n        fontFamily: 'Helvetica, Arial, sans-serif',\n        fontSize: '14px',\n        color: 'rgb(255, 255, 0)',\n        background: '',\n        padding: 25,\n        centerX: false,\n        centerY: true,\n    }, options);\n    const textGroupBoundingBox = _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines, position, mergedOptions);\n    return textGroupBoundingBox;\n}\nfunction _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines = [''], position, options) {\n    const { padding, color, fontFamily, fontSize, background } = options;\n    let textGroupBoundingBox;\n    const [x, y] = [position[0] + padding, position[1] + padding];\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'text', textUID);\n    const existingTextGroup = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingTextGroup) {\n        const textElement = existingTextGroup.querySelector('text');\n        const textSpans = Array.from(textElement.children);\n        for (let i = 0; i < textSpans.length; i++) {\n            const textSpanElement = textSpans[i];\n            const text = textLines[i] || '';\n            textSpanElement.textContent = text;\n        }\n        if (textLines.length > textSpans.length) {\n            for (let i = 0; i < textLines.length - textSpans.length; i++) {\n                const textLine = textLines[i + textSpans.length];\n                const textSpan = _createTextSpan(textLine);\n                textElement.appendChild(textSpan);\n            }\n            existingTextGroup.appendChild(textElement);\n            svgDrawingHelper.appendNode(existingTextGroup, svgNodeHash);\n        }\n        const textAttributes = {\n            fill: color,\n            'font-size': fontSize,\n            'font-family': fontFamily,\n        };\n        const textGroupAttributes = {\n            transform: `translate(${x} ${y})`,\n        };\n        setAttributesIfNecessary(textAttributes, textElement);\n        setAttributesIfNecessary(textGroupAttributes, existingTextGroup);\n        existingTextGroup.setAttribute('data-annotation-uid', annotationUID);\n        textGroupBoundingBox = _drawTextBackground(existingTextGroup, background);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const textGroup = document.createElementNS(svgns, 'g');\n        textGroup.setAttribute('data-annotation-uid', annotationUID);\n        textGroup.setAttribute('transform', `translate(${x} ${y})`);\n        const textElement = _createTextElement(svgDrawingHelper, options);\n        for (let i = 0; i < textLines.length; i++) {\n            const textLine = textLines[i];\n            const textSpan = _createTextSpan(textLine);\n            textElement.appendChild(textSpan);\n        }\n        textGroup.appendChild(textElement);\n        svgDrawingHelper.appendNode(textGroup, svgNodeHash);\n        textGroupBoundingBox = _drawTextBackground(textGroup, background);\n    }\n    return Object.assign({}, textGroupBoundingBox, {\n        x,\n        y,\n        height: textGroupBoundingBox.height + padding,\n        width: textGroupBoundingBox.width + padding,\n    });\n}\nfunction _createTextElement(svgDrawingHelper, options) {\n    const { color, fontFamily, fontSize } = options;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textElement = document.createElementNS(svgns, 'text');\n    const noSelectStyle = 'user-select: none; pointer-events: none; -webkit-tap-highlight-color:  rgba(255, 255, 255, 0);';\n    const dropShadowStyle = `filter:url(#shadow-${svgDrawingHelper.svgLayerElement.id});`;\n    const combinedStyle = `${noSelectStyle}${dropShadowStyle}`;\n    textElement.setAttribute('x', '0');\n    textElement.setAttribute('y', '0');\n    textElement.setAttribute('fill', color);\n    textElement.setAttribute('font-family', fontFamily);\n    textElement.setAttribute('font-size', fontSize);\n    textElement.setAttribute('style', combinedStyle);\n    textElement.setAttribute('pointer-events', 'visible');\n    return textElement;\n}\nfunction _createTextSpan(text) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textSpanElement = document.createElementNS(svgns, 'tspan');\n    textSpanElement.setAttribute('x', '0');\n    textSpanElement.setAttribute('dy', '1.2em');\n    textSpanElement.textContent = text;\n    return textSpanElement;\n}\nfunction _drawTextBackground(group, color) {\n    let element = group.querySelector('rect.background');\n    if (!color) {\n        if (element) {\n            group.removeChild(element);\n        }\n        return group.getBBox();\n    }\n    if (!element) {\n        element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        element.setAttribute('class', 'background');\n        group.insertBefore(element, group.firstChild);\n    }\n    const bBox = group.getBBox();\n    const attributes = {\n        x: `${bBox.x}`,\n        y: `${bBox.y}`,\n        width: `${bBox.width}`,\n        height: `${bBox.height}`,\n        fill: color,\n    };\n    setAttributesIfNecessary(attributes, element);\n    return bBox;\n}\nexport default drawTextBox;\n","import drawLine from './drawLine';\nexport default function drawHeight(svgDrawingHelper, annotationUID, heightUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const midX = end[0] + (start[0] - end[0]) / 2;\n    const endfirstLine = [midX, start[1]];\n    const endsecondLine = [midX, end[1]];\n    const firstLine = {\n        start: start,\n        end: endfirstLine,\n    };\n    const secondLine = {\n        start: endfirstLine,\n        end: endsecondLine,\n    };\n    const threeLine = {\n        start: endsecondLine,\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, '1', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '2', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', threeLine.start, threeLine.end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n}\n","import drawLine from './drawLine';\nconst svgns = 'http://www.w3.org/2000/svg';\nexport default function drawArrow(svgDrawingHelper, annotationUID, arrowUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { viaMarker = false, color = 'rgb(0, 255, 0)', markerSize = 10, } = options;\n    if (!viaMarker) {\n        legacyDrawArrow(svgDrawingHelper, annotationUID, arrowUID, start, end, options);\n        return;\n    }\n    const layerId = svgDrawingHelper.svgLayerElement.id;\n    const markerBaseId = `arrow-${annotationUID}`;\n    const markerFullId = `${markerBaseId}-${layerId}`;\n    const defs = svgDrawingHelper.svgLayerElement.querySelector('defs');\n    let arrowMarker = defs.querySelector(`#${markerFullId}`);\n    if (!arrowMarker) {\n        arrowMarker = document.createElementNS(svgns, 'marker');\n        arrowMarker.setAttribute('id', markerFullId);\n        arrowMarker.setAttribute('viewBox', '0 0 10 10');\n        arrowMarker.setAttribute('refX', '8');\n        arrowMarker.setAttribute('refY', '5');\n        arrowMarker.setAttribute('markerWidth', `${markerSize}`);\n        arrowMarker.setAttribute('markerHeight', `${markerSize}`);\n        arrowMarker.setAttribute('orient', 'auto');\n        const arrowPath = document.createElementNS(svgns, 'path');\n        arrowPath.setAttribute('d', 'M 0 0 L 10 5 L 0 10 z');\n        arrowPath.setAttribute('fill', color);\n        arrowMarker.appendChild(arrowPath);\n        defs.appendChild(arrowMarker);\n    }\n    else {\n        arrowMarker.setAttribute('markerWidth', `${markerSize}`);\n        arrowMarker.setAttribute('markerHeight', `${markerSize}`);\n        const arrowPath = arrowMarker.querySelector('path');\n        if (arrowPath) {\n            arrowPath.setAttribute('fill', color);\n        }\n    }\n    options.markerEndId = markerFullId;\n    drawLine(svgDrawingHelper, annotationUID, arrowUID, start, end, options);\n}\nfunction legacyDrawArrow(svgDrawingHelper, annotationUID, arrowUID, start, end, options = {}) {\n    const { color = 'rgb(0, 255, 0)', width = 2, lineWidth, lineDash } = options;\n    const headLength = 10;\n    const angle = Math.atan2(end[1] - start[1], end[0] - start[0]);\n    const firstLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle - Math.PI / 7),\n            end[1] - headLength * Math.sin(angle - Math.PI / 7),\n        ],\n        end: end,\n    };\n    const secondLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle + Math.PI / 7),\n            end[1] - headLength * Math.sin(angle + Math.PI / 7),\n        ],\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, arrowUID, start, end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '2', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n}\n","import _getHash from './_getHash';\nimport _setAttributesIfNecessary from './setAttributesIfNecessary';\nimport _setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRedactionRect(svgDrawingHelper, annotationUID, rectangleUID, start, end, options = {}) {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const tlhc = [Math.min(start[0], end[0]), Math.min(start[1], end[1])];\n    const width = Math.abs(start[0] - end[0]);\n    const height = Math.abs(start[1] - end[1]);\n    const attributes = {\n        x: `${tlhc[0]}`,\n        y: `${tlhc[1]}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'black',\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        _setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        _setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","export function setAttributesIfNecessary(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const currentValue = svgNode.getAttribute(key);\n        const newValue = attributes[key];\n        if (newValue === undefined || newValue === '') {\n            svgNode.removeAttribute(key);\n        }\n        else if (currentValue !== newValue) {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setAttributesIfNecessary;\n","export function setNewAttributesIfValid(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const newValue = attributes[key];\n        if (newValue !== undefined && newValue !== '') {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setNewAttributesIfValid;\n","import { eventTarget } from '@cornerstonejs/core';\nimport Events from '../enums/Events';\nimport InterpolationManager from '../utilities/segmentation/InterpolationManager/InterpolationManager';\nconst enable = function () {\n    eventTarget.addEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.addEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.addEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nconst disable = function () {\n    eventTarget.removeEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.removeEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.removeEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraModified = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onCameraModified) {\n            tool.onCameraModified(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraReset = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onResetCamera) {\n            tool.onResetCamera(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport triggerAnnotationRender from '../utilities/triggerAnnotationRender';\nconst onImageRendered = function (evt) {\n    triggerAnnotationRender(evt.detail.element);\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onImageSpacingCalibrated = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onImageSpacingCalibrated) {\n            tool.onImageSpacingCalibrated(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nexport default {\n    enable,\n    disable,\n};\n","import Events from '../enums/Events';\nimport { keyDown, keyUp } from './keyboardEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.KEY_DOWN, keyDown);\n    element.addEventListener(Events.KEY_UP, keyUp);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.KEY_DOWN, keyDown);\n    element.removeEventListener(Events.KEY_UP, keyUp);\n};\nconst keyboardToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default keyboardToolEventDispatcher;\n","import Events from '../enums/Events';\nimport { mouseClick, mouseDown, mouseDownActivate, mouseDoubleClick, mouseDrag, mouseMove, mouseUp, mouseWheel, } from './mouseEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.addEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.addEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.addEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.addEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.addEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.addEventListener(Events.MOUSE_UP, mouseUp);\n    element.addEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.removeEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.removeEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.removeEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.removeEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.removeEventListener(Events.MOUSE_UP, mouseUp);\n    element.removeEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst mouseToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default mouseToolEventDispatcher;\n","import Events from '../enums/Events';\nimport { touchStart, touchStartActivate, touchDrag, touchEnd, touchTap, touchPress, } from './touchEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.TOUCH_START, touchStart);\n    element.addEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.addEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.addEventListener(Events.TOUCH_END, touchEnd);\n    element.addEventListener(Events.TOUCH_TAP, touchTap);\n    element.addEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.TOUCH_START, touchStart);\n    element.removeEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.removeEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.removeEventListener(Events.TOUCH_END, touchEnd);\n    element.removeEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst touchToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default touchToolEventDispatcher;\n","import { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport getViewportsForAnnotation from '../../../utilities/getViewportsForAnnotation';\nimport * as math from '../../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getViewportIdsWithToolToRender } from '../../../utilities/viewportFilters';\nimport { addAnnotation, removeAnnotation, getAllAnnotations, getChildAnnotations, addChildAnnotation, clearParentAnnotation, } from '../../../stateManagement/annotation/annotationState';\nimport { ContourWindingDirection } from '../../../types/ContourAnnotation';\nimport { triggerAnnotationModified } from '../../../stateManagement/annotation/helpers/state';\nimport updateContourPolyline from '../../../utilities/contours/updateContourPolyline';\nimport { addContourSegmentationAnnotation, areSameSegment, isContourSegmentationAnnotation, removeContourSegmentationAnnotation, } from '../../../utilities/contourSegmentation';\nimport { getToolGroupForViewport } from '../../../store/ToolGroupManager';\nimport { hasTool, hasToolByName } from '../../../store/addTool';\nconst DEFAULT_CONTOUR_SEG_TOOL_NAME = 'PlanarFreehandContourSegmentationTool';\nexport default async function contourSegmentationCompletedListener(evt) {\n    const sourceAnnotation = evt.detail\n        .annotation;\n    if (!isContourSegmentationAnnotation(sourceAnnotation)) {\n        return;\n    }\n    const viewport = getViewport(sourceAnnotation);\n    const contourSegmentationAnnotations = getValidContourSegmentationAnnotations(viewport, sourceAnnotation);\n    if (!contourSegmentationAnnotations.length) {\n        return;\n    }\n    const sourcePolyline = convertContourPolylineToCanvasSpace(sourceAnnotation.data.contour.polyline, viewport);\n    const targetAnnotationInfo = findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations);\n    if (!targetAnnotationInfo) {\n        return;\n    }\n    const { targetAnnotation, targetPolyline, isContourHole } = targetAnnotationInfo;\n    if (isContourHole) {\n        const { contourHoleProcessingEnabled = false } = evt.detail;\n        if (!contourHoleProcessingEnabled) {\n            return;\n        }\n        createPolylineHole(viewport, targetAnnotation, sourceAnnotation);\n    }\n    else {\n        combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline);\n    }\n}\nfunction isFreehandContourSegToolRegisteredForViewport(viewport, silent = false) {\n    const toolName = 'PlanarFreehandContourSegmentationTool';\n    const toolGroup = getToolGroupForViewport(viewport.id, viewport.renderingEngineId);\n    let errorMessage;\n    if (!toolGroup.hasTool(toolName)) {\n        errorMessage = `Tool ${toolName} not added to ${toolGroup.id} toolGroup`;\n    }\n    else if (!toolGroup.getToolOptions(toolName)) {\n        errorMessage = `Tool ${toolName} must be in active/passive state`;\n    }\n    if (errorMessage && !silent) {\n        console.warn(errorMessage);\n    }\n    return !errorMessage;\n}\nfunction getViewport(annotation) {\n    const viewports = getViewportsForAnnotation(annotation);\n    const viewportWithToolRegistered = viewports.find((viewport) => isFreehandContourSegToolRegisteredForViewport(viewport, true));\n    return viewportWithToolRegistered ?? viewports[0];\n}\nfunction convertContourPolylineToCanvasSpace(polyline, viewport) {\n    const numPoints = polyline.length;\n    const projectedPolyline = new Array(numPoints);\n    for (let i = 0; i < numPoints; i++) {\n        projectedPolyline[i] = viewport.worldToCanvas(polyline[i]);\n    }\n    return projectedPolyline;\n}\nfunction getValidContourSegmentationAnnotations(viewport, sourceAnnotation) {\n    const { annotationUID: sourceAnnotationUID } = sourceAnnotation;\n    const allAnnotations = getAllAnnotations();\n    return allAnnotations.filter((targetAnnotation) => targetAnnotation.annotationUID &&\n        targetAnnotation.annotationUID !== sourceAnnotationUID &&\n        isContourSegmentationAnnotation(targetAnnotation) &&\n        areSameSegment(targetAnnotation, sourceAnnotation) &&\n        viewport.isReferenceViewable(targetAnnotation.metadata));\n}\nfunction findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations) {\n    const sourceAABB = math.polyline.getAABB(sourcePolyline);\n    for (let i = 0; i < contourSegmentationAnnotations.length; i++) {\n        const targetAnnotation = contourSegmentationAnnotations[i];\n        const targetPolyline = convertContourPolylineToCanvasSpace(targetAnnotation.data.contour.polyline, viewport);\n        const targetAABB = math.polyline.getAABB(targetPolyline);\n        const aabbIntersect = math.aabb.intersectAABB(sourceAABB, targetAABB);\n        const lineSegmentsIntersect = aabbIntersect &&\n            math.polyline.intersectPolyline(sourcePolyline, targetPolyline);\n        const isContourHole = aabbIntersect &&\n            !lineSegmentsIntersect &&\n            math.polyline.containsPoints(targetPolyline, sourcePolyline);\n        if (lineSegmentsIntersect || isContourHole) {\n            return { targetAnnotation, targetPolyline, isContourHole };\n        }\n    }\n}\nexport function createPolylineHole(viewport, targetAnnotation, holeAnnotation) {\n    const { windingDirection: targetWindingDirection } = targetAnnotation.data.contour;\n    const { windingDirection: holeWindingDirection } = holeAnnotation.data.contour;\n    addChildAnnotation(targetAnnotation, holeAnnotation);\n    removeContourSegmentationAnnotation(holeAnnotation);\n    const { contour: holeContour } = holeAnnotation.data;\n    const holePolyline = convertContourPolylineToCanvasSpace(holeContour.polyline, viewport);\n    updateContourPolyline(holeAnnotation, {\n        points: holePolyline,\n        closed: holeContour.closed,\n    }, viewport);\n    const { element } = viewport;\n    const updatedToolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        holeAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedToolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n}\nfunction getContourHolesData(viewport, annotation) {\n    return getChildAnnotations(annotation).map((holeAnnotation) => {\n        const polyline = convertContourPolylineToCanvasSpace(holeAnnotation.data.contour.polyline, viewport);\n        return { annotation: holeAnnotation, polyline };\n    });\n}\nfunction combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline) {\n    if (!hasToolByName(DEFAULT_CONTOUR_SEG_TOOL_NAME)) {\n        console.warn(`${DEFAULT_CONTOUR_SEG_TOOL_NAME} is not registered in cornerstone`);\n        return;\n    }\n    if (!isFreehandContourSegToolRegisteredForViewport(viewport)) {\n        return;\n    }\n    const sourceStartPoint = sourcePolyline[0];\n    const mergePolylines = math.polyline.containsPoint(targetPolyline, sourceStartPoint);\n    const contourHolesData = getContourHolesData(viewport, targetAnnotation);\n    const unassignedContourHolesSet = new Set(contourHolesData);\n    const reassignedContourHolesMap = new Map();\n    const assignHoleToPolyline = (parentPolyline, holeData) => {\n        let holes = reassignedContourHolesMap.get(parentPolyline);\n        if (!holes) {\n            holes = [];\n            reassignedContourHolesMap.set(parentPolyline, holes);\n        }\n        holes.push(holeData);\n        unassignedContourHolesSet.delete(holeData);\n    };\n    const newPolylines = [];\n    if (mergePolylines) {\n        const mergedPolyline = math.polyline.mergePolylines(targetPolyline, sourcePolyline);\n        newPolylines.push(mergedPolyline);\n        Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => assignHoleToPolyline(mergedPolyline, holeData));\n    }\n    else {\n        const subtractedPolylines = math.polyline.subtractPolylines(targetPolyline, sourcePolyline);\n        subtractedPolylines.forEach((newPolyline) => {\n            newPolylines.push(newPolyline);\n            Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => {\n                const containsHole = math.polyline.containsPoints(newPolyline, holeData.polyline);\n                if (containsHole) {\n                    assignHoleToPolyline(newPolyline, holeData);\n                    unassignedContourHolesSet.delete(holeData);\n                }\n            });\n        });\n    }\n    Array.from(reassignedContourHolesMap.values()).forEach((contourHolesDataArray) => contourHolesDataArray.forEach((contourHoleData) => clearParentAnnotation(contourHoleData.annotation)));\n    const { element } = viewport;\n    const enabledElement = getEnabledElement(element);\n    const { metadata, data } = targetAnnotation;\n    const { handles, segmentation } = data;\n    const { textBox } = handles;\n    removeAnnotation(sourceAnnotation.annotationUID);\n    removeAnnotation(targetAnnotation.annotationUID);\n    for (let i = 0; i < newPolylines.length; i++) {\n        const polyline = newPolylines[i];\n        const startPoint = viewport.canvasToWorld(polyline[0]);\n        const endPoint = viewport.canvasToWorld(polyline[polyline.length - 1]);\n        const newAnnotation = {\n            metadata: {\n                ...metadata,\n                toolName: DEFAULT_CONTOUR_SEG_TOOL_NAME,\n                originalToolName: metadata.originalToolName || metadata.toolName,\n            },\n            data: {\n                cachedStats: {},\n                handles: {\n                    points: [startPoint, endPoint],\n                    textBox: textBox ? { ...textBox } : undefined,\n                },\n                contour: {\n                    polyline: [],\n                    closed: true,\n                },\n                spline: targetAnnotation.data.spline,\n                segmentation: {\n                    ...segmentation,\n                },\n            },\n            annotationUID: csUtils.uuidv4(),\n            highlighted: true,\n            invalidated: true,\n            isLocked: false,\n            isVisible: undefined,\n            interpolationUID: targetAnnotation.interpolationUID,\n            interpolationCompleted: targetAnnotation.interpolationCompleted,\n        };\n        updateContourPolyline(newAnnotation, {\n            points: polyline,\n            closed: true,\n            targetWindingDirection: ContourWindingDirection.Clockwise,\n        }, viewport);\n        addAnnotation(newAnnotation, element);\n        addContourSegmentationAnnotation(newAnnotation);\n        triggerAnnotationModified(newAnnotation, viewport.element);\n        reassignedContourHolesMap\n            .get(polyline)\n            ?.forEach((holeData) => addChildAnnotation(newAnnotation, holeData.annotation));\n    }\n    updateViewports(enabledElement, targetAnnotation, sourceAnnotation);\n}\nfunction updateViewports(enabledElement, targetAnnotation, sourceAnnotation) {\n    const { viewport } = enabledElement;\n    const { element } = viewport;\n    const updatedTtoolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        sourceAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedTtoolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    return new Promise((resolve) => window.requestAnimationFrame(resolve));\n}\n","import mouseDoubleClickListener from './mouseDoubleClickListener';\nimport mouseDownListener, { mouseDoubleClickIgnoreListener, } from './mouseDownListener';\nimport mouseMoveListener from './mouseMoveListener';\nfunction disable(element) {\n    element.removeEventListener('dblclick', mouseDoubleClickListener);\n    element.removeEventListener('mousedown', mouseDownListener);\n    element.removeEventListener('mousemove', mouseMoveListener);\n    element.removeEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('dblclick', mouseDoubleClickListener);\n    element.addEventListener('mousedown', mouseDownListener);\n    element.addEventListener('mousemove', mouseMoveListener);\n    element.addEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import preventGhostClick from './preventGhostClick';\nimport touchStartListener from './touchStartListener';\nfunction disable(element) {\n    preventGhostClick.disable(element);\n    element.removeEventListener('touchstart', touchStartListener);\n}\nfunction enable(element) {\n    disable(element);\n    preventGhostClick.enable(element);\n    element.addEventListener('touchstart', touchStartListener, {\n        passive: false,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import wheelListener from './wheelListener';\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('wheel', wheelListener, { passive: false });\n}\nfunction disable(element) {\n    element.removeEventListener('wheel', wheelListener);\n}\nexport default {\n    enable,\n    disable,\n};\n","import { VolumeViewport, getEnabledElementByViewportId, StackViewport, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../../enums';\nimport { performVolumeLabelmapUpdate } from './performVolumeLabelmapUpdate';\nimport { performStackLabelmapUpdate } from './performStackLabelmapUpdate';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { getViewportIdsWithSegmentation } from '../../../stateManagement/segmentation/getViewportIdsWithSegmentation';\nconst onLabelmapSegmentationDataModified = function (evt) {\n    const { segmentationId, modifiedSlicesToUse } = evt.detail;\n    const { representationData } = getSegmentation(segmentationId);\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    const hasVolumeViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof VolumeViewport;\n    });\n    const hasStackViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof StackViewport;\n    });\n    const hasBothStackAndVolume = hasVolumeViewport && hasStackViewport;\n    viewportIds.forEach((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        if (viewport instanceof VolumeViewport) {\n            performVolumeLabelmapUpdate({\n                modifiedSlicesToUse: hasBothStackAndVolume ? [] : modifiedSlicesToUse,\n                representationData,\n                type: SegmentationRepresentations.Labelmap,\n            });\n        }\n        if (viewport instanceof StackViewport) {\n            performStackLabelmapUpdate({\n                viewportIds,\n                segmentationId,\n            });\n        }\n    });\n};\nexport default onLabelmapSegmentationDataModified;\n","import { cache } from '@cornerstonejs/core';\nexport function performVolumeLabelmapUpdate({ modifiedSlicesToUse, representationData, type, }) {\n    const segmentationVolume = cache.getVolume(representationData[type].volumeId);\n    if (!segmentationVolume) {\n        console.warn('segmentation not found in cache');\n        return;\n    }\n    const { imageData, vtkOpenGLTexture } = segmentationVolume;\n    let slicesToUpdate;\n    if (modifiedSlicesToUse?.length > 0) {\n        slicesToUpdate = modifiedSlicesToUse;\n    }\n    else {\n        const numSlices = imageData.getDimensions()[2];\n        slicesToUpdate = [...Array(numSlices).keys()];\n    }\n    slicesToUpdate.forEach((i) => {\n        vtkOpenGLTexture.setUpdatedFrame(i);\n    });\n    imageData.modified();\n}\n","import { cache, utilities as csUtils, VolumeViewport, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../../enums';\nimport { getLabelmapActorEntries } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nimport { getSegmentationRepresentations } from '../../../stateManagement/segmentation/getSegmentationRepresentation';\nimport { getCurrentLabelmapImageIdsForViewport } from '../../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nexport function performStackLabelmapUpdate({ viewportIds, segmentationId, }) {\n    viewportIds.forEach((viewportId) => {\n        let representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n        representations.forEach((representation) => {\n            if (representation.segmentationId !== segmentationId) {\n                return;\n            }\n            const enabledElement = getEnabledElementByViewportId(viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            if (viewport instanceof VolumeViewport) {\n                return;\n            }\n            const actorEntries = getLabelmapActorEntries(viewportId, segmentationId);\n            if (!actorEntries?.length) {\n                return;\n            }\n            actorEntries.forEach((actorEntry, i) => {\n                const segImageData = actorEntry.actor.getMapper().getInputData();\n                const currentSegmentationImageIds = getCurrentLabelmapImageIdsForViewport(viewportId, segmentationId);\n                const segmentationImage = cache.getImage(currentSegmentationImageIds[i]);\n                segImageData.modified();\n                csUtils.updateVTKImageDataWithCornerstoneImage(segImageData, segmentationImage);\n            });\n        });\n    });\n}\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport onLabelmapSegmentationDataModified from './labelmap/onLabelmapSegmentationDataModified';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nconst onSegmentationDataModified = function (evt) {\n    const { segmentationId } = evt.detail;\n    const { representationData } = getSegmentation(segmentationId);\n    if (representationData.Labelmap) {\n        onLabelmapSegmentationDataModified(evt);\n    }\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default onSegmentationDataModified;\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationModifiedListener = function (evt) {\n    const { segmentationId } = evt.detail;\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default segmentationModifiedListener;\n","import vtkDataArray from '@kitware/vtk.js/Common/Core/DataArray';\nimport vtkImageData from '@kitware/vtk.js/Common/DataModel/ImageData';\nimport { BaseVolumeViewport, getEnabledElement, Enums, getEnabledElementByIds, cache, utilities, } from '@cornerstonejs/core';\nimport { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport { updateLabelmapSegmentationImageReferences } from '../../stateManagement/segmentation/updateLabelmapSegmentationImageReferences';\nimport { getCurrentLabelmapImageIdsForViewport } from '../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getLabelmapActorEntries } from '../../stateManagement/segmentation/helpers/getSegmentationActor';\nimport { getSegmentationRepresentations } from '../../stateManagement/segmentation/getSegmentationRepresentation';\nconst enable = function (element) {\n    if (!element) {\n        return;\n    }\n    const enabledElement = getEnabledElement(element);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    if (viewport instanceof BaseVolumeViewport) {\n        return;\n    }\n    element.addEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst perViewportManualTriggers = new Map();\nfunction _imageChangeEventListener(evt) {\n    const eventData = evt.detail;\n    const { viewportId, renderingEngineId } = eventData;\n    const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n    const representations = getSegmentationRepresentations(viewportId);\n    if (!representations?.length) {\n        return;\n    }\n    const labelmapRepresentations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n    const actors = viewport.getActors();\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n    });\n    const labelmapActors = labelmapRepresentations\n        .flatMap((representation) => {\n        return getLabelmapActorEntries(viewportId, representation.segmentationId);\n    })\n        .filter((actor) => actor !== undefined);\n    if (!labelmapActors.length) {\n        return;\n    }\n    labelmapActors.forEach((actor) => {\n        const validActor = labelmapRepresentations.find((representation) => {\n            const derivedImageIds = getCurrentLabelmapImageIdsForViewport(viewportId, representation.segmentationId);\n            return derivedImageIds?.includes(actor.referencedId);\n        });\n        if (!validActor) {\n            viewport.removeActors([actor.uid]);\n        }\n    });\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        const currentImageId = viewport.getCurrentImageId();\n        const derivedImageIds = getCurrentLabelmapImageIdsForViewport(viewportId, segmentationId);\n        if (!derivedImageIds) {\n            return;\n        }\n        const updateSegmentationActor = (derivedImageId) => {\n            const derivedImage = cache.getImage(derivedImageId);\n            if (!derivedImage) {\n                console.warn('No derived image found in the cache for segmentation representation', representation);\n                return;\n            }\n            const segmentationActorInput = actors.find((actor) => actor.referencedId === derivedImageId);\n            if (!segmentationActorInput) {\n                const { dimensions, spacing, direction } = viewport.getImageDataMetadata(derivedImage);\n                const currentImage = cache.getImage(currentImageId) ||\n                    {\n                        imageId: currentImageId,\n                    };\n                const { origin: currentOrigin } = viewport.getImageDataMetadata(currentImage);\n                const originToUse = currentOrigin;\n                const constructor = derivedImage.voxelManager.getConstructor();\n                const newPixelData = derivedImage.voxelManager.getScalarData();\n                const scalarArray = vtkDataArray.newInstance({\n                    name: 'Pixels',\n                    numberOfComponents: 1,\n                    values: new constructor(newPixelData),\n                });\n                const imageData = vtkImageData.newInstance();\n                imageData.setDimensions(dimensions[0], dimensions[1], 1);\n                imageData.setSpacing(spacing);\n                imageData.setDirection(direction);\n                imageData.setOrigin(originToUse);\n                imageData.getPointData().setScalars(scalarArray);\n                imageData.modified();\n                viewport.addImages([\n                    {\n                        imageId: derivedImageId,\n                        representationUID: `${segmentationId}-${SegmentationRepresentations.Labelmap}-${derivedImage.imageId}`,\n                        callback: ({ imageActor }) => {\n                            imageActor.getMapper().setInputData(imageData);\n                        },\n                    },\n                ]);\n                triggerSegmentationRender(viewportId);\n                return;\n            }\n            else {\n                const segmentationImageData = segmentationActorInput.actor\n                    .getMapper()\n                    .getInputData();\n                if (segmentationImageData.setDerivedImage) {\n                    segmentationImageData.setDerivedImage(derivedImage);\n                }\n                else {\n                    utilities.updateVTKImageDataWithCornerstoneImage(segmentationImageData, derivedImage);\n                }\n            }\n        };\n        derivedImageIds.forEach(updateSegmentationActor);\n        viewport.render();\n        if (evt.type === Enums.Events.IMAGE_RENDERED) {\n            viewport.element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n        }\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationCompleted } from './contourSegmentation';\nexport default function annotationCompletedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationCompleted(evt);\n    }\n}\n","import { getRenderingEngines } from '@cornerstonejs/core';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationSelectionListener(evt) {\n    const deselectedAnnotation = evt.detail.removed;\n    if (!deselectedAnnotation.length) {\n        return;\n    }\n    const renderingEngines = getRenderingEngines();\n    renderingEngines.forEach((renderingEngine) => {\n        const viewports = renderingEngine.getViewports();\n        const viewportIds = viewports.map((vp) => vp.id);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    });\n}\nexport default annotationSelectionListener;\n","import triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationModifiedListener(evt) {\n    const { viewportId } = evt.detail;\n    triggerAnnotationRenderForViewportIds([viewportId]);\n}\nexport default annotationModifiedListener;\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationRemoved } from './contourSegmentation';\nexport default function annotationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationRemoved(evt);\n    }\n}\n","import { removeContourSegmentationAnnotation } from '../../../utilities/contourSegmentation';\nexport default function contourSegmentationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    removeContourSegmentationAnnotation(annotation);\n}\n","import { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationRepresentationModifiedListener = function (evt) {\n    const { viewportId } = evt.detail;\n    triggerSegmentationRender(viewportId);\n};\nexport default segmentationRepresentationModifiedListener;\n","import { eventTarget, Enums } from '@cornerstonejs/core';\nimport { getAnnotationManager } from './stateManagement/annotation/annotationState';\nimport { Events as TOOLS_EVENTS } from './enums';\nimport { addEnabledElement, removeEnabledElement } from './store';\nimport { resetCornerstoneToolsState } from './store/state';\nimport { annotationCompletedListener, annotationRemovedListener, annotationSelectionListener, annotationModifiedListener, segmentationDataModifiedEventListener, segmentationModifiedListener, } from './eventListeners';\nimport { annotationInterpolationEventDispatcher } from './eventDispatchers';\nimport * as ToolGroupManager from './store/ToolGroupManager';\nimport { defaultSegmentationStateManager } from './stateManagement/segmentation/SegmentationStateManager';\nimport segmentationRepresentationModifiedListener from './eventListeners/segmentation/segmentationRepresentationModifiedListener';\nimport { setConfig } from './config';\nlet csToolsInitialized = false;\nexport function init(defaultConfiguration = {}) {\n    if (csToolsInitialized) {\n        return;\n    }\n    setConfig(defaultConfiguration);\n    _addCornerstoneEventListeners();\n    _addCornerstoneToolsEventListeners();\n    csToolsInitialized = true;\n}\nexport function destroy() {\n    _removeCornerstoneEventListeners();\n    _removeCornerstoneToolsEventListeners();\n    ToolGroupManager.destroy();\n    resetCornerstoneToolsState();\n    const annotationManager = getAnnotationManager();\n    const segmentationStateManager = defaultSegmentationStateManager;\n    annotationManager.restoreAnnotations({});\n    segmentationStateManager.resetState();\n    csToolsInitialized = false;\n}\nfunction _addCornerstoneEventListeners() {\n    _removeCornerstoneEventListeners();\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.addEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.addEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.enable();\n}\nfunction _removeCornerstoneEventListeners() {\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.removeEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.removeEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.disable();\n}\nfunction _addCornerstoneToolsEventListeners() {\n    _removeCornerstoneToolsEventListeners();\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_REMOVED, annotationRemovedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nfunction _removeCornerstoneToolsEventListeners() {\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nexport default init;\n","import { getEnabledElement, triggerEvent, getRenderingEngine, } from '@cornerstonejs/core';\nimport { Events, ToolModes } from '../../enums';\nimport { draw as drawSvg } from '../../drawingSvg';\nimport getToolsWithModesForElement from '../../utilities/getToolsWithModesForElement';\nconst { Active, Passive, Enabled } = ToolModes;\nclass AnnotationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._renderFlaggedViewports = () => {\n            this._throwIfDestroyed();\n            const elements = Array.from(this._viewportElements.values());\n            for (let i = 0; i < elements.length; i++) {\n                const element = elements[i];\n                if (this._needsRender.has(element)) {\n                    this._triggerRender(element);\n                    this._needsRender.delete(element);\n                    if (this._needsRender.size === 0) {\n                        break;\n                    }\n                }\n            }\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n            this._render();\n        };\n        this._viewportElements = new Map();\n    }\n    addViewportElement(viewportId, element) {\n        this._viewportElements.set(viewportId, element);\n    }\n    removeViewportElement(viewportId, element) {\n        this._viewportElements.delete(viewportId);\n        this._needsRender.delete(element);\n        this._reset();\n    }\n    renderViewport(element) {\n        this._setViewportsToBeRenderedNextFrame([element]);\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setAllViewportsToBeRenderedNextFrame() {\n        const elements = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            this._needsRender.add(element);\n        });\n        this._renderFlaggedViewports();\n    }\n    _setViewportsToBeRenderedNextFrame(elements) {\n        const elementsEnabled = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            if (elementsEnabled.indexOf(element) !== -1) {\n                this._needsRender.add(element);\n            }\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedViewports);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(element) {\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const renderingEngine = getRenderingEngine(enabledElement.renderingEngineId);\n        if (!renderingEngine) {\n            console.warn('rendering Engine has been destroyed');\n            return;\n        }\n        const enabledTools = getToolsWithModesForElement(element, [\n            Active,\n            Passive,\n            Enabled,\n        ]);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const eventDetail = {\n            element,\n            renderingEngineId,\n            viewportId,\n        };\n        drawSvg(element, (svgDrawingHelper) => {\n            let anyRendered = false;\n            const handleDrawSvg = (tool) => {\n                if (tool.renderAnnotation) {\n                    const rendered = tool.renderAnnotation(enabledElement, svgDrawingHelper);\n                    anyRendered = anyRendered || rendered;\n                }\n            };\n            enabledTools.forEach(handleDrawSvg);\n            if (anyRendered) {\n                triggerEvent(element, Events.ANNOTATION_RENDERED, { ...eventDetail });\n            }\n        });\n    }\n    _reset() {\n        window.cancelAnimationFrame(this._animationFrameHandle);\n        this._needsRender.clear();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._setAllViewportsToBeRenderedNextFrame();\n    }\n}\nconst annotationRenderingEngine = new AnnotationRenderingEngine();\nexport { annotationRenderingEngine };\n","import { Enums, eventTarget, getEnabledElement, utilities, } from '@cornerstonejs/core';\nclass FrameOfReferenceSpecificAnnotationManager {\n    constructor(uid) {\n        this.getGroupKey = (annotationGroupSelector) => {\n            if (typeof annotationGroupSelector === 'string') {\n                return annotationGroupSelector;\n            }\n            const element = annotationGroupSelector;\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('Element not enabled, you must have an enabled element if you are not providing a FrameOfReferenceUID');\n            }\n            return enabledElement.FrameOfReferenceUID;\n        };\n        this._imageVolumeModifiedHandler = (evt) => {\n            const eventDetail = evt.detail;\n            const { FrameOfReferenceUID } = eventDetail;\n            const annotations = this.annotations;\n            const frameOfReferenceSpecificAnnotations = annotations[FrameOfReferenceUID];\n            if (!frameOfReferenceSpecificAnnotations) {\n                return;\n            }\n            Object.keys(frameOfReferenceSpecificAnnotations).forEach((toolName) => {\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                toolSpecificAnnotations.forEach((annotation) => {\n                    const invalidated = annotation.invalidated;\n                    if (invalidated !== undefined) {\n                        annotation.invalidated = true;\n                    }\n                });\n            });\n        };\n        this.getFramesOfReference = () => {\n            return Object.keys(this.annotations);\n        };\n        this.getAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (!annotations[groupKey]) {\n                return [];\n            }\n            if (toolName) {\n                return annotations[groupKey][toolName]\n                    ? annotations[groupKey][toolName]\n                    : [];\n            }\n            return annotations[groupKey];\n        };\n        this.getAnnotation = (annotationUID) => {\n            const annotations = this.annotations;\n            for (const frameOfReferenceUID in annotations) {\n                const frameOfReferenceAnnotations = annotations[frameOfReferenceUID];\n                for (const toolName in frameOfReferenceAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceAnnotations[toolName];\n                    for (const annotation of toolSpecificAnnotations) {\n                        if (annotationUID === annotation.annotationUID) {\n                            return annotation;\n                        }\n                    }\n                }\n            }\n        };\n        this.getNumberOfAnnotations = (groupKey, toolName) => {\n            const annotations = this.getAnnotations(groupKey, toolName);\n            if (!annotations.length) {\n                return 0;\n            }\n            if (toolName) {\n                return annotations.length;\n            }\n            let total = 0;\n            for (const toolName in annotations) {\n                total += annotations[toolName].length;\n            }\n            return total;\n        };\n        this.addAnnotation = (annotation, groupKey) => {\n            const { metadata } = annotation;\n            const { FrameOfReferenceUID, toolName } = metadata;\n            groupKey = groupKey || FrameOfReferenceUID;\n            const annotations = this.annotations;\n            let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            if (!frameOfReferenceSpecificAnnotations) {\n                annotations[groupKey] = {};\n                frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            }\n            let toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            if (!toolSpecificAnnotations) {\n                frameOfReferenceSpecificAnnotations[toolName] = [];\n                toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            }\n            if (this.preprocessingFn) {\n                annotation = this.preprocessingFn(annotation);\n            }\n            toolSpecificAnnotations.push(annotation);\n        };\n        this.removeAnnotation = (annotationUID) => {\n            const { annotations } = this;\n            for (const groupKey in annotations) {\n                const groupAnnotations = annotations[groupKey];\n                for (const toolName in groupAnnotations) {\n                    const toolAnnotations = groupAnnotations[toolName];\n                    const index = toolAnnotations.findIndex((annotation) => annotation.annotationUID === annotationUID);\n                    if (index !== -1) {\n                        toolAnnotations.splice(index, 1);\n                        if (toolAnnotations.length === 0) {\n                            delete groupAnnotations[toolName];\n                        }\n                    }\n                }\n                if (Object.keys(groupAnnotations).length === 0) {\n                    delete annotations[groupKey];\n                }\n            }\n        };\n        this.removeAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            const removedAnnotations = [];\n            if (!annotations[groupKey]) {\n                return removedAnnotations;\n            }\n            if (toolName) {\n                const annotationsForTool = annotations[groupKey][toolName];\n                for (const annotation of annotationsForTool) {\n                    this.removeAnnotation(annotation.annotationUID);\n                    removedAnnotations.push(annotation);\n                }\n            }\n            else {\n                for (const toolName in annotations[groupKey]) {\n                    const annotationsForTool = annotations[groupKey][toolName];\n                    for (const annotation of annotationsForTool) {\n                        this.removeAnnotation(annotation.annotationUID);\n                        removedAnnotations.push(annotation);\n                    }\n                }\n            }\n            return removedAnnotations;\n        };\n        this.saveAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    return;\n                }\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                return structuredClone(toolSpecificAnnotations);\n            }\n            else if (groupKey) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                return structuredClone(frameOfReferenceSpecificAnnotations);\n            }\n            return structuredClone(annotations);\n        };\n        this.restoreAnnotations = (state, groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    annotations[groupKey] = {};\n                    frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                }\n                frameOfReferenceSpecificAnnotations[toolName] = state;\n            }\n            else if (groupKey) {\n                annotations[groupKey] = state;\n            }\n            else {\n                this.annotations = structuredClone(state);\n            }\n        };\n        this.getAllAnnotations = () => {\n            return Object.values(this.annotations)\n                .map((frameOfReferenceSpecificAnnotations) => Object.values(frameOfReferenceSpecificAnnotations))\n                .flat(2);\n        };\n        this.getNumberOfAllAnnotations = () => {\n            let count = 0;\n            const annotations = this.annotations;\n            for (const groupKey in annotations) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                for (const toolName in frameOfReferenceSpecificAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                    count += toolSpecificAnnotations.length;\n                }\n            }\n            return count;\n        };\n        this.removeAllAnnotations = () => {\n            const removedAnnotations = [];\n            for (const annotation of this.getAllAnnotations()) {\n                this.removeAnnotation(annotation.annotationUID);\n                removedAnnotations.push(annotation);\n            }\n            return removedAnnotations;\n        };\n        if (!uid) {\n            uid = utilities.uuidv4();\n        }\n        this.annotations = {};\n        this.uid = uid;\n        eventTarget.addEventListener(Enums.Events.IMAGE_VOLUME_MODIFIED, this._imageVolumeModifiedHandler);\n    }\n    setPreprocessingFn(preprocessingFn) {\n        this.preprocessingFn = preprocessingFn;\n    }\n}\nconst defaultFrameOfReferenceSpecificAnnotationManager = new FrameOfReferenceSpecificAnnotationManager('DEFAULT');\nexport { defaultFrameOfReferenceSpecificAnnotationManager };\nexport default FrameOfReferenceSpecificAnnotationManager;\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './annotationState';\nconst globalLockedAnnotationUIDsSet = new Set();\nfunction setAnnotationLocked(annotationUID, locked = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (locked) {\n            lock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n        else {\n            unlock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction unlockAllAnnotations() {\n    const detail = makeEventDetail();\n    clearLockedAnnotationsSet(globalLockedAnnotationUIDsSet, detail);\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction getAnnotationsLocked() {\n    return Array.from(globalLockedAnnotationUIDsSet);\n}\nfunction isAnnotationLocked(annotationUID) {\n    return globalLockedAnnotationUIDsSet.has(annotationUID);\n}\nfunction getAnnotationsLockedCount() {\n    return globalLockedAnnotationUIDsSet.size;\n}\nfunction checkAndSetAnnotationLocked(annotationUID) {\n    const isLocked = isAnnotationLocked(annotationUID);\n    setAnnotationLocked(annotationUID, isLocked);\n    return isLocked;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        locked: [],\n    });\n}\nfunction lock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (!lockedAnnotationUIDsSet.has(annotationUID)) {\n        lockedAnnotationUIDsSet.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = true;\n        }\n    }\n}\nfunction unlock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (lockedAnnotationUIDsSet.delete(annotationUID)) {\n        detail.removed.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = false;\n        }\n    }\n}\nfunction clearLockedAnnotationsSet(lockedAnnotationUIDsSet, detail) {\n    lockedAnnotationUIDsSet.forEach((annotationUID) => {\n        unlock(annotationUID, lockedAnnotationUIDsSet, detail);\n    });\n}\nfunction publish(detail, lockedAnnotationUIDsSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        lockedAnnotationUIDsSet.forEach((item) => void detail.locked.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_LOCK_CHANGE, detail);\n    }\n}\nexport { setAnnotationLocked, getAnnotationsLocked, getAnnotationsLockedCount, unlockAllAnnotations, isAnnotationLocked, checkAndSetAnnotationLocked, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './annotationState';\nconst selectedAnnotationUIDs = new Set();\nfunction setAnnotationSelected(annotationUID, selected = true, preserveSelected = false) {\n    if (selected) {\n        selectAnnotation(annotationUID, preserveSelected);\n    }\n    else {\n        deselectAnnotation(annotationUID);\n    }\n}\nfunction selectAnnotation(annotationUID, preserveSelected = false) {\n    const detail = makeEventDetail();\n    if (!preserveSelected) {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    if (annotationUID && !selectedAnnotationUIDs.has(annotationUID)) {\n        selectedAnnotationUIDs.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction deselectAnnotation(annotationUID) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (selectedAnnotationUIDs.delete(annotationUID)) {\n            detail.removed.push(annotationUID);\n            const annotation = getAnnotation(annotationUID);\n            annotation.isSelected = false;\n        }\n    }\n    else {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelected() {\n    return Array.from(selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelectedByToolName(toolName) {\n    return getAnnotationsSelected().filter((annotationUID) => {\n        const annotation = getAnnotation(annotationUID);\n        return annotation?.metadata?.toolName === toolName;\n    });\n}\nfunction isAnnotationSelected(annotationUID) {\n    return selectedAnnotationUIDs.has(annotationUID);\n}\nfunction getAnnotationsSelectedCount() {\n    return selectedAnnotationUIDs.size;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        selection: [],\n    });\n}\nfunction clearSelectionSet(selectionSet, detail) {\n    selectionSet.forEach((value) => {\n        if (selectionSet.delete(value)) {\n            detail.removed.push(value);\n            const annotation = getAnnotation(value);\n            if (annotation) {\n                annotation.isSelected = false;\n            }\n        }\n    });\n}\nfunction publish(detail, selectionSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        selectionSet.forEach((item) => void detail.selection.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_SELECTION_CHANGE, detail);\n    }\n}\nexport { setAnnotationSelected, getAnnotationsSelected, getAnnotationsSelectedByToolName, getAnnotationsSelectedCount, deselectAnnotation, isAnnotationSelected, };\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, } from './helpers/state';\nlet defaultManager;\nfunction getAnnotationManager() {\n    return defaultManager;\n}\nfunction setAnnotationManager(annotationManager) {\n    defaultManager = annotationManager;\n}\nfunction getAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getAnnotations(groupKey, toolName);\n}\nfunction getAnnotation(annotationUID) {\n    const manager = getAnnotationManager();\n    return manager.getAnnotation(annotationUID);\n}\nfunction getAllAnnotations() {\n    const manager = getAnnotationManager();\n    return manager.getAllAnnotations();\n}\nfunction clearParentAnnotation(annotation) {\n    const { annotationUID: childUID, parentAnnotationUID } = annotation;\n    if (!parentAnnotationUID) {\n        return;\n    }\n    const parentAnnotation = getAnnotation(parentAnnotationUID);\n    const childUIDIndex = parentAnnotation.childAnnotationUIDs.indexOf(childUID);\n    parentAnnotation.childAnnotationUIDs.splice(childUIDIndex, 1);\n    annotation.parentAnnotationUID = undefined;\n}\nfunction addChildAnnotation(parentAnnotation, childAnnotation) {\n    const { annotationUID: parentUID } = parentAnnotation;\n    const { annotationUID: childUID } = childAnnotation;\n    clearParentAnnotation(childAnnotation);\n    if (!parentAnnotation.childAnnotationUIDs) {\n        parentAnnotation.childAnnotationUIDs = [];\n    }\n    if (parentAnnotation.childAnnotationUIDs.includes(childUID)) {\n        return;\n    }\n    parentAnnotation.childAnnotationUIDs.push(childUID);\n    childAnnotation.parentAnnotationUID = parentUID;\n}\nfunction getParentAnnotation(annotation) {\n    return annotation.parentAnnotationUID\n        ? getAnnotation(annotation.parentAnnotationUID)\n        : undefined;\n}\nfunction getChildAnnotations(annotation) {\n    return (annotation.childAnnotationUIDs?.map((childAnnotationUID) => getAnnotation(childAnnotationUID)) ?? []);\n}\nfunction addAnnotation(annotation, annotationGroupSelector) {\n    if (!annotation.annotationUID) {\n        annotation.annotationUID = csUtils.uuidv4();\n    }\n    const manager = getAnnotationManager();\n    if (annotationGroupSelector instanceof HTMLDivElement) {\n        const groupKey = manager.getGroupKey(annotationGroupSelector);\n        manager.addAnnotation(annotation, groupKey);\n        triggerAnnotationAddedForElement(annotation, annotationGroupSelector);\n    }\n    else {\n        manager.addAnnotation(annotation, undefined);\n        triggerAnnotationAddedForFOR(annotation);\n    }\n    return annotation.annotationUID;\n}\nfunction getNumberOfAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getNumberOfAnnotations(groupKey, toolName);\n}\nfunction removeAnnotation(annotationUID) {\n    if (!annotationUID) {\n        return;\n    }\n    const manager = getAnnotationManager();\n    const annotation = manager.getAnnotation(annotationUID);\n    if (!annotation) {\n        return;\n    }\n    annotation.childAnnotationUIDs?.forEach((childAnnotationUID) => removeAnnotation(childAnnotationUID));\n    manager.removeAnnotation(annotationUID);\n    triggerAnnotationRemoved({ annotation, annotationManagerUID: manager.uid });\n}\nfunction removeAllAnnotations() {\n    const manager = getAnnotationManager();\n    const removedAnnotations = manager.removeAllAnnotations();\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction removeAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    const removedAnnotations = manager.removeAnnotations(groupKey, toolName);\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction invalidateAnnotation(annotation) {\n    let currAnnotation = annotation;\n    while (currAnnotation) {\n        currAnnotation.invalidated = true;\n        currAnnotation = currAnnotation.parentAnnotationUID\n            ? getAnnotation(currAnnotation.parentAnnotationUID)\n            : undefined;\n    }\n}\nexport { getAllAnnotations, getAnnotations, getParentAnnotation, getChildAnnotations, clearParentAnnotation, addChildAnnotation, getNumberOfAnnotations, addAnnotation, removeAnnotation, removeAnnotations, removeAllAnnotations, setAnnotationManager, getAnnotationManager, invalidateAnnotation, getAnnotation, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { isAnnotationSelected, deselectAnnotation, } from './annotationSelection';\nimport { getAnnotation } from './annotationState';\nconst globalHiddenAnnotationUIDsSet = new Set();\nfunction setAnnotationVisibility(annotationUID, visible = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (visible) {\n            show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n        else {\n            hide(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail);\n}\nfunction showAllAnnotations() {\n    const detail = makeEventDetail();\n    globalHiddenAnnotationUIDsSet.forEach((annotationUID) => {\n        show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n    });\n    publish(detail);\n}\nfunction isAnnotationVisible(annotationUID) {\n    const annotation = getAnnotation(annotationUID);\n    if (annotation) {\n        return !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    }\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        lastVisible: [],\n        lastHidden: [],\n        hidden: [],\n    });\n}\nfunction show(annotationUID, annotationUIDsSet, detail) {\n    if (annotationUIDsSet.delete(annotationUID)) {\n        detail.lastVisible.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        annotation.isVisible = true;\n    }\n}\nfunction hide(annotationUID, annotationUIDsSet, detail) {\n    if (!annotationUIDsSet.has(annotationUID)) {\n        annotationUIDsSet.add(annotationUID);\n        if (isAnnotationSelected(annotationUID)) {\n            deselectAnnotation(annotationUID);\n        }\n        detail.lastHidden.push(annotationUID);\n    }\n}\nfunction publish(detail) {\n    if (detail.lastHidden.length > 0 || detail.lastVisible.length > 0) {\n        globalHiddenAnnotationUIDsSet.forEach((item) => void detail.hidden.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_VISIBILITY_CHANGE, detail);\n    }\n}\nfunction checkAndSetAnnotationVisibility(annotationUID) {\n    const isVisible = !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    setAnnotationVisibility(annotationUID, isVisible);\n    return isVisible;\n}\nexport { setAnnotationVisibility, showAllAnnotations, isAnnotationVisible, checkAndSetAnnotationVisibility, };\n","class ToolStyle {\n    constructor() {\n        const defaultConfig = {\n            color: 'rgb(255, 255, 0)',\n            colorHighlighted: 'rgb(0, 255, 0)',\n            colorSelected: 'rgb(0, 220, 0)',\n            colorLocked: 'rgb(209, 193, 90)',\n            lineWidth: '1',\n            lineDash: '',\n            shadow: true,\n            textBoxVisibility: true,\n            textBoxFontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            textBoxFontSize: '14px',\n            textBoxColor: 'rgb(255, 255, 0)',\n            textBoxColorHighlighted: 'rgb(0, 255, 0)',\n            textBoxColorSelected: 'rgb(0, 255, 0)',\n            textBoxColorLocked: 'rgb(209, 193, 90)',\n            textBoxBackground: '',\n            textBoxLinkLineWidth: '1',\n            textBoxLinkLineDash: '2,3',\n            textBoxShadow: true,\n            markerSize: '10',\n        };\n        this._initializeConfig(defaultConfig);\n    }\n    getAnnotationToolStyles(annotationUID) {\n        return this.config.annotations && this.config.annotations[annotationUID];\n    }\n    getViewportToolStyles(viewportId) {\n        return this.config.viewports && this.config.viewports[viewportId];\n    }\n    getToolGroupToolStyles(toolGroupId) {\n        return this.config.toolGroups && this.config.toolGroups[toolGroupId];\n    }\n    getDefaultToolStyles() {\n        return this.config.default;\n    }\n    setAnnotationStyles(annotationUID, styles) {\n        let annotationSpecificStyles = this.config.annotations;\n        if (!annotationSpecificStyles) {\n            this.config = {\n                ...this.config,\n                annotations: {},\n            };\n            annotationSpecificStyles = this.config.annotations;\n        }\n        annotationSpecificStyles[annotationUID] = styles;\n    }\n    setViewportToolStyles(viewportId, styles) {\n        let viewportSpecificStyles = this.config.viewports;\n        if (!viewportSpecificStyles) {\n            this.config = {\n                ...this.config,\n                viewports: {},\n            };\n            viewportSpecificStyles = this.config.viewports;\n        }\n        viewportSpecificStyles[viewportId] = styles;\n    }\n    setToolGroupToolStyles(toolGroupId, styles) {\n        let toolGroupSpecificStyles = this.config.toolGroups;\n        if (!toolGroupSpecificStyles) {\n            this.config = {\n                ...this.config,\n                toolGroups: {},\n            };\n            toolGroupSpecificStyles = this.config.toolGroups;\n        }\n        toolGroupSpecificStyles[toolGroupId] = styles;\n    }\n    setDefaultToolStyles(styles) {\n        this.config.default = styles;\n    }\n    getStyleProperty(toolStyle, specifications) {\n        const { annotationUID, viewportId, toolGroupId, toolName } = specifications;\n        return this._getToolStyle(toolStyle, annotationUID, viewportId, toolGroupId, toolName);\n    }\n    _getToolStyle(property, annotationUID, viewportId, toolGroupId, toolName) {\n        if (annotationUID) {\n            const annotationToolStyles = this.getAnnotationToolStyles(annotationUID);\n            if (annotationToolStyles) {\n                if (annotationToolStyles[property] !== undefined) {\n                    return annotationToolStyles[property];\n                }\n            }\n        }\n        if (viewportId) {\n            const viewportToolStyles = this.getViewportToolStyles(viewportId);\n            if (viewportToolStyles) {\n                if (viewportToolStyles[toolName] &&\n                    viewportToolStyles[toolName][property] !== undefined) {\n                    return viewportToolStyles[toolName][property];\n                }\n                if (viewportToolStyles.global &&\n                    viewportToolStyles.global[property] !== undefined) {\n                    return viewportToolStyles.global[property];\n                }\n            }\n        }\n        if (toolGroupId) {\n            const toolGroupToolStyles = this.getToolGroupToolStyles(toolGroupId);\n            if (toolGroupToolStyles) {\n                if (toolGroupToolStyles[toolName] &&\n                    toolGroupToolStyles[toolName][property] !== undefined) {\n                    return toolGroupToolStyles[toolName][property];\n                }\n                if (toolGroupToolStyles.global &&\n                    toolGroupToolStyles.global[property] !== undefined) {\n                    return toolGroupToolStyles.global[property];\n                }\n            }\n        }\n        const globalStyles = this.getDefaultToolStyles();\n        if (globalStyles[toolName] &&\n            globalStyles[toolName][property] !== undefined) {\n            return globalStyles[toolName][property];\n        }\n        if (globalStyles.global && globalStyles.global[property] !== undefined) {\n            return globalStyles.global[property];\n        }\n    }\n    _initializeConfig(config) {\n        const toolStyles = {};\n        for (const name in config) {\n            toolStyles[name] = config[name];\n        }\n        this.config = {\n            default: {\n                global: toolStyles,\n            },\n        };\n    }\n}\nconst toolStyle = new ToolStyle();\nexport default toolStyle;\n","import toolStyle from './ToolStyle';\nfunction getHierarchalPropertyStyles(property, state, mode) {\n    const list = [`${property}`];\n    if (state) {\n        list.push(`${list[0]}${state}`);\n    }\n    if (mode) {\n        list.push(`${list[list.length - 1]}${mode}`);\n    }\n    return list;\n}\nfunction getStyleProperty(property, styleSpecifier, state, mode) {\n    const alternatives = getHierarchalPropertyStyles(property, state, mode);\n    for (let i = alternatives.length - 1; i >= 0; --i) {\n        const style = toolStyle.getStyleProperty(alternatives[i], styleSpecifier);\n        if (style !== undefined) {\n            return style;\n        }\n    }\n}\nexport { getStyleProperty };\n","import { isAnnotationLocked } from '../annotationLocking';\nimport { isAnnotationSelected } from '../annotationSelection';\nimport { AnnotationStyleStates } from '../../../enums';\nfunction getState(annotation) {\n    if (annotation) {\n        if (annotation.data && annotation.highlighted) {\n            return AnnotationStyleStates.Highlighted;\n        }\n        if (isAnnotationSelected(annotation.annotationUID)) {\n            return AnnotationStyleStates.Selected;\n        }\n        if (isAnnotationLocked(annotation.annotationUID)) {\n            return AnnotationStyleStates.Locked;\n        }\n        if (annotation.data && annotation.autoGenerated) {\n            return AnnotationStyleStates.AutoGenerated;\n        }\n    }\n    return AnnotationStyleStates.Default;\n}\nexport default getState;\n","import { getStyleProperty } from './helpers';\nfunction getFont(styleSpecifier, state, mode) {\n    const fontSize = getStyleProperty('textBoxFontSize', styleSpecifier, state, mode);\n    const fontFamily = getStyleProperty('textBoxFontFamily', styleSpecifier, state, mode);\n    return `${fontSize}px ${fontFamily}`;\n}\nexport default getFont;\n","import { getEnabledElement, triggerEvent, eventTarget, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { Events, ChangeTypes } from '../../../enums';\nimport { getToolGroupsWithToolName } from '../../../store/ToolGroupManager';\nfunction triggerAnnotationAddedForElement(annotation, element) {\n    const enabledElement = getEnabledElement(element);\n    const { renderingEngine, viewportId } = enabledElement;\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId: renderingEngine.id,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationAddedForFOR(annotation) {\n    const { toolName } = annotation.metadata;\n    const toolGroups = getToolGroupsWithToolName(toolName);\n    if (!toolGroups.length) {\n        return;\n    }\n    const viewportsToRender = [];\n    toolGroups.forEach((toolGroup) => {\n        toolGroup.viewportsInfo.forEach((viewportInfo) => {\n            const { renderingEngineId, viewportId } = viewportInfo;\n            const { FrameOfReferenceUID } = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (annotation.metadata.FrameOfReferenceUID === FrameOfReferenceUID) {\n                viewportsToRender.push(viewportInfo);\n            }\n        });\n    });\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = { annotation };\n    if (!viewportsToRender.length) {\n        triggerEvent(eventTarget, eventType, eventDetail);\n        return;\n    }\n    viewportsToRender.forEach(({ renderingEngineId, viewportId }) => {\n        eventDetail.viewportId = viewportId;\n        eventDetail.renderingEngineId = renderingEngineId;\n        triggerEvent(eventTarget, eventType, eventDetail);\n    });\n}\nfunction triggerAnnotationRemoved(eventDetail) {\n    const eventType = Events.ANNOTATION_REMOVED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationModified(annotation, element, changeType = ChangeTypes.HandlesUpdated) {\n    const enabledElement = element && getEnabledElement(element);\n    const { viewportId, renderingEngineId } = enabledElement || {};\n    const eventType = Events.ANNOTATION_MODIFIED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId,\n        changeType,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationCompleted(annotation) {\n    const eventDetail = {\n        annotation,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled = false) {\n    const eventDetail = {\n        annotation,\n        contourHoleProcessingEnabled,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction _triggerAnnotationCompleted(eventDetail) {\n    const eventType = Events.ANNOTATION_COMPLETED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nexport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, triggerAnnotationModified, triggerAnnotationCompleted, triggerContourAnnotationCompleted, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport { getAnnotation } from './annotationState';\nexport default class AnnotationGroup {\n    constructor() {\n        this.annotationUIDs = new Set();\n        this._isVisible = true;\n        this.visibleFilter = this.unboundVisibleFilter.bind(this);\n    }\n    unboundVisibleFilter(uid) {\n        return !this._isVisible || !this.annotationUIDs.has(uid);\n    }\n    has(uid) {\n        return this.annotationUIDs.has(uid);\n    }\n    setVisible(isVisible = true, baseEvent, filter) {\n        if (this._isVisible === isVisible) {\n            return;\n        }\n        this._isVisible = isVisible;\n        this.annotationUIDs.forEach((uid) => {\n            const annotation = getAnnotation(uid);\n            if (!annotation) {\n                this.annotationUIDs.delete(uid);\n                return;\n            }\n            if (annotation.isVisible === isVisible) {\n                return;\n            }\n            if (!isVisible && filter?.(uid) === false) {\n                return;\n            }\n            annotation.isVisible = isVisible;\n            const eventDetail = {\n                ...baseEvent,\n                annotation,\n            };\n            triggerEvent(eventTarget, Events.ANNOTATION_MODIFIED, eventDetail);\n        });\n    }\n    get isVisible() {\n        return this._isVisible;\n    }\n    findNearby(uid, direction) {\n        const uids = [...this.annotationUIDs];\n        if (uids.length === 0) {\n            return null;\n        }\n        if (!uid) {\n            return uids[direction === 1 ? 0 : uids.length - 1];\n        }\n        const index = uids.indexOf(uid);\n        if (index === -1 ||\n            index + direction < 0 ||\n            index + direction >= uids.length) {\n            return null;\n        }\n        return uids[index + direction];\n    }\n    add(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.add(annotationUID));\n    }\n    remove(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.delete(annotationUID));\n    }\n    clear() {\n        this.annotationUIDs.clear();\n    }\n}\n","import * as config from './config';\nimport * as locking from './annotationLocking';\nimport * as selection from './annotationSelection';\nimport * as annotationState from './annotationState';\nimport * as annotationStateHelpers from './helpers/state';\nimport * as visibility from './annotationVisibility';\nimport FrameOfReferenceSpecificAnnotationManager from './FrameOfReferenceSpecificAnnotationManager';\nimport AnnotationGroup from './AnnotationGroup';\nimport { resetAnnotationManager } from './resetAnnotationManager';\nconst state = {\n    ...annotationState,\n    ...annotationStateHelpers,\n    resetAnnotationManager,\n};\nexport { config, locking, selection, state, visibility, FrameOfReferenceSpecificAnnotationManager, AnnotationGroup, };\n","import { triggerEvent, eventTarget, Enums, getRenderingEngines, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations, Events as csToolsEvents, } from '../../enums';\nimport Representations from '../../enums/SegmentationRepresentations';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport surfaceDisplay from '../../tools/displayTools/Surface/surfaceDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport { addTool } from '../../store/addTool';\nimport { state } from '../../store/state';\nimport PlanarFreehandContourSegmentationTool from '../../tools/annotation/PlanarFreehandContourSegmentationTool';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst renderers = {\n    [Representations.Labelmap]: labelmapDisplay,\n    [Representations.Contour]: contourDisplay,\n    [Representations.Surface]: surfaceDisplay,\n};\nconst planarContourToolName = PlanarFreehandContourSegmentationTool.toolName;\nclass SegmentationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._getAllViewports = () => {\n            const renderingEngine = getRenderingEngines();\n            return renderingEngine.flatMap((renderingEngine) => renderingEngine.getViewports());\n        };\n        this._renderFlaggedSegmentations = () => {\n            this._throwIfDestroyed();\n            const viewportIds = Array.from(this._needsRender);\n            viewportIds.forEach((viewportId) => {\n                this._triggerRender(viewportId);\n            });\n            this._needsRender.clear();\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n        };\n    }\n    renderSegmentationsForViewport(viewportId) {\n        const viewportIds = viewportId\n            ? [viewportId]\n            : this._getViewportIdsForSegmentation();\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    renderSegmentation(segmentationId) {\n        const viewportIds = this._getViewportIdsForSegmentation(segmentationId);\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    _getViewportIdsForSegmentation(segmentationId) {\n        const viewports = this._getAllViewports();\n        const viewportIds = [];\n        for (const viewport of viewports) {\n            const viewportId = viewport.id;\n            if (segmentationId) {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n            else {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n        }\n        return viewportIds;\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setViewportsToBeRenderedNextFrame(viewportIds) {\n        viewportIds.forEach((viewportId) => {\n            this._needsRender.add(viewportId);\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedSegmentations);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(viewportId) {\n        const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n        if (!segmentationRepresentations?.length) {\n            return;\n        }\n        const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n        if (!viewport) {\n            return;\n        }\n        const viewportRenderList = [];\n        const segmentationRenderList = segmentationRepresentations.map((representation) => {\n            if (representation.type === SegmentationRepresentations.Contour) {\n                this._addPlanarFreeHandToolIfAbsent(viewport);\n            }\n            const display = renderers[representation.type];\n            try {\n                const viewportId = display.render(viewport, representation);\n                viewportRenderList.push(viewportId);\n            }\n            catch (error) {\n                console.error(error);\n            }\n            return Promise.resolve({\n                segmentationId: representation.segmentationId,\n                type: representation.type,\n            });\n        });\n        Promise.allSettled(segmentationRenderList).then((results) => {\n            const segmentationDetails = results\n                .filter((r) => r.status === 'fulfilled')\n                .map((r) => r.value);\n            function onSegmentationRender(evt) {\n                const { element, viewportId } = evt.detail;\n                element.removeEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n                segmentationDetails.forEach((detail) => {\n                    const eventDetail = {\n                        viewportId,\n                        segmentationId: detail.segmentationId,\n                        type: detail.type,\n                    };\n                    triggerEvent(eventTarget, csToolsEvents.SEGMENTATION_RENDERED, {\n                        ...eventDetail,\n                    });\n                });\n            }\n            const element = viewport.element;\n            element.addEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n            viewport.render();\n        });\n    }\n    _addPlanarFreeHandToolIfAbsent(viewport) {\n        if (!(planarContourToolName in state.tools)) {\n            addTool(PlanarFreehandContourSegmentationTool);\n        }\n        const toolGroup = getToolGroupForViewport(viewport.id);\n        if (!toolGroup.hasTool(planarContourToolName)) {\n            toolGroup.addTool(planarContourToolName);\n            toolGroup.setToolPassive(planarContourToolName);\n        }\n    }\n}\nfunction triggerSegmentationRender(viewportId) {\n    segmentationRenderingEngine.renderSegmentationsForViewport(viewportId);\n}\nfunction triggerSegmentationRenderBySegmentationId(segmentationId) {\n    segmentationRenderingEngine.renderSegmentation(segmentationId);\n}\nconst segmentationRenderingEngine = new SegmentationRenderingEngine();\nexport { triggerSegmentationRender, triggerSegmentationRenderBySegmentationId, segmentationRenderingEngine, };\n","import { BaseVolumeViewport, cache, utilities as csUtils, getEnabledElementByViewportId, volumeLoader, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport vtkColorTransferFunction from '@kitware/vtk.js/Rendering/Core/ColorTransferFunction';\nimport vtkPiecewiseFunction from '@kitware/vtk.js/Common/DataModel/PiecewiseFunction';\nimport { triggerSegmentationModified, triggerSegmentationRemoved, triggerSegmentationRepresentationModified, triggerSegmentationRepresentationRemoved, } from './triggerSegmentationEvents';\nimport { segmentationStyle } from './SegmentationStyle';\nimport { triggerSegmentationAdded } from './events/triggerSegmentationAdded';\nconst initialDefaultState = {\n    colorLUT: [],\n    segmentations: [],\n    viewportSegRepresentations: {},\n};\nexport default class SegmentationStateManager {\n    constructor(uid) {\n        this._stackLabelmapImageIdReferenceMap = new Map();\n        this._labelmapImageIdReferenceMap = new Map();\n        uid ||= csUtils.uuidv4();\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n        this.uid = uid;\n    }\n    getState() {\n        return this.state;\n    }\n    updateState(updater) {\n        const newState = csUtils.deepClone(this.state);\n        updater(newState);\n        this.state = Object.freeze(newState);\n    }\n    getColorLUT(lutIndex) {\n        return this.state.colorLUT[lutIndex];\n    }\n    getNextColorLUTIndex() {\n        return this.state.colorLUT.length;\n    }\n    resetState() {\n        this._stackLabelmapImageIdReferenceMap.clear();\n        this._labelmapImageIdReferenceMap.clear();\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n    }\n    getSegmentation(segmentationId) {\n        return this.state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n    }\n    updateSegmentation(segmentationId, payload) {\n        this.updateState((draftState) => {\n            const segmentation = draftState.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n            if (!segmentation) {\n                console.warn(`Segmentation with id ${segmentationId} not found. Update aborted.`);\n                return;\n            }\n            Object.assign(segmentation, payload);\n        });\n        triggerSegmentationModified(segmentationId);\n    }\n    addSegmentation(segmentation) {\n        if (this.getSegmentation(segmentation.segmentationId)) {\n            throw new Error(`Segmentation with id ${segmentation.segmentationId} already exists`);\n        }\n        this.updateState((state) => {\n            const newSegmentation = csUtils.deepClone(segmentation);\n            if (newSegmentation.representationData.Labelmap &&\n                'volumeId' in newSegmentation.representationData.Labelmap &&\n                !('imageIds' in newSegmentation.representationData.Labelmap)) {\n                const imageIds = this.getLabelmapImageIds(newSegmentation.representationData);\n                newSegmentation.representationData\n                    .Labelmap.imageIds = imageIds;\n            }\n            state.segmentations.push(newSegmentation);\n        });\n        triggerSegmentationAdded(segmentation.segmentationId);\n    }\n    removeSegmentation(segmentationId) {\n        this.updateState((state) => {\n            const filteredSegmentations = state.segmentations.filter((segmentation) => segmentation.segmentationId !== segmentationId);\n            state.segmentations.splice(0, state.segmentations.length, ...filteredSegmentations);\n        });\n        triggerSegmentationRemoved(segmentationId);\n    }\n    addSegmentationRepresentation(viewportId, segmentationId, type, renderingConfig) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const existingRepresentations = this.getSegmentationRepresentations(viewportId, {\n            type: type,\n            segmentationId,\n        });\n        if (existingRepresentations.length > 0) {\n            console.debug('A segmentation representation of type', type, 'already exists in viewport', viewportId, 'for segmentation', segmentationId);\n            return;\n        }\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                state.viewportSegRepresentations[viewportId] = [];\n                segmentationStyle.setRenderInactiveSegmentations(viewportId, true);\n            }\n            if (type !== SegmentationRepresentations.Labelmap) {\n                this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig);\n            }\n            else {\n                this.addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig);\n            }\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId, type);\n    }\n    addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig) {\n        const segmentation = state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const segmentReps = {};\n        Object.keys(segmentation.segments).forEach((segmentIndex) => {\n            segmentReps[Number(segmentIndex)] = {\n                visible: true,\n            };\n        });\n        state.viewportSegRepresentations[viewportId].push({\n            segmentationId,\n            type,\n            active: true,\n            visible: true,\n            colorLUTIndex: renderingConfig?.colorLUTIndex || 0,\n            segments: segmentReps,\n            config: {\n                ...getDefaultRenderingConfig(type),\n                ...renderingConfig,\n            },\n        });\n        this._setActiveSegmentation(state, viewportId, segmentationId);\n    }\n    addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig = getDefaultRenderingConfig(SegmentationRepresentations.Labelmap)) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n        }\n        this.processLabelmapRepresentationAddition(viewportId, segmentationId);\n        this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n    }\n    async processLabelmapRepresentationAddition(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const volumeViewport = enabledElement.viewport instanceof BaseVolumeViewport;\n        const { representationData } = segmentation;\n        const isBaseVolumeSegmentation = 'volumeId' in representationData.Labelmap;\n        const viewport = enabledElement.viewport;\n        if (!volumeViewport && !isBaseVolumeSegmentation) {\n            !this.updateLabelmapSegmentationImageReferences(viewportId, segmentation.segmentationId);\n        }\n    }\n    _updateLabelmapSegmentationReferences(segmentationId, viewport, labelmapImageIds, updateCallback) {\n        const referenceImageId = viewport.getCurrentImageId();\n        let viewableLabelmapImageIdFound = false;\n        for (const labelmapImageId of labelmapImageIds) {\n            const viewableImageId = viewport.isReferenceViewable({ referencedImageId: labelmapImageId }, { asOverlay: true });\n            if (viewableImageId) {\n                viewableLabelmapImageIdFound = true;\n                this._stackLabelmapImageIdReferenceMap\n                    .get(segmentationId)\n                    .set(referenceImageId, labelmapImageId);\n                this._updateLabelmapImageIdReferenceMap({\n                    segmentationId,\n                    referenceImageId,\n                    labelmapImageId,\n                });\n            }\n        }\n        if (updateCallback) {\n            updateCallback(viewport, segmentationId, labelmapImageIds);\n        }\n        return viewableLabelmapImageIdFound\n            ? this._stackLabelmapImageIdReferenceMap\n                .get(segmentationId)\n                .get(referenceImageId)\n            : undefined;\n    }\n    updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        return this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, null);\n    }\n    _updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, (stackViewport, segmentationId, labelmapImageIds) => {\n            const imageIds = stackViewport.getImageIds();\n            imageIds.forEach((referenceImageId, index) => {\n                for (const labelmapImageId of labelmapImageIds) {\n                    const viewableImageId = stackViewport.isReferenceViewable({ referencedImageId: labelmapImageId, sliceIndex: index }, { asOverlay: true, withNavigation: true });\n                    if (viewableImageId) {\n                        this._stackLabelmapImageIdReferenceMap\n                            .get(segmentationId)\n                            .set(referenceImageId, labelmapImageId);\n                        this._updateLabelmapImageIdReferenceMap({\n                            segmentationId,\n                            referenceImageId,\n                            labelmapImageId,\n                        });\n                    }\n                }\n            });\n        });\n    }\n    getLabelmapImageIds(representationData) {\n        const labelmapData = representationData.Labelmap;\n        let labelmapImageIds;\n        if (labelmapData.imageIds) {\n            labelmapImageIds = labelmapData\n                .imageIds;\n        }\n        else if (!labelmapImageIds &&\n            labelmapData.volumeId) {\n            const volumeId = labelmapData\n                .volumeId;\n            const volume = cache.getVolume(volumeId);\n            labelmapImageIds = volume.imageIds;\n        }\n        return labelmapImageIds;\n    }\n    getLabelmapImageIdsForImageId(imageId, segmentationId) {\n        const key = this._generateMapKey({\n            segmentationId,\n            referenceImageId: imageId,\n        });\n        return this._labelmapImageIdReferenceMap.get(key);\n    }\n    getCurrentLabelmapImageIdsForViewport(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const stackViewport = enabledElement.viewport;\n        const referenceImageId = stackViewport.getCurrentImageId();\n        return this.getLabelmapImageIdsForImageId(referenceImageId, segmentationId);\n    }\n    getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            return;\n        }\n        const stackViewport = enabledElement.viewport;\n        const currentImageId = stackViewport.getCurrentImageId();\n        const imageIdReferenceMap = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIdReferenceMap.get(currentImageId);\n    }\n    getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return [];\n        }\n        this._updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId);\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        const imageIds = viewport.getImageIds();\n        const associatedReferenceImageAndLabelmapImageIds = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIds.map((imageId) => {\n            return associatedReferenceImageAndLabelmapImageIds.get(imageId);\n        });\n    }\n    removeSegmentationRepresentationsInternal(viewportId, specifier) {\n        const removedRepresentations = [];\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                return;\n            }\n            const currentRepresentations = state.viewportSegRepresentations[viewportId];\n            let activeRepresentationRemoved = false;\n            if (!specifier ||\n                Object.values(specifier).every((value) => value === undefined)) {\n                removedRepresentations.push(...currentRepresentations);\n                delete state.viewportSegRepresentations[viewportId];\n            }\n            else {\n                const { segmentationId, type } = specifier;\n                state.viewportSegRepresentations[viewportId] =\n                    currentRepresentations.filter((representation) => {\n                        const shouldRemove = (segmentationId &&\n                            type &&\n                            representation.segmentationId === segmentationId &&\n                            representation.type === type) ||\n                            (segmentationId &&\n                                !type &&\n                                representation.segmentationId === segmentationId) ||\n                            (!segmentationId && type && representation.type === type);\n                        if (shouldRemove) {\n                            removedRepresentations.push(representation);\n                            if (representation.active) {\n                                activeRepresentationRemoved = true;\n                            }\n                        }\n                        return !shouldRemove;\n                    });\n                if (state.viewportSegRepresentations[viewportId].length === 0) {\n                    delete state.viewportSegRepresentations[viewportId];\n                }\n                else if (activeRepresentationRemoved) {\n                    state.viewportSegRepresentations[viewportId][0].active = true;\n                }\n            }\n        });\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentations(viewportId, specifier) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        removedRepresentations.forEach((representation) => {\n            triggerSegmentationRepresentationRemoved(viewportId, representation.segmentationId, representation.type);\n        });\n        const remainingRepresentations = this.getSegmentationRepresentations(viewportId);\n        if (remainingRepresentations.length > 0 &&\n            remainingRepresentations[0].active) {\n            triggerSegmentationRepresentationModified(viewportId, remainingRepresentations[0].segmentationId, remainingRepresentations[0].type);\n        }\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentation(viewportId, specifier, suppressEvent) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        if (!suppressEvent) {\n            removedRepresentations.forEach(({ segmentationId, type }) => {\n                triggerSegmentationRepresentationRemoved(viewportId, segmentationId, type);\n            });\n        }\n        return removedRepresentations;\n    }\n    _updateLabelmapImageIdReferenceMap({ segmentationId, referenceImageId, labelmapImageId, }) {\n        const key = this._generateMapKey({ segmentationId, referenceImageId });\n        if (!this._labelmapImageIdReferenceMap.has(key)) {\n            this._labelmapImageIdReferenceMap.set(key, [labelmapImageId]);\n            return;\n        }\n        const currentValues = this._labelmapImageIdReferenceMap.get(key);\n        const newValues = Array.from(new Set([...currentValues, labelmapImageId]));\n        this._labelmapImageIdReferenceMap.set(key, newValues);\n    }\n    _setActiveSegmentation(state, viewportId, segmentationId) {\n        const viewport = state.viewportSegRepresentations[viewportId];\n        if (!viewport) {\n            return;\n        }\n        viewport.forEach((value) => {\n            value.active = value.segmentationId === segmentationId;\n        });\n    }\n    setActiveSegmentation(viewportId, segmentationId) {\n        this.updateState((state) => {\n            const viewport = state.viewportSegRepresentations[viewportId];\n            if (!viewport) {\n                return;\n            }\n            viewport.forEach((value) => {\n                value.active = value.segmentationId === segmentationId;\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId);\n    }\n    getActiveSegmentation(viewportId) {\n        if (!this.state.viewportSegRepresentations[viewportId]) {\n            return;\n        }\n        const activeSegRep = this.state.viewportSegRepresentations[viewportId].find((segRep) => segRep.active);\n        if (!activeSegRep) {\n            return;\n        }\n        return this.getSegmentation(activeSegRep.segmentationId);\n    }\n    getSegmentationRepresentations(viewportId, specifier = {}) {\n        const viewportRepresentations = this.state.viewportSegRepresentations[viewportId];\n        if (!viewportRepresentations) {\n            return [];\n        }\n        if (!specifier.type && !specifier.segmentationId) {\n            return viewportRepresentations;\n        }\n        return viewportRepresentations.filter((representation) => {\n            const typeMatch = specifier.type\n                ? representation.type === specifier.type\n                : true;\n            const idMatch = specifier.segmentationId\n                ? representation.segmentationId === specifier.segmentationId\n                : true;\n            return typeMatch && idMatch;\n        });\n    }\n    getSegmentationRepresentation(viewportId, specifier) {\n        return this.getSegmentationRepresentations(viewportId, specifier)[0];\n    }\n    getSegmentationRepresentationVisibility(viewportId, specifier) {\n        const viewportRepresentation = this.getSegmentationRepresentation(viewportId, specifier);\n        return viewportRepresentation?.visible;\n    }\n    setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n        this.updateState((state) => {\n            const viewportRepresentations = this.getSegmentationRepresentations(viewportId, specifier);\n            if (!viewportRepresentations) {\n                return;\n            }\n            viewportRepresentations.forEach((representation) => {\n                representation.visible = visible;\n                Object.entries(representation.segments).forEach(([segmentIndex, segment]) => {\n                    segment.visible = visible;\n                });\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId, specifier.type);\n    }\n    addColorLUT(colorLUT, lutIndex) {\n        this.updateState((state) => {\n            if (state.colorLUT[lutIndex]) {\n                console.warn('Color LUT table already exists, overwriting');\n            }\n            state.colorLUT[lutIndex] = csUtils.deepClone(colorLUT);\n        });\n    }\n    removeColorLUT(colorLUTIndex) {\n        this.updateState((state) => {\n            delete state.colorLUT[colorLUTIndex];\n        });\n    }\n    _getStackIdForImageIds(imageIds) {\n        return imageIds\n            .map((imageId) => imageId.slice(-Math.round(imageId.length * 0.15)))\n            .join('_');\n    }\n    getAllViewportSegmentationRepresentations() {\n        return Object.entries(this.state.viewportSegRepresentations).map(([viewportId, representations]) => ({\n            viewportId,\n            representations,\n        }));\n    }\n    getSegmentationRepresentationsBySegmentationId(segmentationId) {\n        const result = [];\n        Object.entries(this.state.viewportSegRepresentations).forEach(([viewportId, viewportReps]) => {\n            const filteredReps = viewportReps.filter((representation) => representation.segmentationId === segmentationId);\n            if (filteredReps.length > 0) {\n                result.push({ viewportId, representations: filteredReps });\n            }\n        });\n        return result;\n    }\n    _generateMapKey({ segmentationId, referenceImageId }) {\n        return `${segmentationId}-${referenceImageId}`;\n    }\n}\nasync function internalComputeVolumeLabelmapFromStack({ imageIds, options, }) {\n    const segmentationImageIds = imageIds;\n    const volumeId = options?.volumeId || csUtils.uuidv4();\n    await volumeLoader.createAndCacheVolumeFromImages(volumeId, segmentationImageIds);\n    return { volumeId };\n}\nasync function internalConvertStackToVolumeLabelmap({ segmentationId, options, }) {\n    const segmentation = defaultSegmentationStateManager.getSegmentation(segmentationId);\n    const data = segmentation.representationData\n        .Labelmap;\n    const { volumeId } = await internalComputeVolumeLabelmapFromStack({\n        imageIds: data.imageIds,\n        options,\n    });\n    segmentation.representationData.Labelmap.volumeId = volumeId;\n}\nfunction getDefaultRenderingConfig(type) {\n    const cfun = vtkColorTransferFunction.newInstance();\n    const ofun = vtkPiecewiseFunction.newInstance();\n    ofun.addPoint(0, 0);\n    if (type === SegmentationRepresentations.Labelmap) {\n        return {\n            cfun,\n            ofun,\n        };\n    }\n    else {\n        return {};\n    }\n}\nconst defaultSegmentationStateManager = new SegmentationStateManager('DEFAULT');\nexport { internalConvertStackToVolumeLabelmap, internalComputeVolumeLabelmapFromStack, defaultSegmentationStateManager, };\n","import { getActiveSegmentation as _getActiveSegmentation } from './getActiveSegmentation';\nimport { setActiveSegmentation as _setActiveSegmentation } from './setActiveSegmentation';\nfunction getActiveSegmentation(viewportId) {\n    return _getActiveSegmentation(viewportId);\n}\nfunction setActiveSegmentation(viewportId, segmentationId) {\n    _setActiveSegmentation(viewportId, segmentationId);\n}\nexport { getActiveSegmentation, setActiveSegmentation, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setActiveSegmentation(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setActiveSegmentation(viewportId, segmentationId);\n}\n","import { utilities } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nexport function addColorLUT(colorLUT, index) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const indexToUse = index ?? getNextColorLUTIndex();\n    let colorLUTToUse = [...colorLUT];\n    if (!utilities.isEqual(colorLUTToUse[0], [0, 0, 0, 0])) {\n        console.warn('addColorLUT: [0, 0, 0, 0] color is not provided for the background color (segmentIndex =0), automatically adding it');\n        colorLUTToUse = [[0, 0, 0, 0], ...colorLUTToUse];\n    }\n    colorLUTToUse = colorLUTToUse.map((color) => {\n        if (color.length === 3) {\n            return [color[0], color[1], color[2], 255];\n        }\n        return color;\n    });\n    if (colorLUTToUse.length < 255) {\n        const missingColorLUTs = CORNERSTONE_COLOR_LUT.slice(colorLUTToUse.length);\n        colorLUTToUse = [...colorLUTToUse, ...missingColorLUTs];\n    }\n    segmentationStateManager.addColorLUT(colorLUTToUse, indexToUse);\n    return indexToUse;\n}\n","import { SegmentationRepresentations } from '../../enums';\nimport { internalAddSegmentationRepresentation } from './internalAddSegmentationRepresentation';\nexport function addSegmentationRepresentations(viewportId, segmentationInputArray) {\n    segmentationInputArray.map((segmentationInput) => {\n        return internalAddSegmentationRepresentation(viewportId, segmentationInput);\n    });\n}\nfunction addContourRepresentationToViewport(viewportId, contourInputArray) {\n    return addSegmentationRepresentations(viewportId, contourInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Contour,\n    })));\n}\nfunction addContourRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addContourRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nfunction addLabelmapRepresentationToViewport(viewportId, labelmapInputArray) {\n    return addSegmentationRepresentations(viewportId, labelmapInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Labelmap,\n    })));\n}\nfunction addLabelmapRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addLabelmapRepresentationToViewport(viewportId, inputArray.map((input) => ({\n            ...input,\n            type: SegmentationRepresentations.Labelmap,\n        })));\n    }\n}\nfunction addSurfaceRepresentationToViewport(viewportId, surfaceInputArray) {\n    return addSegmentationRepresentations(viewportId, surfaceInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Surface,\n    })));\n}\nfunction addSurfaceRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addSurfaceRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nexport { addContourRepresentationToViewport, addLabelmapRepresentationToViewport, addSurfaceRepresentationToViewport, addContourRepresentationToViewportMap, addLabelmapRepresentationToViewportMap, addSurfaceRepresentationToViewportMap, };\n","import { SegmentationRepresentations } from '../../../enums';\nimport { cache } from '@cornerstonejs/core';\nfunction normalizeSegmentationInput(segmentationInput) {\n    const { segmentationId, representation, config } = segmentationInput;\n    const { type, data: inputData } = representation;\n    const data = inputData ? { ...inputData } : {};\n    if (!data) {\n        throw new Error('Segmentation representation data may not be undefined');\n    }\n    if (type === SegmentationRepresentations.Contour) {\n        normalizeContourData(data);\n    }\n    const normalizedSegments = normalizeSegments(config?.segments, type, data);\n    delete config?.segments;\n    return {\n        segmentationId,\n        label: config?.label ?? null,\n        cachedStats: config?.cachedStats ?? {},\n        segments: normalizedSegments,\n        representationData: {\n            [type]: {\n                ...data,\n            },\n        },\n    };\n}\nfunction normalizeContourData(contourData) {\n    contourData.geometryIds = contourData.geometryIds ?? [];\n    contourData.annotationUIDsMap = contourData.annotationUIDsMap ?? new Map();\n}\nfunction normalizeSegments(segmentsConfig, type, data) {\n    const normalizedSegments = {};\n    if (segmentsConfig) {\n        Object.entries(segmentsConfig).forEach(([segmentIndex, segment]) => {\n            normalizedSegments[segmentIndex] = {\n                segmentIndex: Number(segmentIndex),\n                label: segment.label ?? `Segment ${segmentIndex}`,\n                locked: segment.locked ?? false,\n                cachedStats: segment.cachedStats ?? {},\n                active: segment.active ?? false,\n            };\n        });\n    }\n    else if (type === SegmentationRepresentations.Surface) {\n        normalizeSurfaceSegments(normalizedSegments, data);\n    }\n    else {\n        normalizedSegments[1] = createDefaultSegment();\n    }\n    return normalizedSegments;\n}\nfunction normalizeSurfaceSegments(normalizedSegments, surfaceData) {\n    const { geometryIds } = surfaceData;\n    geometryIds?.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (geometry?.data) {\n            const { segmentIndex } = geometry.data;\n            normalizedSegments[segmentIndex] = { segmentIndex };\n        }\n    });\n}\nfunction createDefaultSegment() {\n    return {\n        segmentIndex: 1,\n        label: 'Segment 1',\n        locked: false,\n        cachedStats: {},\n        active: true,\n    };\n}\nexport default normalizeSegmentationInput;\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport normalizeSegmentationInput from './helpers/normalizeSegmentationInput';\nexport function addSegmentations(segmentationInputArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationInputArray.forEach((segmentationInput) => {\n        const segmentation = normalizeSegmentationInput(segmentationInput);\n        segmentationStateManager.addSegmentation(segmentation);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentation.segmentationId);\n        }\n    });\n}\nexport default addSegmentations;\n","import { addColorLUT as _addColorLUT } from '../addColorLUT';\nimport { getColorLUT as _getColorLUT } from '../getColorLUT';\nimport { getSegmentationRepresentations } from '../getSegmentationRepresentation';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction addColorLUT(colorLUT, colorLUTIndex) {\n    if (!colorLUT) {\n        throw new Error('addColorLUT: colorLUT is required');\n    }\n    return _addColorLUT(colorLUT, colorLUTIndex);\n}\nfunction setColorLUT(viewportId, segmentationId, colorLUTsIndex) {\n    if (!_getColorLUT(colorLUTsIndex)) {\n        throw new Error(`setColorLUT: could not find colorLUT with index ${colorLUTsIndex}`);\n    }\n    const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n    if (!segmentationRepresentations) {\n        throw new Error(`viewport specific state for viewport ${viewportId} does not exist`);\n    }\n    segmentationRepresentations.forEach((segmentationRepresentation) => {\n        segmentationRepresentation.colorLUTIndex = colorLUTsIndex;\n    });\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nfunction getSegmentIndexColor(viewportId, segmentationId, segmentIndex) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n    });\n    if (!representations || representations.length === 0) {\n        return null;\n    }\n    const representation = representations[0];\n    const { colorLUTIndex } = representation;\n    const colorLUT = _getColorLUT(colorLUTIndex);\n    let colorValue = colorLUT[segmentIndex];\n    if (!colorValue) {\n        if (typeof segmentIndex !== 'number') {\n            console.warn(`Can't create colour for LUT index ${segmentIndex}`);\n            return null;\n        }\n        colorValue = colorLUT[segmentIndex] = [0, 0, 0, 0];\n    }\n    return colorValue;\n}\nfunction setSegmentIndexColor(viewportId, segmentationId, segmentIndex, color) {\n    const colorReference = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n    for (let i = 0; i < color.length; i++) {\n        colorReference[i] = color[i];\n    }\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nexport { getSegmentIndexColor, addColorLUT, setColorLUT, setSegmentIndexColor };\n","import { getSegmentation } from './getSegmentation';\nexport function getActiveSegmentIndex(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation) {\n        const activeSegmentIndex = Object.keys(segmentation.segments).find((segmentIndex) => segmentation.segments[segmentIndex].active);\n        return activeSegmentIndex ? Number(activeSegmentIndex) : undefined;\n    }\n    return undefined;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n    const imageIds = getCurrentLabelmapImageIdsForViewport(viewportId, segmentationId);\n    return imageIds[0];\n}\nexport function getCurrentLabelmapImageIdsForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getCurrentLabelmapImageIdsForViewport(viewportId, segmentationId);\n}\nexport function getLabelmapImageIdsForImageId(imageId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getLabelmapImageIdsForImageId(imageId, segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentation(segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentationRepresentations(viewportId, specifier = {}) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n}\nexport function getSegmentationRepresentation(viewportId, specifier) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    if (!specifier.segmentationId || !specifier.type) {\n        throw new Error('getSegmentationRepresentation: No segmentationId or type provided, you need to provide at least one of them');\n    }\n    const representations = segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n    return representations?.[0];\n}\nexport function getSegmentationRepresentationsBySegmentationId(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentationsBySegmentationId(segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    return state.segmentations;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportIdsWithSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportSegRepresentations = state.viewportSegRepresentations;\n    const viewportIdsWithSegmentation = Object.entries(viewportSegRepresentations)\n        .filter(([, viewportSegmentations]) => viewportSegmentations.some((segRep) => segRep.segmentationId === segmentationId))\n        .map(([viewportId]) => viewportId);\n    return viewportIdsWithSegmentation;\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportSegmentations(viewportId, type) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportRepresentations = state.viewportSegRepresentations[viewportId];\n    const segmentations = viewportRepresentations.map((representation) => {\n        if (type && representation.type === type) {\n            return getSegmentation(representation.segmentationId);\n        }\n        return getSegmentation(representation.segmentationId);\n    });\n    const filteredSegmentations = segmentations.filter((segmentation) => segmentation !== undefined);\n    return filteredSegmentations;\n}\n","import { cache } from '@cornerstonejs/core';\nimport { getSegmentation } from '../getSegmentation';\nimport { updateStackSegmentationState } from '../helpers/updateStackSegmentationState';\nexport async function computeStackLabelmapFromVolume({ volumeId, }) {\n    const segmentationVolume = cache.getVolume(volumeId);\n    return { imageIds: segmentationVolume.imageIds };\n}\nexport function convertVolumeToStackLabelmap({ segmentationId, options, }) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    const { volumeId } = segmentation.representationData\n        .Labelmap;\n    const segmentationVolume = cache.getVolume(volumeId);\n    return updateStackSegmentationState({\n        segmentationId,\n        viewportId: options.viewportId,\n        imageIds: segmentationVolume.imageIds,\n        options,\n    });\n}\n","import { internalComputeVolumeLabelmapFromStack } from '../SegmentationStateManager';\nexport async function computeVolumeLabelmapFromStack(args) {\n    return internalComputeVolumeLabelmapFromStack(args);\n}\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../../enums';\nfunction getActorEntry(viewportId, segmentationId, filterFn) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { renderingEngine, viewport } = enabledElement;\n    if (!renderingEngine || !viewport) {\n        return;\n    }\n    const actors = viewport.getActors();\n    const filteredActors = actors.filter(filterFn);\n    return filteredActors.length > 0 ? filteredActors[0] : undefined;\n}\nfunction getActorEntries(viewportId, filterFn) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { renderingEngine, viewport } = enabledElement;\n    if (!renderingEngine || !viewport) {\n        return;\n    }\n    const actors = viewport.getActors();\n    const filteredActors = actors.filter(filterFn);\n    return filteredActors.length > 0 ? filteredActors : undefined;\n}\nexport function getLabelmapActorUID(viewportId, segmentationId) {\n    const actorEntry = getLabelmapActorEntry(viewportId, segmentationId);\n    return actorEntry?.uid;\n}\nexport function getLabelmapActorEntries(viewportId, segmentationId) {\n    return getActorEntries(viewportId, (actor) => actor.representationUID?.startsWith(`${segmentationId}-${SegmentationRepresentations.Labelmap}`));\n}\nexport function getLabelmapActorEntry(viewportId, segmentationId) {\n    return getActorEntry(viewportId, segmentationId, (actor) => actor.representationUID?.startsWith(`${segmentationId}-${SegmentationRepresentations.Labelmap}`));\n}\nexport function getSurfaceActorEntry(viewportId, segmentationId, segmentIndex) {\n    return getActorEntry(viewportId, segmentationId, (actor) => actor.representationUID ===\n        getSurfaceRepresentationUID(segmentationId, segmentIndex));\n}\nexport function getSurfaceActorUID(viewportId, segmentationId, segmentIndex) {\n    const segIndex = segmentIndex ? segmentIndex.toString() : '';\n    const actorEntry = getSurfaceActorEntry(viewportId, segmentationId, segIndex);\n    return actorEntry?.uid;\n}\nexport function getSurfaceRepresentationUID(segmentationId, segmentIndex) {\n    return `${segmentationId}-${SegmentationRepresentations.Surface}-${segmentIndex}`;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nexport function updateSegmentations(segmentationUpdateArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationUpdateArray.forEach((segmentationUpdate) => {\n        segmentationStateManager.updateSegmentation(segmentationUpdate.segmentationId, segmentationUpdate.payload);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentationUpdate.segmentationId);\n        }\n    });\n}\n","import { getSegmentationRepresentation, getSegmentationRepresentations, } from '../getSegmentationRepresentation';\nimport { setSegmentationRepresentationVisibility as _setSegmentationRepresentationVisibility } from '../setSegmentationRepresentationVisibility';\nimport { getSegmentationRepresentationVisibility as _getSegmentationRepresentationVisibility } from '../getSegmentationRepresentationVisibility';\nimport { triggerSegmentationRenderBySegmentationId } from '../SegmentationRenderingEngine';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction setSegmentationRepresentationVisibility(viewportId, specifier, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        _setSegmentationRepresentationVisibility(viewportId, {\n            segmentationId: representation.segmentationId,\n            type: representation.type,\n        }, visibility);\n    });\n}\nfunction getSegmentationRepresentationVisibility(viewportId, specifier) {\n    return _getSegmentationRepresentationVisibility(viewportId, specifier);\n}\nfunction setSegmentIndexVisibility(viewportId, specifier, segmentIndex, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        representation.segments[segmentIndex].visible = visibility;\n    });\n    triggerSegmentationRenderBySegmentationId(specifier.segmentationId);\n    triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId);\n}\nfunction getSegmentIndexVisibility(viewportId, specifier, segmentIndex) {\n    const hiddenSegments = getHiddenSegmentIndices(viewportId, specifier);\n    return !hiddenSegments.has(segmentIndex);\n}\nfunction getHiddenSegmentIndices(viewportId, specifier) {\n    const representation = getSegmentationRepresentation(viewportId, specifier);\n    if (!representation) {\n        return new Set();\n    }\n    const segmentsHidden = Object.entries(representation.segments).reduce((acc, [segmentIndex, segment]) => {\n        if (!segment.visible) {\n            acc.add(Number(segmentIndex));\n        }\n        return acc;\n    }, new Set());\n    return segmentsHidden;\n}\nexport { setSegmentationRepresentationVisibility, getSegmentationRepresentationVisibility, setSegmentIndexVisibility, getSegmentIndexVisibility, getHiddenSegmentIndices, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setSegmentationRepresentationVisibility(viewportId, specifier, visible);\n}\n","import { getSegmentations } from '../getSegmentations';\nimport { getViewportSegmentations } from '../getViewportSegmentations';\nimport { triggerSegmentationRender } from '../SegmentationRenderingEngine';\nimport { segmentationStyle } from '../SegmentationStyle';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction getStyle(specifier) {\n    return segmentationStyle.getStyle(specifier);\n}\nfunction setStyle(specifier, style) {\n    segmentationStyle.setStyle(specifier, style);\n    if (!specifier.viewportId && !specifier.segmentationId) {\n        const segmentations = getSegmentations();\n        segmentations.forEach((segmentation) => {\n            triggerSegmentationRender(segmentation.segmentationId);\n        });\n    }\n    triggerSegmentationRepresentationModified(specifier.viewportId, specifier.segmentationId, specifier.type);\n}\nfunction setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations) {\n    segmentationStyle.setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations);\n    triggerSegmentationRender(viewportId);\n    const segmentations = getViewportSegmentations(viewportId);\n    segmentations.forEach((segmentation) => {\n        triggerSegmentationRepresentationModified(viewportId, segmentation.segmentationId);\n    });\n}\nfunction getRenderInactiveSegmentations(viewportId) {\n    return segmentationStyle.getRenderInactiveSegmentations(viewportId);\n}\nfunction resetToGlobalStyle() {\n    segmentationStyle.resetToGlobalStyle();\n    triggerSegmentationRender();\n}\nfunction hasCustomStyle(specifier) {\n    return segmentationStyle.hasCustomStyle(specifier);\n}\nexport { getStyle, setStyle, setRenderInactiveSegmentations, getRenderInactiveSegmentations, resetToGlobalStyle, hasCustomStyle, };\n","import { cache } from '@cornerstonejs/core';\nimport { getSegmentation } from '../getSegmentation';\nimport { triggerSegmentationDataModified } from '../triggerSegmentationEvents';\nexport function clearSegmentValue(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation.representationData.Labelmap) {\n        const { representationData } = segmentation;\n        const labelmapData = representationData.Labelmap;\n        if ('imageIds' in labelmapData || 'volumeId' in labelmapData) {\n            const items = 'imageIds' in labelmapData\n                ? labelmapData.imageIds.map((imageId) => cache.getImage(imageId))\n                : [cache.getVolume(labelmapData.volumeId)];\n            items.forEach((item) => {\n                if (!item) {\n                    return;\n                }\n                const { voxelManager } = item;\n                voxelManager.forEach(({ value, index }) => {\n                    if (value === segmentIndex) {\n                        voxelManager.setAtIndex(index, 0);\n                    }\n                });\n            });\n        }\n        triggerSegmentationDataModified(segmentationId);\n    }\n    else {\n        throw new Error('Invalid segmentation type, only labelmap is supported right now');\n    }\n}\n","import { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentation } from './getSegmentation';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { setActiveSegmentIndex } from './segmentIndex';\nimport { updateSegmentations } from './updateSegmentations';\nexport function removeSegment(segmentationId, segmentIndex, options = {\n    setNextSegmentAsActive: true,\n}) {\n    clearSegmentValue(segmentationId, segmentIndex);\n    const isThisSegmentActive = getActiveSegmentIndex(segmentationId) === segmentIndex;\n    const segmentation = getSegmentation(segmentationId);\n    const { segments } = segmentation;\n    delete segments[segmentIndex];\n    const updatedSegments = {\n        ...segments,\n    };\n    updateSegmentations([\n        {\n            segmentationId,\n            payload: {\n                segments: updatedSegments,\n            },\n        },\n    ]);\n    if (isThisSegmentActive && options.setNextSegmentAsActive) {\n        const segmentIndices = Object.keys(segments)\n            .map(Number)\n            .sort((a, b) => a - b);\n        const currentIndex = segmentIndices.indexOf(segmentIndex);\n        const nextSegmentIndex = segmentIndices[currentIndex + 1];\n        const previousSegmentIndex = segmentIndices[currentIndex - 1];\n        if (nextSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, nextSegmentIndex);\n        }\n        else if (previousSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, previousSegmentIndex);\n        }\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            delete representation.segments[segmentIndex];\n        });\n    });\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getLabelmapImageIds(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentation = getSegmentation(segmentationId);\n    return segmentationStateManager.getLabelmapImageIds(segmentation.representationData);\n}\n","import { removeContourRepresentation, removeLabelmapRepresentation, removeSegmentationRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, } from './addSegmentationRepresentationsToViewport';\nimport { addSegmentations } from './addSegmentations';\nimport addRepresentationData from './internalAddRepresentationData';\nimport { updateSegmentations } from './updateSegmentations';\nimport * as activeSegmentation from './activeSegmentation';\nimport * as segmentLocking from './segmentLocking';\nimport * as state from './segmentationState';\nimport * as config from './config';\nimport * as segmentIndex from './segmentIndex';\nimport * as triggerSegmentationEvents from './triggerSegmentationEvents';\nimport { convertStackToVolumeLabelmap } from './helpers/convertStackToVolumeLabelmap';\nimport { computeVolumeLabelmapFromStack } from './helpers/computeVolumeLabelmapFromStack';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { convertVolumeToStackLabelmap } from './helpers/computeStackLabelmapFromVolume';\nimport { removeSegment } from './removeSegment';\nimport { getLabelmapImageIds } from './getLabelmapImageIds';\nimport * as strategies from './../../tools/segmentation/strategies';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nimport { segmentationStyle } from './SegmentationStyle';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getCurrentLabelmapImageIdsForViewport, getLabelmapImageIdsForImageId, } from './getCurrentLabelmapImageIdForViewport';\nimport { getActiveSegmentation } from './getActiveSegmentation';\nconst helpers = {\n    clearSegmentValue,\n    convertStackToVolumeLabelmap,\n    computeVolumeLabelmapFromStack,\n    convertVolumeToStackLabelmap,\n};\nexport { removeSegmentationRepresentation, removeContourRepresentation, removeLabelmapRepresentation, removeSurfaceRepresentation, removeAllSegmentations, removeSegmentation, removeSegmentationRepresentations, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, removeAllSegmentationRepresentations, addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addSegmentations, updateSegmentations, state, activeSegmentation, segmentLocking, config, segmentIndex, triggerSegmentationEvents, helpers, removeSegment, getLabelmapImageIds, addRepresentationData, strategies, segmentationStyle, defaultSegmentationStateManager, getCurrentLabelmapImageIdsForViewport, getLabelmapImageIdsForImageId, getActiveSegmentation, };\n","import CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { addColorLUT } from './addColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getColorLUT } from './getColorLUT';\nfunction internalAddSegmentationRepresentation(viewportId, representationInput) {\n    const { segmentationId, config } = representationInput;\n    const renderingConfig = {\n        colorLUTIndex: getColorLUTIndex(config),\n        ...config,\n    };\n    defaultSegmentationStateManager.addSegmentationRepresentation(viewportId, segmentationId, representationInput.type, renderingConfig);\n    if (representationInput.type === SegmentationRepresentations.Contour) {\n        triggerAnnotationRenderForViewportIds([viewportId]);\n    }\n    triggerSegmentationModified(segmentationId);\n}\nfunction getColorLUTIndex(config) {\n    const { colorLUTOrIndex } = config || {};\n    if (colorLUTOrIndex === undefined) {\n        const index = addColorLUT(JSON.parse(JSON.stringify(CORNERSTONE_COLOR_LUT)));\n        return index;\n    }\n    if (typeof colorLUTOrIndex === 'number') {\n        return colorLUTOrIndex;\n    }\n    if (Array.isArray(colorLUTOrIndex) &&\n        colorLUTOrIndex.every((item) => Array.isArray(item) && item.length === 4)) {\n        const index = addColorLUT(colorLUTOrIndex);\n        return index;\n    }\n    const index = addColorLUT(JSON.parse(JSON.stringify(CORNERSTONE_COLOR_LUT)));\n    return index;\n}\nexport { internalAddSegmentationRepresentation };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationRemoved } from './triggerSegmentationEvents';\nimport { removeSegmentationRepresentations } from './removeSegmentationRepresentations';\nexport function removeSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const viewportsWithSegmentation = segmentationStateManager\n        .getAllViewportSegmentationRepresentations()\n        .filter(({ representations }) => representations.some((rep) => rep.segmentationId === segmentationId))\n        .map(({ viewportId }) => viewportId);\n    viewportsWithSegmentation.forEach((viewportId) => {\n        removeSegmentationRepresentations(viewportId, { segmentationId });\n    });\n    segmentationStateManager.removeSegmentation(segmentationId);\n    triggerSegmentationRemoved(segmentationId);\n}\nexport function removeAllSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentations = segmentationStateManager.getState().segmentations;\n    const segmentationIds = segmentations.map((segmentation) => segmentation.segmentationId);\n    segmentationIds.forEach((segmentationId) => {\n        removeSegmentation(segmentationId);\n    });\n    segmentationStateManager.resetState();\n}\n","import SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { surfaceDisplay } from '../../tools/displayTools/Surface';\nfunction removeSegmentationRepresentation(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction _removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    const { segmentationId, type } = specifier;\n    _removeRepresentationObject(viewportId, segmentationId, type, immediate);\n    return defaultSegmentationStateManager.removeSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n}\nfunction removeAllSegmentationRepresentations() {\n    const state = defaultSegmentationStateManager.getAllViewportSegmentationRepresentations();\n    state.forEach(({ viewportId, representations }) => {\n        representations.forEach(({ segmentationId, type }) => {\n            removeSegmentationRepresentation(viewportId, {\n                segmentationId,\n                type,\n            });\n        });\n    });\n    defaultSegmentationStateManager.resetState();\n}\nfunction removeLabelmapRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    }, immediate);\n}\nfunction removeContourRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Contour,\n    }, immediate);\n}\nfunction removeSurfaceRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Surface,\n    }, immediate);\n}\nfunction _removeRepresentationObject(viewportId, segmentationId, type, immediate) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n    representations.forEach((representation) => {\n        if (representation.type === SegmentationRepresentations.Labelmap) {\n            labelmapDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Contour) {\n            contourDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Surface) {\n            surfaceDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n    });\n    const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n    if (viewport) {\n        viewport.render();\n    }\n}\nexport { removeSegmentationRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, };\n","import { getToolGroupForViewport } from '../../store/ToolGroupManager';\nimport { invalidateBrushCursor } from '../../utilities/segmentation/invalidateBrushCursor';\nimport { getSegmentation } from './getSegmentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nfunction setActiveSegmentIndex(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (typeof segmentIndex === 'string') {\n        console.warn('segmentIndex is a string, converting to number');\n        segmentIndex = Number(segmentIndex);\n    }\n    Object.values(segmentation.segments).forEach((segment) => {\n        segment.active = false;\n    });\n    if (!segmentation.segments[segmentIndex]) {\n        segmentation.segments[segmentIndex] = {\n            segmentIndex,\n            label: '',\n            locked: false,\n            cachedStats: {},\n            active: false,\n        };\n    }\n    if (segmentation.segments[segmentIndex].active !== true) {\n        segmentation.segments[segmentIndex].active = true;\n        triggerSegmentationModified(segmentationId);\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            if (!representation.segments[segmentIndex]) {\n                representation.segments[segmentIndex] = {\n                    visible: true,\n                };\n            }\n        });\n    });\n    viewportIds.forEach((viewportId) => {\n        const toolGroup = getToolGroupForViewport(viewportId);\n        invalidateBrushCursor(toolGroup.id);\n    });\n}\nexport { setActiveSegmentIndex, getActiveSegmentIndex };\n","import { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nfunction isSegmentIndexLocked(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    return segments[segmentIndex].locked;\n}\nfunction setSegmentIndexLocked(segmentationId, segmentIndex, locked = true) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    segments[segmentIndex].locked = locked;\n    triggerSegmentationModified(segmentationId);\n}\nfunction getLockedSegmentIndices(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    const lockedSegmentIndices = Object.keys(segments).filter((segmentIndex) => segments[segmentIndex].locked);\n    return lockedSegmentIndices.map((segmentIndex) => parseInt(segmentIndex));\n}\nexport { isSegmentIndexLocked, setSegmentIndexLocked, getLockedSegmentIndices };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function removeColorLUT(colorLUTIndex) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.removeColorLUT(colorLUTIndex);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getStackSegmentationImageIdsForViewport(viewportId, segmentationId);\n}\n","import { getSegmentation } from './getSegmentation';\nimport { getSegmentations } from './getSegmentations';\nimport { addSegmentations } from './addSegmentations';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nimport { removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addColorLUT } from './addColorLUT';\nimport { getColorLUT } from './getColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { removeColorLUT } from './removeColorLUT';\nimport { getViewportSegmentations } from './getViewportSegmentations';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { getCurrentLabelmapImageIdForViewport, getCurrentLabelmapImageIdsForViewport, } from './getCurrentLabelmapImageIdForViewport';\nimport { updateLabelmapSegmentationImageReferences } from './updateLabelmapSegmentationImageReferences';\nimport { getStackSegmentationImageIdsForViewport } from './getStackSegmentationImageIdsForViewport';\nimport { getSegmentationRepresentation, getSegmentationRepresentations, getSegmentationRepresentationsBySegmentationId, } from './getSegmentationRepresentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nfunction destroy() {\n    defaultSegmentationStateManager.resetState();\n}\nexport { getColorLUT, getCurrentLabelmapImageIdForViewport, getCurrentLabelmapImageIdsForViewport, getNextColorLUTIndex, getSegmentation, getSegmentations, getStackSegmentationImageIdsForViewport, getViewportIdsWithSegmentation, getSegmentationRepresentation, getSegmentationRepresentations, removeColorLUT, getViewportSegmentations, removeSegmentation, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, removeAllSegmentations, addColorLUT, addSegmentations, updateLabelmapSegmentationImageReferences, getSegmentationRepresentationsBySegmentationId, destroy, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n}\n","import { getRenderingEngine, getEnabledElement, eventTarget, Enums, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nclass Synchronizer {\n    constructor(synchronizerId, eventName, eventHandler, options) {\n        this._viewportOptions = {};\n        this._onEvent = (evt) => {\n            if (this._ignoreFiredEvents === true) {\n                return;\n            }\n            if (!this._targetViewports.length) {\n                return;\n            }\n            const enabledElement = this._eventSource === 'element'\n                ? getEnabledElement(evt.currentTarget)\n                : getEnabledElementByViewportId(evt.detail?.viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { renderingEngineId, viewportId } = enabledElement;\n            if (!this._sourceViewports.find((s) => s.viewportId === viewportId)) {\n                return;\n            }\n            this.fireEvent({\n                renderingEngineId,\n                viewportId,\n            }, evt);\n        };\n        this._enabled = true;\n        this._eventName = eventName;\n        this._eventHandler = eventHandler;\n        this._ignoreFiredEvents = false;\n        this._sourceViewports = [];\n        this._targetViewports = [];\n        this._options = options || {};\n        this._eventSource = this._options.eventSource || 'element';\n        this._auxiliaryEvents = this._options.auxiliaryEvents || [];\n        this.id = synchronizerId;\n    }\n    isDisabled() {\n        return !this._enabled || !this._hasSourceElements();\n    }\n    setOptions(viewportId, options = {}) {\n        this._viewportOptions[viewportId] = options;\n    }\n    setEnabled(enabled) {\n        this._enabled = enabled;\n    }\n    getOptions(viewportId) {\n        return this._viewportOptions[viewportId];\n    }\n    add(viewportInfo) {\n        this.addTarget(viewportInfo);\n        this.addSource(viewportInfo);\n    }\n    addSource(viewportInfo) {\n        if (_containsViewport(this._sourceViewports, viewportInfo)) {\n            return;\n        }\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const viewport = getRenderingEngine(renderingEngineId).getViewport(viewportId);\n        if (!viewport) {\n            console.warn(`Synchronizer.addSource: No viewport for ${renderingEngineId} ${viewportId}`);\n            return;\n        }\n        const eventSource = this._eventSource === 'element' ? viewport.element : eventTarget;\n        eventSource.addEventListener(this._eventName, this._onEvent.bind(this));\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element' ? viewport.element : eventTarget;\n            target.addEventListener(name, this._onEvent.bind(this));\n        });\n        this._updateDisableHandlers();\n        this._sourceViewports.push(viewportInfo);\n    }\n    addTarget(viewportInfo) {\n        if (_containsViewport(this._targetViewports, viewportInfo)) {\n            return;\n        }\n        this._targetViewports.push(viewportInfo);\n        this._updateDisableHandlers();\n    }\n    getSourceViewports() {\n        return this._sourceViewports;\n    }\n    getTargetViewports() {\n        return this._targetViewports;\n    }\n    destroy() {\n        this._sourceViewports.forEach((s) => this.removeSource(s));\n        this._targetViewports.forEach((t) => this.removeTarget(t));\n    }\n    remove(viewportInfo) {\n        this.removeTarget(viewportInfo);\n        this.removeSource(viewportInfo);\n    }\n    removeSource(viewportInfo) {\n        const index = _getViewportIndex(this._sourceViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        const eventSource = this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n        this._sourceViewports.splice(index, 1);\n        eventSource.removeEventListener(this._eventName, this._eventHandler);\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element'\n                ? this.getViewportElement(viewportInfo)\n                : eventTarget;\n            target.removeEventListener(name, this._eventHandler);\n        });\n        this._updateDisableHandlers();\n    }\n    removeTarget(viewportInfo) {\n        const index = _getViewportIndex(this._targetViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        this._targetViewports.splice(index, 1);\n        this._updateDisableHandlers();\n    }\n    hasSourceViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._sourceViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    hasTargetViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._targetViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    fireEvent(sourceViewport, sourceEvent) {\n        if (this.isDisabled() || this._ignoreFiredEvents) {\n            return;\n        }\n        this._ignoreFiredEvents = true;\n        const promises = [];\n        try {\n            for (let i = 0; i < this._targetViewports.length; i++) {\n                const targetViewport = this._targetViewports[i];\n                const targetIsSource = sourceViewport.viewportId === targetViewport.viewportId;\n                if (targetIsSource) {\n                    continue;\n                }\n                const result = this._eventHandler(this, sourceViewport, targetViewport, sourceEvent, this._options);\n                if (result instanceof Promise) {\n                    promises.push(result);\n                }\n            }\n        }\n        catch (ex) {\n            console.warn(`Synchronizer, for: ${this._eventName}`, ex);\n        }\n        finally {\n            if (promises.length) {\n                Promise.allSettled(promises).then(() => {\n                    this._ignoreFiredEvents = false;\n                });\n            }\n            else {\n                this._ignoreFiredEvents = false;\n            }\n        }\n    }\n    _hasSourceElements() {\n        return this._sourceViewports.length !== 0;\n    }\n    _updateDisableHandlers() {\n        const viewports = _getUniqueViewports(this._sourceViewports, this._targetViewports);\n        const _remove = this.remove.bind(this);\n        const disableHandler = (elementDisabledEvent) => {\n            _remove(elementDisabledEvent.detail.element);\n        };\n        viewports.forEach((vp) => {\n            const eventSource = this.getEventSource(vp);\n            if (!eventSource) {\n                return;\n            }\n            eventSource.removeEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n            eventSource.addEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n        });\n    }\n    getEventSource(viewportInfo) {\n        return this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n    }\n    getViewportElement(viewportInfo) {\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const renderingEngine = getRenderingEngine(renderingEngineId);\n        if (!renderingEngine) {\n            return null;\n        }\n        const viewport = renderingEngine.getViewport(viewportId);\n        if (!viewport) {\n            return null;\n        }\n        return viewport.element;\n    }\n}\nfunction _getUniqueViewports(vp1, vp2) {\n    const unique = [];\n    const vps = vp1.concat(vp2);\n    for (let i = 0; i < vps.length; i++) {\n        const vp = vps[i];\n        if (!unique.some((u) => vp.renderingEngineId === u.renderingEngineId &&\n            vp.viewportId === u.viewportId)) {\n            unique.push(vp);\n        }\n    }\n    return unique;\n}\nfunction _getViewportIndex(arr, vp) {\n    return arr.findIndex((ar) => vp.renderingEngineId === ar.renderingEngineId &&\n        vp.viewportId === ar.viewportId);\n}\nfunction _containsViewport(arr, vp) {\n    return arr.some((ar) => ar.renderingEngineId === vp.renderingEngineId &&\n        ar.viewportId === vp.viewportId);\n}\nexport default Synchronizer;\n","import { state } from '../state';\nimport Synchronizer, {} from './Synchronizer';\nfunction createSynchronizer(synchronizerId, eventName, eventHandler, options) {\n    const synchronizerWithSameIdExists = state.synchronizers.some((sync) => sync.id === synchronizerId);\n    if (synchronizerWithSameIdExists) {\n        throw new Error(`Synchronizer with id '${synchronizerId}' already exists.`);\n    }\n    const synchronizer = new Synchronizer(synchronizerId, eventName, eventHandler, options);\n    state.synchronizers.push(synchronizer);\n    return synchronizer;\n}\nexport default createSynchronizer;\n","import { state } from '../state';\nfunction destroy() {\n    while (state.synchronizers.length > 0) {\n        const synchronizer = state.synchronizers.pop();\n        synchronizer.destroy();\n    }\n}\nexport default destroy;\n","import { state } from '../state';\nfunction destroySynchronizer(synchronizerId) {\n    const synchronizerIndex = state.synchronizers.findIndex((sync) => sync.id === synchronizerId);\n    if (synchronizerIndex > -1) {\n        const synchronizer = state.synchronizers[synchronizerIndex];\n        synchronizer.destroy();\n        state.synchronizers.splice(synchronizerIndex, 1);\n    }\n}\nexport default destroySynchronizer;\n","import { state } from '../state';\nfunction getAllSynchronizers() {\n    return state.synchronizers;\n}\nexport default getAllSynchronizers;\n","import { state } from '../state';\nfunction getSynchronizer(synchronizerId) {\n    return state.synchronizers.find((s) => s.id === synchronizerId);\n}\nexport default getSynchronizer;\n","import { state } from '../state';\nfunction getSynchronizersForViewport(viewportId, renderingEngineId) {\n    const synchronizersFilteredByIds = [];\n    if (!renderingEngineId && !viewportId) {\n        throw new Error('At least one of renderingEngineId or viewportId should be given');\n    }\n    for (let i = 0; i < state.synchronizers.length; i++) {\n        const synchronizer = state.synchronizers[i];\n        const notDisabled = !synchronizer.isDisabled();\n        const hasSourceViewport = synchronizer.hasSourceViewport(renderingEngineId, viewportId);\n        const hasTargetViewport = synchronizer.hasTargetViewport(renderingEngineId, viewportId);\n        if (notDisabled && (hasSourceViewport || hasTargetViewport)) {\n            synchronizersFilteredByIds.push(synchronizer);\n        }\n    }\n    return synchronizersFilteredByIds;\n}\nexport default getSynchronizersForViewport;\n","import { state } from '../state';\nfunction getToolGroup(toolGroupId) {\n    return state.toolGroups.find((s) => s.id === toolGroupId);\n}\nexport default getToolGroup;\n","import { MouseBindings, ToolModes, Events } from '../../enums';\nimport get from 'lodash.get';\nimport { triggerEvent, eventTarget, getRenderingEngine, getRenderingEngines, getEnabledElementByIds, Settings, } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { state } from '../state';\nimport { MouseCursor, SVGMouseCursor } from '../../cursors';\nimport { initElementCursor } from '../../cursors/elementCursor';\nimport getToolGroup from './getToolGroup';\nconst { Active, Passive, Enabled, Disabled } = ToolModes;\nconst PRIMARY_BINDINGS = [{ mouseButton: MouseBindings.Primary }];\nexport default class ToolGroup {\n    constructor(id) {\n        this.viewportsInfo = [];\n        this.toolOptions = {};\n        this.currentActivePrimaryToolName = null;\n        this.prevActivePrimaryToolName = null;\n        this.restoreToolOptions = {};\n        this._toolInstances = {};\n        this.id = id;\n    }\n    getViewportIds() {\n        return this.viewportsInfo.map(({ viewportId }) => viewportId);\n    }\n    getViewportsInfo() {\n        return this.viewportsInfo.slice();\n    }\n    getToolInstance(toolInstanceName) {\n        const toolInstance = this._toolInstances[toolInstanceName];\n        if (!toolInstance) {\n            console.warn(`'${toolInstanceName}' is not registered with this toolGroup (${this.id}).`);\n            return;\n        }\n        return toolInstance;\n    }\n    getToolInstances() {\n        return this._toolInstances;\n    }\n    hasTool(toolName) {\n        return !!this._toolInstances[toolName];\n    }\n    addTool(toolName, configuration = {}) {\n        const toolDefinition = state.tools[toolName];\n        const hasToolName = typeof toolName !== 'undefined' && toolName !== '';\n        const localToolInstance = this.toolOptions[toolName];\n        if (!hasToolName) {\n            console.warn('Tool with configuration did not produce a toolName: ', configuration);\n            return;\n        }\n        if (!toolDefinition) {\n            console.warn(`'${toolName}' is not registered with the library. You need to use cornerstoneTools.addTool to register it.`);\n            return;\n        }\n        if (localToolInstance) {\n            console.warn(`'${toolName}' is already registered for ToolGroup ${this.id}.`);\n            return;\n        }\n        const { toolClass: ToolClass } = toolDefinition;\n        const toolProps = {\n            name: toolName,\n            toolGroupId: this.id,\n            configuration,\n        };\n        const instantiatedTool = new ToolClass(toolProps);\n        this._toolInstances[toolName] = instantiatedTool;\n    }\n    addToolInstance(toolName, parentClassName, configuration = {}) {\n        let ToolClassToUse = state.tools[toolName]\n            ?.toolClass;\n        if (!ToolClassToUse) {\n            const ParentClass = state.tools[parentClassName]\n                .toolClass;\n            class ToolInstance extends ParentClass {\n            }\n            ToolInstance.toolName = toolName;\n            ToolClassToUse = ToolInstance;\n            state.tools[toolName] = {\n                toolClass: ToolInstance,\n            };\n        }\n        this.addTool(ToolClassToUse.toolName, configuration);\n    }\n    addViewport(viewportId, renderingEngineId) {\n        if (typeof viewportId !== 'string') {\n            throw new Error('viewportId must be defined and be a string');\n        }\n        const renderingEngineUIDToUse = this._findRenderingEngine(viewportId, renderingEngineId);\n        if (!this.viewportsInfo.some(({ viewportId: vpId }) => vpId === viewportId)) {\n            this.viewportsInfo.push({\n                viewportId,\n                renderingEngineId: renderingEngineUIDToUse,\n            });\n        }\n        const toolName = this.getActivePrimaryMouseButtonTool();\n        const runtimeSettings = Settings.getRuntimeSettings();\n        if (runtimeSettings.get('useCursors')) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId: renderingEngineUIDToUse,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_ADDED, eventDetail);\n    }\n    removeViewports(renderingEngineId, viewportId) {\n        const indices = [];\n        this.viewportsInfo.forEach((vpInfo, index) => {\n            let match = false;\n            if (vpInfo.renderingEngineId === renderingEngineId) {\n                match = true;\n                if (viewportId && vpInfo.viewportId !== viewportId) {\n                    match = false;\n                }\n            }\n            if (match) {\n                indices.push(index);\n            }\n        });\n        if (indices.length) {\n            for (let i = indices.length - 1; i >= 0; i--) {\n                this.viewportsInfo.splice(indices[i], 1);\n            }\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_REMOVED, eventDetail);\n    }\n    setActiveStrategy(toolName, strategyName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool configuration.`);\n            return;\n        }\n        toolInstance.setActiveStrategy(strategyName);\n    }\n    setToolMode(toolName, mode, options = {}) {\n        if (!toolName) {\n            console.warn('setToolMode: toolName must be defined');\n            return;\n        }\n        if (mode === ToolModes.Active) {\n            this.setToolActive(toolName, options || this.restoreToolOptions[toolName]);\n            return;\n        }\n        if (mode === ToolModes.Passive) {\n            this.setToolPassive(toolName);\n            return;\n        }\n        if (mode === ToolModes.Enabled) {\n            this.setToolEnabled(toolName);\n            return;\n        }\n        if (mode === ToolModes.Disabled) {\n            this.setToolDisabled(toolName);\n            return;\n        }\n        console.warn('setToolMode: mode must be defined');\n    }\n    setToolActive(toolName, toolBindingsOptions = {}) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        if (!toolInstance) {\n            console.warn(`'${toolName}' instance ${toolInstance} is not registered with this toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevBindings = this.toolOptions[toolName]\n            ? this.toolOptions[toolName].bindings\n            : [];\n        const newBindings = toolBindingsOptions.bindings\n            ? toolBindingsOptions.bindings\n            : [];\n        const bindingsToUse = [...prevBindings, ...newBindings].reduce((unique, binding) => {\n            const TouchBinding = binding.numTouchPoints !== undefined;\n            const MouseBinding = binding.mouseButton !== undefined;\n            if (!unique.some((obj) => hasSameBinding(obj, binding)) &&\n                (TouchBinding || MouseBinding)) {\n                unique.push(binding);\n            }\n            return unique;\n        }, []);\n        const toolOptions = {\n            bindings: bindingsToUse,\n            mode: Active,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        this._toolInstances[toolName].mode = Active;\n        const runtimeSettings = Settings.getRuntimeSettings();\n        const useCursor = runtimeSettings.get('useCursors');\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions) && useCursor) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        else {\n            const activeToolIdentifier = this.getActivePrimaryMouseButtonTool();\n            if (!activeToolIdentifier && useCursor) {\n                const cursor = MouseCursor.getDefinedCursor('default');\n                this._setCursorForViewports(cursor);\n            }\n        }\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions)) {\n            if (this.prevActivePrimaryToolName === null) {\n                this.prevActivePrimaryToolName = toolName;\n            }\n            else {\n                this.prevActivePrimaryToolName = this.currentActivePrimaryToolName;\n            }\n            this.currentActivePrimaryToolName = toolName;\n        }\n        if (typeof toolInstance.onSetToolActive === 'function') {\n            toolInstance.onSetToolActive();\n        }\n        this._renderViewports();\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_ACTIVATED, eventDetail);\n        this._triggerToolModeChangedEvent(toolName, Active, toolBindingsOptions);\n    }\n    setToolPassive(toolName, options) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevToolOptions = this.getToolOptions(toolName);\n        const toolOptions = Object.assign({\n            bindings: prevToolOptions ? prevToolOptions.bindings : [],\n        }, prevToolOptions, {\n            mode: Passive,\n        });\n        const matchBindings = Array.isArray(options?.removeAllBindings)\n            ? options.removeAllBindings\n            : this.getDefaultPrimaryBindings();\n        toolOptions.bindings = toolOptions.bindings.filter((binding) => options?.removeAllBindings !== true &&\n            !matchBindings.some((matchBinding) => hasSameBinding(binding, matchBinding)));\n        let mode = Passive;\n        if (toolOptions.bindings.length !== 0) {\n            mode = Active;\n            toolOptions.mode = mode;\n        }\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = mode;\n        if (typeof toolInstance.onSetToolPassive === 'function') {\n            toolInstance.onSetToolPassive();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Passive);\n    }\n    setToolEnabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Enabled,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Enabled;\n        if (typeof toolInstance.onSetToolEnabled === 'function') {\n            toolInstance.onSetToolEnabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Enabled);\n    }\n    setToolDisabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Disabled,\n        };\n        this.restoreToolOptions[toolName] = this.toolOptions[toolName];\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Disabled;\n        if (typeof toolInstance.onSetToolDisabled === 'function') {\n            toolInstance.onSetToolDisabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Disabled);\n    }\n    getToolOptions(toolName) {\n        const toolOptionsForTool = this.toolOptions[toolName];\n        if (toolOptionsForTool === undefined) {\n            return;\n        }\n        return toolOptionsForTool;\n    }\n    getActivePrimaryMouseButtonTool() {\n        return Object.keys(this.toolOptions).find((toolName) => {\n            const toolOptions = this.toolOptions[toolName];\n            return (toolOptions.mode === Active &&\n                this._hasMousePrimaryButtonBinding(toolOptions));\n        });\n    }\n    setViewportsCursorByToolName(toolName, strategyName) {\n        const cursor = this._getCursor(toolName, strategyName);\n        this._setCursorForViewports(cursor);\n    }\n    _getCursor(toolName, strategyName) {\n        let cursorName;\n        let cursor;\n        if (strategyName) {\n            cursorName = `${toolName}.${strategyName}`;\n            cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n            if (cursor) {\n                return cursor;\n            }\n        }\n        cursorName = `${toolName}`;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        cursorName = toolName;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        return MouseCursor.getDefinedCursor('default');\n    }\n    _setCursorForViewports(cursor) {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            initElementCursor(viewport.element, cursor);\n        });\n    }\n    setToolConfiguration(toolName, configuration, overwrite) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return false;\n        }\n        let _configuration;\n        if (overwrite) {\n            _configuration = configuration;\n        }\n        else {\n            _configuration = Object.assign(toolInstance.configuration, configuration);\n        }\n        toolInstance.configuration = _configuration;\n        if (typeof toolInstance.onSetToolConfiguration === 'function') {\n            toolInstance.onSetToolConfiguration();\n        }\n        this._renderViewports();\n        return true;\n    }\n    getDefaultMousePrimary() {\n        return MouseBindings.Primary;\n    }\n    getDefaultPrimaryBindings() {\n        return PRIMARY_BINDINGS;\n    }\n    getToolConfiguration(toolName, configurationPath) {\n        if (this._toolInstances[toolName] === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return;\n        }\n        const _configuration = get(this._toolInstances[toolName].configuration, configurationPath) ||\n            this._toolInstances[toolName].configuration;\n        return utilities.deepClone(_configuration);\n    }\n    getPrevActivePrimaryToolName() {\n        return this.prevActivePrimaryToolName;\n    }\n    setActivePrimaryTool(toolName) {\n        const activeToolName = this.getCurrentActivePrimaryToolName();\n        this.setToolDisabled(activeToolName);\n        this.setToolActive(toolName, {\n            bindings: [{ mouseButton: MouseBindings.Primary }],\n        });\n    }\n    getCurrentActivePrimaryToolName() {\n        return this.currentActivePrimaryToolName;\n    }\n    clone(newToolGroupId, fnToolFilter = null) {\n        let toolGroup = getToolGroup(newToolGroupId);\n        if (toolGroup) {\n            console.debug(`ToolGroup ${newToolGroupId} already exists`);\n            return toolGroup;\n        }\n        toolGroup = new ToolGroup(newToolGroupId);\n        state.toolGroups.push(toolGroup);\n        fnToolFilter = fnToolFilter ?? (() => true);\n        Object.keys(this._toolInstances)\n            .filter(fnToolFilter)\n            .forEach((toolName) => {\n            const sourceToolInstance = this._toolInstances[toolName];\n            const sourceToolOptions = this.toolOptions[toolName];\n            const sourceToolMode = sourceToolInstance.mode;\n            toolGroup.addTool(toolName);\n            toolGroup.setToolMode(toolName, sourceToolMode, {\n                bindings: sourceToolOptions.bindings ?? [],\n            });\n        });\n        return toolGroup;\n    }\n    _hasMousePrimaryButtonBinding(toolOptions) {\n        const primaryBindings = this.getDefaultPrimaryBindings();\n        return toolOptions?.bindings?.some((binding) => primaryBindings.some((primary) => hasSameBinding(binding, primary)));\n    }\n    _renderViewports() {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            getRenderingEngine(renderingEngineId).renderViewport(viewportId);\n        });\n    }\n    _triggerToolModeChangedEvent(toolName, mode, toolBindingsOptions) {\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            mode,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_MODE_CHANGED, eventDetail);\n    }\n    _findRenderingEngine(viewportId, renderingEngineId) {\n        const renderingEngines = getRenderingEngines();\n        if (renderingEngines?.length === 0) {\n            throw new Error('No rendering engines found.');\n        }\n        if (renderingEngineId) {\n            return renderingEngineId;\n        }\n        const matchingEngines = renderingEngines.filter((engine) => engine.getViewport(viewportId));\n        if (matchingEngines.length === 0) {\n            if (renderingEngines.length === 1) {\n                return renderingEngines[0].id;\n            }\n            throw new Error('No rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        if (matchingEngines.length > 1) {\n            throw new Error('Multiple rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        return matchingEngines[0].id;\n    }\n}\nfunction hasSameBinding(binding1, binding2) {\n    if (binding1.mouseButton !== binding2.mouseButton) {\n        return false;\n    }\n    if (binding1.numTouchPoints !== binding2.numTouchPoints) {\n        return false;\n    }\n    return binding1.modifierKey === binding2.modifierKey;\n}\n","import { state } from '../state';\nimport ToolGroup from './ToolGroup';\nfunction createToolGroup(toolGroupId) {\n    const toolGroupWithIdExists = state.toolGroups.some((tg) => tg.id === toolGroupId);\n    if (toolGroupWithIdExists) {\n        console.warn(`'${toolGroupId}' already exists.`);\n        return;\n    }\n    const toolGroup = new ToolGroup(toolGroupId);\n    state.toolGroups.push(toolGroup);\n    return toolGroup;\n}\nexport default createToolGroup;\n","import { state } from '../state';\nfunction destroyToolGroup(toolGroupId) {\n    const toolGroupIndex = state.toolGroups.findIndex((tg) => tg.id === toolGroupId);\n    if (toolGroupIndex > -1) {\n        state.toolGroups.splice(toolGroupIndex, 1);\n    }\n}\nexport default destroyToolGroup;\n","import { state } from '../state';\nimport destroyToolGroup from './destroyToolGroup';\nfunction destroy() {\n    const toolGroups = [...state.toolGroups];\n    for (const toolGroup of toolGroups) {\n        destroyToolGroup(toolGroup.id);\n    }\n    state.toolGroups = [];\n}\nexport default destroy;\n","import { state } from '../state';\nfunction getAllToolGroups() {\n    return state.toolGroups;\n}\nexport default getAllToolGroups;\n","import { state } from '../state';\nimport { ToolModes } from '../../enums';\nconst MODES = [ToolModes.Active, ToolModes.Passive, ToolModes.Enabled];\nfunction getToolGroupsWithToolName(toolName) {\n    return state.toolGroups.filter(({ toolOptions }) => {\n        const toolGroupToolNames = Object.keys(toolOptions);\n        for (let i = 0; i < toolGroupToolNames.length; i++) {\n            if (toolName !== toolGroupToolNames[i]) {\n                continue;\n            }\n            if (!toolOptions[toolName]) {\n                continue;\n            }\n            if (MODES.includes(toolOptions[toolName].mode)) {\n                return true;\n            }\n        }\n        return false;\n    });\n}\nexport default getToolGroupsWithToolName;\n","import { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, touchToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport { state } from './state';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nexport default function addEnabledElement(evt) {\n    const { element, viewportId } = evt.detail;\n    const svgLayer = _createSvgAnnotationLayer(viewportId);\n    _setSvgNodeCache(element);\n    _appendChild(svgLayer, element);\n    annotationRenderingEngine.addViewportElement(viewportId, element);\n    mouseEventListeners.enable(element);\n    wheelEventListener.enable(element);\n    touchEventListeners.enable(element);\n    keyEventListener.enable(element);\n    imageChangeEventListener.enable(element);\n    imageRenderedEventDispatcher.enable(element);\n    cameraModifiedEventDispatcher.enable(element);\n    imageSpacingCalibratedEventDispatcher.enable(element);\n    cameraResetEventDispatcher.enable(element);\n    mouseToolEventDispatcher.enable(element);\n    keyboardToolEventDispatcher.enable(element);\n    touchToolEventDispatcher.enable(element);\n    state.enabledElements.push(element);\n}\nfunction _createSvgAnnotationLayer(viewportId) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgLayer = document.createElementNS(svgns, 'svg');\n    const svgLayerId = `svg-layer-${viewportId}`;\n    svgLayer.classList.add('svg-layer');\n    svgLayer.setAttribute('id', svgLayerId);\n    svgLayer.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    svgLayer.style.width = '100%';\n    svgLayer.style.height = '100%';\n    svgLayer.style.pointerEvents = 'none';\n    svgLayer.style.position = 'absolute';\n    const defs = document.createElementNS(svgns, 'defs');\n    const filter = document.createElementNS(svgns, 'filter');\n    const feOffset = document.createElementNS(svgns, 'feOffset');\n    const feColorMatrix = document.createElementNS(svgns, 'feColorMatrix');\n    const feBlend = document.createElementNS(svgns, 'feBlend');\n    filter.setAttribute('id', `shadow-${svgLayerId}`);\n    filter.setAttribute('filterUnits', 'userSpaceOnUse');\n    feOffset.setAttribute('result', 'offOut');\n    feOffset.setAttribute('in', 'SourceGraphic');\n    feOffset.setAttribute('dx', '0.5');\n    feOffset.setAttribute('dy', '0.5');\n    feColorMatrix.setAttribute('result', 'matrixOut');\n    feColorMatrix.setAttribute('in', 'offOut');\n    feColorMatrix.setAttribute('in2', 'matrix');\n    feColorMatrix.setAttribute('values', '0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0');\n    feBlend.setAttribute('in', 'SourceGraphic');\n    feBlend.setAttribute('in2', 'matrixOut');\n    feBlend.setAttribute('mode', 'normal');\n    filter.appendChild(feOffset);\n    filter.appendChild(feColorMatrix);\n    filter.appendChild(feBlend);\n    defs.appendChild(filter);\n    svgLayer.appendChild(defs);\n    return svgLayer;\n}\nfunction _setSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    state.svgNodeCache[elementHash] = {};\n}\nfunction _appendChild(newNode, referenceNode) {\n    referenceNode.querySelector('div.viewport-element').appendChild(newNode);\n}\n","import { state } from './state';\nexport function addTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    if (!toolName) {\n        throw new Error(`No Tool Found for the ToolClass ${ToolClass.name}`);\n    }\n    if (!state.tools[toolName]) {\n        state.tools[toolName] = {\n            toolClass: ToolClass,\n        };\n    }\n}\nexport function hasTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    return !!(toolName && state.tools[toolName]);\n}\nexport function hasToolByName(toolName) {\n    return !!(toolName && state.tools[toolName]);\n}\nexport function removeTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    if (!toolName) {\n        throw new Error(`No tool found for: ${ToolClass.name}`);\n    }\n    if (!state.tools[toolName] !== undefined) {\n        delete state.tools[toolName];\n    }\n    else {\n        throw new Error(`${toolName} cannot be removed because it has not been added`);\n    }\n}\nexport default addTool;\n","import { ToolModes } from '../enums';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nexport default function cancelActiveManipulations(element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    for (const { tool } of toolsWithData) {\n        const annotationUID = tool.cancel(element);\n        if (annotationUID) {\n            return annotationUID;\n        }\n    }\n}\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, touchToolEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nimport { state } from './state';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport { ToolModes } from '../enums';\nimport { removeAnnotation } from '../stateManagement';\nimport getSynchronizersForViewport from './SynchronizerManager/getSynchronizersForViewport';\nimport getToolGroupForViewport from './ToolGroupManager/getToolGroupForViewport';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nconst VIEWPORT_ELEMENT = 'viewport-element';\nfunction removeEnabledElement(elementDisabledEvt) {\n    const { element, viewportId } = elementDisabledEvt.detail;\n    _resetSvgNodeCache(element);\n    _removeSvgNode(element);\n    annotationRenderingEngine.removeViewportElement(viewportId, element);\n    mouseEventListeners.disable(element);\n    wheelEventListener.disable(element);\n    touchEventListeners.disable(element);\n    keyEventListener.disable(element);\n    imageChangeEventListener.disable(element);\n    imageRenderedEventDispatcher.disable(element);\n    cameraModifiedEventDispatcher.disable(element);\n    imageSpacingCalibratedEventDispatcher.disable(element);\n    cameraResetEventDispatcher.disable(element);\n    mouseToolEventDispatcher.disable(element);\n    keyboardToolEventDispatcher.disable(element);\n    touchToolEventDispatcher.disable(element);\n    _removeViewportFromSynchronizers(element);\n    _removeViewportFromToolGroup(element);\n    _removeEnabledElement(element);\n}\nconst _removeViewportFromSynchronizers = (element) => {\n    const enabledElement = getEnabledElement(element);\n    if (!enabledElement) {\n        return;\n    }\n    const synchronizers = getSynchronizersForViewport(enabledElement.viewportId, enabledElement.renderingEngineId);\n    synchronizers.forEach((sync) => {\n        sync.remove(enabledElement);\n    });\n};\nconst _removeViewportFromToolGroup = (element) => {\n    const enabledElement = getEnabledElement(element);\n    if (!enabledElement) {\n        return;\n    }\n    const { renderingEngineId, viewportId } = enabledElement;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (toolGroup) {\n        toolGroup.removeViewports(renderingEngineId, viewportId);\n    }\n};\nconst _removeAllToolsForElement = function (element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    toolsWithData.forEach(({ annotations }) => {\n        annotations.forEach((annotation) => {\n            removeAnnotation(annotation.annotationUID);\n        });\n    });\n};\nfunction _resetSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    delete state.svgNodeCache[elementHash];\n}\nfunction _removeSvgNode(element) {\n    const internalViewportNode = element.querySelector(`div.${VIEWPORT_ELEMENT}`);\n    const svgLayer = internalViewportNode.querySelector('svg');\n    if (svgLayer) {\n        internalViewportNode.removeChild(svgLayer);\n    }\n}\nconst _removeEnabledElement = function (element) {\n    const foundElementIndex = state.enabledElements.findIndex((el) => el === element);\n    if (foundElementIndex > -1) {\n        state.enabledElements.splice(foundElementIndex, 1);\n    }\n};\nexport default removeEnabledElement;\n","import svgNodeCache, { resetSvgNodeCache } from './svgNodeCache';\nconst defaultState = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nlet state = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nfunction resetCornerstoneToolsState() {\n    resetSvgNodeCache();\n    state = {\n        ...structuredClone({\n            ...defaultState,\n            svgNodeCache: {},\n        }),\n        svgNodeCache: {\n            ...defaultState.svgNodeCache,\n        },\n    };\n}\nexport { resetCornerstoneToolsState, state, state as default };\n","let svgNodeCache = {};\nexport function resetSvgNodeCache() {\n    svgNodeCache = {};\n}\nexport default svgNodeCache;\n","import { vec3 } from 'gl-matrix';\nexport default function areViewportsCoplanar(viewport1, viewport2) {\n    const { viewPlaneNormal: viewPlaneNormal1 } = viewport1.getCamera();\n    const { viewPlaneNormal: viewPlaneNormal2 } = viewport2.getCamera();\n    const dotProducts = vec3.dot(viewPlaneNormal1, viewPlaneNormal2);\n    return Math.abs(dotProducts) > 0.9;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function cameraSyncCallback(synchronizerInstance, sourceViewport, targetViewport, cameraModifiedEvent) {\n    const { camera } = cameraModifiedEvent.detail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    tViewport.setCamera(camera);\n    tViewport.render();\n}\n","import { vec3, mat4 } from 'gl-matrix';\nimport { getRenderingEngine, metaData, utilities, VolumeViewport, } from '@cornerstonejs/core';\nimport areViewportsCoplanar from './areViewportsCoplanar';\nconst getSpatialRegistration = (targetId, sourceId) => utilities.spatialRegistrationMetadataProvider.get('spatialRegistrationModule', targetId, sourceId);\nexport default async function imageSliceSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    if (options?.disabled) {\n        return;\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const imageId1 = sViewport.getCurrentImageId();\n    const imagePlaneModule1 = metaData.get('imagePlaneModule', imageId1);\n    const sourceImagePositionPatient = imagePlaneModule1.imagePositionPatient;\n    const targetImageIds = tViewport.getImageIds();\n    if (!areViewportsCoplanar(sViewport, tViewport)) {\n        return;\n    }\n    let registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n    if (!registrationMatrixMat4) {\n        const frameOfReferenceUID1 = sViewport.getFrameOfReferenceUID();\n        const frameOfReferenceUID2 = tViewport.getFrameOfReferenceUID();\n        if (frameOfReferenceUID1 === frameOfReferenceUID2 &&\n            options?.useInitialPosition !== false) {\n            registrationMatrixMat4 = mat4.identity(mat4.create());\n        }\n        else {\n            utilities.calculateViewportsSpatialRegistration(sViewport, tViewport);\n            registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n        }\n        if (!registrationMatrixMat4) {\n            return;\n        }\n    }\n    const targetImagePositionPatientWithRegistrationMatrix = vec3.transformMat4(vec3.create(), sourceImagePositionPatient, registrationMatrixMat4);\n    const closestImageIdIndex2 = _getClosestImageIdIndex(targetImagePositionPatientWithRegistrationMatrix, targetImageIds);\n    let imageIndexToSet = closestImageIdIndex2.index;\n    if (tViewport instanceof VolumeViewport) {\n        imageIndexToSet = targetImageIds.length - closestImageIdIndex2.index - 1;\n    }\n    if (closestImageIdIndex2.index !== -1 &&\n        tViewport.getCurrentImageIdIndex() !== closestImageIdIndex2.index) {\n        await utilities.jumpToSlice(tViewport.element, {\n            imageIndex: imageIndexToSet,\n        });\n    }\n}\nfunction _getClosestImageIdIndex(targetPoint, imageIds) {\n    return imageIds.reduce((closestImageIdIndex, imageId, index) => {\n        const { imagePositionPatient } = metaData.get('imagePlaneModule', imageId);\n        const distance = vec3.distance(imagePositionPatient, targetPoint);\n        if (distance < closestImageIdIndex.distance) {\n            return {\n                distance,\n                index,\n            };\n        }\n        return closestImageIdIndex;\n    }, {\n        distance: Infinity,\n        index: -1,\n    });\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function presentationViewSyncCallback(_synchronizerInstance, sourceViewport, targetViewport, _sourceEvent, options) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const presentationView = sViewport.getViewPresentation(options);\n    tViewport.setViewPresentation(presentationView);\n    tViewport.render();\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function slabThicknessSyncCallback(_synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const slabThickness = sViewport.getSlabThickness?.();\n    if (!slabThickness) {\n        return;\n    }\n    tViewport.setSlabThickness?.(slabThickness);\n    tViewport.render();\n}\n","import { BaseVolumeViewport, getRenderingEngine, StackViewport, } from '@cornerstonejs/core';\nexport default function voiSyncCallback(synchronizerInstance, sourceViewport, targetViewport, modifiedEvent, options) {\n    const eventDetail = modifiedEvent.detail;\n    const { volumeId, range, invertStateChanged, invert, colormap } = eventDetail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`Rendering Engine does not exist: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const tProperties = {\n        voiRange: range,\n    };\n    if (options?.syncInvertState && invertStateChanged) {\n        tProperties.invert = invert;\n    }\n    if (options?.syncColormap && colormap) {\n        tProperties.colormap = colormap;\n    }\n    if (tViewport instanceof BaseVolumeViewport) {\n        const isFusion = tViewport._actors && tViewport._actors.size > 1;\n        if (isFusion) {\n            tViewport.setProperties(tProperties, volumeId);\n        }\n        else {\n            tViewport.setProperties(tProperties);\n        }\n    }\n    else if (tViewport instanceof StackViewport) {\n        tViewport.setProperties(tProperties);\n    }\n    else {\n        throw new Error('Viewport type not supported.');\n    }\n    tViewport.render();\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function zoomPanSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    if (options?.syncZoom !== false) {\n        const srcZoom = sViewport.getZoom();\n        tViewport.setZoom(srcZoom);\n    }\n    if (options?.syncPan !== false) {\n        const srcPan = sViewport.getPan();\n        tViewport.setPan(srcPan);\n    }\n    tViewport.render();\n}\n","import createCameraPositionSynchronizer from './synchronizers/createCameraPositionSynchronizer';\nimport createPresentationViewSynchronizer from './synchronizers/createPresentationViewSynchronizer';\nimport createVOISynchronizer from './synchronizers/createVOISynchronizer';\nimport createZoomPanSynchronizer from './synchronizers/createZoomPanSynchronizer';\nimport createImageSliceSynchronizer from './synchronizers/createImageSliceSynchronizer';\nimport createSlabThicknessSynchronizer from './synchronizers/createSlabThicknessSynchronizer';\nconst createStackImageSynchronizer = createImageSliceSynchronizer;\nexport { createCameraPositionSynchronizer, createPresentationViewSynchronizer, createVOISynchronizer, createZoomPanSynchronizer, createImageSliceSynchronizer, createStackImageSynchronizer, createSlabThicknessSynchronizer, };\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport cameraSyncCallback from '../callbacks/cameraSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createCameraPositionSynchronizer(synchronizerName) {\n    const cameraPositionSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, cameraSyncCallback);\n    return cameraPositionSynchronizer;\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport imageSliceSyncCallback from '../callbacks/imageSliceSyncCallback';\nconst { STACK_NEW_IMAGE, VOLUME_NEW_IMAGE } = Enums.Events;\nexport default function createImageSliceSynchronizer(synchronizerName) {\n    const stackImageSynchronizer = createSynchronizer(synchronizerName, STACK_NEW_IMAGE, imageSliceSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: 'VOLUME_NEW_IMAGE',\n            },\n        ],\n    });\n    return stackImageSynchronizer;\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport presentationViewSyncCallback from '../callbacks/presentationViewSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName, options) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, presentationViewSyncCallback, { viewPresentation: options });\n    return presentationView;\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport slabThicknessSyncCallback from '../callbacks/slabThicknessSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, slabThicknessSyncCallback);\n    return presentationView;\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport voiSyncCallback from '../callbacks/voiSyncCallback';\nexport default function createVOISynchronizer(synchronizerName, options) {\n    options = Object.assign({ syncInvertState: true, syncColormap: true }, options);\n    const VOISynchronizer = createSynchronizer(synchronizerName, Enums.Events.VOI_MODIFIED, voiSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: Enums.Events.COLORMAP_MODIFIED,\n            },\n        ],\n        ...options,\n    });\n    return VOISynchronizer;\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport zoomPanSyncCallback from '../callbacks/zoomPanSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createZoomPanSynchronizer(synchronizerName) {\n    const zoomPanSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, zoomPanSyncCallback);\n    return zoomPanSynchronizer;\n}\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities as csUtils, eventTarget, Enums, getRenderingEngine, CONSTANTS, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { addAnnotation, getAllAnnotations, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events, MouseBindings, KeyboardBindings, Events as cstEvents, SegmentationRepresentations, ToolModes, } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../utilities/math/circle';\nimport { vec2, vec3 } from 'gl-matrix';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nimport debounce from '../utilities/debounce';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { addSegmentationRepresentations } from '../stateManagement/segmentation';\nconst MAGNIFY_CLASSNAME = 'advancedMagnifyTool';\nconst MAGNIFY_VIEWPORT_INITIAL_RADIUS = 125;\nconst { Events: csEvents } = Enums;\nconst isSegmentation = (actor) => actor.uid !== actor.referencedId;\nvar AdvancedMagnifyToolActions;\n(function (AdvancedMagnifyToolActions) {\n    AdvancedMagnifyToolActions[\"ShowZoomFactorsList\"] = \"showZoomFactorsList\";\n})(AdvancedMagnifyToolActions || (AdvancedMagnifyToolActions = {}));\nconst ADVANCED_MAGNIFY_TOOL_NAME = 'AdvancedMagnify';\nconst PARALLEL_THRESHOLD = 1 - CONSTANTS.EPSILON;\nclass AdvancedMagnifyTool extends AnnotationTool {\n    static { this.Actions = AdvancedMagnifyToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            magnifyingGlass: {\n                radius: 125,\n                zoomFactor: 3,\n                zoomFactorList: [1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5],\n                autoPan: {\n                    enabled: true,\n                    padding: 10,\n                },\n            },\n            actions: {\n                showZoomFactorsList: {\n                    method: 'showZoomFactorsList',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Secondary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const { magnifyingGlass: config } = this.configuration;\n            const { radius, zoomFactor, autoPan } = config;\n            const canvasHandlePoints = this._getCanvasHandlePoints(canvasPos, radius);\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotationUID = csUtils.uuidv4();\n            const magnifyViewportId = csUtils.uuidv4();\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                annotationUID,\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    sourceViewportId: viewport.id,\n                    magnifyViewportId,\n                    zoomFactor,\n                    isCanvasAnnotation: true,\n                    handles: {\n                        points: canvasHandlePoints,\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            this.magnifyViewportManager.createViewport(annotation, {\n                magnifyViewportId,\n                sourceEnabledElement: enabledElement,\n                position: canvasPos,\n                radius,\n                zoomFactor,\n                autoPan: {\n                    enabled: autoPan.enabled,\n                    padding: autoPan.padding,\n                    callback: (data) => {\n                        const annotationPoints = annotation.data.handles.points;\n                        const { canvas: canvasDelta } = data.delta;\n                        for (let i = 0, len = annotationPoints.length; i < len; i++) {\n                            const point = annotationPoints[i];\n                            point[0] += canvasDelta[0];\n                            point[1] += canvasDelta[1];\n                            annotation.invalidated = true;\n                        }\n                    },\n                },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.onSetToolDisabled = () => {\n            this.magnifyViewportManager.dispose();\n            const annotations = getAllAnnotations();\n            annotations.forEach((annotation) => {\n                if (annotation.metadata.toolName === this.getToolName()) {\n                    removeAnnotation(annotation.annotationUID);\n                }\n            });\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const center = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const radiusPoint = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radiusPoint - radius) < proximity * 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            const { points } = data.handles;\n            const handleIndex = points.findIndex((p) => p === handle);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { deltaPoints } = eventDetail;\n            const canvasDelta = deltaPoints?.canvas ?? [0, 0, 0];\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { points } = annotation.data.handles;\n            points.forEach((point) => {\n                point[0] += canvasDelta[0];\n                point[1] += canvasDelta[1];\n            });\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const canvasDelta = deltaPoints.canvas;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += canvasDelta[0];\n                    point[1] += canvasDelta[1];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const canvasCenter = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const newRadius = getCanvasCircleRadius([\n                canvasCenter,\n                currentCanvasPoints,\n            ]);\n            const newCanvasHandlePoints = this._getCanvasHandlePoints(canvasCenter, newRadius);\n            points[0] = newCanvasHandlePoints[0];\n            points[1] = newCanvasHandlePoints[1];\n            points[2] = newCanvasHandlePoints[2];\n            points[3] = newCanvasHandlePoints[3];\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = annotations?.filter((annotation) => annotation.data.sourceViewportId ===\n                viewport.id);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!filteredAnnotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < filteredAnnotations.length; i++) {\n                const annotation = filteredAnnotations[i];\n                const { annotationUID, data } = annotation;\n                const { magnifyViewportId, zoomFactor, handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points;\n                const canvasTop = canvasCoordinates[0];\n                const canvasBottom = canvasCoordinates[2];\n                const canvasLeft = canvasCoordinates[3];\n                const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n                const center = [\n                    canvasLeft[0] + radius,\n                    canvasTop[1] + radius,\n                ];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-advancedMagnify`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineWidth: 5,\n                }, dataId);\n                const magnifyViewport = this.magnifyViewportManager.getViewport(magnifyViewportId);\n                magnifyViewport.position = center;\n                magnifyViewport.radius = radius;\n                magnifyViewport.zoomFactor = zoomFactor;\n                magnifyViewport.update();\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._getCanvasHandlePoints = (canvasCenterPos, canvasRadius) => {\n            return [\n                [canvasCenterPos[0], canvasCenterPos[1] - canvasRadius, 0],\n                [canvasCenterPos[0] + canvasRadius, canvasCenterPos[1], 0],\n                [canvasCenterPos[0], canvasCenterPos[1] + canvasRadius, 0],\n                [canvasCenterPos[0] - canvasRadius, canvasCenterPos[1], 0],\n            ];\n        };\n        this.magnifyViewportManager = AdvancedMagnifyViewportManager.getInstance();\n    }\n    showZoomFactorsList(evt, annotation) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvas: canvasPoint } = currentPoints;\n        const viewportElement = element.querySelector(':scope .viewport-element');\n        const currentZoomFactor = annotation.data.zoomFactor;\n        const remove = () => dropdown.parentElement.removeChild(dropdown);\n        const dropdown = this._getZoomFactorsListDropdown(currentZoomFactor, (newZoomFactor) => {\n            if (newZoomFactor !== undefined) {\n                annotation.data.zoomFactor = Number.parseFloat(newZoomFactor);\n                annotation.invalidated = true;\n            }\n            remove();\n            viewport.render();\n        });\n        Object.assign(dropdown.style, {\n            left: `${canvasPoint[0]}px`,\n            top: `${canvasPoint[1]}px`,\n        });\n        viewportElement.appendChild(dropdown);\n        dropdown.focus();\n    }\n    _getZoomFactorsListDropdown(currentZoomFactor, onChangeCallback) {\n        const { zoomFactorList } = this.configuration.magnifyingGlass;\n        const dropdown = document.createElement('select');\n        dropdown.size = 5;\n        Object.assign(dropdown.style, {\n            width: '50px',\n            position: 'absolute',\n        });\n        ['mousedown', 'mouseup', 'mousemove', 'click'].forEach((eventName) => {\n            dropdown.addEventListener(eventName, (evt) => evt.stopPropagation());\n        });\n        dropdown.addEventListener('change', (evt) => {\n            evt.stopPropagation();\n            onChangeCallback(dropdown.value);\n        });\n        dropdown.addEventListener('keydown', (evt) => {\n            const shouldCancel = (evt.keyCode ?? evt.which === 27) ||\n                evt.key?.toLowerCase() === 'escape';\n            if (shouldCancel) {\n                evt.stopPropagation();\n                onChangeCallback();\n            }\n        });\n        zoomFactorList.forEach((zoomFactor) => {\n            const option = document.createElement('option');\n            option.label = zoomFactor;\n            option.title = `Zoom factor ${zoomFactor.toFixed(1)}`;\n            option.value = zoomFactor;\n            option.defaultSelected = zoomFactor === currentZoomFactor;\n            dropdown.add(option);\n        });\n        return dropdown;\n    }\n}\nclass AdvancedMagnifyViewportManager {\n    constructor() {\n        this.createViewport = (annotation, viewportInfo) => {\n            const { magnifyViewportId, sourceEnabledElement, position, radius, zoomFactor, autoPan, } = viewportInfo;\n            const { viewport: sourceViewport } = sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            const magnifyViewport = new AdvancedMagnifyViewport({\n                magnifyViewportId,\n                sourceEnabledElement,\n                radius,\n                position,\n                zoomFactor,\n                autoPan,\n            });\n            this._addSourceElementEventListener(sourceElement);\n            this._magnifyViewportsMap.set(magnifyViewport.viewportId, {\n                annotation,\n                magnifyViewport,\n                magnifyViewportInfo: viewportInfo,\n            });\n            return magnifyViewport;\n        };\n        this._annotationRemovedCallback = (evt) => {\n            const { annotation } = evt.detail;\n            if (annotation.metadata.toolName !== ADVANCED_MAGNIFY_TOOL_NAME) {\n                return;\n            }\n            this.destroyViewport(annotation.data.magnifyViewportId);\n        };\n        this._newStackImageCallback = (evt) => {\n            const { viewportId: sourceViewportId, imageId } = evt.detail;\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            const { viewport } = getEnabledElementByViewportId(sourceViewportId);\n            if (viewport.stackActorReInitialized) {\n                this._reset(sourceViewportId);\n            }\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                annotation.metadata.referencedImageId = imageId;\n                annotation.invalidated = true;\n            });\n        };\n        this._newVolumeImageCallback = (evt) => {\n            const { renderingEngineId, viewportId: sourceViewportId } = evt.detail;\n            const renderingEngine = getRenderingEngine(renderingEngineId);\n            const sourceViewport = renderingEngine.getViewport(sourceViewportId);\n            const { viewPlaneNormal: currentViewPlaneNormal } = sourceViewport.getCamera();\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                const { viewPlaneNormal } = annotation.metadata;\n                const isParallel = Math.abs(vec3.dot(viewPlaneNormal, currentViewPlaneNormal)) >\n                    PARALLEL_THRESHOLD;\n                if (!isParallel) {\n                    return;\n                }\n                const { handles } = annotation.data;\n                const worldImagePlanePoint = sourceViewport.canvasToWorld([0, 0]);\n                const vecHandleToImagePlane = vec3.sub(vec3.create(), worldImagePlanePoint, handles.points[0]);\n                const worldDist = vec3.dot(vecHandleToImagePlane, currentViewPlaneNormal);\n                const worldDelta = vec3.scale(vec3.create(), currentViewPlaneNormal, worldDist);\n                for (let i = 0, len = handles.points.length; i < len; i++) {\n                    const point = handles.points[i];\n                    point[0] += worldDelta[0];\n                    point[1] += worldDelta[1];\n                    point[2] += worldDelta[2];\n                }\n                annotation.invalidated = true;\n            });\n        };\n        this._magnifyViewportsMap = new Map();\n        this._initialize();\n    }\n    static getInstance() {\n        AdvancedMagnifyViewportManager._singleton =\n            AdvancedMagnifyViewportManager._singleton ??\n                new AdvancedMagnifyViewportManager();\n        return AdvancedMagnifyViewportManager._singleton;\n    }\n    getViewport(magnifyViewportId) {\n        return this._magnifyViewportsMap.get(magnifyViewportId)?.magnifyViewport;\n    }\n    dispose() {\n        this._removeEventListeners();\n        this._destroyViewports();\n    }\n    destroyViewport(magnifyViewportId) {\n        const magnifyViewportMapEntry = this._magnifyViewportsMap.get(magnifyViewportId);\n        if (magnifyViewportMapEntry) {\n            const { magnifyViewport } = magnifyViewportMapEntry;\n            const { viewport: sourceViewport } = magnifyViewport.sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            this._removeSourceElementEventListener(sourceElement);\n            magnifyViewport.dispose();\n            this._magnifyViewportsMap.delete(magnifyViewportId);\n        }\n    }\n    _destroyViewports() {\n        const magnifyViewportIds = Array.from(this._magnifyViewportsMap.keys());\n        magnifyViewportIds.forEach((magnifyViewportId) => this.destroyViewport(magnifyViewportId));\n    }\n    _getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId) {\n        const magnifyViewportsMapEntries = Array.from(this._magnifyViewportsMap.values());\n        return magnifyViewportsMapEntries.filter(({ magnifyViewport }) => {\n            const { viewport } = magnifyViewport.sourceEnabledElement;\n            return viewport.id === sourceViewportId;\n        });\n    }\n    _reset(sourceViewportId) {\n        const magnifyViewports = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n        magnifyViewports.forEach(({ magnifyViewport, annotation, magnifyViewportInfo }) => {\n            this.destroyViewport(magnifyViewport.viewportId);\n            const newEnabledElement = getEnabledElementByViewportId(sourceViewportId);\n            this.createViewport(annotation, {\n                ...magnifyViewportInfo,\n                sourceEnabledElement: {\n                    ...newEnabledElement,\n                },\n            });\n        });\n    }\n    _addEventListeners() {\n        eventTarget.addEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _removeEventListeners() {\n        eventTarget.removeEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _addSourceElementEventListener(element) {\n        element.addEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        const newStackHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, newStackHandler);\n        const newVolumeHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, newVolumeHandler);\n        element.addEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.newStackHandler = newStackHandler;\n        element.newVolumeHandler = newVolumeHandler;\n    }\n    _removeSourceElementEventListener(element) {\n        element.removeEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        element.removeEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.removeEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, element.newStackHandler);\n        element.removeEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, element.newVolumeHandler);\n        delete element.newStackHandler;\n        delete element.newVolumeHandler;\n    }\n    _initialize() {\n        this._addEventListeners();\n    }\n}\nclass AdvancedMagnifyViewport {\n    constructor({ magnifyViewportId, sourceEnabledElement, radius = MAGNIFY_VIEWPORT_INITIAL_RADIUS, position = [0, 0], zoomFactor, autoPan, }) {\n        this._enabledElement = null;\n        this._sourceToolGroup = null;\n        this._magnifyToolGroup = null;\n        this._isViewportReady = false;\n        this._radius = 0;\n        this._resized = false;\n        this._canAutoPan = false;\n        this._viewportId = magnifyViewportId ?? csUtils.uuidv4();\n        this._sourceEnabledElement = sourceEnabledElement;\n        this._autoPan = autoPan;\n        this.radius = radius;\n        this.position = position;\n        this.zoomFactor = zoomFactor;\n        this.visible = true;\n        this._browserMouseDownCallback = this._browserMouseDownCallback.bind(this);\n        this._browserMouseUpCallback = this._browserMouseUpCallback.bind(this);\n        this._handleToolModeChanged = this._handleToolModeChanged.bind(this);\n        this._mouseDragCallback = this._mouseDragCallback.bind(this);\n        this._resizeViewportAsync = (debounce(this._resizeViewport.bind(this), 1));\n        this._initialize();\n    }\n    get sourceEnabledElement() {\n        return this._sourceEnabledElement;\n    }\n    get viewportId() {\n        return this._viewportId;\n    }\n    get radius() {\n        return this._radius;\n    }\n    set radius(radius) {\n        if (Math.abs(this._radius - radius) > 0.00001) {\n            this._radius = radius;\n            this._resized = true;\n        }\n    }\n    update() {\n        const { radius, position, visible } = this;\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const size = 2 * radius;\n        const [x, y] = position;\n        if (this._resized) {\n            this._resizeViewportAsync();\n            this._resized = false;\n        }\n        Object.assign(element.style, {\n            display: visible ? 'block' : 'hidden',\n            width: `${size}px`,\n            height: `${size}px`,\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(${x}px, ${y}px)`,\n        });\n        if (this._isViewportReady) {\n            this._syncViewports();\n            viewport.render();\n        }\n    }\n    dispose() {\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const renderingEngine = viewport.getRenderingEngine();\n        this._removeEventListeners(element);\n        renderingEngine.disableElement(viewport.id);\n        if (element.parentNode) {\n            element.parentNode.removeChild(element);\n        }\n    }\n    _handleToolModeChanged(evt) {\n        const { _magnifyToolGroup: magnifyToolGroup } = this;\n        const { toolGroupId, toolName, mode, toolBindingsOptions } = evt.detail;\n        if (this._sourceToolGroup?.id !== toolGroupId) {\n            return;\n        }\n        switch (mode) {\n            case ToolModes.Active:\n                magnifyToolGroup.setToolActive(toolName, toolBindingsOptions);\n                break;\n            case ToolModes.Passive:\n                magnifyToolGroup.setToolPassive(toolName);\n                break;\n            case ToolModes.Enabled:\n                magnifyToolGroup.setToolEnabled(toolName);\n                break;\n            case ToolModes.Disabled:\n                magnifyToolGroup.setToolDisabled(toolName);\n                break;\n            default:\n                throw new Error(`Unknow tool mode (${mode})`);\n        }\n    }\n    _inheritBorderRadius(magnifyElement) {\n        const viewport = magnifyElement.querySelector('.viewport-element');\n        const canvas = magnifyElement.querySelector('.cornerstone-canvas');\n        viewport.style.borderRadius = 'inherit';\n        canvas.style.borderRadius = 'inherit';\n    }\n    _createViewportNode() {\n        const magnifyElement = document.createElement('div');\n        const { radius } = this;\n        const size = radius * 2;\n        magnifyElement.classList.add(MAGNIFY_CLASSNAME);\n        Object.assign(magnifyElement.style, {\n            display: 'block',\n            width: `${size}px`,\n            height: `${size}px`,\n            position: 'absolute',\n            overflow: 'hidden',\n            borderRadius: '50%',\n            boxSizing: 'border-box',\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(-1000px, -1000px)`,\n        });\n        return magnifyElement;\n    }\n    _convertZoomFactorToParallelScale(viewport, magnifyViewport, zoomFactor) {\n        const { parallelScale } = viewport.getCamera();\n        const canvasRatio = magnifyViewport.canvas.offsetWidth / viewport.canvas.offsetWidth;\n        return parallelScale * (1 / zoomFactor) * canvasRatio;\n    }\n    _isStackViewport(viewport) {\n        return 'setStack' in viewport;\n    }\n    _isVolumeViewport(viewport) {\n        return 'addVolumes' in viewport;\n    }\n    _cloneToolGroups(sourceViewport, magnifyViewport) {\n        const sourceActors = sourceViewport.getActors();\n        const magnifyToolGroupId = `${magnifyViewport.id}-toolGroup`;\n        const sourceToolGroup = getToolGroupForViewport(sourceViewport.id, sourceViewport.renderingEngineId);\n        const magnifyToolGroup = sourceToolGroup.clone(magnifyToolGroupId, (toolName) => {\n            const toolInstance = sourceToolGroup.getToolInstance(toolName);\n            const isAnnotationTool = toolInstance instanceof AnnotationTool &&\n                !(toolInstance instanceof AdvancedMagnifyTool);\n            return isAnnotationTool;\n        });\n        magnifyToolGroup.addViewport(magnifyViewport.id, magnifyViewport.renderingEngineId);\n        sourceActors.filter(isSegmentation).forEach((actor) => {\n            addSegmentationRepresentations(this.viewportId, [\n                {\n                    segmentationId: actor.referencedId,\n                    type: SegmentationRepresentations.Labelmap,\n                },\n            ]);\n        });\n        return { sourceToolGroup, magnifyToolGroup };\n    }\n    _cloneStack(sourceViewport, magnifyViewport) {\n        const imageIds = sourceViewport.getImageIds();\n        magnifyViewport.setStack(imageIds).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n    }\n    _cloneVolumes(sourceViewport, magnifyViewport) {\n        const actors = sourceViewport.getActors();\n        const volumeInputArray = actors\n            .filter((actor) => !isSegmentation(actor))\n            .map((actor) => ({ volumeId: actor.uid }));\n        magnifyViewport.setVolumes(volumeInputArray).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n        return magnifyViewport;\n    }\n    _cloneViewport(sourceViewport, magnifyElement) {\n        const { viewportId: magnifyViewportId } = this;\n        const renderingEngine = sourceViewport.getRenderingEngine();\n        const { options: sourceViewportOptions } = sourceViewport;\n        const viewportInput = {\n            element: magnifyElement,\n            viewportId: magnifyViewportId,\n            type: sourceViewport.type,\n            defaultOptions: { ...sourceViewportOptions },\n        };\n        renderingEngine.enableElement(viewportInput);\n        const magnifyViewport = (renderingEngine.getViewport(magnifyViewportId));\n        if (this._isStackViewport(sourceViewport)) {\n            this._cloneStack(sourceViewport, magnifyViewport);\n        }\n        else if (this._isVolumeViewport(sourceViewport)) {\n            this._cloneVolumes(sourceViewport, magnifyViewport);\n        }\n        this._inheritBorderRadius(magnifyElement);\n        const toolGroups = this._cloneToolGroups(sourceViewport, magnifyViewport);\n        this._sourceToolGroup = toolGroups.sourceToolGroup;\n        this._magnifyToolGroup = toolGroups.magnifyToolGroup;\n    }\n    _cancelMouseEventCallback(evt) {\n        evt.stopPropagation();\n        evt.preventDefault();\n    }\n    _browserMouseUpCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _browserMouseDownCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        this._canAutoPan = !!evt.target?.closest('.advancedMagnifyTool');\n        document.addEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _mouseDragCallback(evt) {\n        if (!state.isInteractingWithTool) {\n            return;\n        }\n        const { _autoPan: autoPan } = this;\n        if (!autoPan.enabled || !this._canAutoPan) {\n            return;\n        }\n        const { currentPoints } = evt.detail;\n        const { viewport } = this._enabledElement;\n        const { canvasToWorld } = viewport;\n        const { canvas: canvasCurrent } = currentPoints;\n        const { radius: magnifyRadius } = this;\n        const canvasCenter = [magnifyRadius, magnifyRadius];\n        const dist = distanceToPoint(canvasCenter, canvasCurrent);\n        const maxDist = magnifyRadius - autoPan.padding;\n        if (dist <= maxDist) {\n            return;\n        }\n        const panDist = dist - maxDist;\n        const canvasDeltaPos = vec2.sub(vec2.create(), canvasCurrent, canvasCenter);\n        vec2.normalize(canvasDeltaPos, canvasDeltaPos);\n        vec2.scale(canvasDeltaPos, canvasDeltaPos, panDist);\n        const newCanvasPosition = vec2.add(vec2.create(), this.position, canvasDeltaPos);\n        const currentWorldPos = canvasToWorld(this.position);\n        const newWorldPos = canvasToWorld(newCanvasPosition);\n        const worldDeltaPos = vec3.sub(vec3.create(), newWorldPos, currentWorldPos);\n        const autoPanCallbackData = {\n            points: {\n                currentPosition: {\n                    canvas: this.position,\n                    world: currentWorldPos,\n                },\n                newPosition: {\n                    canvas: newCanvasPosition,\n                    world: newWorldPos,\n                },\n            },\n            delta: {\n                canvas: canvasDeltaPos,\n                world: worldDeltaPos,\n            },\n        };\n        autoPan.callback(autoPanCallbackData);\n    }\n    _addBrowserEventListeners(element) {\n        document.addEventListener('mousedown', this._browserMouseDownCallback, true);\n        element.addEventListener('mousedown', this._cancelMouseEventCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n        element.addEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _removeBrowserEventListeners(element) {\n        document.removeEventListener('mousedown', this._browserMouseDownCallback, true);\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mousedown', this._cancelMouseEventCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n        element.removeEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _addEventListeners(element) {\n        eventTarget.addEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._addBrowserEventListeners(element);\n    }\n    _removeEventListeners(element) {\n        eventTarget.removeEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._removeBrowserEventListeners(element);\n    }\n    _initialize() {\n        const { _sourceEnabledElement: sourceEnabledElement } = this;\n        const { viewport: sourceViewport } = sourceEnabledElement;\n        const { canvas: sourceCanvas } = sourceViewport;\n        const magnifyElement = this._createViewportNode();\n        sourceCanvas.parentNode.appendChild(magnifyElement);\n        this._addEventListeners(magnifyElement);\n        this._cloneViewport(sourceViewport, magnifyElement);\n        this._enabledElement = getEnabledElement(magnifyElement);\n    }\n    _syncViewportsCameras(sourceViewport, magnifyViewport) {\n        const worldPos = sourceViewport.canvasToWorld(this.position);\n        const parallelScale = this._convertZoomFactorToParallelScale(sourceViewport, magnifyViewport, this.zoomFactor);\n        const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n        const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n            Math.pow(focalPoint[1] - position[1], 2) +\n            Math.pow(focalPoint[2] - position[2], 2));\n        const updatedFocalPoint = [\n            worldPos[0],\n            worldPos[1],\n            worldPos[2],\n        ];\n        const updatedPosition = [\n            updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n            updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n            updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n        ];\n        magnifyViewport.setCamera({\n            parallelScale,\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n    }\n    _syncStackViewports(sourceViewport, magnifyViewport) {\n        magnifyViewport.setImageIdIndex(sourceViewport.getCurrentImageIdIndex());\n    }\n    _syncViewports() {\n        const { viewport: sourceViewport } = this._sourceEnabledElement;\n        const { viewport: magnifyViewport } = this._enabledElement;\n        const sourceProperties = sourceViewport.getProperties();\n        const imageData = magnifyViewport.getImageData();\n        if (!imageData) {\n            return;\n        }\n        magnifyViewport.setProperties(sourceProperties);\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        if (this._isStackViewport(sourceViewport)) {\n            this._syncStackViewports(sourceViewport, magnifyViewport);\n        }\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        magnifyViewport.render();\n    }\n    _resizeViewport() {\n        const { viewport } = this._enabledElement;\n        const renderingEngine = viewport.getRenderingEngine();\n        renderingEngine.resize();\n    }\n}\nAdvancedMagnifyTool.toolName = 'AdvancedMagnify';\nexport { AdvancedMagnifyTool as default };\n","import { BaseTool, AnnotationTool } from './base';\nimport { getAnnotations, getAnnotation, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { setAnnotationSelected } from '../stateManagement/annotation/annotationSelection';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass AnnotationEraserTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'mouse');\n        };\n        this.preTouchStartCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'touch');\n        };\n    }\n    _deleteNearbyAnnotations(evt, interactionType) {\n        const { renderingEngineId, viewportId, element, currentPoints } = evt.detail;\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        if (!toolGroup) {\n            return false;\n        }\n        const tools = toolGroup._toolInstances;\n        const annotationsToRemove = [];\n        for (const toolName in tools) {\n            const toolInstance = tools[toolName];\n            if (typeof toolInstance.isPointNearTool !== 'function' ||\n                typeof toolInstance.filterInteractableAnnotationsForElement !==\n                    'function') {\n                continue;\n            }\n            const annotations = getAnnotations(toolName, element);\n            const interactableAnnotations = toolInstance.filterInteractableAnnotationsForElement(element, annotations);\n            if (!interactableAnnotations) {\n                continue;\n            }\n            for (const annotation of interactableAnnotations) {\n                if (toolInstance.isPointNearTool(element, annotation, currentPoints.canvas, 10, interactionType)) {\n                    annotationsToRemove.push(annotation.annotationUID);\n                }\n            }\n        }\n        for (const annotationUID of annotationsToRemove) {\n            setAnnotationSelected(annotationUID);\n            const annotation = getAnnotation(annotationUID);\n            AnnotationTool.createAnnotationMemo(element, annotation, {\n                deleting: true,\n            });\n            removeAnnotation(annotationUID);\n        }\n        evt.preventDefault();\n        return true;\n    }\n}\nAnnotationEraserTool.toolName = 'Eraser';\nexport default AnnotationEraserTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport vtkMatrixBuilder from '@kitware/vtk.js/Common/Core/MatrixBuilder';\nimport { AnnotationTool } from './base';\nimport { getEnabledElementByIds, getEnabledElement, utilities as csUtils, Enums, CONSTANTS, triggerEvent, eventTarget, } from '@cornerstonejs/core';\nimport { getToolGroup, getToolGroupForViewport, } from '../store/ToolGroupManager';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLine as drawLineSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport liangBarksyClip from '../utilities/math/vec2/liangBarksyClip';\nimport * as lineSegment from '../utilities/math/line';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nconst { RENDERING_DEFAULTS } = CONSTANTS;\nfunction defaultReferenceLineColor() {\n    return 'rgb(0, 200, 0)';\n}\nfunction defaultReferenceLineControllable() {\n    return true;\n}\nfunction defaultReferenceLineDraggableRotatable() {\n    return true;\n}\nfunction defaultReferenceLineSlabThicknessControlsOn() {\n    return true;\n}\nconst OPERATION = {\n    DRAG: 1,\n    ROTATE: 2,\n    SLAB: 3,\n};\nconst EPSILON = 1e-3;\nclass CrosshairsTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse'],\n        configuration: {\n            shadow: true,\n            viewportIndicators: false,\n            viewportIndicatorsConfig: {\n                radius: 5,\n                x: null,\n                y: null,\n            },\n            autoPan: {\n                enabled: false,\n                panSize: 10,\n            },\n            handleRadius: 3,\n            enableHDPIHandles: false,\n            referenceLinesCenterGapRadius: 20,\n            filterActorUIDsToSetSlabThickness: [],\n            slabThicknessBlendMode: Enums.BlendModes.MAXIMUM_INTENSITY_BLEND,\n            mobile: {\n                enabled: false,\n                opacity: 0.8,\n                handleRadius: 9,\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.toolCenter = [0, 0, 0];\n        this.initializeViewport = ({ renderingEngineId, viewportId, }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const { FrameOfReferenceUID, viewport } = enabledElement;\n            const { element } = viewport;\n            const { position, focalPoint, viewPlaneNormal } = viewport.getCamera();\n            let annotations = this._getAnnotations(enabledElement);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (annotations?.length) {\n                removeAnnotation(annotations[0].annotationUID);\n            }\n            const annotation = {\n                highlighted: false,\n                metadata: {\n                    cameraPosition: [...position],\n                    cameraFocalPoint: [...focalPoint],\n                    FrameOfReferenceUID,\n                    toolName: this.getToolName(),\n                },\n                data: {\n                    handles: {\n                        rotationPoints: [],\n                        slabThicknessPoints: [],\n                        toolCenter: this.toolCenter,\n                    },\n                    activeOperation: null,\n                    activeViewportIds: [],\n                    viewportId,\n                },\n            };\n            addAnnotation(annotation, element);\n            return {\n                normal: viewPlaneNormal,\n                point: viewport.canvasToWorld([\n                    viewport.canvas.clientWidth / 2,\n                    viewport.canvas.clientHeight / 2,\n                ]),\n            };\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resetCrosshairs = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            for (const viewportInfo of viewportsInfo) {\n                const { viewportId, renderingEngineId } = viewportInfo;\n                const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n                const viewport = enabledElement.viewport;\n                const resetPan = true;\n                const resetZoom = true;\n                const resetToCenter = true;\n                const resetRotation = true;\n                const suppressEvents = true;\n                viewport.resetCamera({\n                    resetPan,\n                    resetZoom,\n                    resetToCenter,\n                    resetRotation,\n                    suppressEvents,\n                });\n                viewport.resetSlabThickness();\n                const { element } = viewport;\n                let annotations = this._getAnnotations(enabledElement);\n                annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n                if (annotations.length) {\n                    removeAnnotation(annotations[0].annotationUID);\n                }\n                viewport.render();\n            }\n            this._computeToolCenter(viewportsInfo);\n        };\n        this.computeToolCenter = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._computeToolCenter = (viewportsInfo) => {\n            if (!viewportsInfo.length || viewportsInfo.length === 1) {\n                console.warn('For crosshairs to operate, at least two viewports must be given.');\n                return;\n            }\n            const [firstViewport, secondViewport, thirdViewport] = viewportsInfo;\n            const { normal: normal1, point: point1 } = this.initializeViewport(firstViewport);\n            const { normal: normal2, point: point2 } = this.initializeViewport(secondViewport);\n            let normal3 = [0, 0, 0];\n            let point3 = vec3.create();\n            if (thirdViewport) {\n                ({ normal: normal3, point: point3 } =\n                    this.initializeViewport(thirdViewport));\n            }\n            else {\n                vec3.add(point3, point1, point2);\n                vec3.scale(point3, point3, 0.5);\n                vec3.cross(normal3, normal1, normal2);\n            }\n            const firstPlane = csUtils.planar.planeEquation(normal1, point1);\n            const secondPlane = csUtils.planar.planeEquation(normal2, point2);\n            const thirdPlane = csUtils.planar.planeEquation(normal3, point3);\n            const toolCenter = csUtils.planar.threePlaneIntersection(firstPlane, secondPlane, thirdPlane);\n            this.setToolCenter(toolCenter);\n        };\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const jumpWorld = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this._jump(enabledElement, jumpWorld);\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(viewport.element, annotations);\n            const { data } = filteredAnnotations[0];\n            const { rotationPoints } = data.handles;\n            const viewportIdArray = [];\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                if (!viewportControllable || !viewportDraggableRotatable) {\n                    continue;\n                }\n                viewportIdArray.push(otherViewport.id);\n                i++;\n            }\n            data.activeViewportIds = [...viewportIdArray];\n            data.handles.activeOperation = OPERATION.DRAG;\n            evt.preventDefault();\n            hideElementCursor(element);\n            this._activateModify(element);\n            return filteredAnnotations[0];\n        };\n        this.cancel = () => {\n            console.log('Not implemented yet');\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            if (this._pointNearTool(element, annotation, canvasCoords, 6)) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const viewport = enabledElement.viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const currentCamera = viewport.getCamera();\n            const oldCameraPosition = viewportAnnotation.metadata.cameraPosition;\n            const deltaCameraPosition = [0, 0, 0];\n            vtkMath.subtract(currentCamera.position, oldCameraPosition, deltaCameraPosition);\n            const oldCameraFocalPoint = viewportAnnotation.metadata.cameraFocalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(currentCamera.focalPoint, oldCameraFocalPoint, deltaCameraFocalPoint);\n            viewportAnnotation.metadata.cameraPosition = [...currentCamera.position];\n            viewportAnnotation.metadata.cameraFocalPoint = [\n                ...currentCamera.focalPoint,\n            ];\n            const viewportControllable = this._getReferenceLineControllable(viewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(viewport.id);\n            if (!csUtils.isEqual(currentCamera.position, oldCameraPosition, 1e-3) &&\n                viewportControllable &&\n                viewportDraggableRotatable) {\n                let isRotation = false;\n                const cameraModifiedSameForPosAndFocalPoint = csUtils.isEqual(deltaCameraPosition, deltaCameraFocalPoint, 1e-3);\n                if (!cameraModifiedSameForPosAndFocalPoint) {\n                    isRotation = true;\n                }\n                const cameraModifiedInPlane = Math.abs(vtkMath.dot(deltaCameraPosition, currentCamera.viewPlaneNormal)) < 1e-2;\n                if (!isRotation && !cameraModifiedInPlane) {\n                    this.toolCenter[0] += deltaCameraPosition[0];\n                    this.toolCenter[1] += deltaCameraPosition[1];\n                    this.toolCenter[2] += deltaCameraPosition[2];\n                    triggerEvent(eventTarget, Events.CROSSHAIR_TOOL_CENTER_CHANGED, {\n                        toolGroupId: this.toolGroupId,\n                        toolCenter: this.toolCenter,\n                    });\n                }\n            }\n            if (this.configuration.autoPan?.enabled) {\n                const toolGroup = getToolGroupForViewport(viewport.id, renderingEngine.id);\n                const otherViewportIds = toolGroup\n                    .getViewportIds()\n                    .filter((id) => id !== viewport.id);\n                otherViewportIds.forEach((viewportId) => {\n                    this._autoPanViewportIfNecessary(viewportId, renderingEngine);\n                });\n            }\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onResetCamera = (evt) => {\n            this.resetCrosshairs();\n        };\n        this.mouseMoveCallback = (evt, filteredToolAnnotations) => {\n            const { element, currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            let imageNeedsUpdate = false;\n            for (let i = 0; i < filteredToolAnnotations.length; i++) {\n                const annotation = filteredToolAnnotations[i];\n                if (isAnnotationLocked(annotation.annotationUID)) {\n                    continue;\n                }\n                const { data, highlighted } = annotation;\n                if (!data.handles) {\n                    continue;\n                }\n                const previousActiveOperation = data.handles.activeOperation;\n                const previousActiveViewportIds = data.activeViewportIds && data.activeViewportIds.length > 0\n                    ? [...data.activeViewportIds]\n                    : [];\n                data.activeViewportIds = [];\n                data.handles.activeOperation = null;\n                const handleNearImagePoint = this.getHandleNearImagePoint(element, annotation, canvasCoords, 6);\n                let near = false;\n                if (handleNearImagePoint) {\n                    near = true;\n                }\n                else {\n                    near = this._pointNearTool(element, annotation, canvasCoords, 6);\n                }\n                const nearToolAndNotMarkedActive = near && !highlighted;\n                const notNearToolAndMarkedActive = !near && highlighted;\n                if (nearToolAndNotMarkedActive || notNearToolAndMarkedActive) {\n                    annotation.highlighted = !highlighted;\n                    imageNeedsUpdate = true;\n                }\n                else if (data.handles.activeOperation !== previousActiveOperation ||\n                    !this._areViewportIdArraysEqual(data.activeViewportIds, previousActiveViewportIds)) {\n                    imageNeedsUpdate = true;\n                }\n            }\n            return imageNeedsUpdate;\n        };\n        this.filterInteractableAnnotationsForElement = (element, annotations) => {\n            if (!annotations || !annotations.length) {\n                return [];\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewportId } = enabledElement;\n            const viewportUIDSpecificCrosshairs = annotations.filter((annotation) => annotation.data.viewportId === viewportId);\n            return viewportUIDSpecificCrosshairs;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, renderingEngine } = enabledElement;\n            const { element } = viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const camera = viewport.getCamera();\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!annotations?.length || !viewportAnnotation?.data) {\n                return renderStatus;\n            }\n            const annotationUID = viewportAnnotation.annotationUID;\n            const { clientWidth, clientHeight } = viewport.canvas;\n            const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n            const canvasMinDimensionLength = Math.min(clientWidth, clientHeight);\n            const data = viewportAnnotation.data;\n            const crosshairCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n            const otherViewportAnnotations = this._filterAnnotationsByUniqueViewportOrientations(enabledElement, annotations);\n            const referenceLines = [];\n            const canvasBox = [0, 0, clientWidth, clientHeight];\n            otherViewportAnnotations.forEach((annotation) => {\n                const { data } = annotation;\n                data.handles.toolCenter = this.toolCenter;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                const { clientWidth, clientHeight } = otherViewport.canvas;\n                const otherCanvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n                const otherCanvasCenter = [\n                    clientWidth * 0.5,\n                    clientHeight * 0.5,\n                ];\n                const otherViewportCenterWorld = otherViewport.canvasToWorld(otherCanvasCenter);\n                const direction = [0, 0, 0];\n                vtkMath.cross(camera.viewPlaneNormal, otherCamera.viewPlaneNormal, direction);\n                vtkMath.normalize(direction);\n                vtkMath.multiplyScalar(direction, otherCanvasDiagonalLength);\n                const pointWorld0 = [0, 0, 0];\n                vtkMath.add(otherViewportCenterWorld, direction, pointWorld0);\n                const pointWorld1 = [0, 0, 0];\n                vtkMath.subtract(otherViewportCenterWorld, direction, pointWorld1);\n                const pointCanvas0 = viewport.worldToCanvas(pointWorld0);\n                const otherViewportCenterCanvas = viewport.worldToCanvas(otherViewportCenterWorld);\n                const canvasUnitVectorFromCenter = vec2.create();\n                vec2.subtract(canvasUnitVectorFromCenter, pointCanvas0, otherViewportCenterCanvas);\n                vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n                const canvasVectorFromCenterLong = vec2.create();\n                vec2.scale(canvasVectorFromCenterLong, canvasUnitVectorFromCenter, canvasDiagonalLength * 100);\n                const canvasVectorFromCenterMid = vec2.create();\n                vec2.scale(canvasVectorFromCenterMid, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.4);\n                const canvasVectorFromCenterShort = vec2.create();\n                vec2.scale(canvasVectorFromCenterShort, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.2);\n                const canvasVectorFromCenterStart = vec2.create();\n                const centerGap = this.configuration.referenceLinesCenterGapRadius;\n                vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, otherViewportAnnotations.length === 2 ? centerGap : 0);\n                const refLinePointOne = vec2.create();\n                const refLinePointTwo = vec2.create();\n                const refLinePointThree = vec2.create();\n                const refLinePointFour = vec2.create();\n                let refLinesCenter = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable || !otherViewportControllable) {\n                    refLinesCenter = vec2.clone(otherViewportCenterCanvas);\n                }\n                vec2.add(refLinePointOne, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.add(refLinePointTwo, refLinesCenter, canvasVectorFromCenterLong);\n                vec2.subtract(refLinePointThree, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.subtract(refLinePointFour, refLinesCenter, canvasVectorFromCenterLong);\n                liangBarksyClip(refLinePointOne, refLinePointTwo, canvasBox);\n                liangBarksyClip(refLinePointThree, refLinePointFour, canvasBox);\n                const rotHandleOne = vec2.create();\n                vec2.subtract(rotHandleOne, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                const rotHandleTwo = vec2.create();\n                vec2.add(rotHandleTwo, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                let stHandlesCenterCanvas = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterCanvas = vec2.clone(otherViewportCenterCanvas);\n                }\n                let stHandlesCenterWorld = [...this.toolCenter];\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterWorld = [...otherViewportCenterWorld];\n                }\n                const worldUnitVectorFromCenter = [0, 0, 0];\n                vtkMath.subtract(pointWorld0, pointWorld1, worldUnitVectorFromCenter);\n                vtkMath.normalize(worldUnitVectorFromCenter);\n                const { viewPlaneNormal } = camera;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromDegree()\n                    .rotate(90, viewPlaneNormal);\n                const worldUnitOrthoVectorFromCenter = [0, 0, 0];\n                vec3.transformMat4(worldUnitOrthoVectorFromCenter, worldUnitVectorFromCenter, matrix);\n                const slabThicknessValue = otherViewport.getSlabThickness();\n                const worldOrthoVectorFromCenter = [\n                    ...worldUnitOrthoVectorFromCenter,\n                ];\n                vtkMath.multiplyScalar(worldOrthoVectorFromCenter, slabThicknessValue);\n                const worldVerticalRefPoint = [0, 0, 0];\n                vtkMath.add(stHandlesCenterWorld, worldOrthoVectorFromCenter, worldVerticalRefPoint);\n                const canvasVerticalRefPoint = viewport.worldToCanvas(worldVerticalRefPoint);\n                const canvasOrthoVectorFromCenter = vec2.create();\n                vec2.subtract(canvasOrthoVectorFromCenter, stHandlesCenterCanvas, canvasVerticalRefPoint);\n                const stLinePointOne = vec2.create();\n                vec2.subtract(stLinePointOne, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointOne, stLinePointOne, canvasOrthoVectorFromCenter);\n                const stLinePointTwo = vec2.create();\n                vec2.add(stLinePointTwo, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointTwo, stLinePointTwo, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointOne, stLinePointTwo, canvasBox);\n                const stLinePointThree = vec2.create();\n                vec2.add(stLinePointThree, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointThree, stLinePointThree, canvasOrthoVectorFromCenter);\n                const stLinePointFour = vec2.create();\n                vec2.subtract(stLinePointFour, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointFour, stLinePointFour, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointThree, stLinePointFour, canvasBox);\n                const stHandleOne = vec2.create();\n                const stHandleTwo = vec2.create();\n                const stHandleThree = vec2.create();\n                const stHandleFour = vec2.create();\n                vec2.subtract(stHandleOne, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleOne, stHandleOne, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleTwo, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleTwo, stHandleTwo, canvasOrthoVectorFromCenter);\n                vec2.subtract(stHandleThree, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleThree, stHandleThree, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleFour, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleFour, stHandleFour, canvasOrthoVectorFromCenter);\n                referenceLines.push([\n                    otherViewport,\n                    refLinePointOne,\n                    refLinePointTwo,\n                    refLinePointThree,\n                    refLinePointFour,\n                    stLinePointOne,\n                    stLinePointTwo,\n                    stLinePointThree,\n                    stLinePointFour,\n                    rotHandleOne,\n                    rotHandleTwo,\n                    stHandleOne,\n                    stHandleTwo,\n                    stHandleThree,\n                    stHandleFour,\n                ]);\n            });\n            const newRtpoints = [];\n            const newStpoints = [];\n            const viewportColor = this._getReferenceLineColor(viewport.id);\n            const color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n            referenceLines.forEach((line, lineIndex) => {\n                const otherViewport = line[0];\n                const viewportColor = this._getReferenceLineColor(otherViewport.id);\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const selectedViewportId = data.activeViewportIds.find((id) => id === otherViewport.id);\n                let color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                let lineWidth = 1;\n                const lineActive = data.handles.activeOperation !== null &&\n                    data.handles.activeOperation === OPERATION.DRAG &&\n                    selectedViewportId;\n                if (lineActive) {\n                    lineWidth = 2.5;\n                }\n                let lineUID = `${lineIndex}`;\n                if (viewportControllable && viewportDraggableRotatable) {\n                    lineUID = `${lineIndex}One`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[1], line[2], {\n                        color,\n                        lineWidth,\n                    });\n                    lineUID = `${lineIndex}Two`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[3], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                else {\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[2], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                if (viewportControllable) {\n                    color =\n                        viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                    const rotHandlesActive = data.handles.activeOperation === OPERATION.ROTATE;\n                    const rotationHandles = [line[9], line[10]];\n                    const rotHandleWorldOne = [\n                        viewport.canvasToWorld(line[9]),\n                        otherViewport,\n                        line[1],\n                        line[2],\n                    ];\n                    const rotHandleWorldTwo = [\n                        viewport.canvasToWorld(line[10]),\n                        otherViewport,\n                        line[3],\n                        line[4],\n                    ];\n                    newRtpoints.push(rotHandleWorldOne, rotHandleWorldTwo);\n                    const slabThicknessHandlesActive = data.handles.activeOperation === OPERATION.SLAB;\n                    const slabThicknessHandles = [line[11], line[12], line[13], line[14]];\n                    const slabThicknessHandleWorldOne = [\n                        viewport.canvasToWorld(line[11]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldTwo = [\n                        viewport.canvasToWorld(line[12]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldThree = [\n                        viewport.canvasToWorld(line[13]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    const slabThicknessHandleWorldFour = [\n                        viewport.canvasToWorld(line[14]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    newStpoints.push(slabThicknessHandleWorldOne, slabThicknessHandleWorldTwo, slabThicknessHandleWorldThree, slabThicknessHandleWorldFour);\n                    let handleRadius = this.configuration.handleRadius *\n                        (this.configuration.enableHDPIHandles ? window.devicePixelRatio : 1);\n                    let opacity = 1;\n                    if (this.configuration.mobile?.enabled) {\n                        handleRadius = this.configuration.mobile.handleRadius;\n                        opacity = this.configuration.mobile.opacity;\n                    }\n                    if ((lineActive || this.configuration.mobile?.enabled) &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable &&\n                        viewportSlabThicknessControlsOn) {\n                        let handleUID = `${lineIndex}One`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius,\n                            opacity,\n                            type: 'circle',\n                        });\n                        handleUID = `${lineIndex}Two`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius,\n                            opacity,\n                            type: 'rect',\n                        });\n                    }\n                    else if (lineActive &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius,\n                            opacity,\n                            type: 'circle',\n                        });\n                    }\n                    else if (selectedViewportId &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportSlabThicknessControlsOn) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius,\n                            opacity,\n                            type: 'rect',\n                        });\n                    }\n                    else if (rotHandlesActive && viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        const handleRadius = this.configuration.handleRadius *\n                            (this.configuration.enableHDPIHandles\n                                ? window.devicePixelRatio\n                                : 1);\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius,\n                            fill: color,\n                            type: 'circle',\n                        });\n                    }\n                    else if (slabThicknessHandlesActive &&\n                        selectedViewportId &&\n                        viewportSlabThicknessControlsOn) {\n                        const handleRadius = this.configuration.handleRadius *\n                            (this.configuration.enableHDPIHandles\n                                ? window.devicePixelRatio\n                                : 1);\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, lineUID, slabThicknessHandles, {\n                            color,\n                            handleRadius,\n                            fill: color,\n                            type: 'rect',\n                        });\n                    }\n                    const slabThicknessValue = otherViewport.getSlabThickness();\n                    if (slabThicknessValue > 0.5 && viewportSlabThicknessControlsOn) {\n                        lineUID = `${lineIndex}STOne`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[5], line[6], {\n                            color,\n                            width: 1,\n                            lineDash: [2, 3],\n                        });\n                        lineUID = `${lineIndex}STTwo`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[7], line[8], {\n                            color,\n                            width: line,\n                            lineDash: [2, 3],\n                        });\n                    }\n                }\n            });\n            renderStatus = true;\n            data.handles.rotationPoints = newRtpoints;\n            data.handles.slabThicknessPoints = newStpoints;\n            if (this.configuration.viewportIndicators) {\n                const { viewportIndicatorsConfig } = this.configuration;\n                const xOffset = viewportIndicatorsConfig?.xOffset || 0.95;\n                const yOffset = viewportIndicatorsConfig?.yOffset || 0.05;\n                const referenceColorCoordinates = [\n                    clientWidth * xOffset,\n                    clientHeight * yOffset,\n                ];\n                const circleRadius = viewportIndicatorsConfig?.circleRadius || canvasDiagonalLength * 0.01;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, referenceColorCoordinates, circleRadius, { color, fill: color });\n            }\n            return renderStatus;\n        };\n        this._getAnnotations = (enabledElement) => {\n            const { viewport } = enabledElement;\n            const annotations = getAnnotations(this.getToolName(), viewport.element) || [];\n            const viewportIds = this._getViewportsInfo().map(({ viewportId }) => viewportId);\n            const toolGroupAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                return viewportIds.includes(data.viewportId);\n            });\n            return toolGroupAnnotations;\n        };\n        this._onNewVolume = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._areViewportIdArraysEqual = (viewportIdArrayOne, viewportIdArrayTwo) => {\n            if (viewportIdArrayOne.length !== viewportIdArrayTwo.length) {\n                return false;\n            }\n            viewportIdArrayOne.forEach((id) => {\n                let itemFound = false;\n                for (let i = 0; i < viewportIdArrayTwo.length; ++i) {\n                    if (id === viewportIdArrayTwo[i]) {\n                        itemFound = true;\n                        break;\n                    }\n                }\n                if (itemFound === false) {\n                    return false;\n                }\n            });\n            return true;\n        };\n        this._getAnnotationsForViewportsWithDifferentCameras = (enabledElement, annotations) => {\n            const { viewportId, renderingEngine, viewport } = enabledElement;\n            const otherViewportAnnotations = annotations.filter((annotation) => annotation.data.viewportId !== viewportId);\n            if (!otherViewportAnnotations || !otherViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, position } = camera;\n            const viewportsWithDifferentCameras = otherViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const targetViewport = renderingEngine.getViewport(viewportId);\n                const cameraOfTarget = targetViewport.getCamera();\n                return !(csUtils.isEqual(cameraOfTarget.viewPlaneNormal, viewPlaneNormal, 1e-2) && csUtils.isEqual(cameraOfTarget.position, position, 1));\n            });\n            return viewportsWithDifferentCameras;\n        };\n        this._filterViewportWithSameOrientation = (enabledElement, referenceAnnotation, annotations) => {\n            const { renderingEngine } = enabledElement;\n            const { data } = referenceAnnotation;\n            const viewport = renderingEngine.getViewport(data.viewportId);\n            const linkedViewportAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return otherViewportControllable === true;\n            });\n            if (!linkedViewportAnnotations || !linkedViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherViewportsAnnotationsWithSameCameraDirection = linkedViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                return (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) &&\n                    csUtils.isEqual(camera.viewUp, otherCamera.viewUp, 1e-2));\n            });\n            return otherViewportsAnnotationsWithSameCameraDirection;\n        };\n        this._filterAnnotationsByUniqueViewportOrientations = (enabledElement, annotations) => {\n            const { renderingEngine, viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable === true);\n            });\n            const otherViewportsAnnotationsWithUniqueCameras = [];\n            for (let i = 0; i < otherLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherNonLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable !== true);\n            });\n            for (let i = 0; i < otherNonLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherNonLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            for (let i = 0; i < otherViewportAnnotations.length; ++i) {\n                const annotation = otherViewportAnnotations[i];\n                if (otherViewportsAnnotationsWithUniqueCameras.some((element) => element === annotation)) {\n                    continue;\n                }\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            return otherViewportsAnnotationsWithUniqueCameras;\n        };\n        this._checkIfViewportsRenderingSameScene = (viewport, otherViewport) => {\n            const volumeIds = viewport.getAllVolumeIds();\n            const otherVolumeIds = otherViewport.getAllVolumeIds();\n            return (volumeIds.length === otherVolumeIds.length &&\n                volumeIds.every((id) => otherVolumeIds.includes(id)));\n        };\n        this._jump = (enabledElement, jumpWorld) => {\n            state.isInteractingWithTool = true;\n            const { viewport, renderingEngine } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const delta = [0, 0, 0];\n            vtkMath.subtract(jumpWorld, this.toolCenter, delta);\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const sameScene = this._checkIfViewportsRenderingSameScene(viewport, otherViewport);\n                return (this._getReferenceLineControllable(otherViewport.id) &&\n                    this._getReferenceLineDraggableRotatable(otherViewport.id) &&\n                    sameScene);\n            });\n            if (viewportsAnnotationsToUpdate.length === 0) {\n                state.isInteractingWithTool = false;\n                return false;\n            }\n            this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            state.isInteractingWithTool = false;\n            return true;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = !this.configuration.mobile?.enabled;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            this.editData.annotation.data.handles.activeOperation = null;\n            this.editData.annotation.data.activeViewportIds = [];\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const delta = eventDetail.deltaPoints.world;\n            if (Math.abs(delta[0]) < 1e-3 &&\n                Math.abs(delta[1]) < 1e-3 &&\n                Math.abs(delta[2]) < 1e-3) {\n                return;\n            }\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const { handles } = viewportAnnotation.data;\n            const { currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            if (handles.activeOperation === OPERATION.DRAG) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            }\n            else if (handles.activeOperation === OPERATION.ROTATE) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true);\n                });\n                const dir1 = vec2.create();\n                const dir2 = vec2.create();\n                const center = [\n                    this.toolCenter[0],\n                    this.toolCenter[1],\n                    this.toolCenter[2],\n                ];\n                const centerCanvas = viewport.worldToCanvas(center);\n                const finalPointCanvas = eventDetail.currentPoints.canvas;\n                const originalPointCanvas = vec2.create();\n                vec2.sub(originalPointCanvas, finalPointCanvas, eventDetail.deltaPoints.canvas);\n                vec2.sub(dir1, originalPointCanvas, centerCanvas);\n                vec2.sub(dir2, finalPointCanvas, centerCanvas);\n                let angle = vec2.angle(dir1, dir2);\n                if (this._isClockWise(centerCanvas, originalPointCanvas, finalPointCanvas)) {\n                    angle *= -1;\n                }\n                angle = Math.round(angle * 100) / 100;\n                const rotationAxis = viewport.getCamera().viewPlaneNormal;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromRadian()\n                    .translate(center[0], center[1], center[2])\n                    .rotate(angle, rotationAxis)\n                    .translate(-center[0], -center[1], -center[2]);\n                const otherViewportsIds = [];\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    data.handles.toolCenter = center;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const { viewUp, position, focalPoint } = camera;\n                    viewUp[0] += position[0];\n                    viewUp[1] += position[1];\n                    viewUp[2] += position[2];\n                    vec3.transformMat4(focalPoint, focalPoint, matrix);\n                    vec3.transformMat4(position, position, matrix);\n                    vec3.transformMat4(viewUp, viewUp, matrix);\n                    viewUp[0] -= position[0];\n                    viewUp[1] -= position[1];\n                    viewUp[2] -= position[2];\n                    otherViewport.setCamera({\n                        position,\n                        viewUp,\n                        focalPoint,\n                    });\n                    otherViewportsIds.push(otherViewport.id);\n                });\n                renderingEngine.renderViewports(otherViewportsIds);\n            }\n            else if (handles.activeOperation === OPERATION.SLAB) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const referenceAnnotations = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportSlabThicknessControlsOn === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                if (referenceAnnotations.length === 0) {\n                    return;\n                }\n                const viewportsAnnotationsToUpdate = this._filterViewportWithSameOrientation(enabledElement, referenceAnnotations[0], annotations);\n                const viewportsIds = [];\n                viewportsIds.push(viewport.id);\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const normal = camera.viewPlaneNormal;\n                    const dotProd = vtkMath.dot(delta, normal);\n                    const projectedDelta = [...normal];\n                    vtkMath.multiplyScalar(projectedDelta, dotProd);\n                    if (Math.abs(projectedDelta[0]) > 1e-3 ||\n                        Math.abs(projectedDelta[1]) > 1e-3 ||\n                        Math.abs(projectedDelta[2]) > 1e-3) {\n                        const mod = Math.sqrt(projectedDelta[0] * projectedDelta[0] +\n                            projectedDelta[1] * projectedDelta[1] +\n                            projectedDelta[2] * projectedDelta[2]);\n                        const currentPoint = eventDetail.lastPoints.world;\n                        const direction = [0, 0, 0];\n                        const currentCenter = [\n                            this.toolCenter[0],\n                            this.toolCenter[1],\n                            this.toolCenter[2],\n                        ];\n                        const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                        if (!viewportDraggableRotatable) {\n                            const { rotationPoints } = this.editData.annotation.data.handles;\n                            const otherViewportRotationPoints = rotationPoints.filter((point) => point[1].uid === otherViewport.id);\n                            if (otherViewportRotationPoints.length === 2) {\n                                const point1 = viewport.canvasToWorld(otherViewportRotationPoints[0][3]);\n                                const point2 = viewport.canvasToWorld(otherViewportRotationPoints[1][3]);\n                                vtkMath.add(point1, point2, currentCenter);\n                                vtkMath.multiplyScalar(currentCenter, 0.5);\n                            }\n                        }\n                        vtkMath.subtract(currentPoint, currentCenter, direction);\n                        const dotProdDirection = vtkMath.dot(direction, normal);\n                        const projectedDirection = [...normal];\n                        vtkMath.multiplyScalar(projectedDirection, dotProdDirection);\n                        const normalizedProjectedDirection = [\n                            projectedDirection[0],\n                            projectedDirection[1],\n                            projectedDirection[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDirection, normalizedProjectedDirection);\n                        const normalizedProjectedDelta = [\n                            projectedDelta[0],\n                            projectedDelta[1],\n                            projectedDelta[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDelta, normalizedProjectedDelta);\n                        let slabThicknessValue = otherViewport.getSlabThickness();\n                        if (csUtils.isOpposite(normalizedProjectedDirection, normalizedProjectedDelta, 1e-3)) {\n                            slabThicknessValue -= mod;\n                        }\n                        else {\n                            slabThicknessValue += mod;\n                        }\n                        slabThicknessValue = Math.abs(slabThicknessValue);\n                        slabThicknessValue = Math.max(RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS, slabThicknessValue);\n                        const near = this._pointNearReferenceLine(viewportAnnotation, canvasCoords, 6, otherViewport);\n                        if (near) {\n                            slabThicknessValue = RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;\n                        }\n                        const toolGroup = getToolGroupForViewport(otherViewport.id, renderingEngine.id);\n                        const crosshairsInstance = toolGroup.getToolInstance(this.getToolName());\n                        crosshairsInstance.setSlabThickness(otherViewport, slabThicknessValue);\n                        viewportsIds.push(otherViewport.id);\n                    }\n                });\n                renderingEngine.renderViewports(viewportsIds);\n            }\n        };\n        this._pointNearReferenceLine = (annotation, canvasCoords, proximity, lineViewport) => {\n            const { data } = annotation;\n            const { rotationPoints } = data.handles;\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                if (otherViewport.id !== lineViewport.id) {\n                    continue;\n                }\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                if (!viewportControllable) {\n                    continue;\n                }\n                const lineSegment1 = {\n                    start: {\n                        x: rotationPoints[i][2][0],\n                        y: rotationPoints[i][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i][3][0],\n                        y: rotationPoints[i][3][1],\n                    },\n                };\n                const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n                const lineSegment2 = {\n                    start: {\n                        x: rotationPoints[i + 1][2][0],\n                        y: rotationPoints[i + 1][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i + 1][3][0],\n                        y: rotationPoints[i + 1][3][1],\n                    },\n                };\n                const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n                if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                    return true;\n                }\n                i++;\n            }\n            return false;\n        };\n        this._getReferenceLineColor =\n            toolProps.configuration?.getReferenceLineColor ||\n                defaultReferenceLineColor;\n        this._getReferenceLineControllable =\n            toolProps.configuration?.getReferenceLineControllable ||\n                defaultReferenceLineControllable;\n        this._getReferenceLineDraggableRotatable =\n            toolProps.configuration?.getReferenceLineDraggableRotatable ||\n                defaultReferenceLineDraggableRotatable;\n        this._getReferenceLineSlabThicknessControlsOn =\n            toolProps.configuration?.getReferenceLineSlabThicknessControlsOn ||\n                defaultReferenceLineSlabThicknessControlsOn;\n    }\n    onSetToolActive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        this._subscribeToViewportNewVolumeSet(viewportsInfo);\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolPassive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolEnabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolDisabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const annotations = this._getAnnotations(enabledElement);\n            if (annotations?.length) {\n                annotations.forEach((annotation) => {\n                    removeAnnotation(annotation.annotationUID);\n                });\n            }\n        });\n    }\n    setToolCenter(toolCenter, suppressEvents = false) {\n        this.toolCenter = toolCenter;\n        const viewportsInfo = this._getViewportsInfo();\n        triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        if (!suppressEvents) {\n            triggerEvent(eventTarget, Events.CROSSHAIR_TOOL_CENTER_CHANGED, {\n                toolGroupId: this.toolGroupId,\n                toolCenter: this.toolCenter,\n            });\n        }\n    }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let point = this._getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n        point = this._getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n    }\n    _unsubscribeToViewportNewVolumeSet(viewportsInfo) {\n        viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _subscribeToViewportNewVolumeSet(viewports) {\n        viewports.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _autoPanViewportIfNecessary(viewportId, renderingEngine) {\n        const viewport = renderingEngine.getViewport(viewportId);\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const toolCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n        const pan = this.configuration.autoPan.panSize;\n        const visiblePointCanvas = [\n            toolCenterCanvas[0],\n            toolCenterCanvas[1],\n        ];\n        if (toolCenterCanvas[0] < 0) {\n            visiblePointCanvas[0] = pan;\n        }\n        else if (toolCenterCanvas[0] > clientWidth) {\n            visiblePointCanvas[0] = clientWidth - pan;\n        }\n        if (toolCenterCanvas[1] < 0) {\n            visiblePointCanvas[1] = pan;\n        }\n        else if (toolCenterCanvas[1] > clientHeight) {\n            visiblePointCanvas[1] = clientHeight - pan;\n        }\n        if (visiblePointCanvas[0] === toolCenterCanvas[0] &&\n            visiblePointCanvas[1] === toolCenterCanvas[1]) {\n            return;\n        }\n        const visiblePointWorld = viewport.canvasToWorld(visiblePointCanvas);\n        const deltaPointsWorld = [\n            visiblePointWorld[0] - this.toolCenter[0],\n            visiblePointWorld[1] - this.toolCenter[1],\n            visiblePointWorld[2] - this.toolCenter[2],\n        ];\n        const camera = viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        viewport.render();\n    }\n    setSlabThickness(viewport, slabThickness) {\n        let actorUIDs;\n        const { filterActorUIDsToSetSlabThickness } = this.configuration;\n        if (filterActorUIDsToSetSlabThickness &&\n            filterActorUIDsToSetSlabThickness.length > 0) {\n            actorUIDs = filterActorUIDsToSetSlabThickness;\n        }\n        let blendModeToUse = this.configuration.slabThicknessBlendMode;\n        if (slabThickness === RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS) {\n            blendModeToUse = Enums.BlendModes.COMPOSITE;\n        }\n        const immediate = false;\n        viewport.setBlendMode(blendModeToUse, actorUIDs, immediate);\n        viewport.setSlabThickness(slabThickness, actorUIDs);\n    }\n    _isClockWise(a, b, c) {\n        return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]) > 0;\n    }\n    _applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta) {\n        viewportsAnnotationsToUpdate.forEach((annotation) => {\n            this._applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta);\n        });\n    }\n    _applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta) {\n        const { data } = annotation;\n        const viewport = renderingEngine.getViewport(data.viewportId);\n        const camera = viewport.getCamera();\n        const normal = camera.viewPlaneNormal;\n        const dotProd = vtkMath.dot(delta, normal);\n        const projectedDelta = [...normal];\n        vtkMath.multiplyScalar(projectedDelta, dotProd);\n        if (Math.abs(projectedDelta[0]) > 1e-3 ||\n            Math.abs(projectedDelta[1]) > 1e-3 ||\n            Math.abs(projectedDelta[2]) > 1e-3) {\n            const newFocalPoint = [0, 0, 0];\n            const newPosition = [0, 0, 0];\n            vtkMath.add(camera.focalPoint, projectedDelta, newFocalPoint);\n            vtkMath.add(camera.position, projectedDelta, newPosition);\n            viewport.setCamera({\n                focalPoint: newFocalPoint,\n                position: newPosition,\n            });\n            viewport.render();\n        }\n    }\n    _getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        for (let i = 0; i < rotationPoints.length; i++) {\n            const point = rotationPoints[i][0];\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportDraggableRotatable) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.ROTATE;\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { slabThicknessPoints } = data.handles;\n        for (let i = 0; i < slabThicknessPoints.length; i++) {\n            const point = slabThicknessPoints[i][0];\n            const otherViewport = slabThicknessPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.SLAB;\n                data.activeViewportIds = [otherViewport.id];\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _pointNearTool(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        const { slabThicknessPoints } = data.handles;\n        const viewportIdArray = [];\n        for (let i = 0; i < rotationPoints.length - 1; ++i) {\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportControllable || !viewportDraggableRotatable) {\n                continue;\n            }\n            const lineSegment1 = {\n                start: {\n                    x: rotationPoints[i][2][0],\n                    y: rotationPoints[i][2][1],\n                },\n                end: {\n                    x: rotationPoints[i][3][0],\n                    y: rotationPoints[i][3][1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: rotationPoints[i + 1][2][0],\n                    y: rotationPoints[i + 1][2][1],\n                },\n                end: {\n                    x: rotationPoints[i + 1][3][0],\n                    y: rotationPoints[i + 1][3][1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = OPERATION.DRAG;\n            }\n            i++;\n        }\n        for (let i = 0; i < slabThicknessPoints.length - 1; ++i) {\n            const otherViewport = slabThicknessPoints[i][1];\n            if (viewportIdArray.find((id) => id === otherViewport.id)) {\n                continue;\n            }\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportControllable || !viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const stPointLineCanvas1 = slabThicknessPoints[i][2];\n            const stPointLineCanvas2 = slabThicknessPoints[i][3];\n            const centerCanvas = vec2.create();\n            vec2.add(centerCanvas, stPointLineCanvas1, stPointLineCanvas2);\n            vec2.scale(centerCanvas, centerCanvas, 0.5);\n            const canvasUnitVectorFromCenter = vec2.create();\n            vec2.subtract(canvasUnitVectorFromCenter, stPointLineCanvas1, centerCanvas);\n            vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n            const canvasVectorFromCenterStart = vec2.create();\n            vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, canvasDiagonalLength * 0.05);\n            const stPointLineCanvas1Start = vec2.create();\n            const stPointLineCanvas2Start = vec2.create();\n            vec2.add(stPointLineCanvas1Start, centerCanvas, canvasVectorFromCenterStart);\n            vec2.subtract(stPointLineCanvas2Start, centerCanvas, canvasVectorFromCenterStart);\n            const lineSegment1 = {\n                start: {\n                    x: stPointLineCanvas1Start[0],\n                    y: stPointLineCanvas1Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas1[0],\n                    y: stPointLineCanvas1[1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: stPointLineCanvas2Start[0],\n                    y: stPointLineCanvas2Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas2[0],\n                    y: stPointLineCanvas2[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = null;\n            }\n            i++;\n        }\n        data.activeViewportIds = [...viewportIdArray];\n        this.editData = {\n            annotation,\n        };\n        return data.handles.activeOperation === OPERATION.DRAG ? true : false;\n    }\n}\nCrosshairsTool.toolName = 'Crosshairs';\nexport default CrosshairsTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { getPointInLineOfSightWithCriteria } from '../utilities/planar';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass MIPJumpToClickTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            targetViewportIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseClickCallback(evt) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        const volumeId = viewport.getVolumeId();\n        if (!volumeId) {\n            throw new Error(`MIPJumpToClickTool: targetId is not a volumeId, you should only use MIPJumpToClickTool with a volumeId as the targetId`);\n        }\n        let maxIntensity = -Infinity;\n        const maxFn = (intensity, point) => {\n            if (intensity > maxIntensity) {\n                maxIntensity = intensity;\n                return point;\n            }\n        };\n        const brightestPoint = getPointInLineOfSightWithCriteria(viewport, currentPoints.world, volumeId, maxFn);\n        if (!brightestPoint || !brightestPoint.length) {\n            return;\n        }\n        const { targetViewportIds, toolGroupId } = this.configuration;\n        const viewports = renderingEngine.getViewports().filter((vp) => {\n            if (targetViewportIds?.indexOf(vp.id) >= 0) {\n                return true;\n            }\n            const foundToolGroup = getToolGroupForViewport(vp.id, renderingEngine.id);\n            if (toolGroupId && toolGroupId === foundToolGroup?.id) {\n                return true;\n            }\n            return false;\n        });\n        viewports.forEach((viewport) => {\n            if (viewport instanceof VolumeViewport) {\n                viewport.jumpToWorld(brightestPoint);\n            }\n            else {\n                console.warn('Cannot jump to specified world coordinates for a viewport that is not a VolumeViewport');\n            }\n        });\n    }\n}\nMIPJumpToClickTool.toolName = 'MIPJumpToClickTool';\nexport default MIPJumpToClickTool;\n","import { BaseTool } from './base';\nimport { Events } from '../enums';\nimport { getEnabledElement, StackViewport, Enums } from '@cornerstonejs/core';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { state } from '../store/state';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nconst MAGNIFY_VIEWPORT_ID = 'magnify-viewport';\nclass MagnifyTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            magnifySize: 10,\n            magnifyWidth: 250,\n            magnifyHeight: 250,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._hasBeenRemoved = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('MagnifyTool only works on StackViewports');\n            }\n            const referencedImageId = this._getReferencedImageId(viewport);\n            if (!referencedImageId) {\n                throw new Error('MagnifyTool: No referenced image id found, reconstructed planes not supported yet');\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                referencedImageId,\n                viewportIdsToRender,\n                enabledElement,\n                renderingEngine,\n                currentPoints,\n            };\n            this._createMagnificationViewport();\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this.preTouchStartCallback = (evt) => {\n            this.preMouseDownCallback(evt);\n        };\n        this._createMagnificationViewport = () => {\n            const { enabledElement, referencedImageId, viewportIdsToRender, renderingEngine, currentPoints, } = this.editData;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const viewportProperties = viewport.getProperties();\n            const { rotation: originalViewportRotation } = viewport.getViewPresentation();\n            const { canvas: canvasPos, world: worldPos } = currentPoints;\n            let magnifyToolElement;\n            magnifyToolElement = element.querySelector('.magnifyTool');\n            if (magnifyToolElement === null) {\n                const magnifyElement = document.createElement('div');\n                magnifyElement.classList.add('magnifyTool');\n                magnifyElement.style.display = 'block';\n                magnifyElement.style.width = `${this.configuration.magnifyWidth}px`;\n                magnifyElement.style.height = `${this.configuration.magnifyHeight}px`;\n                magnifyElement.style.position = 'absolute';\n                magnifyToolElement = magnifyElement;\n                const viewportElement = element.querySelector('.viewport-element');\n                viewportElement.appendChild(magnifyElement);\n                const viewportInput = {\n                    viewportId: MAGNIFY_VIEWPORT_ID,\n                    type: Enums.ViewportType.STACK,\n                    element: magnifyToolElement,\n                };\n                renderingEngine.enableElement(viewportInput);\n            }\n            magnifyToolElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyToolElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            magnifyViewport.setStack([referencedImageId]).then(() => {\n                if (this._hasBeenRemoved) {\n                    return;\n                }\n                magnifyViewport.setProperties(viewportProperties);\n                magnifyViewport.setViewPresentation({\n                    rotation: originalViewportRotation,\n                });\n                const { parallelScale } = viewport.getCamera();\n                const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n                const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n                    Math.pow(focalPoint[1] - position[1], 2) +\n                    Math.pow(focalPoint[2] - position[2], 2));\n                const updatedFocalPoint = [\n                    worldPos[0],\n                    worldPos[1],\n                    worldPos[2],\n                ];\n                const updatedPosition = [\n                    updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n                    updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n                    updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n                ];\n                magnifyViewport.setCamera({\n                    parallelScale: parallelScale * (1 / this.configuration.magnifySize),\n                    focalPoint: updatedFocalPoint,\n                    position: updatedPosition,\n                });\n                magnifyViewport.render();\n            });\n            magnifyToolElement.style.display = 'block';\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { deltaPoints, element, currentPoints } = eventDetail;\n            const deltaPointsWorld = deltaPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            const magnifyElement = element.querySelector('.magnifyTool');\n            if (!magnifyElement) {\n                return;\n            }\n            magnifyElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const { focalPoint, position } = magnifyViewport.getCamera();\n            const updatedPosition = [\n                position[0] + deltaPointsWorld[0],\n                position[1] + deltaPointsWorld[1],\n                position[2] + deltaPointsWorld[2],\n            ];\n            const updatedFocalPoint = [\n                focalPoint[0] + deltaPointsWorld[0],\n                focalPoint[1] + deltaPointsWorld[1],\n                focalPoint[2] + deltaPointsWorld[2],\n            ];\n            magnifyViewport.setCamera({\n                focalPoint: updatedFocalPoint,\n                position: updatedPosition,\n            });\n            magnifyViewport.render();\n        };\n        this._dragEndCallback = (evt) => {\n            const { element } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            renderingEngine.disableElement(MAGNIFY_VIEWPORT_ID);\n            const viewportElement = element.querySelector('.viewport-element');\n            const magnifyToolElement = viewportElement.querySelector('.magnifyTool');\n            viewportElement.removeChild(magnifyToolElement);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this._hasBeenRemoved = true;\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            this._hasBeenRemoved = false;\n            element.addEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n    }\n    _getReferencedImageId(viewport) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId;\n        if (viewport instanceof StackViewport) {\n            referencedImageId = targetId.split('imageId:')[1];\n        }\n        return referencedImageId;\n    }\n}\nMagnifyTool.toolName = 'Magnify';\nexport default MagnifyTool;\n","import vtkOrientationMarkerWidget from '@kitware/vtk.js/Interaction/Widgets/OrientationMarkerWidget';\nimport vtkAnnotatedCubeActor from '@kitware/vtk.js/Rendering/Core/AnnotatedCubeActor';\nimport vtkAxesActor from '@kitware/vtk.js/Rendering/Core/AxesActor';\nimport vtkActor from '@kitware/vtk.js/Rendering/Core/Actor';\nimport vtkMapper from '@kitware/vtk.js/Rendering/Core/Mapper';\nimport vtkXMLPolyDataReader from '@kitware/vtk.js/IO/XML/XMLPolyDataReader';\nimport vtkPolyData from '@kitware/vtk.js/Common/DataModel/PolyData';\nimport { BaseTool } from './base';\nimport { Enums, eventTarget, getEnabledElementByIds, getRenderingEngines, } from '@cornerstonejs/core';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { Events } from '../enums';\nvar OverlayMarkerType;\n(function (OverlayMarkerType) {\n    OverlayMarkerType[OverlayMarkerType[\"ANNOTATED_CUBE\"] = 1] = \"ANNOTATED_CUBE\";\n    OverlayMarkerType[OverlayMarkerType[\"AXES\"] = 2] = \"AXES\";\n    OverlayMarkerType[OverlayMarkerType[\"CUSTOM\"] = 3] = \"CUSTOM\";\n})(OverlayMarkerType || (OverlayMarkerType = {}));\nclass OrientationMarkerTool extends BaseTool {\n    static { this.CUBE = 1; }\n    static { this.AXIS = 2; }\n    static { this.VTPFILE = 3; }\n    static { this.OVERLAY_MARKER_TYPES = OverlayMarkerType; }\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            orientationWidget: {\n                enabled: true,\n                viewportCorner: vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT,\n                viewportSize: 0.15,\n                minPixelSize: 100,\n                maxPixelSize: 300,\n            },\n            overlayMarkerType: OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE,\n            overlayConfiguration: {\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE]: {\n                    faceProperties: {\n                        xPlus: { text: 'L', faceColor: '#ffff00', faceRotation: 90 },\n                        xMinus: { text: 'R', faceColor: '#ffff00', faceRotation: 270 },\n                        yPlus: {\n                            text: 'P',\n                            faceColor: '#00ffff',\n                            fontColor: 'white',\n                            faceRotation: 180,\n                        },\n                        yMinus: { text: 'A', faceColor: '#00ffff', fontColor: 'white' },\n                        zPlus: { text: 'S' },\n                        zMinus: { text: 'I' },\n                    },\n                    defaultStyle: {\n                        fontStyle: 'bold',\n                        fontFamily: 'Arial',\n                        fontColor: 'black',\n                        fontSizeScale: (res) => res / 2,\n                        faceColor: '#0000ff',\n                        edgeThickness: 0.1,\n                        edgeColor: 'black',\n                        resolution: 400,\n                    },\n                },\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.AXES]: {},\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.CUSTOM]: {\n                    polyDataURL: 'https://raw.githubusercontent.com/Slicer/Slicer/80ad0a04dacf134754459557bf2638c63f3d1d1b/Base/Logic/Resources/OrientationMarkers/Human.vtp',\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this.onSetToolEnabled = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolActive = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolDisabled = () => {\n            this.cleanUpData();\n            this._unsubscribeToViewportNewVolumeSet();\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resize = (viewportId) => {\n            const orientationMarker = this.orientationMarkers[viewportId];\n            if (!orientationMarker) {\n                return;\n            }\n            const { orientationWidget } = orientationMarker;\n            orientationWidget.updateViewport();\n        };\n        this.orientationMarkers = {};\n        this.updatingOrientationMarker = {};\n    }\n    _unsubscribeToViewportNewVolumeSet() {\n        const unsubscribe = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = this._resizeObservers.get(viewportId);\n                resizeObserver.unobserve(element);\n            });\n        };\n        eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            unsubscribe();\n            this.initViewports();\n        });\n    }\n    _subscribeToViewportEvents() {\n        const subscribeToElementResize = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                this.initViewports();\n                element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = new ResizeObserver(() => {\n                    setTimeout(() => {\n                        const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                        if (!element) {\n                            return;\n                        }\n                        const { viewport } = element;\n                        this.resize(viewportId);\n                        viewport.render();\n                    }, 100);\n                });\n                resizeObserver.observe(element);\n                this._resizeObservers.set(viewportId, resizeObserver);\n            });\n        };\n        subscribeToElementResize();\n        eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            subscribeToElementResize();\n            this.initViewports();\n        });\n    }\n    cleanUpData() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        const viewports = renderingEngine.getViewports();\n        viewports.forEach((viewport) => {\n            const orientationMarker = this.orientationMarkers[viewport.id];\n            if (!orientationMarker) {\n                return;\n            }\n            const { actor, orientationWidget } = orientationMarker;\n            orientationWidget?.setEnabled(false);\n            orientationWidget?.delete();\n            actor?.delete();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            delete this.orientationMarkers[viewport.id];\n        });\n    }\n    initViewports() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        if (!renderingEngine) {\n            return;\n        }\n        let viewports = renderingEngine.getViewports();\n        viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n        viewports.forEach((viewport) => {\n            const widget = viewport.getWidget(this.getToolName());\n            if (!widget || widget.isDeleted()) {\n                this.addAxisActorInViewport(viewport);\n            }\n        });\n    }\n    async addAxisActorInViewport(viewport) {\n        const viewportId = viewport.id;\n        if (!this.updatingOrientationMarker[viewportId]) {\n            this.updatingOrientationMarker[viewportId] = true;\n            const type = this.configuration.overlayMarkerType;\n            const overlayConfiguration = this.configuration.overlayConfiguration[type];\n            if (this.orientationMarkers[viewportId]) {\n                const { actor, orientationWidget } = this.orientationMarkers[viewportId];\n                viewport.getRenderer().removeActor(actor);\n                orientationWidget.setEnabled(false);\n            }\n            let actor;\n            if (type === 1) {\n                actor = this.createAnnotationCube(overlayConfiguration);\n            }\n            else if (type === 2) {\n                actor = vtkAxesActor.newInstance();\n            }\n            else if (type === 3) {\n                actor = await this.createCustomActor();\n            }\n            const renderer = viewport.getRenderer();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            const { enabled, viewportCorner, viewportSize, minPixelSize, maxPixelSize, } = this.configuration.orientationWidget;\n            const orientationWidget = vtkOrientationMarkerWidget.newInstance({\n                actor,\n                interactor: renderWindow.getInteractor(),\n                parentRenderer: renderer,\n            });\n            orientationWidget.setEnabled(enabled);\n            orientationWidget.setViewportCorner(viewportCorner);\n            orientationWidget.setViewportSize(viewportSize);\n            orientationWidget.setMinPixelSize(minPixelSize);\n            orientationWidget.setMaxPixelSize(maxPixelSize);\n            orientationWidget.updateMarkerOrientation();\n            this.orientationMarkers[viewportId] = {\n                orientationWidget,\n                actor,\n            };\n            viewport.addWidget(this.getToolName(), orientationWidget);\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            this.updatingOrientationMarker[viewportId] = false;\n        }\n    }\n    async createCustomActor() {\n        const url = this.configuration.overlayConfiguration[OverlayMarkerType.CUSTOM]\n            .polyDataURL;\n        const response = await fetch(url);\n        const arrayBuffer = await response.arrayBuffer();\n        const vtpReader = vtkXMLPolyDataReader.newInstance();\n        vtpReader.parseAsArrayBuffer(arrayBuffer);\n        vtpReader.update();\n        const polyData = vtkPolyData.newInstance();\n        polyData.shallowCopy(vtpReader.getOutputData());\n        polyData.getPointData().setActiveScalars('Color');\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputData(polyData);\n        mapper.setColorModeToDirectScalars();\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n        actor.rotateZ(180);\n        return actor;\n    }\n    createAnnotationCube(overlayConfiguration) {\n        const actor = vtkAnnotatedCubeActor.newInstance();\n        actor.setDefaultStyle({ ...overlayConfiguration.defaultStyle });\n        actor.setXPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.xPlus,\n        });\n        actor.setXMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.xMinus,\n        });\n        actor.setYPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.yPlus,\n        });\n        actor.setYMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.yMinus,\n        });\n        actor.setZPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.zPlus,\n        });\n        actor.setZMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.zMinus,\n        });\n        return actor;\n    }\n    async createAnnotatedCubeActor() {\n        const axes = vtkAnnotatedCubeActor.newInstance();\n        const { faceProperties, defaultStyle } = this.configuration.annotatedCube;\n        axes.setDefaultStyle(defaultStyle);\n        Object.keys(faceProperties).forEach((key) => {\n            const methodName = `set${key.charAt(0).toUpperCase() + key.slice(1)}FaceProperty`;\n            axes[methodName](faceProperties[key]);\n        });\n        return axes;\n    }\n}\nOrientationMarkerTool.toolName = 'OrientationMarker';\nexport default OrientationMarkerTool;\n","import { vec3 } from 'gl-matrix';\nimport { metaData, CONSTANTS, getRenderingEngine, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass OverlayGridTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceImageIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolActive = () => {\n            this._init();\n        };\n        this._init = () => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            if (!sourceImageIds?.length) {\n                console.warn('OverlayGridTool: No sourceImageIds provided in configuration');\n                return;\n            }\n            const imagePlaneModule = metaData.get('imagePlaneModule', sourceImageIds[0]);\n            if (!imagePlaneModule) {\n                console.warn('OverlayGridTool: No imagePlaneModule found for sourceImageIds');\n                return;\n            }\n            const { frameOfReferenceUID } = imagePlaneModule;\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn('OverlayGridTool: No viewports found');\n                return;\n            }\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const pointSets = sourceImageIds.map((id) => {\n                    return this.calculateImageIdPointSets(id);\n                });\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        viewportData: new Map(),\n                        pointSets,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.calculateImageIdPointSets = (imageId) => {\n            const { imagePositionPatient, rows, columns, rowCosines, columnCosines, rowPixelSpacing, columnPixelSpacing, } = metaData.get('imagePlaneModule', imageId);\n            const topLeft = [...imagePositionPatient];\n            const topRight = [...imagePositionPatient];\n            const bottomLeft = [...imagePositionPatient];\n            const bottomRight = [...imagePositionPatient];\n            vec3.scaleAndAdd(topRight, imagePositionPatient, columnCosines, columns * columnPixelSpacing);\n            vec3.scaleAndAdd(bottomLeft, imagePositionPatient, rowCosines, rows * rowPixelSpacing);\n            vec3.scaleAndAdd(bottomRight, bottomLeft, columnCosines, columns * columnPixelSpacing);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            return { pointSet1, pointSet2 };\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            let renderStatus = false;\n            if (!sourceImageIds?.length) {\n                return renderStatus;\n            }\n            const { viewport: targetViewport, FrameOfReferenceUID } = enabledElement;\n            const targetImageIds = targetViewport.getImageIds();\n            if (targetImageIds.length < 2) {\n                return renderStatus;\n            }\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const { focalPoint, viewPlaneNormal } = targetViewport.getCamera();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const imageIdNormal = (this.getImageIdNormal(sourceImageIds[0]));\n            if (this.isParallel(viewPlaneNormal, imageIdNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSets = annotation.data.pointSets;\n            const viewportData = annotation.data.viewportData;\n            for (let i = 0; i < sourceImageIds.length; i++) {\n                const { pointSet1, pointSet2 } = pointSets[i];\n                const targetData = viewportData.get(targetViewport.id) ||\n                    this.initializeViewportData(viewportData, targetViewport.id);\n                if (!targetData.pointSetsToUse[i]) {\n                    let pointSetToUse = pointSet1;\n                    let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n                    topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n                    if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                        pointSetToUse = pointSet2;\n                    }\n                    targetData.pointSetsToUse[i] = pointSetToUse;\n                    targetData.lineStartsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n                    targetData.lineEndsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n                }\n                const lineStartWorld = targetData.lineStartsWorld[i];\n                const lineEndWorld = targetData.lineEndsWorld[i];\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n                const canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n                const dataId = `${annotationUID}-line`;\n                const lineUID = `${i}`;\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n            }\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.initializeViewportData = (viewportData, id) => {\n            viewportData.set(id, {\n                pointSetsToUse: [],\n                lineStartsWorld: [],\n                lineEndsWorld: [],\n            });\n            return viewportData.get(id);\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    getImageIdNormal(imageId) {\n        const { imageOrientationPatient } = metaData.get('imagePlaneModule', imageId);\n        const rowCosineVec = vec3.fromValues(imageOrientationPatient[0], imageOrientationPatient[1], imageOrientationPatient[2]);\n        const colCosineVec = vec3.fromValues(imageOrientationPatient[3], imageOrientationPatient[4], imageOrientationPatient[5]);\n        return vec3.cross(vec3.create(), rowCosineVec, colCosineVec);\n    }\n}\nOverlayGridTool.toolName = 'OverlayGrid';\nexport default OverlayGridTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nclass PanTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        if (deltaPointsWorld[0] === 0 &&\n            deltaPointsWorld[1] === 0 &&\n            deltaPointsWorld[2] === 0) {\n            return;\n        }\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nPanTool.toolName = 'Pan';\nexport default PanTool;\n","import { BaseVolumeViewport, getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport angleBetweenLines from '../utilities/math/angle/angleBetweenLines';\nclass PlanarRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseWheelCallback = (evt) => {\n            const { element, wheel } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { invert } = this.configuration;\n            const angle = wheel.direction * 10 * (invert ? -1 : 1);\n            this.setAngle(viewport, angle);\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, startPoints } = evt.detail;\n        const currentPointWorld = currentPoints.world;\n        const startPointWorld = startPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const centerCanvas = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(centerCanvas);\n        let angle = angleBetweenLines([startPointWorld, centerWorld], [centerWorld, currentPointWorld]);\n        const { viewPlaneNormal } = camera;\n        const v1 = vec3.sub(vec3.create(), centerWorld, startPointWorld);\n        const v2 = vec3.sub(vec3.create(), centerWorld, currentPointWorld);\n        const cross = vec3.cross(vec3.create(), v1, v2);\n        if (vec3.dot(viewPlaneNormal, cross) > 0) {\n            angle = -angle;\n        }\n        if (Number.isNaN(angle)) {\n            return;\n        }\n        this.setAngle(viewport, angle);\n    }\n    setAngle(viewport, angle) {\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        if (viewport instanceof BaseVolumeViewport) {\n            const rotAngle = (((angle + 360) % 360) * Math.PI) / 180;\n            const rotMat = mat4.identity(new Float32Array(16));\n            mat4.rotate(rotMat, rotMat, rotAngle, viewPlaneNormal);\n            const rotatedViewUp = vec3.transformMat4(vec3.create(), viewUp, rotMat);\n            viewport.setCamera({ viewUp: rotatedViewUp });\n        }\n        else {\n            const { rotation } = viewport.getViewPresentation();\n            viewport.setViewPresentation({\n                rotation: (rotation + angle + 360) % 360,\n            });\n        }\n        viewport.render();\n    }\n}\nPlanarRotateTool.toolName = 'PlanarRotate';\nexport default PlanarRotateTool;\n","import { getEnabledElement, StackViewport, VolumeViewport, utilities, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { drawLine } from '../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { vec3 } from 'gl-matrix';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass ReferenceCursors extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            displayThreshold: 5,\n            positionSync: true,\n            disableCursor: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isDrawing = false;\n        this.isHandleOutsideImage = false;\n        this._elementWithCursor = null;\n        this._currentCursorWorldPosition = null;\n        this._currentCanvasPosition = null;\n        this._disableCursorEnabled = false;\n        this.mouseMoveCallback = (evt) => {\n            const { detail } = evt;\n            const { element, currentPoints } = detail;\n            this._currentCursorWorldPosition = currentPoints.world;\n            this._currentCanvasPosition = currentPoints.canvas;\n            this._elementWithCursor = element;\n            const annotation = this.getActiveAnnotation(element);\n            if (annotation === null) {\n                this.createInitialAnnotation(currentPoints.world, element);\n                return false;\n            }\n            this.updateAnnotationPosition(element, annotation);\n            return false;\n        };\n        this.createInitialAnnotation = (worldPos, element) => {\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('No enabled element found');\n            }\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            if (!viewPlaneNormal || !viewUp) {\n                throw new Error('Camera not found');\n            }\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                },\n            };\n            const annotations = getAnnotations(this.getToolName(), element);\n            if (annotations.length > 0) {\n                return null;\n            }\n            const annotationId = addAnnotation(annotation, element);\n            if (annotationId === null) {\n                return;\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, previousCamera, camera } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const viewport = enabledElement.viewport;\n            if (element !== this._elementWithCursor) {\n                return;\n            }\n            const oldFocalPoint = previousCamera.focalPoint;\n            const cameraNormal = camera.viewPlaneNormal;\n            const newFocalPoint = camera.focalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(newFocalPoint, oldFocalPoint, deltaCameraFocalPoint);\n            if (deltaCameraFocalPoint.reduce((a, b) => a + b, 0) === 0) {\n                return;\n            }\n            const dotProduct = vtkMath.dot(deltaCameraFocalPoint, cameraNormal);\n            if (Math.abs(dotProduct) < 1e-2) {\n                return;\n            }\n            if (!this._currentCanvasPosition) {\n                return;\n            }\n            const newWorldPos = viewport.canvasToWorld(this._currentCanvasPosition);\n            this._currentCursorWorldPosition = newWorldPos;\n            this.updateAnnotationPosition(element, this.getActiveAnnotation(element));\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            const isElementWithCursor = this._elementWithCursor === viewport.element;\n            if (this.configuration.positionSync && !isElementWithCursor) {\n                this.updateViewportImage(viewport);\n            }\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                if (!annotationUID) {\n                    return renderStatus;\n                }\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidthBase = parseFloat(this.getStyle('lineWidth', styleSpecifier, annotation));\n                const lineWidth = typeof lineWidthBase === 'number' && isElementWithCursor\n                    ? lineWidthBase\n                    : lineWidthBase;\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (points[0].some((e) => isNaN(e))) {\n                    return renderStatus;\n                }\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                const crosshairUIDs = {\n                    upper: 'upper',\n                    right: 'right',\n                    lower: 'lower',\n                    left: 'left',\n                };\n                const [x, y] = canvasCoordinates[0];\n                const centerSpace = isElementWithCursor ? 20 : 7;\n                const lineLength = isElementWithCursor ? 5 : 7;\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.upper, [x, y - (centerSpace / 2 + lineLength)], [x, y - centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.lower, [x, y + (centerSpace / 2 + lineLength)], [x, y + centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.right, [x + (centerSpace / 2 + lineLength), y], [x + centerSpace / 2, y], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.left, [x - (centerSpace / 2 + lineLength), y], [x - centerSpace / 2, y], { color, lineDash, lineWidth });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._disableCursorEnabled = this.configuration.disableCursor;\n    }\n    onSetToolActive() {\n        this._disableCursorEnabled = this.configuration.disableCursor;\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                hideElementCursor(element.viewport.element);\n            }\n        });\n    }\n    onSetToolDisabled() {\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                resetElementCursor(element.viewport.element);\n            }\n        });\n    }\n    getActiveAnnotation(element) {\n        const annotations = getAnnotations(this.getToolName(), element);\n        if (!annotations.length) {\n            return null;\n        }\n        const targetAnnotation = annotations[0];\n        return targetAnnotation;\n    }\n    updateAnnotationPosition(element, annotation) {\n        const worldPos = this._currentCursorWorldPosition;\n        if (!worldPos) {\n            return;\n        }\n        if (!annotation.data?.handles?.points) {\n            return;\n        }\n        annotation.data.handles.points = [[...worldPos]];\n        annotation.invalidated = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!(annotations instanceof Array) || annotations.length === 0) {\n            return [];\n        }\n        const annotation = annotations[0];\n        const viewport = getEnabledElement(element)?.viewport;\n        if (!viewport) {\n            return [];\n        }\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, focalPoint } = camera;\n        if (!viewPlaneNormal || !focalPoint) {\n            return [];\n        }\n        const points = annotation.data?.handles?.points;\n        if (!(points instanceof Array) || points.length !== 1) {\n            return [];\n        }\n        const worldPos = points[0];\n        const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n        const distance = utilities.planar.planeDistanceToPoint(plane, worldPos);\n        return distance < this.configuration.displayThreshold ? [annotation] : [];\n    }\n    updateViewportImage(viewport) {\n        const currentMousePosition = this._currentCursorWorldPosition;\n        if (!currentMousePosition || currentMousePosition.some((e) => isNaN(e))) {\n            return;\n        }\n        if (viewport instanceof StackViewport) {\n            const closestIndex = utilities.getClosestStackImageIndexForPoint(currentMousePosition, viewport);\n            if (closestIndex === null) {\n                return;\n            }\n            if (closestIndex !== viewport.getCurrentImageIdIndex()) {\n                viewport.setImageIdIndex(closestIndex);\n            }\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const { focalPoint, viewPlaneNormal } = viewport.getCamera();\n            if (!focalPoint || !viewPlaneNormal) {\n                return;\n            }\n            const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const currentDistance = utilities.planar.planeDistanceToPoint(plane, currentMousePosition, true);\n            if (Math.abs(currentDistance) < 0.5) {\n                return;\n            }\n            const normalizedViewPlane = vec3.normalize(vec3.create(), vec3.fromValues(...viewPlaneNormal));\n            const scaledPlaneNormal = vec3.scale(vec3.create(), normalizedViewPlane, currentDistance);\n            const newFocalPoint = vec3.add(vec3.create(), vec3.fromValues(...focalPoint), scaledPlaneNormal);\n            const isInBounds = true;\n            if (isInBounds) {\n                viewport.setCamera({ focalPoint: newFocalPoint });\n                const renderingEngine = viewport.getRenderingEngine();\n                if (renderingEngine) {\n                    renderingEngine.renderViewport(viewport.id);\n                }\n            }\n        }\n    }\n}\nReferenceCursors.toolName = 'ReferenceCursors';\nexport default ReferenceCursors;\n","import { vec3 } from 'gl-matrix';\nimport { getRenderingEngines, CONSTANTS, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { addAnnotation } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass ReferenceLines extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceViewportId: '',\n            enforceSameFrameOfReference: true,\n            showFullDimension: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            let viewports = renderingEngine.getViewports();\n            viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n            const sourceViewport = renderingEngine.getViewport(this.configuration.sourceViewportId);\n            if (!sourceViewport?.getImageData()) {\n                return;\n            }\n            const { element } = sourceViewport;\n            const { viewUp, viewPlaneNormal } = sourceViewport.getCamera();\n            const sourceViewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(sourceViewport);\n            let annotation = this.editData?.annotation;\n            const FrameOfReferenceUID = sourceViewport.getFrameOfReferenceUID();\n            if (!annotation) {\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        viewPlaneNormal: [...viewPlaneNormal],\n                        viewUp: [...viewUp],\n                        FrameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        handles: {\n                            points: sourceViewportCanvasCornersInWorld,\n                        },\n                    },\n                };\n                addAnnotation(newAnnotation, element);\n                annotation = newAnnotation;\n            }\n            else {\n                this.editData.annotation.data.handles.points =\n                    sourceViewportCanvasCornersInWorld;\n            }\n            this.editData = {\n                sourceViewportId: sourceViewport.id,\n                renderingEngine,\n                annotation,\n            };\n            triggerAnnotationRenderForViewportIds(viewports\n                .filter((viewport) => viewport.id !== sourceViewport.id)\n                .map((viewport) => viewport.id));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolConfiguration = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport: targetViewport } = enabledElement;\n            if (!this.editData) {\n                return false;\n            }\n            const { annotation, sourceViewportId } = this.editData;\n            let renderStatus = false;\n            const { viewport: sourceViewport } = getEnabledElementByViewportId(sourceViewportId) || {};\n            if (!sourceViewport) {\n                return renderStatus;\n            }\n            if (sourceViewport.id === targetViewport.id) {\n                return renderStatus;\n            }\n            if (!annotation || !annotation?.data?.handles?.points) {\n                return renderStatus;\n            }\n            if (this.configuration.enforceSameFrameOfReference &&\n                sourceViewport.getFrameOfReferenceUID() !==\n                    targetViewport.getFrameOfReferenceUID()) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const topLeft = annotation.data.handles.points[0];\n            const topRight = annotation.data.handles.points[1];\n            const bottomLeft = annotation.data.handles.points[2];\n            const bottomRight = annotation.data.handles.points[3];\n            const { focalPoint, viewPlaneNormal, viewUp } = targetViewport.getCamera();\n            const { viewPlaneNormal: sourceViewPlaneNormal } = sourceViewport.getCamera();\n            if (this.isParallel(viewPlaneNormal, sourceViewPlaneNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            let pointSetToUse = pointSet1;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet1[2], pointSet1[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const newNormal = vec3.cross(vec3.create(), topBottomVec, topRightVec);\n            if (this.isParallel(newNormal, viewPlaneNormal)) {\n                return renderStatus;\n            }\n            if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                pointSetToUse = pointSet2;\n            }\n            const lineStartWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n            const lineEndWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n            const { annotationUID } = annotation;\n            styleSpecifier.annotationUID = annotationUID;\n            const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n            const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n            const color = this.getStyle('color', styleSpecifier, annotation);\n            const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n            let canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n            if (this.configuration.showFullDimension) {\n                canvasCoordinates = this.handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates);\n            }\n            if (canvasCoordinates.length < 2) {\n                return renderStatus;\n            }\n            const dataId = `${annotationUID}-line`;\n            const lineUID = '1';\n            drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, dataId);\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates) {\n        const renderingEngine = targetViewport.getRenderingEngine();\n        const targetId = this.getTargetId(targetViewport);\n        const targetImage = this.getTargetImageData(targetId);\n        const referencedImageId = this.getReferencedImageId(targetViewport, lineStartWorld, viewPlaneNormal, viewUp);\n        if (referencedImageId && targetImage) {\n            try {\n                const { imageData, dimensions } = targetImage;\n                const [topLeftImageCoord, topRightImageCoord, bottomRightImageCoord, bottomLeftImageCoord,] = [\n                    imageData.indexToWorld([0, 0, 0]),\n                    imageData.indexToWorld([dimensions[0] - 1, 0, 0]),\n                    imageData.indexToWorld([\n                        dimensions[0] - 1,\n                        dimensions[1] - 1,\n                        0,\n                    ]),\n                    imageData.indexToWorld([0, dimensions[1] - 1, 0]),\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                const [lineStartImageCoord, lineEndImageCoord] = [\n                    lineStartWorld,\n                    lineEndWorld,\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                canvasCoordinates = [\n                    [topLeftImageCoord, topRightImageCoord],\n                    [topRightImageCoord, bottomRightImageCoord],\n                    [bottomLeftImageCoord, bottomRightImageCoord],\n                    [topLeftImageCoord, bottomLeftImageCoord],\n                ]\n                    .map(([start, end]) => this.intersectInfiniteLines(start, end, lineStartImageCoord, lineEndImageCoord))\n                    .filter((point) => point && this.isInBound(point, dimensions))\n                    .map((point) => {\n                    const world = csUtils.imageToWorldCoords(referencedImageId, point);\n                    return targetViewport.worldToCanvas(world);\n                });\n            }\n            catch (err) {\n                console.log(err);\n            }\n        }\n        return canvasCoordinates;\n    }\n    intersectInfiniteLines(line1Start, line1End, line2Start, line2End) {\n        const [x1, y1] = line1Start;\n        const [x2, y2] = line1End;\n        const [x3, y3] = line2Start;\n        const [x4, y4] = line2End;\n        const a1 = y2 - y1;\n        const b1 = x1 - x2;\n        const c1 = x2 * y1 - x1 * y2;\n        const a2 = y4 - y3;\n        const b2 = x3 - x4;\n        const c2 = x4 * y3 - x3 * y4;\n        if (Math.abs(a1 * b2 - a2 * b1) < EPSILON) {\n            return;\n        }\n        const x = (b1 * c2 - b2 * c1) / (a1 * b2 - a2 * b1);\n        const y = (a2 * c1 - a1 * c2) / (a1 * b2 - a2 * b1);\n        return [x, y];\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    isInBound(point, dimensions) {\n        return (point[0] >= 0 &&\n            point[0] <= dimensions[0] &&\n            point[1] >= 0 &&\n            point[1] <= dimensions[1]);\n    }\n}\nReferenceLines.toolName = 'ReferenceLines';\nexport default ReferenceLines;\n","import AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { vec3 } from 'gl-matrix';\nimport { getEnabledElementByIds, getRenderingEngines, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg, drawTextBox as drawTextBoxSvg, } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nconst viewportsWithAnnotations = [];\nclass ScaleOverlayTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            viewportId: '',\n            scaleLocation: 'bottom',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportIds) {\n                return;\n            }\n            const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n            let { viewport } = enabledElements[0];\n            const { FrameOfReferenceUID } = enabledElements[0];\n            if (this.configuration.viewportId) {\n                enabledElements.forEach((element) => {\n                    if (element.viewport.id == this.configuration.viewportId) {\n                        viewport = element.viewport;\n                    }\n                });\n            }\n            if (!viewport) {\n                return;\n            }\n            const { viewUp, viewPlaneNormal } = viewport.getCamera();\n            const viewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(viewport);\n            let annotation = this.editData?.annotation;\n            const annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (annotations.length) {\n                annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n            }\n            enabledElements.forEach((element) => {\n                const { viewport } = element;\n                if (!viewportsWithAnnotations.includes(viewport.id)) {\n                    const newAnnotation = {\n                        metadata: {\n                            toolName: this.getToolName(),\n                            viewPlaneNormal: [...viewPlaneNormal],\n                            viewUp: [...viewUp],\n                            FrameOfReferenceUID,\n                            referencedImageId: null,\n                        },\n                        data: {\n                            handles: {\n                                points: csUtils.getViewportImageCornersInWorld(viewport),\n                            },\n                            viewportId: viewport.id,\n                        },\n                    };\n                    viewportsWithAnnotations.push(viewport.id);\n                    addAnnotation(newAnnotation, viewport.element);\n                    annotation = newAnnotation;\n                }\n            });\n            if (this.editData?.annotation &&\n                this.editData.annotation.data.viewportId == viewport.id) {\n                this.editData.annotation.data.handles.points =\n                    viewportCanvasCornersInWorld;\n                this.editData.annotation.data.viewportId = viewport.id;\n            }\n            this.editData = {\n                viewport,\n                renderingEngine,\n                annotation,\n            };\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this.configuration.viewportId = evt.detail.viewportId;\n            this._init();\n        };\n        this.computeScaleSize = (worldWidthViewport, worldHeightViewport, location) => {\n            const scaleSizes = [\n                16000, 8000, 4000, 2000, 1000, 500, 250, 100, 50, 25, 10, 5, 2,\n            ];\n            let currentScaleSize;\n            if (location == 'top' || location == 'bottom') {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldWidthViewport * 0.6 &&\n                    scaleSize > worldWidthViewport * 0.2);\n            }\n            else {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldHeightViewport * 0.6 &&\n                    scaleSize > worldHeightViewport * 0.2);\n            }\n            return currentScaleSize[0];\n        };\n        this.computeEndScaleTicks = (canvasCoordinates, location) => {\n            const locationTickOffset = {\n                bottom: [\n                    [0, -10],\n                    [0, -10],\n                ],\n                top: [\n                    [0, 10],\n                    [0, 10],\n                ],\n                left: [\n                    [0, 0],\n                    [10, 0],\n                ],\n                right: [\n                    [0, 0],\n                    [-10, 0],\n                ],\n            };\n            const endTick1 = [\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            const endTick2 = [\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            return {\n                endTick1: endTick1,\n                endTick2: endTick2,\n            };\n        };\n        this.computeInnerScaleTicks = (scaleSize, location, annotationUID, leftTick, rightTick) => {\n            let canvasScaleSize;\n            if (location == 'bottom' || location == 'top') {\n                canvasScaleSize = rightTick[0][0] - leftTick[0][0];\n            }\n            else if (location == 'left' || location == 'right') {\n                canvasScaleSize = rightTick[0][1] - leftTick[0][1];\n            }\n            const tickIds = [];\n            const tickUIDs = [];\n            const tickCoordinates = [];\n            let numberSmallTicks = scaleSize;\n            if (scaleSize >= 50) {\n                numberSmallTicks = scaleSize / 10;\n            }\n            const tickSpacing = canvasScaleSize / numberSmallTicks;\n            for (let i = 0; i < numberSmallTicks - 1; i++) {\n                const locationOffset = {\n                    bottom: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), 5],\n                    ],\n                    top: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), -5],\n                    ],\n                    left: [\n                        [0, tickSpacing * (i + 1)],\n                        [-5, tickSpacing * (i + 1)],\n                    ],\n                    right: [\n                        [0, tickSpacing * (i + 1)],\n                        [5, tickSpacing * (i + 1)],\n                    ],\n                };\n                tickIds.push(`${annotationUID}-tick${i}`);\n                tickUIDs.push(`tick${i}`);\n                if ((i + 1) % 5 == 0) {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][0][0],\n                            leftTick[1][1] + locationOffset[location][0][1],\n                        ],\n                    ]);\n                }\n                else {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][1][0],\n                            leftTick[1][1] + locationOffset[location][1][1],\n                        ],\n                    ]);\n                }\n            }\n            return { tickIds, tickUIDs, tickCoordinates };\n        };\n        this.computeWorldScaleCoordinates = (scaleSize, location, pointSet) => {\n            let worldCoordinates;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet[0], pointSet[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet[2], pointSet[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const midpointLocation = {\n                bottom: [pointSet[1], pointSet[2]],\n                top: [pointSet[0], pointSet[3]],\n                right: [pointSet[2], pointSet[3]],\n                left: [pointSet[0], pointSet[1]],\n            };\n            const midpoint = vec3\n                .add(vec3.create(), midpointLocation[location][0], midpointLocation[location][0])\n                .map((i) => i / 2);\n            const offset = scaleSize /\n                2 /\n                Math.sqrt(Math.pow(topBottomVec[0], 2) +\n                    Math.pow(topBottomVec[1], 2) +\n                    Math.pow(topBottomVec[2], 2));\n            if (location == 'top' || location == 'bottom') {\n                worldCoordinates = [\n                    vec3.subtract(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                    vec3.add(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                worldCoordinates = [\n                    vec3.add(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                    vec3.subtract(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                ];\n            }\n            return worldCoordinates;\n        };\n        this.computeCanvasScaleCoordinates = (canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location) => {\n            let scaleCanvasCoordinates;\n            if (location == 'top' || location == 'bottom') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][0] - canvasCoordinates[1][0];\n                scaleCanvasCoordinates = [\n                    [canvasSize.width / 2 - worldDistanceOnCanvas / 2, vscaleBounds.height],\n                    [canvasSize.width / 2 + worldDistanceOnCanvas / 2, vscaleBounds.height],\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][1] - canvasCoordinates[1][1];\n                scaleCanvasCoordinates = [\n                    [hscaleBounds.width, canvasSize.height / 2 - worldDistanceOnCanvas / 2],\n                    [hscaleBounds.width, canvasSize.height / 2 + worldDistanceOnCanvas / 2],\n                ];\n            }\n            return scaleCanvasCoordinates;\n        };\n        this.computeScaleBounds = (canvasSize, horizontalReduction, verticalReduction, location) => {\n            const hReduction = horizontalReduction * Math.min(1000, canvasSize.width);\n            const vReduction = verticalReduction * Math.min(1000, canvasSize.height);\n            const locationBounds = {\n                bottom: [-vReduction, -hReduction],\n                top: [vReduction, hReduction],\n                left: [vReduction, hReduction],\n                right: [-vReduction, -hReduction],\n            };\n            const canvasBounds = {\n                bottom: [canvasSize.height, canvasSize.width],\n                top: [0, canvasSize.width],\n                left: [canvasSize.height, 0],\n                right: [canvasSize.height, canvasSize.width],\n            };\n            return {\n                height: canvasBounds[location][0] + locationBounds[location][0],\n                width: canvasBounds[location][1] + locationBounds[location][1],\n            };\n        };\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this.editData || !this.editData.viewport) {\n            return;\n        }\n        const location = this.configuration.scaleLocation;\n        const { viewport } = enabledElement;\n        const annotations = getAnnotations(this.getToolName(), viewport.element);\n        const annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n        const canvas = enabledElement.viewport.canvas;\n        const renderStatus = false;\n        if (!viewport) {\n            return renderStatus;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        const canvasSize = {\n            width: canvas.width / window.devicePixelRatio || 1,\n            height: canvas.height / window.devicePixelRatio || 1,\n        };\n        const topLeft = annotation.data.handles.points[0];\n        const topRight = annotation.data.handles.points[1];\n        const bottomLeft = annotation.data.handles.points[2];\n        const bottomRight = annotation.data.handles.points[3];\n        const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n        const worldWidthViewport = vec3.distance(bottomLeft, bottomRight);\n        const worldHeightViewport = vec3.distance(topLeft, bottomLeft);\n        const hscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const vscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const scaleSize = this.computeScaleSize(worldWidthViewport, worldHeightViewport, location);\n        const canvasCoordinates = this.computeWorldScaleCoordinates(scaleSize, location, pointSet1).map((world) => viewport.worldToCanvas(world));\n        const scaleCanvasCoordinates = this.computeCanvasScaleCoordinates(canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location);\n        const scaleTicks = this.computeEndScaleTicks(scaleCanvasCoordinates, location);\n        const { annotationUID } = annotation;\n        styleSpecifier.annotationUID = annotationUID;\n        const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n        const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n        const color = this.getStyle('color', styleSpecifier, annotation);\n        const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n        const scaleId = `${annotationUID}-scaleline`;\n        const scaleLineUID = '1';\n        drawLineSvg(svgDrawingHelper, annotationUID, scaleLineUID, scaleCanvasCoordinates[0], scaleCanvasCoordinates[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, scaleId);\n        const leftTickId = `${annotationUID}-left`;\n        const leftTickUID = '2';\n        drawLineSvg(svgDrawingHelper, annotationUID, leftTickUID, scaleTicks.endTick1[0], scaleTicks.endTick1[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, leftTickId);\n        const rightTickId = `${annotationUID}-right`;\n        const rightTickUID = '3';\n        drawLineSvg(svgDrawingHelper, annotationUID, rightTickUID, scaleTicks.endTick2[0], scaleTicks.endTick2[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, rightTickId);\n        const locationTextOffest = {\n            bottom: [-10, -42],\n            top: [-12, -35],\n            left: [-40, -20],\n            right: [-50, -20],\n        };\n        const textCanvasCoordinates = [\n            scaleCanvasCoordinates[0][0] + locationTextOffest[location][0],\n            scaleCanvasCoordinates[0][1] + locationTextOffest[location][1],\n        ];\n        const textBoxLines = this._getTextLines(scaleSize);\n        const { tickIds, tickUIDs, tickCoordinates } = this.computeInnerScaleTicks(scaleSize, location, annotationUID, scaleTicks.endTick1, scaleTicks.endTick2);\n        for (let i = 0; i < tickUIDs.length; i++) {\n            drawLineSvg(svgDrawingHelper, annotationUID, tickUIDs[i], tickCoordinates[i][0], tickCoordinates[i][1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, tickIds[i]);\n        }\n        const textUID = 'text0';\n        drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textBoxLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], {\n            fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            fontSize: '14px',\n            lineDash: '2,3',\n            lineWidth: '1',\n            shadow: true,\n            color: color,\n        });\n        return renderStatus;\n    }\n    _getTextLines(scaleSize) {\n        let scaleSizeDisplayValue;\n        let scaleSizeUnits;\n        if (scaleSize >= 50) {\n            scaleSizeDisplayValue = scaleSize / 10;\n            scaleSizeUnits = ' cm';\n        }\n        else {\n            scaleSizeDisplayValue = scaleSize;\n            scaleSizeUnits = ' mm';\n        }\n        const textLines = [scaleSizeDisplayValue.toString().concat(scaleSizeUnits)];\n        return textLines;\n    }\n}\nScaleOverlayTool.toolName = 'ScaleOverlay';\nexport default ScaleOverlayTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nimport { getAnnotations } from '../stateManagement';\nimport { point } from '../utilities/math';\nimport { Events, ToolModes, AnnotationStyleStates, ChangeTypes, } from '../enums';\nimport { triggerAnnotationRenderForViewportIds } from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nimport { triggerAnnotationModified } from '../stateManagement/annotation/helpers/state';\nimport CircleSculptCursor from './SculptorTool/CircleSculptCursor';\nimport { distancePointToContour } from './distancePointToContour';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass SculptorTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minSpacing: 1,\n            referencedToolNames: [\n                'PlanarFreehandROI',\n                'PlanarFreehandContourSegmentationTool',\n            ],\n            toolShape: 'circle',\n            referencedToolName: 'PlanarFreehandROI',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.registeredShapes = new Map();\n        this.isActive = false;\n        this.commonData = {\n            activeAnnotationUID: null,\n            viewportIdsToRender: [],\n            isEditingOpenContour: false,\n            canvasLocation: undefined,\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.configureToolSize(evt);\n            this.selectFreehandTool(eventData);\n            if (this.commonData.activeAnnotationUID === null) {\n                return;\n            }\n            this.isActive = true;\n            hideElementCursor(element);\n            this.activateModify(element);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.configureToolSize(evt);\n                this.updateCursor(evt);\n            }\n            else {\n                this.commonData.canvasLocation = undefined;\n            }\n        };\n        this.endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const config = this.configuration;\n            const enabledElement = getEnabledElement(element);\n            this.isActive = false;\n            this.deactivateModify(element);\n            resetElementCursor(element);\n            const { renderingEngineId, viewportId } = enabledElement;\n            const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n            const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (toolInstance.configuration.calculateStats) {\n                activeAnnotation.invalidated = true;\n            }\n            triggerAnnotationModified(activeAnnotation, element, ChangeTypes.HandlesUpdated);\n        };\n        this.dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.updateCursor(evt);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (!annotations?.length || !this.isActive) {\n                return;\n            }\n            const points = activeAnnotation.data.contour.polyline;\n            this.sculpt(eventData, points);\n        };\n        this.registerShapes(CircleSculptCursor.shapeName, CircleSculptCursor);\n        this.setToolShape(this.configuration.toolShape);\n    }\n    registerShapes(shapeName, shapeClass) {\n        const shape = new shapeClass();\n        this.registeredShapes.set(shapeName, shape);\n    }\n    sculpt(eventData, points) {\n        const config = this.configuration;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        this.sculptData = {\n            mousePoint: eventData.currentPoints.world,\n            mouseCanvasPoint: eventData.currentPoints.canvas,\n            points,\n            maxSpacing: cursorShape.getMaxSpacing(config.minSpacing),\n            element: element,\n        };\n        const pushedHandles = cursorShape.pushHandles(viewport, this.sculptData);\n        if (pushedHandles.first !== undefined) {\n            this.insertNewHandles(pushedHandles);\n        }\n    }\n    interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing) {\n        const { element } = this.sculptData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const nextHandleIndex = contourIndex(i + 1, points.length);\n        const currentCanvasPoint = viewport.worldToCanvas(points[i]);\n        const nextCanvasPoint = viewport.worldToCanvas(points[nextHandleIndex]);\n        const distanceToNextHandle = point.distanceToPoint(currentCanvasPoint, nextCanvasPoint);\n        if (distanceToNextHandle > maxSpacing) {\n            indicesToInsertAfter.push(i);\n        }\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine, viewport } = enabledElement;\n        this.commonData.viewportIdsToRender = [viewport.id];\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n        this.commonData.canvasLocation = eventData.currentPoints.canvas;\n        if (this.isActive) {\n            activeAnnotation.highlighted = true;\n        }\n        else {\n            const cursorShape = this.registeredShapes.get(this.selectedShape);\n            const canvasCoords = eventData.currentPoints.canvas;\n            cursorShape.updateToolSize(canvasCoords, viewport, activeAnnotation);\n        }\n        triggerAnnotationRenderForViewportIds(this.commonData.viewportIdsToRender);\n    }\n    filterSculptableAnnotationsForElement(element) {\n        const config = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const sculptableAnnotations = [];\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n        config.referencedToolNames.forEach((referencedToolName) => {\n            const annotations = getAnnotations(referencedToolName, element);\n            if (annotations) {\n                sculptableAnnotations.push(...annotations);\n            }\n        });\n        return toolInstance.filterInteractableAnnotationsForElement(element, sculptableAnnotations);\n    }\n    configureToolSize(evt) {\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.configureToolSize(evt);\n    }\n    insertNewHandles(pushedHandles) {\n        const indicesToInsertAfter = this.findNewHandleIndices(pushedHandles);\n        let newIndexModifier = 0;\n        for (let i = 0; i < indicesToInsertAfter?.length; i++) {\n            const insertIndex = indicesToInsertAfter[i] + 1 + newIndexModifier;\n            this.insertHandleRadially(insertIndex);\n            newIndexModifier++;\n        }\n    }\n    findNewHandleIndices(pushedHandles) {\n        const { points, maxSpacing } = this.sculptData;\n        const indicesToInsertAfter = [];\n        for (let i = pushedHandles.first; i <= pushedHandles.last; i++) {\n            this.interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing);\n        }\n        return indicesToInsertAfter;\n    }\n    insertHandleRadially(insertIndex) {\n        const { points } = this.sculptData;\n        if (insertIndex > points.length - 1 &&\n            this.commonData.isEditingOpenContour) {\n            return;\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        const previousIndex = insertIndex - 1;\n        const nextIndex = contourIndex(insertIndex, points.length);\n        const insertPosition = cursorShape.getInsertPosition(previousIndex, nextIndex, this.sculptData);\n        const handleData = insertPosition;\n        points.splice(insertIndex, 0, handleData);\n    }\n    selectFreehandTool(eventData) {\n        const closestAnnotationUID = this.getClosestFreehandToolOnElement(eventData);\n        if (closestAnnotationUID === undefined) {\n            return;\n        }\n        this.commonData.activeAnnotationUID = closestAnnotationUID;\n    }\n    getClosestFreehandToolOnElement(eventData) {\n        const { element } = eventData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const config = this.configuration;\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const canvasPoints = eventData.currentPoints.canvas;\n        const closest = {\n            distance: Infinity,\n            toolIndex: undefined,\n            annotationUID: undefined,\n        };\n        for (let i = 0; i < annotations?.length; i++) {\n            if (annotations[i].isLocked || !annotations[i].isVisible) {\n                continue;\n            }\n            const distanceFromTool = distancePointToContour(viewport, annotations[i], canvasPoints);\n            if (distanceFromTool === -1) {\n                continue;\n            }\n            if (distanceFromTool < closest.distance) {\n                closest.distance = distanceFromTool;\n                closest.toolIndex = i;\n                closest.annotationUID = annotations[i].annotationUID;\n            }\n        }\n        this.commonData.isEditingOpenContour =\n            !annotations[closest.toolIndex].data.contour.closed;\n        config.referencedToolName =\n            annotations[closest.toolIndex].metadata.toolName;\n        return closest.annotationUID;\n    }\n    activateModify(element) {\n        element.addEventListener(Events.MOUSE_UP, this.endCallback);\n        element.addEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.addEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.addEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.addEventListener(Events.TOUCH_END, this.endCallback);\n        element.addEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    deactivateModify(element) {\n        element.removeEventListener(Events.MOUSE_UP, this.endCallback);\n        element.removeEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.removeEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.removeEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.removeEventListener(Events.TOUCH_END, this.endCallback);\n        element.removeEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    setToolShape(toolShape) {\n        this.selectedShape =\n            this.registeredShapes.get(toolShape) ?? CircleSculptCursor.shapeName;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const viewportIdsToRender = this.commonData.viewportIdsToRender;\n        if (!this.commonData.canvasLocation ||\n            this.mode !== ToolModes.Active ||\n            !viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        let color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Default, this.mode);\n        if (this.isActive) {\n            color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Highlighted, this.mode);\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.renderShape(svgDrawingHelper, this.commonData.canvasLocation, {\n            color,\n        });\n    }\n}\nexport const contourIndex = (i, length) => {\n    return (i + length) % length;\n};\nSculptorTool.toolName = 'SculptorTool';\nexport default SculptorTool;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawPath } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { pointToString } from '../utilities/pointToString';\nimport { polyDataUtils } from '../utilities';\nclass SegmentationIntersectionTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            opacity: 0.5,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._init = () => {\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn(this.getToolName() + 'Tool: No viewports found');\n                return;\n            }\n            const firstViewport = getRenderingEngine(viewportsInfo[0].renderingEngineId)?.getViewport(viewportsInfo[0].viewportId);\n            if (!firstViewport) {\n                return;\n            }\n            const frameOfReferenceUID = firstViewport.getFrameOfReferenceUID();\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const actorsWorldPointsMap = new Map();\n                calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo);\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        actorsWorldPointsMap,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            let renderStatus = false;\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const actorsWorldPointsMap = annotation.data.actorsWorldPointsMap;\n            calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n            const actorEntries = viewport.getActors();\n            const cacheId = getCacheId(viewport);\n            actorEntries.forEach((actorEntry) => {\n                if (!actorEntry?.clippingFilter) {\n                    return;\n                }\n                const actorWorldPointMap = actorsWorldPointsMap.get(actorEntry.uid);\n                if (!actorWorldPointMap) {\n                    return;\n                }\n                if (!actorWorldPointMap.get(cacheId)) {\n                    return;\n                }\n                let polyLineIdx = 1;\n                const { worldPointsSet, color } = actorWorldPointMap.get(cacheId);\n                for (let i = 0; i < worldPointsSet.length; i++) {\n                    const worldPoints = worldPointsSet[i];\n                    const canvasPoints = worldPoints.map((point) => viewport.worldToCanvas(point));\n                    const options = {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: this.configuration.opacity,\n                        closePath: true,\n                        lineWidth: 2,\n                    };\n                    const polyLineUID = actorEntry.uid + '#' + polyLineIdx;\n                    drawPath(svgDrawingHelper, annotationUID, polyLineUID, canvasPoints, options);\n                    polyLineIdx++;\n                }\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nfunction calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo) {\n    viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n        const viewport = getRenderingEngine(renderingEngineId)?.getViewport(viewportId);\n        calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n    });\n}\nfunction calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport) {\n    const actorEntries = viewport.getActors();\n    const cacheId = getCacheId(viewport);\n    actorEntries.forEach((actorEntry) => {\n        if (!actorEntry?.clippingFilter) {\n            return;\n        }\n        let actorWorldPointsMap = actorsWorldPointsMap.get(actorEntry.uid);\n        if (!actorWorldPointsMap) {\n            actorWorldPointsMap = new Map();\n            actorsWorldPointsMap.set(actorEntry.uid, actorWorldPointsMap);\n        }\n        if (!actorWorldPointsMap.get(cacheId)) {\n            const polyData = actorEntry.clippingFilter.getOutputData();\n            const worldPointsSet = polyDataUtils.getPolyDataPoints(polyData);\n            if (!worldPointsSet) {\n                return;\n            }\n            const colorArray = actorEntry.actor.getProperty().getColor();\n            const color = colorToString(colorArray);\n            actorWorldPointsMap.set(cacheId, { worldPointsSet, color });\n        }\n    });\n}\nfunction getCacheId(viewport) {\n    const { viewPlaneNormal } = viewport.getCamera();\n    const imageIndex = viewport.getCurrentImageIdIndex();\n    return `${viewport.id}-${pointToString(viewPlaneNormal)}-${imageIndex}`;\n}\nfunction colorToString(colorArray) {\n    function colorComponentToString(component) {\n        let componentString = Math.floor(component * 255).toString(16);\n        if (componentString.length === 1) {\n            componentString = '0' + componentString;\n        }\n        return componentString;\n    }\n    return ('#' +\n        colorComponentToString(colorArray[0]) +\n        colorComponentToString(colorArray[1]) +\n        colorComponentToString(colorArray[2]));\n}\nfunction removeExtraPoints(viewport, worldPointsSet) {\n    return worldPointsSet.map((worldPoints) => {\n        const canvasPoints = worldPoints.map((point) => {\n            const canvasPoint = viewport.worldToCanvas(point);\n            return [Math.floor(canvasPoint[0]), Math.floor(canvasPoint[1])];\n        });\n        let lastPoint;\n        const newWorldPoints = [];\n        let newCanvasPoints = [];\n        for (let i = 0; i < worldPoints.length; i++) {\n            if (lastPoint) {\n                if (distanceToPoint(lastPoint, canvasPoints[i]) > 0) {\n                    newWorldPoints.push(worldPoints[i]);\n                    newCanvasPoints.push(canvasPoints[i]);\n                }\n            }\n            lastPoint = canvasPoints[i];\n        }\n        const firstPoint = newCanvasPoints[0];\n        for (let j = Math.min(30, newCanvasPoints.length); j < newCanvasPoints.length; j++) {\n            if (distanceToPoint(firstPoint, newCanvasPoints[j]) < 0.5) {\n                newCanvasPoints = newCanvasPoints.slice(0, j);\n                return newWorldPoints.slice(0, j);\n            }\n        }\n        return newWorldPoints;\n    });\n}\nSegmentationIntersectionTool.toolName = 'SegmentationIntersection';\nexport default SegmentationIntersectionTool;\n","import { getEnabledElementByIds, getEnabledElement, VolumeViewport, BaseVolumeViewport, utilities, } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass StackScrollTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            invert: false,\n            debounceIfNotLoaded: true,\n            loop: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.deltaY = 1;\n    }\n    mouseWheelCallback(evt) {\n        this._scroll(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        this._scrollDrag(evt);\n    }\n    _scrollDrag(evt) {\n        const { deltaPoints, viewportId, renderingEngineId } = evt.detail;\n        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n        const { debounceIfNotLoaded, invert, loop } = this.configuration;\n        const deltaPointY = deltaPoints.canvas[1];\n        let volumeId;\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n        }\n        const pixelsPerImage = this._getPixelPerImage(viewport);\n        const deltaY = deltaPointY + this.deltaY;\n        if (!pixelsPerImage) {\n            return;\n        }\n        if (Math.abs(deltaY) >= pixelsPerImage) {\n            const imageIdIndexOffset = Math.round(deltaY / pixelsPerImage);\n            utilities.scroll(viewport, {\n                delta: invert ? -imageIdIndexOffset : imageIdIndexOffset,\n                volumeId,\n                debounceLoading: debounceIfNotLoaded,\n                loop: loop,\n            });\n            this.deltaY = deltaY % pixelsPerImage;\n        }\n        else {\n            this.deltaY = deltaY;\n        }\n    }\n    _scroll(evt) {\n        const { wheel, element } = evt.detail;\n        const { direction } = wheel;\n        const { invert } = this.configuration;\n        const { viewport } = getEnabledElement(element);\n        const delta = direction * (invert ? -1 : 1);\n        utilities.scroll(viewport, {\n            delta,\n            debounceLoading: this.configuration.debounceIfNotLoaded,\n            loop: this.configuration.loop,\n            volumeId: viewport instanceof BaseVolumeViewport\n                ? viewport.getVolumeId()\n                : undefined,\n            scrollSlabs: this.configuration.scrollSlabs,\n        });\n    }\n    _getPixelPerImage(viewport) {\n        const { element } = viewport;\n        const numberOfSlices = viewport.getNumberOfSlices();\n        return Math.max(2, element.offsetHeight / Math.max(numberOfSlices, 8));\n    }\n}\nStackScrollTool.toolName = 'StackScroll';\nexport default StackScrollTool;\n","import vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { Events } from '../enums';\nimport { eventTarget, getEnabledElement, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass TrackballRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            rotateIncrementDegrees: 2,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this._hasResolutionChanged = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const actorEntry = viewport.getDefaultActor();\n            const actor = actorEntry.actor;\n            const mapper = actor.getMapper();\n            const hasSampleDistance = 'getSampleDistance' in mapper || 'getCurrentSampleDistance' in mapper;\n            if (!hasSampleDistance) {\n                return true;\n            }\n            const originalSampleDistance = mapper.getSampleDistance();\n            if (!this._hasResolutionChanged) {\n                mapper.setSampleDistance(originalSampleDistance * 2);\n                this._hasResolutionChanged = true;\n                if (this.cleanUp !== null) {\n                    document.removeEventListener('mouseup', this.cleanUp);\n                }\n                this.cleanUp = () => {\n                    mapper.setSampleDistance(originalSampleDistance);\n                    viewport.render();\n                    this._hasResolutionChanged = false;\n                };\n                document.addEventListener('mouseup', this.cleanUp, { once: true });\n            }\n            return true;\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.onSetToolActive = () => {\n            const subscribeToElementResize = () => {\n                const viewportsInfo = this._getViewportsInfo();\n                viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                    if (!this._resizeObservers.has(viewportId)) {\n                        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId) || { viewport: null };\n                        if (!viewport) {\n                            return;\n                        }\n                        const { element } = viewport;\n                        const resizeObserver = new ResizeObserver(() => {\n                            const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                            if (!element) {\n                                return;\n                            }\n                            const { viewport } = element;\n                            const viewPresentation = viewport.getViewPresentation();\n                            viewport.resetCamera();\n                            viewport.setViewPresentation(viewPresentation);\n                            viewport.render();\n                        });\n                        resizeObserver.observe(element);\n                        this._resizeObservers.set(viewportId, resizeObserver);\n                    }\n                });\n            };\n            subscribeToElementResize();\n            this._viewportAddedListener = (evt) => {\n                if (evt.detail.toolGroupId === this.toolGroupId) {\n                    subscribeToElementResize();\n                }\n            };\n            eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n        };\n        this.onSetToolDisabled = () => {\n            this._resizeObservers.forEach((resizeObserver, viewportId) => {\n                resizeObserver.disconnect();\n                this._resizeObservers.delete(viewportId);\n            });\n            if (this._viewportAddedListener) {\n                eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n                this._viewportAddedListener = null;\n            }\n        };\n        this.rotateCamera = (viewport, centerWorld, axis, angle) => {\n            const vtkCamera = viewport.getVtkActiveCamera();\n            const viewUp = vtkCamera.getViewUp();\n            const focalPoint = vtkCamera.getFocalPoint();\n            const position = vtkCamera.getPosition();\n            const newPosition = [0, 0, 0];\n            const newFocalPoint = [0, 0, 0];\n            const newViewUp = [0, 0, 0];\n            const transform = mat4.identity(new Float32Array(16));\n            mat4.translate(transform, transform, centerWorld);\n            mat4.rotate(transform, transform, angle, axis);\n            mat4.translate(transform, transform, [\n                -centerWorld[0],\n                -centerWorld[1],\n                -centerWorld[2],\n            ]);\n            vec3.transformMat4(newPosition, position, transform);\n            vec3.transformMat4(newFocalPoint, focalPoint, transform);\n            mat4.identity(transform);\n            mat4.rotate(transform, transform, angle, axis);\n            vec3.transformMat4(newViewUp, viewUp, transform);\n            viewport.setCamera({\n                position: newPosition,\n                viewUp: newViewUp,\n                focalPoint: newFocalPoint,\n            });\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, lastPoints } = evt.detail;\n        const currentPointsCanvas = currentPoints.canvas;\n        const lastPointsCanvas = lastPoints.canvas;\n        const { rotateIncrementDegrees } = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const normalizedPosition = [\n            currentPointsCanvas[0] / width,\n            currentPointsCanvas[1] / height,\n        ];\n        const normalizedPreviousPosition = [\n            lastPointsCanvas[0] / width,\n            lastPointsCanvas[1] / height,\n        ];\n        const center = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(center);\n        const normalizedCenter = [0.5, 0.5];\n        const radsq = (1.0 + Math.abs(normalizedCenter[0])) ** 2.0;\n        const op = [normalizedPreviousPosition[0], 0, 0];\n        const oe = [normalizedPosition[0], 0, 0];\n        const opsq = op[0] ** 2;\n        const oesq = oe[0] ** 2;\n        const lop = opsq > radsq ? 0 : Math.sqrt(radsq - opsq);\n        const loe = oesq > radsq ? 0 : Math.sqrt(radsq - oesq);\n        const nop = [op[0], 0, lop];\n        vtkMath.normalize(nop);\n        const noe = [oe[0], 0, loe];\n        vtkMath.normalize(noe);\n        const dot = vtkMath.dot(nop, noe);\n        if (Math.abs(dot) > 0.0001) {\n            const angleX = -2 *\n                Math.acos(vtkMath.clampValue(dot, -1.0, 1.0)) *\n                Math.sign(normalizedPosition[0] - normalizedPreviousPosition[0]) *\n                rotateIncrementDegrees;\n            const upVec = camera.viewUp;\n            const atV = camera.viewPlaneNormal;\n            const rightV = [0, 0, 0];\n            const forwardV = [0, 0, 0];\n            vtkMath.cross(upVec, atV, rightV);\n            vtkMath.normalize(rightV);\n            vtkMath.cross(atV, rightV, forwardV);\n            vtkMath.normalize(forwardV);\n            vtkMath.normalize(upVec);\n            this.rotateCamera(viewport, centerWorld, forwardV, angleX);\n            const angleY = (normalizedPreviousPosition[1] - normalizedPosition[1]) *\n                rotateIncrementDegrees;\n            this.rotateCamera(viewport, centerWorld, rightV, angleY);\n            viewport.render();\n        }\n    }\n}\nTrackballRotateTool.toolName = 'TrackballRotate';\nexport default TrackballRotateTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nconst DIRECTIONS = {\n    X: [1, 0, 0],\n    Y: [0, 1, 0],\n    Z: [0, 0, 1],\n    CUSTOM: [],\n};\nclass VolumeRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            direction: DIRECTIONS.Z,\n            rotateIncrementDegrees: 30,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseWheelCallback(evt) {\n        const { element, wheel } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { direction, rotateIncrementDegrees } = this.configuration;\n        const camera = viewport.getCamera();\n        const { viewUp, position, focalPoint } = camera;\n        const { direction: deltaY } = wheel;\n        const [cx, cy, cz] = focalPoint;\n        const [ax, ay, az] = direction;\n        const angle = (deltaY * (rotateIncrementDegrees * Math.PI)) / 180;\n        const newPosition = [0, 0, 0];\n        const newFocalPoint = [0, 0, 0];\n        const newViewUp = [0, 0, 0];\n        const transform = mat4.identity(new Float32Array(16));\n        mat4.translate(transform, transform, [cx, cy, cz]);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        mat4.translate(transform, transform, [-cx, -cy, -cz]);\n        vec3.transformMat4(newPosition, position, transform);\n        vec3.transformMat4(newFocalPoint, focalPoint, transform);\n        mat4.identity(transform);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        vec3.transformMat4(newViewUp, viewUp, transform);\n        viewport.setCamera({\n            position: newPosition,\n            viewUp: newViewUp,\n            focalPoint: newFocalPoint,\n        });\n        viewport.render();\n    }\n}\nVolumeRotateTool.toolName = 'VolumeRotateMouseWheel';\nexport default VolumeRotateTool;\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawRect as drawRectSvg } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { windowLevel } from '../utilities/voi';\nclass WindowLevelRegionTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minWindowWidth: 10,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            removeAnnotation(annotation.annotationUID);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationCompleted(annotation);\n            this.applyWindowLevelRegion(annotation, element);\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            const DEFAULT_HANDLE_INDEX = 3;\n            points[DEFAULT_HANDLE_INDEX] = [...worldPos];\n            const bottomLeftCanvas = worldToCanvas(points[0]);\n            const topRightCanvas = worldToCanvas(points[3]);\n            const bottomRightCanvas = [\n                topRightCanvas[0],\n                bottomLeftCanvas[1],\n            ];\n            const topLeftCanvas = [\n                bottomLeftCanvas[0],\n                topRightCanvas[1],\n            ];\n            const bottomRightWorld = canvasToWorld(bottomRightCanvas);\n            const topLeftWorld = canvasToWorld(topLeftCanvas);\n            points[1] = bottomRightWorld;\n            points[2] = topLeftWorld;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const dataId = `${annotationUID}-rect`;\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this.applyWindowLevelRegion = (annotation, element) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const imageData = windowLevel.extractWindowLevelRegionToolData(viewport);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const startCanvas = canvasCoordinates[0];\n            const endCanvas = canvasCoordinates[3];\n            let left = Math.min(startCanvas[0], endCanvas[0]);\n            let top = Math.min(startCanvas[1], endCanvas[1]);\n            let width = Math.abs(startCanvas[0] - endCanvas[0]);\n            let height = Math.abs(startCanvas[1] - endCanvas[1]);\n            left = utilities.clip(left, 0, imageData.width);\n            top = utilities.clip(top, 0, imageData.height);\n            width = Math.floor(Math.min(width, Math.abs(imageData.width - left)));\n            height = Math.floor(Math.min(height, Math.abs(imageData.height - top)));\n            const pixelLuminanceData = windowLevel.getLuminanceFromRegion(imageData, Math.round(left), Math.round(top), width, height);\n            const minMaxMean = windowLevel.calculateMinMaxMean(pixelLuminanceData, imageData.minPixelValue, imageData.maxPixelValue);\n            if (this.configuration.minWindowWidth === undefined) {\n                this.configuration.minWindowWidth = 10;\n            }\n            const windowWidth = Math.max(Math.abs(minMaxMean.max - minMaxMean.min), this.configuration.minWindowWidth);\n            const windowCenter = minMaxMean.mean;\n            const voiLutFunction = viewport.getProperties().VOILUTFunction;\n            const voiRange = utilities.windowLevel.toLowHighRange(windowWidth, windowCenter, voiLutFunction);\n            viewport.setProperties({ voiRange });\n            viewport.render();\n        };\n        this.cancel = () => {\n            return null;\n        };\n        this.isPointNearTool = () => {\n            return null;\n        };\n        this.toolSelectedCallback = () => {\n            return null;\n        };\n        this.handleSelectedCallback = () => {\n            return null;\n        };\n        this._activateModify = () => {\n            return null;\n        };\n        this._deactivateModify = () => {\n            return null;\n        };\n    }\n}\nWindowLevelRegionTool.toolName = 'WindowLevelRegion';\nexport default WindowLevelRegionTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport, cache, utilities, } from '@cornerstonejs/core';\nconst DEFAULT_MULTIPLIER = 4;\nconst DEFAULT_IMAGE_DYNAMIC_RANGE = 1024;\nconst PT = 'PT';\nclass WindowLevelTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this._getImageDynamicRangeFromMiddleSlice = (scalarData, dimensions) => {\n            const middleSliceIndex = Math.floor(dimensions[2] / 2);\n            const frameLength = dimensions[0] * dimensions[1];\n            let bytesPerVoxel;\n            let TypedArrayConstructor;\n            if (scalarData instanceof Float32Array) {\n                bytesPerVoxel = 4;\n                TypedArrayConstructor = Float32Array;\n            }\n            else if (scalarData instanceof Uint8Array) {\n                bytesPerVoxel = 1;\n                TypedArrayConstructor = Uint8Array;\n            }\n            else if (scalarData instanceof Uint16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Uint16Array;\n            }\n            else if (scalarData instanceof Int16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Int16Array;\n            }\n            const buffer = scalarData.buffer;\n            const byteOffset = middleSliceIndex * frameLength * bytesPerVoxel;\n            const frame = new TypedArrayConstructor(buffer, byteOffset, frameLength);\n            const { max, min } = this._getMinMax(frame, frameLength);\n            return max - min;\n        };\n    }\n    touchDragCallback(evt) {\n        this.mouseDragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let volumeId, lower, upper, modality, newRange, viewportsContainingVolumeUID;\n        let isPreScaled = false;\n        const properties = viewport.getProperties();\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n            viewportsContainingVolumeUID =\n                utilities.getViewportsWithVolumeId(volumeId);\n            ({ lower, upper } = properties.voiRange);\n            const volume = cache.getVolume(volumeId);\n            if (!volume) {\n                throw new Error('Volume not found ' + volumeId);\n            }\n            modality = volume.metadata.Modality;\n            isPreScaled = volume.scaling && Object.keys(volume.scaling).length > 0;\n        }\n        else if (properties.voiRange) {\n            modality = viewport.modality;\n            ({ lower, upper } = properties.voiRange);\n            const { preScale = { scaled: false } } = viewport.getImageData?.() || {};\n            isPreScaled =\n                preScale.scaled && preScale.scalingParameters?.suvbw !== undefined;\n        }\n        else {\n            throw new Error('Viewport is not a valid type');\n        }\n        if (modality === PT && isPreScaled) {\n            newRange = this.getPTScaledNewRange({\n                deltaPointsCanvas: deltaPoints.canvas,\n                lower,\n                upper,\n                clientHeight: element.clientHeight,\n                isPreScaled,\n                viewport,\n                volumeId,\n            });\n        }\n        else {\n            newRange = this.getNewRange({\n                viewport,\n                deltaPointsCanvas: deltaPoints.canvas,\n                volumeId,\n                lower,\n                upper,\n            });\n        }\n        if (newRange.lower >= newRange.upper) {\n            return;\n        }\n        viewport.setProperties({\n            voiRange: newRange,\n        });\n        viewport.render();\n        if (viewport instanceof VolumeViewport) {\n            viewportsContainingVolumeUID.forEach((vp) => {\n                if (viewport !== vp) {\n                    vp.render();\n                }\n            });\n            return;\n        }\n    }\n    getPTScaledNewRange({ deltaPointsCanvas, lower, upper, clientHeight, viewport, volumeId, isPreScaled, }) {\n        let multiplier = DEFAULT_MULTIPLIER;\n        if (isPreScaled) {\n            multiplier = 5 / clientHeight;\n        }\n        else {\n            multiplier =\n                this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n                    DEFAULT_MULTIPLIER;\n        }\n        const deltaY = deltaPointsCanvas[1];\n        const wcDelta = deltaY * multiplier;\n        upper -= wcDelta;\n        upper = isPreScaled ? Math.max(upper, 0.1) : upper;\n        return { lower, upper };\n    }\n    getNewRange({ viewport, deltaPointsCanvas, volumeId, lower, upper }) {\n        const multiplier = this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n            DEFAULT_MULTIPLIER;\n        const wwDelta = deltaPointsCanvas[0] * multiplier;\n        const wcDelta = deltaPointsCanvas[1] * multiplier;\n        let { windowWidth, windowCenter } = utilities.windowLevel.toWindowLevel(lower, upper);\n        windowWidth += wwDelta;\n        windowCenter += wcDelta;\n        windowWidth = Math.max(windowWidth, 1);\n        const voiLutFunction = viewport.getProperties().VOILUTFunction;\n        return utilities.windowLevel.toLowHighRange(windowWidth, windowCenter, voiLutFunction);\n    }\n    _getMultiplierFromDynamicRange(viewport, volumeId) {\n        let imageDynamicRange;\n        if (volumeId) {\n            const imageVolume = cache.getVolume(volumeId);\n            const { voxelManager } = viewport.getImageData();\n            const middleSlicePixelData = voxelManager.getMiddleSliceData();\n            const calculatedDynamicRange = middleSlicePixelData.reduce((acc, pixel) => {\n                return [Math.min(acc[0], pixel), Math.max(acc[1], pixel)];\n            }, [Infinity, -Infinity]);\n            const BitsStored = imageVolume?.metadata?.BitsStored;\n            const metadataDynamicRange = BitsStored ? 2 ** BitsStored : Infinity;\n            imageDynamicRange = Math.min(calculatedDynamicRange, metadataDynamicRange);\n        }\n        else {\n            imageDynamicRange = this._getImageDynamicRangeFromViewport(viewport);\n        }\n        const ratio = imageDynamicRange / DEFAULT_IMAGE_DYNAMIC_RANGE;\n        return ratio > 1 ? Math.round(ratio) : ratio;\n    }\n    _getImageDynamicRangeFromViewport(viewport) {\n        const { imageData, voxelManager } = viewport.getImageData();\n        if (voxelManager?.getRange) {\n            const range = voxelManager.getRange();\n            return range[1] - range[0];\n        }\n        const dimensions = imageData.getDimensions();\n        if (imageData.getRange) {\n            const imageDataRange = imageData.getRange();\n            return imageDataRange[1] - imageDataRange[0];\n        }\n        let scalarData;\n        if (imageData.getScalarData) {\n            scalarData = imageData.getScalarData();\n        }\n        else {\n            scalarData = imageData.getPointData().getScalars().getData();\n        }\n        if (dimensions[2] !== 1) {\n            return this._getImageDynamicRangeFromMiddleSlice(scalarData, dimensions);\n        }\n        let range;\n        if (scalarData.getRange) {\n            range = scalarData.getRange();\n        }\n        else {\n            const { min, max } = this._getMinMax(scalarData, scalarData.length);\n            range = [min, max];\n        }\n        return range[1] - range[0];\n    }\n    _getMinMax(frame, frameLength) {\n        let min = Infinity;\n        let max = -Infinity;\n        for (let i = 0; i < frameLength; i++) {\n            const voxel = frame[i];\n            if (voxel < min) {\n                min = voxel;\n            }\n            if (voxel > max) {\n                max = voxel;\n            }\n        }\n        return { max, min };\n    }\n}\nWindowLevelTool.toolName = 'WindowLevel';\nexport default WindowLevelTool;\n","import { vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass ZoomTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            zoomToCenter: false,\n            minZoomScale: 0.001,\n            maxZoomScale: 3000,\n            pinchToZoom: true,\n            pan: true,\n            invert: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const camera = enabledElement.viewport.getCamera();\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            return false;\n        };\n        this.preTouchStartCallback = (evt) => {\n            if (!this.configuration.pinchToZoom) {\n                return this.preMouseDownCallback(evt);\n            }\n        };\n        this._dragParallelProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { parallelScale, focalPoint, position } = camera;\n            const zoomScale = 5 / size[1];\n            const k = deltaY * zoomScale * (this.configuration.invert ? -1 : 1);\n            const parallelScaleToSet = (1.0 - k) * parallelScale;\n            let focalPointToSet = focalPoint;\n            let positionToSet = position;\n            if (!this.configuration.zoomToCenter) {\n                const distanceToCanvasCenter = vec3.distance(focalPoint, this.initialMousePosWorld);\n                positionToSet = vec3.scaleAndAdd(vec3.create(), position, this.dirVec, -distanceToCanvasCenter * k);\n                focalPointToSet = vec3.scaleAndAdd(vec3.create(), focalPoint, this.dirVec, -distanceToCanvasCenter * k);\n            }\n            const imageData = viewport.getImageData();\n            let spacing = [1, 1, 1];\n            if (imageData) {\n                spacing = imageData.spacing;\n            }\n            const { minZoomScale, maxZoomScale } = this.configuration;\n            const t = element.clientHeight * spacing[1] * 0.5;\n            const scale = t / parallelScaleToSet;\n            let cappedParallelScale = parallelScaleToSet;\n            let thresholdExceeded = false;\n            if (imageData) {\n                if (scale < minZoomScale) {\n                    cappedParallelScale = t / minZoomScale;\n                    thresholdExceeded = true;\n                }\n                else if (scale >= maxZoomScale) {\n                    cappedParallelScale = t / maxZoomScale;\n                    thresholdExceeded = true;\n                }\n            }\n            viewport.setCamera({\n                parallelScale: cappedParallelScale,\n                focalPoint: thresholdExceeded ? focalPoint : focalPointToSet,\n                position: thresholdExceeded ? position : positionToSet,\n            });\n        };\n        this._dragPerspectiveProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { position, focalPoint, viewPlaneNormal } = camera;\n            const distance = vtkMath.distance2BetweenPoints(position, focalPoint);\n            const zoomScale = Math.sqrt(distance) / size[1];\n            const directionOfProjection = [\n                -viewPlaneNormal[0],\n                -viewPlaneNormal[1],\n                -viewPlaneNormal[2],\n            ];\n            const k = this.configuration.invert\n                ? deltaY / zoomScale\n                : deltaY * zoomScale;\n            let tmp = k * directionOfProjection[0];\n            position[0] += tmp;\n            focalPoint[0] += tmp;\n            tmp = k * directionOfProjection[1];\n            position[1] += tmp;\n            focalPoint[1] += tmp;\n            tmp = k * directionOfProjection[2];\n            position[2] += tmp;\n            focalPoint[2] += tmp;\n            viewport.setCamera({ position, focalPoint });\n        };\n        this.initialMousePosWorld = [0, 0, 0];\n        this.dirVec = [0, 0, 0];\n        if (this.configuration.pinchToZoom) {\n            this.touchDragCallback = this._pinchCallback.bind(this);\n        }\n        else {\n            this.touchDragCallback = this._dragCallback.bind(this);\n        }\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _pinchCallback(evt) {\n        const pointsList = evt.detail\n            .currentPointsList;\n        if (pointsList.length > 1) {\n            const { element, currentPoints } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const worldPos = currentPoints.world;\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            if (camera.parallelProjection) {\n                this._dragParallelProjection(evt, viewport, camera, true);\n            }\n            else {\n                this._dragPerspectiveProjection(evt, viewport, camera, true);\n            }\n            viewport.render();\n        }\n        if (this.configuration.pan) {\n            this._panCallback(evt);\n        }\n    }\n    _dragCallback(evt) {\n        const { element } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        if (camera.parallelProjection) {\n            this._dragParallelProjection(evt, viewport, camera);\n        }\n        else {\n            this._dragPerspectiveProjection(evt, viewport, camera);\n        }\n        viewport.render();\n    }\n    _panCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nZoomTool.toolName = 'Zoom';\nexport default ZoomTool;\n","import { ChangeTypes, Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nclass AngleTool extends AnnotationTool {\n    static { this.toolName = 'Angle'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2, point3] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            if (!point3) {\n                return false;\n            }\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const line2 = {\n                start: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n                end: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.angleStartedNotYetCompleted && data.handles.points.length === 2) {\n                this.editData.handleIndex = 2;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (annotation.invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.angleStartedNotYetCompleted = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotation.annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                let lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length !== 3) {\n                    return renderStatus;\n                }\n                lineUID = '2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], canvasCoordinates[2], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, instance, viewport, } = this.hydrateBase(AngleTool, enabledElement, points, options);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 3) {\n            return;\n        }\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const worldPos3 = data.handles.points[2];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const angle = angleBetweenLines([worldPos1, worldPos2], [worldPos2, worldPos3]);\n            const { dimensions, imageData } = this.getTargetImageData(targetId);\n            this.isHandleOutsideImage = [worldPos1, worldPos2, worldPos3]\n                .map((worldPos) => csUtils.transformWorldToIndex(imageData, worldPos))\n                .some((index) => !csUtils.indexWithinDimensions(index, dimensions));\n            cachedStats[targetId] = {\n                angle: isNaN(angle) ? 'Incomplete Angle' : angle,\n            };\n        }\n        const invalidated = annotation.invalidated;\n        annotation.invalidated = false;\n        if (invalidated) {\n            triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n        }\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    if (isNaN(angle)) {\n        return [`${angle}`];\n    }\n    const textLines = [\n        `${csUtils.roundNumber(angle)} ${String.fromCharCode(176)}`,\n    ];\n    return textLines;\n}\nexport default AngleTool;\n","import { ChangeTypes, Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawArrow as drawArrowSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { setAnnotationLabel } from '../../utilities';\nclass ArrowAnnotateTool extends AnnotationTool {\n    static { this.toolName = 'ArrowAnnotate'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            getTextCallback,\n            changeTextCallback,\n            preventHandleOutsideImage: false,\n            arrowFirst: true,\n            arrowHeadStyle: 'legacy',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const { arrowFirst } = this.configuration;\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    text: '',\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        arrowFirst,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved, movingTextBox, } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            if (newAnnotation) {\n                this.configuration.getTextCallback((text) => {\n                    if (!text) {\n                        removeAnnotation(annotation.annotationUID);\n                        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                        this.editData = null;\n                        this.isDrawing = false;\n                        return;\n                    }\n                    annotation.data.text = text;\n                    triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n                    triggerAnnotationCompleted(annotation);\n                    this.createMemo(element, annotation, { newAnnotation: !!this.memo });\n                    setAnnotationLabel(annotation, element, text);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                });\n            }\n            else if (!movingTextBox) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n            this.doneEditMemo();\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, newAnnotation, } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (annotation.invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n        };\n        this.touchTapCallback = (evt) => {\n            if (evt.detail.taps == 2) {\n                this.doubleClickCallback(evt);\n            }\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.editData = null;\n            this.isDrawing = false;\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles, text } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, markerSize } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineWidth,\n                    });\n                }\n                const arrowUID = '1';\n                if (this.configuration.arrowFirst) {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[1], canvasCoordinates[0], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                        viaMarker: this.configuration.arrowHeadStyle !== 'legacy',\n                        markerSize,\n                    });\n                }\n                else {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                        viaMarker: this.configuration.arrowHeadStyle !== 'legacy',\n                        markerSize,\n                    });\n                }\n                renderStatus = true;\n                if (!text) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, [text], textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n    }\n    static { this.hydrate = (viewportId, points, text, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, instance, viewport, } = this.hydrateBase(ArrowAnnotateTool, enabledElement, points, options);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                text: text || '',\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const enabledElement = getEnabledElement(element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nexport default ArrowAnnotateTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils, getEnabledElementByViewportId, utilities, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawLine as drawLineSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { ChangeTypes, Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as lineSegment from '../../utilities/math/line';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nconst { transformWorldToIndex } = csUtils;\nclass BidirectionalTool extends AnnotationTool {\n    static { this.toolName = 'Bidirectional'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            let canvasPoint1 = viewport.worldToCanvas(points[0]);\n            let canvasPoint2 = viewport.worldToCanvas(points[1]);\n            let line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            let distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            canvasPoint1 = viewport.worldToCanvas(points[2]);\n            canvasPoint2 = viewport.worldToCanvas(points[3]);\n            line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const data = annotation.data;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            hideElementCursor(element);\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            this.doneEditMemo();\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            if (this.editData.handleIndex !== undefined) {\n                const { points } = data.handles;\n                const firstLineSegmentLength = vec3.distance(points[0], points[1]);\n                const secondLineSegmentLength = vec3.distance(points[2], points[3]);\n                if (secondLineSegmentLength > firstLineSegmentLength) {\n                    const longAxis = [[...points[2]], [...points[3]]];\n                    const shortAxisPoint0 = [...points[0]];\n                    const shortAxisPoint1 = [...points[1]];\n                    const longAxisVector = vec2.create();\n                    vec2.set(longAxisVector, longAxis[1][0] - longAxis[0][0], longAxis[1][1] - longAxis[1][0]);\n                    const counterClockWisePerpendicularToLongAxis = vec2.create();\n                    vec2.set(counterClockWisePerpendicularToLongAxis, -longAxisVector[1], longAxisVector[0]);\n                    const currentShortAxisVector = vec2.create();\n                    vec2.set(currentShortAxisVector, shortAxisPoint1[0] - shortAxisPoint0[0], shortAxisPoint1[1] - shortAxisPoint0[0]);\n                    let shortAxis;\n                    if (vec2.dot(currentShortAxisVector, counterClockWisePerpendicularToLongAxis) > 0) {\n                        shortAxis = [shortAxisPoint0, shortAxisPoint1];\n                    }\n                    else {\n                        shortAxis = [shortAxisPoint1, shortAxisPoint0];\n                    }\n                    data.handles.points = [\n                        longAxis[0],\n                        longAxis[1],\n                        shortAxis[0],\n                        shortAxis[1],\n                    ];\n                }\n            }\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { worldToCanvas } = viewport;\n            const { annotation, viewportIdsToRender, handleIndex, newAnnotation } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            data.handles.points[handleIndex] = [...worldPos];\n            const canvasCoordPoints = data.handles.points.map(worldToCanvas);\n            const canvasCoords = {\n                longLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[0][0],\n                        y: canvasCoordPoints[0][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[1][0],\n                        y: canvasCoordPoints[1][1],\n                    },\n                },\n                shortLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[2][0],\n                        y: canvasCoordPoints[2][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[3][0],\n                        y: canvasCoordPoints[3][1],\n                    },\n                },\n            };\n            const dist = vec2.distance(canvasCoordPoints[0], canvasCoordPoints[1]);\n            const shortAxisDistFromCenter = dist / 3;\n            const dx = canvasCoords.longLineSegment.start.x - canvasCoords.longLineSegment.end.x;\n            const dy = canvasCoords.longLineSegment.start.y - canvasCoords.longLineSegment.end.y;\n            const length = Math.sqrt(dx * dx + dy * dy);\n            const vectorX = dx / length;\n            const vectorY = dy / length;\n            const xMid = (canvasCoords.longLineSegment.start.x +\n                canvasCoords.longLineSegment.end.x) /\n                2;\n            const yMid = (canvasCoords.longLineSegment.start.y +\n                canvasCoords.longLineSegment.end.y) /\n                2;\n            const startX = xMid + shortAxisDistFromCenter * vectorY;\n            const startY = yMid - shortAxisDistFromCenter * vectorX;\n            const endX = xMid - shortAxisDistFromCenter * vectorY;\n            const endY = yMid + shortAxisDistFromCenter * vectorX;\n            data.handles.points[2] = viewport.canvasToWorld([startX, startY]);\n            data.handles.points[3] = viewport.canvasToWorld([endX, endY]);\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            this.editData.hasMoved = true;\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, newAnnotation, } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragModifyHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (annotation.invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n        };\n        this._dragModifyHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { annotation, handleIndex: movingHandleIndex } = this.editData;\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            const canvasCoordHandlesCurrent = [\n                viewport.worldToCanvas(data.handles.points[0]),\n                viewport.worldToCanvas(data.handles.points[1]),\n                viewport.worldToCanvas(data.handles.points[2]),\n                viewport.worldToCanvas(data.handles.points[3]),\n            ];\n            const firstLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[0][0],\n                    y: canvasCoordHandlesCurrent[0][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[1][0],\n                    y: canvasCoordHandlesCurrent[1][1],\n                },\n            };\n            const secondLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[2][0],\n                    y: canvasCoordHandlesCurrent[2][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[3][0],\n                    y: canvasCoordHandlesCurrent[3][1],\n                },\n            };\n            const proposedPoint = [...worldPos];\n            const proposedCanvasCoord = viewport.worldToCanvas(proposedPoint);\n            if (movingHandleIndex === 0 || movingHandleIndex === 1) {\n                const fixedHandleIndex = movingHandleIndex === 0 ? 1 : 0;\n                const fixedHandleCanvasCoord = canvasCoordHandlesCurrent[fixedHandleIndex];\n                const fixedHandleToProposedCoordVec = vec2.set(vec2.create(), proposedCanvasCoord[0] - fixedHandleCanvasCoord[0], proposedCanvasCoord[1] - fixedHandleCanvasCoord[1]);\n                const fixedHandleToOldCoordVec = vec2.set(vec2.create(), canvasCoordHandlesCurrent[movingHandleIndex][0] -\n                    fixedHandleCanvasCoord[0], canvasCoordHandlesCurrent[movingHandleIndex][1] -\n                    fixedHandleCanvasCoord[1]);\n                vec2.normalize(fixedHandleToProposedCoordVec, fixedHandleToProposedCoordVec);\n                vec2.normalize(fixedHandleToOldCoordVec, fixedHandleToOldCoordVec);\n                const proposedFirstLineSegment = {\n                    start: {\n                        x: fixedHandleCanvasCoord[0],\n                        y: fixedHandleCanvasCoord[1],\n                    },\n                    end: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                };\n                if (this._movingLongAxisWouldPutItThroughShortAxis(proposedFirstLineSegment, secondLineSegment)) {\n                    return;\n                }\n                const centerOfRotation = fixedHandleCanvasCoord;\n                const angle = this._getSignedAngle(fixedHandleToOldCoordVec, fixedHandleToProposedCoordVec);\n                let firstPointX = canvasCoordHandlesCurrent[2][0];\n                let firstPointY = canvasCoordHandlesCurrent[2][1];\n                let secondPointX = canvasCoordHandlesCurrent[3][0];\n                let secondPointY = canvasCoordHandlesCurrent[3][1];\n                firstPointX -= centerOfRotation[0];\n                firstPointY -= centerOfRotation[1];\n                secondPointX -= centerOfRotation[0];\n                secondPointY -= centerOfRotation[1];\n                const rotatedFirstPoint = firstPointX * Math.cos(angle) - firstPointY * Math.sin(angle);\n                const rotatedFirstPointY = firstPointX * Math.sin(angle) + firstPointY * Math.cos(angle);\n                const rotatedSecondPoint = secondPointX * Math.cos(angle) - secondPointY * Math.sin(angle);\n                const rotatedSecondPointY = secondPointX * Math.sin(angle) + secondPointY * Math.cos(angle);\n                firstPointX = rotatedFirstPoint + centerOfRotation[0];\n                firstPointY = rotatedFirstPointY + centerOfRotation[1];\n                secondPointX = rotatedSecondPoint + centerOfRotation[0];\n                secondPointY = rotatedSecondPointY + centerOfRotation[1];\n                const newFirstPoint = viewport.canvasToWorld([firstPointX, firstPointY]);\n                const newSecondPoint = viewport.canvasToWorld([\n                    secondPointX,\n                    secondPointY,\n                ]);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n                data.handles.points[2] = newFirstPoint;\n                data.handles.points[3] = newSecondPoint;\n            }\n            else {\n                const translateHandleIndex = movingHandleIndex === 2 ? 3 : 2;\n                const canvasCoordsCurrent = {\n                    longLineSegment: {\n                        start: firstLineSegment.start,\n                        end: firstLineSegment.end,\n                    },\n                    shortLineSegment: {\n                        start: secondLineSegment.start,\n                        end: secondLineSegment.end,\n                    },\n                };\n                const longLineSegmentVec = vec2.subtract(vec2.create(), [\n                    canvasCoordsCurrent.longLineSegment.end.x,\n                    canvasCoordsCurrent.longLineSegment.end.y,\n                ], [\n                    canvasCoordsCurrent.longLineSegment.start.x,\n                    canvasCoordsCurrent.longLineSegment.start.y,\n                ]);\n                const longLineSegmentVecNormalized = vec2.normalize(vec2.create(), longLineSegmentVec);\n                const proposedToCurrentVec = vec2.subtract(vec2.create(), [proposedCanvasCoord[0], proposedCanvasCoord[1]], [\n                    canvasCoordHandlesCurrent[movingHandleIndex][0],\n                    canvasCoordHandlesCurrent[movingHandleIndex][1],\n                ]);\n                const movementLength = vec2.length(proposedToCurrentVec);\n                const angle = this._getSignedAngle(longLineSegmentVecNormalized, proposedToCurrentVec);\n                const movementAlongLineSegmentLength = Math.cos(angle) * movementLength;\n                const newTranslatedPoint = vec2.scaleAndAdd(vec2.create(), [\n                    canvasCoordHandlesCurrent[translateHandleIndex][0],\n                    canvasCoordHandlesCurrent[translateHandleIndex][1],\n                ], longLineSegmentVecNormalized, movementAlongLineSegmentLength);\n                if (this._movingLongAxisWouldPutItThroughShortAxis({\n                    start: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                    end: {\n                        x: newTranslatedPoint[0],\n                        y: newTranslatedPoint[1],\n                    },\n                }, {\n                    start: {\n                        x: canvasCoordsCurrent.longLineSegment.start.x,\n                        y: canvasCoordsCurrent.longLineSegment.start.y,\n                    },\n                    end: {\n                        x: canvasCoordsCurrent.longLineSegment.end.x,\n                        y: canvasCoordsCurrent.longLineSegment.end.y,\n                    },\n                })) {\n                    return;\n                }\n                const intersectionPoint = lineSegment.intersectLine([proposedCanvasCoord[0], proposedCanvasCoord[1]], [newTranslatedPoint[0], newTranslatedPoint[1]], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n                if (!intersectionPoint) {\n                    return;\n                }\n                data.handles.points[translateHandleIndex] = viewport.canvasToWorld(newTranslatedPoint);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = true;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        width: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId1 = `${annotationUID}-line-1`;\n                const dataId2 = `${annotationUID}-line-2`;\n                const lineUID = '0';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId1);\n                const secondLineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, secondLineUID, canvasCoordinates[2], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId2);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._movingLongAxisWouldPutItThroughShortAxis = (firstLineSegment, secondLineSegment) => {\n            const vectorInSecondLineDirection = vec2.create();\n            vec2.set(vectorInSecondLineDirection, secondLineSegment.end.x - secondLineSegment.start.x, secondLineSegment.end.y - secondLineSegment.start.y);\n            vec2.normalize(vectorInSecondLineDirection, vectorInSecondLineDirection);\n            const extendedSecondLineSegment = {\n                start: {\n                    x: secondLineSegment.start.x - vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.start.y - vectorInSecondLineDirection[1] * 10,\n                },\n                end: {\n                    x: secondLineSegment.end.x + vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.end.y + vectorInSecondLineDirection[1] * 10,\n                },\n            };\n            const proposedIntersectionPoint = lineSegment.intersectLine([extendedSecondLineSegment.start.x, extendedSecondLineSegment.start.y], [extendedSecondLineSegment.end.x, extendedSecondLineSegment.end.y], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n            const wouldPutThroughShortAxis = !proposedIntersectionPoint;\n            return wouldPutThroughShortAxis;\n        };\n        this._calculateCachedStats = (annotation, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { element } = enabledElement.viewport;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const worldPos3 = data.handles.points[2];\n            const worldPos4 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { imageData, dimensions } = image;\n                const index1 = transformWorldToIndex(imageData, worldPos1);\n                const index2 = transformWorldToIndex(imageData, worldPos2);\n                const index3 = transformWorldToIndex(imageData, worldPos3);\n                const index4 = transformWorldToIndex(imageData, worldPos4);\n                const handles1 = [index1, index2];\n                const handles2 = [index3, index4];\n                const { scale: scale1, unit: units1 } = getCalibratedLengthUnitsAndScale(image, handles1);\n                const { scale: scale2, unit: units2 } = getCalibratedLengthUnitsAndScale(image, handles2);\n                const dist1 = this._calculateLength(worldPos1, worldPos2) / scale1;\n                const dist2 = this._calculateLength(worldPos3, worldPos4) / scale2;\n                const length = dist1 > dist2 ? dist1 : dist2;\n                const width = dist1 > dist2 ? dist2 : dist1;\n                const unit = dist1 > dist2 ? units1 : units2;\n                const widthUnit = dist1 > dist2 ? units2 : units1;\n                this._isInsideVolume(index1, index2, index3, index4, dimensions)\n                    ? (this.isHandleOutsideImage = false)\n                    : (this.isHandleOutsideImage = true);\n                cachedStats[targetId] = {\n                    length,\n                    width,\n                    unit,\n                    widthUnit,\n                };\n            }\n            const invalidated = annotation.invalidated;\n            annotation.invalidated = false;\n            if (invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n            }\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, index3, index4, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions) &&\n                csUtils.indexWithinDimensions(index3, dimensions) &&\n                csUtils.indexWithinDimensions(index4, dimensions));\n        };\n        this._getSignedAngle = (vector1, vector2) => {\n            return Math.atan2(vector1[0] * vector2[1] - vector1[1] * vector2[0], vector1[0] * vector2[0] + vector1[1] * vector2[1]);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const worldPos = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        this.isDrawing = true;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const annotation = {\n            highlighted: true,\n            invalidated: true,\n            metadata: {\n                toolName: this.getToolName(),\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...viewport.getViewReference({ points: [worldPos] }),\n            },\n            data: {\n                handles: {\n                    points: [\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                    ],\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n        };\n        addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex: 1,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n        };\n        this._activateDraw(element);\n        hideElementCursor(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    static { this.hydrate = (viewportId, axis, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, instance, viewport, } = this.hydrateBase(BidirectionalTool, enabledElement, [], options);\n        const [majorAxis, minorAxis] = axis;\n        const [major0, major1] = majorAxis;\n        const [minor0, minor1] = minorAxis;\n        const points = [major0, major1, minor0, minor1];\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    activeHandleIndex: null,\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                },\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n        return annotation;\n    }; }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const { cachedStats, label } = data;\n    const { length, width, unit } = cachedStats[targetId];\n    const textLines = [];\n    if (label) {\n        textLines.push(label);\n    }\n    if (length === undefined) {\n        return textLines;\n    }\n    textLines.push(`L: ${csUtils.roundNumber(length)} ${unit || unit}`, `W: ${csUtils.roundNumber(width)} ${unit}`);\n    return textLines;\n}\nexport default BidirectionalTool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedAspect, getCalibratedLengthUnitsAndScale, } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { ChangeTypes, Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROITool extends AnnotationTool {\n    static { this.toolName = 'CircleROI'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const radius = getCanvasCircleRadius(canvasCoordinates);\n            const radiusPoint = getCanvasCircleRadius([\n                canvasCoordinates[0],\n                canvasCoords,\n            ]);\n            if (Math.abs(radiusPoint - radius) < proximity / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            this.doneEditMemo();\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            data.handles.points = [\n                data.handles.points[0],\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, newAnnotation, } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (annotation.invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0) {\n                const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n                const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n                const canvasCenter = currentCanvasPoints;\n                const canvasEnd = [\n                    canvasCoordinates[1][0] + dXCanvas,\n                    canvasCoordinates[1][1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasCenter);\n                points[1] = canvasToWorld(canvasEnd);\n            }\n            else {\n                points[1] = canvasToWorld(currentCanvasPoints);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                        radius: null,\n                        radiusUnit: null,\n                        perimeter: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-circle`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine, enabledElement) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const wasInvalidated = annotation.invalidated;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const pos2Index = transformWorldToIndex(imageData, worldPos2);\n                pos2Index[0] = Math.floor(pos2Index[0]);\n                pos2Index[1] = Math.floor(pos2Index[1]);\n                pos2Index[2] = Math.floor(pos2Index[2]);\n                if (this._isInsideVolume(pos1Index, pos2Index, dimensions)) {\n                    const iMin = Math.min(pos1Index[0], pos2Index[0]);\n                    const iMax = Math.max(pos1Index[0], pos2Index[0]);\n                    const jMin = Math.min(pos1Index[1], pos2Index[1]);\n                    const jMax = Math.max(pos1Index[1], pos2Index[1]);\n                    const kMin = Math.min(pos1Index[2], pos2Index[2]);\n                    const kMax = Math.max(pos1Index[2], pos2Index[2]);\n                    const boundsIJK = [\n                        [iMin, iMax],\n                        [jMin, jMax],\n                        [kMin, kMax],\n                    ];\n                    const center = [\n                        (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                        (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                        (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                    ];\n                    const ellipseObj = {\n                        center,\n                        xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                        yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                        zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                    };\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                    const handles = [pos1Index, pos2Index];\n                    const { scale, unit, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                    const aspect = getCalibratedAspect(image);\n                    const area = Math.abs(Math.PI *\n                        (worldWidth / scale / 2) *\n                        (worldHeight / aspect / scale / 2));\n                    const pixelUnitsOptions = {\n                        isPreScaled: isViewportPreScaled(viewport, targetId),\n                        isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                    };\n                    const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                    const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                        isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                        boundsIJK,\n                        imageData,\n                        returnPoints: this.configuration.storePointData,\n                    });\n                    const stats = this.configuration.statsCalculator.getStatistics();\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean: stats.mean?.value,\n                        max: stats.max?.value,\n                        pointsInShape,\n                        stdDev: stats.stdDev?.value,\n                        statsArray: stats.array,\n                        isEmptyArea,\n                        areaUnit,\n                        radius: worldWidth / 2 / scale,\n                        radiusUnit: unit,\n                        perimeter: (2 * Math.PI * (worldWidth / 2)) / scale,\n                        modalityUnit,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            annotation.invalidated = false;\n            if (wasInvalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n            }\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, instance, viewport, } = this.hydrateBase(CircleROITool, enabledElement, points, options);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { radius, radiusUnit, area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit, } = cachedVolumeStats;\n    const textLines = [];\n    if (radius) {\n        const radiusLine = isEmptyArea\n            ? `Radius: Oblique not supported`\n            : `Radius: ${csUtils.roundNumber(radius)} ${radiusUnit}`;\n        textLines.push(radiusLine);\n    }\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nexport default CircleROITool;\n","import { vec3 } from 'gl-matrix';\nimport { ChangeTypes, Events } from '../../enums';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { midPoint2 } from '../../utilities/math/midPoint';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nclass CobbAngleTool extends AnnotationTool {\n    static { this.toolName = 'CobbAngle'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            showArcLines: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { distanceToPoint, distanceToPoint2 } = this.distanceToLines({\n                viewport,\n                points: data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            if (distanceToPoint <= proximity || distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType, canvasCoords, proximity = 6) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { isNearFirstLine, isNearSecondLine } = this.distanceToLines({\n                viewport,\n                points: annotation.data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            this.doneEditMemo();\n            if (this.angleStartedNotYetCompleted && data.handles.points.length < 4) {\n                resetElementCursor(element);\n                this.editData.handleIndex = data.handles.points.length;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._mouseDownCallback = (evt) => {\n            const { annotation, handleIndex } = this.editData;\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { data } = annotation;\n            if (handleIndex === 1) {\n                data.handles.points[1] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[1][0] !== data.handles.points[0][0] ||\n                        data.handles.points[1][1] !== data.handles.points[0][0];\n                return;\n            }\n            if (handleIndex === 3) {\n                data.handles.points[3] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[3][0] !== data.handles.points[2][0] ||\n                        data.handles.points[3][1] !== data.handles.points[2][0];\n                this.angleStartedNotYetCompleted = false;\n                return;\n            }\n            this.editData.hasMoved = false;\n            hideElementCursor(element);\n            data.handles.points[2] = data.handles.points[3] = worldPos;\n            this.editData.handleIndex = data.handles.points.length - 1;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, isNearFirstLine, isNearSecondLine, newAnnotation, } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined &&\n                (isNearFirstLine || isNearSecondLine)) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                if (isNearFirstLine) {\n                    const firstLinePoints = [points[0], points[1]];\n                    firstLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                else if (isNearSecondLine) {\n                    const secondLinePoints = [points[2], points[3]];\n                    secondLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (annotation.invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length < 4) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.angleStartedNotYetCompleted = false;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_START, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_START, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_START, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_START, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                        arc1Angle: null,\n                        arc2Angle: null,\n                        points: {\n                            world: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                            canvas: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                        },\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const firstLine = [canvasCoordinates[0], canvasCoordinates[1]];\n                const secondLine = [canvasCoordinates[2], canvasCoordinates[3]];\n                let lineUID = 'line1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, firstLine[0], firstLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length < 4) {\n                    return renderStatus;\n                }\n                lineUID = 'line2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, secondLine[0], secondLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                lineUID = 'linkLine';\n                const mid1 = midPoint2(firstLine[0], firstLine[1]);\n                const mid2 = midPoint2(secondLine[0], secondLine[1]);\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, mid1, mid2, {\n                    color,\n                    lineWidth: '1',\n                    lineDash: '1,4',\n                });\n                const { arc1Start, arc1End, arc2End, arc2Start } = data.cachedStats[targetId].points.canvas;\n                const { arc1Angle, arc2Angle } = data.cachedStats[targetId];\n                if (this.configuration.showArcLines) {\n                    lineUID = 'arc1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc1Start, arc1End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                    lineUID = 'arc2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc2Start, arc2End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                }\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = 'cobbAngleText';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n                if (this.configuration.showArcLines) {\n                    const arc1TextBoxUID = 'arcAngle1';\n                    const arc1TextLine = [\n                        `${arc1Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch1TextPosCanvas = midPoint2(arc1Start, arc1End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc1TextBoxUID, arc1TextLine, arch1TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                    const arc2TextBoxUID = 'arcAngle2';\n                    const arc2TextLine = [\n                        `${arc2Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch2TextPosCanvas = midPoint2(arc2Start, arc2End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc2TextBoxUID, arc2TextLine, arch2TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                }\n            }\n            return renderStatus;\n        };\n        this.distanceToLines = ({ viewport, points, canvasCoords, proximity }) => {\n            const [point1, point2, point3, point4] = points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const canvasPoint4 = viewport.worldToCanvas(point4);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const line2 = {\n                start: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n                end: {\n                    x: canvasPoint4[0],\n                    y: canvasPoint4[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            let isNearFirstLine = false;\n            let isNearSecondLine = false;\n            if (distanceToPoint <= proximity) {\n                isNearFirstLine = true;\n            }\n            else if (distanceToPoint2 <= proximity) {\n                isNearSecondLine = true;\n            }\n            return {\n                distanceToPoint,\n                distanceToPoint2,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n        };\n        this.getArcsStartEndPoints = ({ firstLine, secondLine, mid1, mid2, }) => {\n            const linkLine = [mid1, mid2];\n            const arc1Angle = angleBetweenLines(firstLine, linkLine);\n            const arc2Angle = angleBetweenLines(secondLine, linkLine);\n            const arc1Side = arc1Angle > 90 ? 1 : 0;\n            const arc2Side = arc2Angle > 90 ? 0 : 1;\n            const midLinkLine = midPoint2(linkLine[0], linkLine[1]);\n            const linkLineLength = Math.sqrt((linkLine[1][0] - linkLine[0][0]) ** 2 +\n                (linkLine[1][1] - linkLine[0][1]) ** 2);\n            const ratio = 0.1;\n            const midFirstLine = midPoint2(firstLine[0], firstLine[1]);\n            const midSecondLine = midPoint2(secondLine[0], secondLine[1]);\n            const directionVectorStartArc1 = [\n                firstLine[arc1Side][0] - midFirstLine[0],\n                firstLine[arc1Side][1] - midFirstLine[1],\n            ];\n            const magnitudeStartArc1 = Math.sqrt(directionVectorStartArc1[0] ** 2 + directionVectorStartArc1[1] ** 2);\n            const normalizedDirectionStartArc1 = [\n                directionVectorStartArc1[0] / magnitudeStartArc1,\n                directionVectorStartArc1[1] / magnitudeStartArc1,\n            ];\n            const arc1Start = [\n                midFirstLine[0] +\n                    normalizedDirectionStartArc1[0] * linkLineLength * ratio,\n                midFirstLine[1] +\n                    normalizedDirectionStartArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc1 = [\n                midLinkLine[0] - mid1[0],\n                midLinkLine[1] - mid1[1],\n            ];\n            const magnitudeEndArc1 = Math.sqrt(directionVectorEndArc1[0] ** 2 + directionVectorEndArc1[1] ** 2);\n            const normalizedDirectionEndArc1 = [\n                directionVectorEndArc1[0] / magnitudeEndArc1,\n                directionVectorEndArc1[1] / magnitudeEndArc1,\n            ];\n            const arc1End = [\n                mid1[0] + normalizedDirectionEndArc1[0] * linkLineLength * ratio,\n                mid1[1] + normalizedDirectionEndArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorStartArc2 = [\n                secondLine[arc2Side][0] - midSecondLine[0],\n                secondLine[arc2Side][1] - midSecondLine[1],\n            ];\n            const magnitudeStartArc2 = Math.sqrt(directionVectorStartArc2[0] ** 2 + directionVectorStartArc2[1] ** 2);\n            const normalizedDirectionStartArc2 = [\n                directionVectorStartArc2[0] / magnitudeStartArc2,\n                directionVectorStartArc2[1] / magnitudeStartArc2,\n            ];\n            const arc2Start = [\n                midSecondLine[0] +\n                    normalizedDirectionStartArc2[0] * linkLineLength * ratio,\n                midSecondLine[1] +\n                    normalizedDirectionStartArc2[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc2 = [\n                midLinkLine[0] - mid2[0],\n                midLinkLine[1] - mid2[1],\n            ];\n            const magnitudeEndArc2 = Math.sqrt(directionVectorEndArc2[0] ** 2 + directionVectorEndArc2[1] ** 2);\n            const normalizedDirectionEndArc2 = [\n                directionVectorEndArc2[0] / magnitudeEndArc2,\n                directionVectorEndArc2[1] / magnitudeEndArc2,\n            ];\n            const arc2End = [\n                mid2[0] + normalizedDirectionEndArc2[0] * linkLineLength * ratio,\n                mid2[1] + normalizedDirectionEndArc2[1] * linkLineLength * ratio,\n            ];\n            return {\n                arc1Start,\n                arc1End,\n                arc2Start,\n                arc2End,\n                arc1Angle: arc1Angle > 90 ? 180 - arc1Angle : arc1Angle,\n                arc2Angle: arc2Angle > 90 ? 180 - arc2Angle : arc2Angle,\n            };\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 25, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle, interactionType = 'mouse') {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        if (data.handles.points.length !== 4) {\n            return;\n        }\n        const seg1 = [null, null];\n        const seg2 = [null, null];\n        let minDist = Number.MAX_VALUE;\n        for (let i = 0; i < 2; i += 1) {\n            for (let j = 2; j < 4; j += 1) {\n                const dist = vec3.distance(data.handles.points[i], data.handles.points[j]);\n                if (dist < minDist) {\n                    minDist = dist;\n                    seg1[1] = data.handles.points[i];\n                    seg1[0] = data.handles.points[(i + 1) % 2];\n                    seg2[0] = data.handles.points[j];\n                    seg2[1] = data.handles.points[2 + ((j - 1) % 2)];\n                }\n            }\n        }\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const canvasPoints = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const firstLine = [canvasPoints[0], canvasPoints[1]];\n        const secondLine = [canvasPoints[2], canvasPoints[3]];\n        const mid1 = midPoint2(firstLine[0], firstLine[1]);\n        const mid2 = midPoint2(secondLine[0], secondLine[1]);\n        const { arc1Start, arc1End, arc2End, arc2Start, arc1Angle, arc2Angle } = this.getArcsStartEndPoints({\n            firstLine,\n            secondLine,\n            mid1,\n            mid2,\n        });\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            cachedStats[targetId] = {\n                angle: angleBetweenLines(seg1, seg2),\n                arc1Angle,\n                arc2Angle,\n                points: {\n                    canvas: {\n                        arc1Start,\n                        arc1End,\n                        arc2End,\n                        arc2Start,\n                    },\n                    world: {\n                        arc1Start: viewport.canvasToWorld(arc1Start),\n                        arc1End: viewport.canvasToWorld(arc1End),\n                        arc2End: viewport.canvasToWorld(arc2End),\n                        arc2Start: viewport.canvasToWorld(arc2Start),\n                    },\n                },\n            };\n        }\n        const invalidated = annotation.invalidated;\n        annotation.invalidated = false;\n        if (invalidated) {\n            triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n        }\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    const textLines = [`${angle.toFixed(2)} ${String.fromCharCode(176)}`];\n    return textLines;\n}\nexport default CobbAngleTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport ProbeTool from './ProbeTool';\nclass DragProbeTool extends ProbeTool {\n    static { this.toolName = 'DragProbe'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.postMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                isVisible: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: { points: [[...worldPos]] },\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.postTouchStartCallback = (evt) => {\n            return this.postMouseDownCallback(evt);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const annotations = this.filterInteractableAnnotationsForElement(viewport.element, [this.editData.annotation]);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const annotation = this.editData.annotation;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const point = data.handles.points[0];\n            const canvasCoordinates = viewport.worldToCanvas(point);\n            styleSpecifier.annotationUID = annotationUID;\n            const { color } = this.getAnnotationStyle({\n                annotation,\n                styleSpecifier,\n            });\n            if (!data.cachedStats[targetId] ||\n                data.cachedStats[targetId].value === null) {\n                data.cachedStats[targetId] = {\n                    Modality: null,\n                    index: null,\n                    value: null,\n                };\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            else if (annotation.invalidated) {\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color });\n            renderStatus = true;\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (textLines) {\n                const textCanvasCoordinates = [\n                    canvasCoordinates[0] + 6,\n                    canvasCoordinates[1] - 6,\n                ];\n                const textUID = '0';\n                drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], this.getLinkedTextBoxStyle(styleSpecifier, annotation));\n            }\n            return renderStatus;\n        };\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    textLines.push(`${value.toFixed(2)} ${modalityUnit}`);\n    return textLines;\n}\nexport default DragProbeTool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawLine } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../../utilities/math/circle';\nimport { vec3 } from 'gl-matrix';\nconst CROSSHAIR_SIZE = 5;\nclass ETDRSGridTool extends AnnotationTool {\n    static { this.toolName = 'ETDRSGrid'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            degrees: [45, 135, 225, 315],\n            diameters: [10, 30, 60],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                    },\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const center = viewport.worldToCanvas(points[0]);\n            const radius = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radius) < proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points = [\n                canvasToWorld(currentCanvasPoints),\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { deltaPoints } = eventDetail;\n            const worldPosDelta = deltaPoints.world;\n            const points = data.handles.points;\n            points.forEach((point) => {\n                point[0] += worldPosDelta[0];\n                point[1] += worldPosDelta[1];\n                point[2] += worldPosDelta[2];\n            });\n            annotation.invalidated = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n            const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n            const canvasCenter = currentCanvasPoints;\n            const canvasEnd = [\n                canvasCoordinates[1][0] + dXCanvas,\n                canvasCoordinates[1][1] + dYCanvas,\n            ];\n            points[0] = canvasToWorld(canvasCenter);\n            points[1] = canvasToWorld(canvasEnd);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const { renderingEngine } = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                let lineUID = `${annotationUID}-crosshair-vertical`;\n                let start = [center[0], center[1] + CROSSHAIR_SIZE];\n                let end = [center[0], center[1] - CROSSHAIR_SIZE];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                lineUID = `${annotationUID}-crosshair-horizontal`;\n                start = [center[0] + CROSSHAIR_SIZE, center[1]];\n                end = [center[0] - CROSSHAIR_SIZE, center[1]];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                const diametersCanvas = this.configuration.diameters.map((diameter) => this.worldMeasureToCanvas(diameter, viewport));\n                for (let i = 0; i < diametersCanvas.length; i++) {\n                    const dataId = `${annotationUID}-circle-${i}`;\n                    const circleUID = `${annotationUID}-circle-${i}`;\n                    drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, diametersCanvas[i] / 2, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    }, dataId);\n                }\n                const degreesRad = (x) => (x * Math.PI) / 180;\n                const angleRadians = this.configuration.degrees.map((degree) => degreesRad(degree));\n                for (let i = 0; i < angleRadians.length; i++) {\n                    const lineUID = `${annotationUID}-line-${i}`;\n                    const start = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[0]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[0]) / 2 + center[1],\n                    ];\n                    const end = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[2]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[2]) / 2 + center[1],\n                    ];\n                    drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n    worldMeasureToCanvas(measurement, viewport) {\n        const p1 = viewport.canvasToWorld([\n            viewport.canvas.width / 2,\n            viewport.canvas.height / 2,\n        ]);\n        const { viewUp } = viewport.getCamera();\n        const p2 = vec3.scaleAndAdd(vec3.create(), p1, viewUp, measurement);\n        const p1Canvas = viewport.worldToCanvas(p1);\n        const p2Canvas = viewport.worldToCanvas(p2);\n        const distance = Math.sqrt(Math.pow(p2Canvas[0] - p1Canvas[0], 2) +\n            Math.pow(p2Canvas[1] - p1Canvas[1], 2));\n        return distance;\n    }\n}\nexport default ETDRSGridTool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawEllipseByCoordinates as drawEllipseSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { ChangeTypes, Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { pointInEllipse, getCanvasEllipseCorners, } from '../../utilities/math/ellipse';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass EllipticalROITool extends AnnotationTool {\n    static { this.toolName = 'EllipticalROI'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    initialRotation: viewport.getRotation(),\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                centerWorld: worldPos,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const canvasCorners = getCanvasEllipseCorners(canvasCoordinates);\n            const [canvasPoint1, canvasPoint2] = canvasCorners;\n            const minorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) + proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) + proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) - proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) - proximity,\n            };\n            const majorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) - proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) - proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) + proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) + proximity,\n            };\n            const pointInMinorEllipse = this._pointInEllipseCanvas(minorEllipse, canvasCoords);\n            const pointInMajorEllipse = this._pointInEllipseCanvas(majorEllipse, canvasCoords);\n            if (pointInMajorEllipse && !pointInMinorEllipse) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            let centerCanvas;\n            let centerWorld;\n            let canvasWidth;\n            let canvasHeight;\n            let originalHandleCanvas;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                const { viewport } = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = viewport;\n                handleIndex = points.findIndex((p) => p === handle);\n                const pointsCanvas = points.map(worldToCanvas);\n                originalHandleCanvas = pointsCanvas[handleIndex];\n                canvasWidth = Math.abs(pointsCanvas[2][0] - pointsCanvas[3][0]);\n                canvasHeight = Math.abs(pointsCanvas[0][1] - pointsCanvas[1][1]);\n                centerCanvas = [\n                    (pointsCanvas[2][0] + pointsCanvas[3][0]) / 2,\n                    (pointsCanvas[0][1] + pointsCanvas[1][1]) / 2,\n                ];\n                centerWorld = canvasToWorld(centerCanvas);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                canvasWidth,\n                canvasHeight,\n                centerWorld,\n                originalHandleCanvas,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            this.doneEditMemo();\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerWorld, newAnnotation } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const bottomCanvas = [centerCanvas[0], centerCanvas[1] - dY];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] + dY];\n            const leftCanvas = [centerCanvas[0] - dX, centerCanvas[1]];\n            const rightCanvas = [centerCanvas[0] + dX, centerCanvas[1]];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, newAnnotation, } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (annotation.invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { viewport } = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = viewport;\n            const { annotation, canvasWidth, canvasHeight, handleIndex, centerWorld, originalHandleCanvas, } = this.editData;\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0 || handleIndex === 1) {\n                const dYCanvas = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - dYCanvas,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n                const dXCanvas = currentCanvasPoints[0] - originalHandleCanvas[0];\n                const newHalfCanvasWidth = canvasWidth / 2 + dXCanvas;\n                const canvasLeft = [\n                    centerCanvas[0] - newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n            }\n            else {\n                const dXCanvas = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n                const canvasLeft = [\n                    centerCanvas[0] - dXCanvas,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + dXCanvas,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n                const dYCanvas = currentCanvasPoints[1] - originalHandleCanvas[1];\n                const newHalfCanvasHeight = canvasHeight / 2 + dYCanvas;\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - newHalfCanvasHeight,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + newHalfCanvasHeight,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasCorners = (getCanvasEllipseCorners(canvasCoordinates));\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-ellipse`;\n                const ellipseUID = '0';\n                drawEllipseSvg(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    const minRadius = Math.min(Math.abs(canvasCorners[0][0] - canvasCorners[1][0]) / 2, Math.abs(canvasCorners[0][1] - canvasCorners[1][1]) / 2);\n                    if (minRadius > 3 * centerPointRadius) {\n                        const centerPoint = this._getCanvasEllipseCenter(canvasCoordinates);\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${ellipseUID}-center`, centerPoint, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasEllipseCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const post2Index = transformWorldToIndex(imageData, worldPos2);\n                post2Index[0] = Math.floor(post2Index[0]);\n                post2Index[1] = Math.floor(post2Index[1]);\n                post2Index[2] = Math.floor(post2Index[2]);\n                this.isHandleOutsideImage = !this._isInsideVolume(pos1Index, post2Index, dimensions);\n                const iMin = Math.min(pos1Index[0], post2Index[0]);\n                const iMax = Math.max(pos1Index[0], post2Index[0]);\n                const jMin = Math.min(pos1Index[1], post2Index[1]);\n                const jMax = Math.max(pos1Index[1], post2Index[1]);\n                const kMin = Math.min(pos1Index[2], post2Index[2]);\n                const kMax = Math.max(pos1Index[2], post2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = [\n                    (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                    (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                    (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                ];\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                const handles = [pos1Index, post2Index];\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                const area = Math.abs(Math.PI * (worldWidth / 2) * (worldHeight / 2)) /\n                    scale /\n                    scale;\n                const pixelUnitsOptions = {\n                    isPreScaled: isViewportPreScaled(viewport, targetId),\n                    isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                };\n                const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                    returnPoints: this.configuration.storePointData,\n                });\n                const stats = this.configuration.statsCalculator.getStatistics();\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    mean: stats.mean?.value,\n                    max: stats.max?.value,\n                    stdDev: stats.stdDev?.value,\n                    statsArray: stats.array,\n                    pointsInShape,\n                    isEmptyArea,\n                    areaUnit,\n                    modalityUnit,\n                };\n            }\n            const invalidated = annotation.invalidated;\n            annotation.invalidated = false;\n            if (invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n            }\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, instance, viewport, } = this.hydrateBase(EllipticalROITool, enabledElement, points, options);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    _pointInEllipseCanvas(ellipse, location) {\n        const xRadius = ellipse.width / 2;\n        const yRadius = ellipse.height / 2;\n        if (xRadius <= 0.0 || yRadius <= 0.0) {\n            return false;\n        }\n        const center = [ellipse.left + xRadius, ellipse.top + yRadius];\n        const normalized = [location[0] - center[0], location[1] - center[1]];\n        const inEllipse = (normalized[0] * normalized[0]) / (xRadius * xRadius) +\n            (normalized[1] * normalized[1]) / (yRadius * yRadius) <=\n            1.0;\n        return inEllipse;\n    }\n    _getCanvasEllipseCenter(ellipseCanvasPoints) {\n        const [bottom, top, left, right] = ellipseCanvasPoints;\n        const topLeft = [left[0], top[1]];\n        const bottomRight = [right[0], bottom[1]];\n        return [\n            (topLeft[0] + bottomRight[0]) / 2,\n            (topLeft[1] + bottomRight[1]) / 2,\n        ];\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nexport default EllipticalROITool;\n","import { ChangeTypes, Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawHeight as drawHeightSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass HeightTool extends AnnotationTool {\n    static { this.toolName = 'Height'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const enabledElement = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const heightUID = '0';\n                drawHeightSvg(svgDrawingHelper, annotationUID, heightUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash: lineDash,\n                });\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateHeight(pos1, pos2) {\n        const dx = pos2[0] - pos1[0];\n        const dy = pos2[1] - pos1[1];\n        const dz = pos2[2] - pos1[2];\n        if (dx == 0) {\n            if (dy != 0) {\n                return Math.abs(dz);\n            }\n            else {\n                return 0;\n            }\n        }\n        else if (dy == 0) {\n            return Math.abs(dz);\n        }\n        else if (dz == 0) {\n            return Math.abs(dy);\n        }\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const height = this._calculateHeight(worldPos1, worldPos2) / scale;\n            const outside = this._isInsideVolume(index1, index2, dimensions);\n            this.isHandleOutsideImage = outside;\n            cachedStats[targetId] = {\n                height,\n                unit,\n            };\n        }\n        const invalidated = annotation.invalidated;\n        annotation.invalidated = false;\n        if (invalidated) {\n            triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n        }\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { height, unit } = cachedVolumeStats;\n    if (height === undefined || height === null || isNaN(height)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(height)} ${unit}`];\n    return textLines;\n}\nexport default HeightTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawArrow as drawArrowSvg, drawHandles as drawHandlesSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass KeyImageTool extends AnnotationTool {\n    static { this.toolName = 'KeyImage'; }\n    static { this.dataSeries = {\n        data: {\n            seriesLevel: true,\n        },\n    }; }\n    static { this.dataPoint = {\n        data: {\n            isPoint: true,\n        },\n    }; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextCallback,\n            changeTextCallback,\n            canvasPosition: [10, 10],\n            canvasSize: 10,\n            handleRadius: '6',\n            seriesLevel: false,\n            isPoint: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const worldPos = currentPoints.world;\n            const annotation = (this.constructor).createAnnotationForViewport(viewport, {\n                data: {\n                    handles: { points: [[...worldPos]] },\n                    seriesLevel: this.configuration.seriesLevel,\n                    isPoint: this.configuration.isPoint,\n                },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.configuration.getTextCallback((text) => {\n                if (!text) {\n                    removeAnnotation(annotation.annotationUID);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                    this.isDrawing = false;\n                    return;\n                }\n                annotation.data.text = text;\n                triggerAnnotationCompleted(annotation);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            });\n            this.createMemo(element, annotation, { newAnnotation: true });\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            if (!data?.isPoint) {\n                return false;\n            }\n            const { canvasPosition, canvasSize } = this.configuration;\n            if (!canvasPosition?.length) {\n                return false;\n            }\n            if (Math.abs(canvasCoords[0] - canvasPosition[0] + canvasSize / 2) <=\n                canvasSize / 2 &&\n                Math.abs(canvasCoords[1] - canvasPosition[1] + canvasSize / 2) <=\n                    canvasSize / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            annotation.highlighted = true;\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { viewportId, renderingEngine } = getEnabledElement(element);\n            this.eventDispatchDetail = {\n                viewportId,\n                renderingEngineId: renderingEngine.id,\n            };\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            if (newAnnotation) {\n                this.createMemo(element, annotation, { newAnnotation });\n            }\n            this.editData = null;\n            this.isDrawing = false;\n            this.doneEditMemo();\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.createMemo(element, annotation);\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.isDrawing = false;\n            this.doneEditMemo();\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            this.createMemo(element, annotation, { newAnnotation });\n            data.handles.points[0] = [...worldPos];\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const { canvasPosition, canvasSize } = this.configuration;\n                const arrowUID = '1';\n                if (data?.isPoint) {\n                    const point = data.handles.points[0];\n                    const canvasCoordinates = viewport.worldToCanvas(point);\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, arrowUID, [canvasCoordinates], {\n                        color,\n                        lineWidth,\n                        handleRadius: this.configuration.handleRadius,\n                    });\n                }\n                else if (canvasPosition?.length) {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasPosition.map((it) => it + canvasSize), canvasPosition, {\n                        color,\n                        width: 1,\n                    });\n                }\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n            }\n            return renderStatus;\n        };\n    }\n    handleSelectedCallback(evt, annotation) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    static setPoint(annotation, isPoint = !annotation.data.isPoint, element) {\n        annotation.data.isPoint = isPoint;\n        triggerAnnotationModified(annotation, element);\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    cancel(element) {\n        if (this.isDrawing) {\n            this.isDrawing = false;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            return annotation.annotationUID;\n        }\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nexport default KeyImageTool;\n","import { vec2 } from 'gl-matrix';\nimport { ChangeTypes, Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { drawTextBox as drawTextBoxSvg } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nclass LabelTool extends AnnotationTool {\n    static { this.toolName = 'Label'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            getTextCallback,\n            changeTextCallback,\n            preventHandleOutsideImage: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { annotationUID } = annotation;\n            const point = annotation.data.handles.points[0];\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            const dist = vec2.distance(canvasCoords, annotationCanvasCoordinate);\n            if (dist < proximity) {\n                return true;\n            }\n            const svgLayer = element.querySelector('svg');\n            if (!svgLayer) {\n                return false;\n            }\n            const textGroup = svgLayer.querySelector(`g[data-annotation-uid=\"${annotationUID}\"]`);\n            if (!textGroup) {\n                return false;\n            }\n            const textGroupElement = textGroup;\n            const bbox = textGroupElement.getBBox();\n            const transform = textGroupElement.getAttribute('transform');\n            let translateX = 0;\n            let translateY = 0;\n            if (transform) {\n                const matches = transform.match(/translate\\(([-\\d.]+)\\s+([-\\d.]+)\\)/);\n                if (matches) {\n                    translateX = parseFloat(matches[1]);\n                    translateY = parseFloat(matches[2]);\n                }\n            }\n            const x = bbox.x + translateX;\n            const y = bbox.y + translateY;\n            const isNear = canvasCoords[0] >= x &&\n                canvasCoords[0] <= x + bbox.width &&\n                canvasCoords[1] >= y &&\n                canvasCoords[1] <= y + bbox.height;\n            return isNear;\n        };\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                annotationUID: null,\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    text: '',\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                    },\n                    label: '',\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n                offset: [0, 0, 0],\n            };\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.configuration.getTextCallback((text) => {\n                if (!text) {\n                    removeAnnotation(annotation.annotationUID);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                    this.isDrawing = false;\n                    return;\n                }\n                resetElementCursor(element);\n                annotation.data.text = text;\n                triggerAnnotationCompleted(annotation);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            });\n            this.createMemo(element, annotation, { newAnnotation: true });\n            return annotation;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            let offset = [0, 0, 0];\n            if (currentPoints && currentPoints.world) {\n                const initialWorldPos = currentPoints.world;\n                const anchorWorldPos = annotation.data.handles.points[0];\n                offset = [\n                    anchorWorldPos[0] - initialWorldPos[0],\n                    anchorWorldPos[1] - initialWorldPos[1],\n                    anchorWorldPos[2] - initialWorldPos[2],\n                ];\n            }\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                offset,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            if (newAnnotation) {\n                this.createMemo(element, annotation, { newAnnotation });\n            }\n            this.editData = null;\n            this.isDrawing = false;\n            this.doneEditMemo();\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { annotation, viewportIdsToRender, offset } = this.editData;\n            if (offset) {\n                annotation.data.handles.points[0] = [\n                    worldPos[0] + offset[0],\n                    worldPos[1] + offset[1],\n                    worldPos[2] + offset[2],\n                ];\n            }\n            else {\n                annotation.data.handles.points[0] = [...worldPos];\n            }\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationModified(annotation, element, ChangeTypes.LabelChange);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const point = data.handles.points[0];\n                styleSpecifier.annotationUID = annotationUID;\n                const canvasCoordinates = viewport.worldToCanvas(point);\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!data.text) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                const textBoxUID = '1';\n                drawTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, [data.text], canvasCoordinates, {\n                    ...options,\n                    padding: 0,\n                });\n            }\n            return renderStatus;\n        };\n    }\n    static { this.hydrate = (viewportId, position, text, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, position, viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                text,\n                handles: {\n                    points: [position],\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    handleSelectedCallback(evt, annotation, handle, interactionType) { }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nLabelTool.toolName = 'Label';\nexport default LabelTool;\n","import { Events, ChangeTypes } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, utilities, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass LengthTool extends AnnotationTool {\n    static { this.toolName = 'Length'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            actions: {\n                undo: {\n                    method: 'undo',\n                    bindings: [{ key: 'z' }],\n                },\n                redo: {\n                    method: 'redo',\n                    bindings: [{ key: 'y' }],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.doneEditMemo();\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, newAnnotation, } = this.editData;\n            const { data } = annotation;\n            this.createMemo(element, annotation, { newAnnotation });\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (annotation.invalidated) {\n                triggerAnnotationModified(annotation, element, ChangeTypes.HandlesUpdated);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const dataId = `${annotationUID}-line`;\n                const lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, instance, viewport, } = this.hydrateBase(LengthTool, enabledElement, points, options);\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const length = this._calculateLength(worldPos1, worldPos2) / scale;\n            if (this._isInsideVolume(index1, index2, dimensions)) {\n                this.isHandleOutsideImage = false;\n            }\n            else {\n                this.isHandleOutsideImage = true;\n            }\n            cachedStats[targetId] = {\n                length,\n                unit,\n            };\n        }\n        const invalidated = annotation.invalidated;\n        annotation.invalidated = false;\n        if (invalidated) {\n            triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n        }\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { length, unit } = cachedVolumeStats;\n    if (length === undefined || length === null || isNaN(length)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(length)} ${unit}`];\n    return textLines;\n}\nexport default LengthTool;\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport LivewireContourTool from './LivewireContourTool';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport { ChangeTypes } from '../../enums';\nimport { drawPolyline as drawPolylineSvg } from '../../drawingSvg';\nclass LivewireContourSegmentationTool extends LivewireContourTool {\n    static { this.toolName = 'LivewireContourSegmentationTool'; }\n    updateInterpolatedAnnotation(annotation, enabledElement) {\n        if (this.editData ||\n            !annotation.invalidated ||\n            !annotation.data.handles.interpolationSources) {\n            return;\n        }\n        annotation.data.contour.originalPolyline = annotation.data.contour.polyline;\n        queueMicrotask(() => {\n            if (!annotation.data.handles.interpolationSources) {\n                return;\n            }\n            const { points } = annotation.data.handles;\n            const { element } = enabledElement.viewport;\n            this.setupBaseEditData(points[0], element, annotation);\n            const { length: count } = points;\n            const { scissors } = this;\n            const { nearestEdge, repeatInterpolation } = this.configuration.interpolation;\n            annotation.data.handles.originalPoints = points;\n            const { worldToSlice, sliceToWorld } = this.editData;\n            const handleSmoothing = [];\n            if (nearestEdge) {\n                let lastPoint = worldToSlice(points[points.length - 1]);\n                points.forEach((point, hIndex) => {\n                    const testPoint = worldToSlice(point);\n                    lastPoint = testPoint;\n                    handleSmoothing.push(testPoint);\n                    scissors.startSearch(lastPoint);\n                    scissors.findPathToPoint(testPoint);\n                    scissors.findPathToPoint(worldToSlice(points[(hIndex + 3) % points.length]));\n                    const minPoint = scissors.findMinNearby(testPoint, nearestEdge);\n                    if (!csUtils.isEqual(testPoint, minPoint)) {\n                        handleSmoothing[hIndex] = minPoint;\n                        lastPoint = minPoint;\n                        points[hIndex] = sliceToWorld(minPoint);\n                    }\n                });\n            }\n            const acceptedPath = new LivewirePath();\n            for (let i = 0; i < count; i++) {\n                scissors.startSearch(worldToSlice(points[i]));\n                const path = scissors.findPathToPoint(worldToSlice(points[(i + 1) % count]));\n                acceptedPath.addPoints(path);\n            }\n            this.updateAnnotation(acceptedPath);\n            this.scissors = null;\n            this.scissorsNext = null;\n            this.editData = null;\n            annotation.data.handles.interpolationSources = null;\n            if (repeatInterpolation) {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, ChangeTypes.InterpolationUpdated);\n            }\n        });\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, svgDrawingHelper } = renderContext;\n        const annotation = renderContext.annotation;\n        const { annotationUID } = annotation;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { showInterpolationPolyline } = this.configuration.interpolation || {};\n        this.updateInterpolatedAnnotation?.(annotation, enabledElement);\n        const { originalPolyline } = annotation.data.contour;\n        const rendered = super.renderAnnotationInstance(renderContext);\n        if (showInterpolationPolyline &&\n            originalPolyline &&\n            annotation.autoGenerated) {\n            const polylineCanvasPoints = originalPolyline.map(worldToCanvas);\n            polylineCanvasPoints.push(polylineCanvasPoints[0]);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'interpolationContour-0', polylineCanvasPoints, {\n                color: '#70ffff',\n                lineWidth: 1,\n                fillOpacity: 0,\n            });\n        }\n        return rendered;\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nexport default LivewireContourSegmentationTool;\n","import { vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils, VolumeViewport, utilities, triggerEvent, eventTarget, } from '@cornerstonejs/core';\nimport { removeAnnotation } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, KeyboardBindings, ChangeTypes } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport * as math from '../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport findHandlePolylineIndex from '../../utilities/contours/findHandlePolylineIndex';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { triggerAnnotationModified, triggerContourAnnotationCompleted, } from '../../stateManagement/annotation/helpers/state';\nimport { LivewireScissors } from '../../utilities/livewire/LivewireScissors';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale, throttle } from '../../utilities';\nconst CLICK_CLOSE_CURVE_SQR_DIST = 10 ** 2;\nclass LivewireContourTool extends ContourSegmentationBaseTool {\n    static { this.toolName = 'LivewireContour'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextLines: defaultGetTextLines,\n            calculateStats: true,\n            preventHandleOutsideImage: false,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            snapHandleNearby: 2,\n            interpolation: {\n                enabled: false,\n                nearestEdge: 2,\n                showInterpolationPolyline: false,\n            },\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            actions: {\n                cancelInProgress: {\n                    method: 'cancelInProgress',\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const proximitySquared = proximity * proximity;\n            const canvasPoints = annotation.data.contour.polyline.map((p) => viewport.worldToCanvas(p));\n            let startPoint = canvasPoints[canvasPoints.length - 1];\n            for (let i = 0; i < canvasPoints.length; i++) {\n                const endPoint = canvasPoints[i];\n                const distanceToPointSquared = math.lineSegment.distanceToPointSquared(startPoint, endPoint, canvasCoords);\n                if (distanceToPointSquared <= proximitySquared) {\n                    return true;\n                }\n                startPoint = endPoint;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt, clearAnnotation = false) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            this.doneEditMemo();\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            if ((this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) ||\n                clearAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n                this.clearEditData();\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                return;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            this.triggerChangeEvent(annotation, enabledElement, changeType, contourHoleProcessingEnabled);\n            this.clearEditData();\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled = false) => {\n            if (changeType === ChangeTypes.Completed) {\n                triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, changeType);\n            }\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender, worldToSlice, sliceToWorld, newAnnotation, } = this.editData;\n            if (this.editData.closed) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const { canvas: canvasPos, world: worldPosOriginal } = currentPoints;\n            let worldPos = worldPosOriginal;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const controlPoints = this.editData.currentPath.getControlPoints();\n            let closePath = controlPoints.length >= 2 && doubleClick;\n            this.doneEditMemo();\n            this.createMemo(element, annotation, {\n                newAnnotation: newAnnotation && controlPoints.length === 1,\n            });\n            if (controlPoints.length >= 2) {\n                const closestHandlePoint = {\n                    index: -1,\n                    distSquared: Infinity,\n                };\n                for (let i = 0, len = controlPoints.length; i < len; i++) {\n                    const controlPoint = controlPoints[i];\n                    const worldControlPoint = sliceToWorld(controlPoint);\n                    const canvasControlPoint = viewport.worldToCanvas(worldControlPoint);\n                    const distSquared = math.point.distanceToPointSquared(canvasPos, canvasControlPoint);\n                    if (distSquared <= CLICK_CLOSE_CURVE_SQR_DIST &&\n                        distSquared < closestHandlePoint.distSquared) {\n                        closestHandlePoint.distSquared = distSquared;\n                        closestHandlePoint.index = i;\n                    }\n                }\n                if (closestHandlePoint.index === 0) {\n                    closePath = true;\n                }\n            }\n            const { snapHandleNearby } = this.configuration;\n            if (snapHandleNearby && !this.editData.closed) {\n                const currentPath = new LivewirePath();\n                const snapPoint = this.scissors.findMinNearby(worldToSlice(worldPosOriginal), 1);\n                const pathPoints = this.scissors.findPathToPoint(snapPoint);\n                currentPath.addPoints(pathPoints);\n                currentPath.prependPath(this.editData.confirmedPath);\n                worldPos = sliceToWorld(snapPoint);\n                this.editData.currentPath = currentPath;\n            }\n            this.editData.closed = this.editData.closed || closePath;\n            this.editData.confirmedPath = this.editData.currentPath;\n            const lastPoint = this.editData.currentPath.getLastPoint();\n            this.editData.confirmedPath.addControlPoint(lastPoint);\n            annotation.data.handles.points.push(sliceToWorld(lastPoint));\n            this.scissors.startSearch(worldToSlice(worldPos));\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (this.editData.closed) {\n                this.updateAnnotation(this.editData.confirmedPath);\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { element, currentPoints } = evt.detail;\n            const { world: worldPos, canvas: canvasPos } = currentPoints;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = canvasPos;\n            const { width: imgWidth, height: imgHeight } = this.scissors;\n            const { worldToSlice } = this.editData;\n            const slicePoint = worldToSlice(worldPos);\n            if (slicePoint[0] < 0 ||\n                slicePoint[1] < 0 ||\n                slicePoint[0] >= imgWidth ||\n                slicePoint[1] >= imgHeight) {\n                return;\n            }\n            const pathPoints = this.scissors.findPathToPoint(slicePoint);\n            const currentPath = new LivewirePath();\n            currentPath.addPoints(pathPoints);\n            currentPath.prependPath(this.editData.confirmedPath);\n            this.editData.currentPath = currentPath;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, movingTextBox, handleIndex, newAnnotation, } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                console.warn('Drag annotation not implemented');\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                this.editHandle(worldPos, element, annotation, handleIndex);\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            if (newAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.doneEditMemo();\n            this.scissors = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit: areaUnit,\n                };\n            }\n            const invalidated = annotation.invalidated;\n            annotation.invalidated = false;\n            if (invalidated) {\n                this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            }\n            return cachedStats;\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.contour.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    setupBaseEditData(worldPos, element, annotation, nextPos, contourHoleProcessingEnabled) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        this.isDrawing = true;\n        const viewportImageData = viewport.getImageData();\n        const { imageData: vtkImageData } = viewportImageData;\n        let worldToSlice;\n        let sliceToWorld;\n        let width;\n        let height;\n        let scalarData;\n        if (!(viewport instanceof VolumeViewport)) {\n            width = viewportImageData.dimensions[0];\n            height = viewportImageData.dimensions[1];\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                return [ijkPoint[0], ijkPoint[1]];\n            };\n            sliceToWorld = (point) => csUtils.transformIndexToWorld(vtkImageData, [point[0], point[1], 0]);\n            scalarData = viewportImageData.scalarData;\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const sliceImageData = csUtils.getCurrentVolumeViewportSlice(viewport);\n            const { sliceToIndexMatrix, indexToSliceMatrix } = sliceImageData;\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                const slicePoint = vec3.transformMat4([0, 0, 0], ijkPoint, indexToSliceMatrix);\n                return [slicePoint[0], slicePoint[1]];\n            };\n            sliceToWorld = (point) => {\n                const ijkPoint = vec3.transformMat4([0, 0, 0], [point[0], point[1], 0], sliceToIndexMatrix);\n                return csUtils.transformIndexToWorld(vtkImageData, ijkPoint);\n            };\n            scalarData = sliceImageData.scalarData;\n            width = sliceImageData.width;\n            height = sliceImageData.height;\n        }\n        else {\n            throw new Error('Viewport not supported');\n        }\n        scalarData = csUtils.convertToGrayscale(scalarData, width, height);\n        const { voiRange } = viewport.getProperties();\n        const startPos = worldToSlice(worldPos);\n        this.scissors = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n        if (nextPos) {\n            this.scissorsNext = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n            this.scissorsNext.startSearch(worldToSlice(nextPos));\n        }\n        this.scissors.startSearch(startPos);\n        const newAnnotation = !nextPos;\n        const confirmedPath = new LivewirePath();\n        const currentPath = new LivewirePath();\n        const currentPathNext = newAnnotation ? undefined : new LivewirePath();\n        confirmedPath.addPoint(startPos);\n        confirmedPath.addControlPoint(startPos);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        const lastCanvasPoint = viewport.worldToCanvas(worldPos);\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            newAnnotation,\n            hasMoved: false,\n            lastCanvasPoint,\n            confirmedPath,\n            currentPath,\n            confirmedPathNext: currentPathNext,\n            closed: false,\n            handleIndex: this.editData?.handleIndex ?? annotation.handles?.activeHandleIndex,\n            worldToSlice,\n            sliceToWorld,\n            contourHoleProcessingEnabled,\n        };\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { world: worldPos } = currentPoints;\n        const annotation = this.createAnnotation(evt);\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        this.setupBaseEditData(worldPos, element, annotation, undefined, contourHoleProcessingEnabled);\n        this.addAnnotation(annotation, element);\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(this.editData.viewportIdsToRender);\n        return annotation;\n    }\n    clearEditData() {\n        this.editData = null;\n        this.scissors = null;\n        this.scissorsNext = null;\n        this.isDrawing = false;\n    }\n    editHandle(worldPos, element, annotation, handleIndex) {\n        const { data } = annotation;\n        const { points: handlePoints } = data.handles;\n        const { length: numHandles } = handlePoints;\n        const previousHandle = handlePoints[(handleIndex - 1 + numHandles) % numHandles];\n        const nextHandle = handlePoints[(handleIndex + 1) % numHandles];\n        if (!this.editData?.confirmedPathNext) {\n            this.setupBaseEditData(previousHandle, element, annotation, nextHandle);\n            const { polyline } = data.contour;\n            const confirmedPath = new LivewirePath();\n            const confirmedPathNext = new LivewirePath();\n            const { worldToSlice } = this.editData;\n            const previousIndex = findHandlePolylineIndex(annotation, handleIndex - 1);\n            const nextIndex = findHandlePolylineIndex(annotation, handleIndex + 1);\n            if (nextIndex === -1 || previousIndex === -1) {\n                throw new Error(`Can't find handle index ${nextIndex === -1 && nextHandle} ${previousIndex === -1 && previousHandle}`);\n            }\n            if (handleIndex === 0) {\n                confirmedPathNext.addPoints(polyline.slice(nextIndex + 1, previousIndex).map(worldToSlice));\n            }\n            else {\n                confirmedPath.addPoints(polyline.slice(0, previousIndex + 1).map(worldToSlice));\n                confirmedPathNext.addPoints(polyline.slice(nextIndex, polyline.length).map(worldToSlice));\n            }\n            this.editData.confirmedPath = confirmedPath;\n            this.editData.confirmedPathNext = confirmedPathNext;\n        }\n        const { editData, scissors } = this;\n        const { worldToSlice, sliceToWorld } = editData;\n        const { activeHandleIndex } = data.handles;\n        if (activeHandleIndex === null || activeHandleIndex === undefined) {\n            data.handles.activeHandleIndex = handleIndex;\n        }\n        else if (activeHandleIndex !== handleIndex) {\n            throw new Error(`Trying to edit a different handle than the one currently being edited ${handleIndex}!==${data.handles.activeHandleIndex}`);\n        }\n        const slicePos = worldToSlice(worldPos);\n        if (slicePos[0] < 0 ||\n            slicePos[0] >= scissors.width ||\n            slicePos[1] < 0 ||\n            slicePos[1] >= scissors.height) {\n            return;\n        }\n        handlePoints[handleIndex] = sliceToWorld(slicePos);\n        const pathPointsLeft = scissors.findPathToPoint(slicePos);\n        const pathPointsRight = this.scissorsNext.findPathToPoint(slicePos);\n        const currentPath = new LivewirePath();\n        currentPath.prependPath(editData.confirmedPath);\n        if (handleIndex !== 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        currentPath.addPoints(pathPointsRight.reverse());\n        currentPath.appendPath(editData.confirmedPathNext);\n        if (handleIndex === 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        editData.currentPath = currentPath;\n        annotation.invalidated = true;\n        editData.hasMoved = true;\n        editData.closed = true;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        this.updateAnnotation(this.editData?.currentPath);\n        return super.renderAnnotation(enabledElement, svgDrawingHelper);\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    createAnnotation(evt) {\n        const contourSegmentationAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const annotation = csUtils.deepMerge(contourSegmentationAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n            },\n        });\n        return annotation;\n    }\n    cancelInProgress(element, config, evt) {\n        if (!this.editData) {\n            this.undo();\n            return;\n        }\n        this._endCallback(evt, true);\n    }\n    renderAnnotationInstance(renderContext) {\n        const { annotation, enabledElement, svgDrawingHelper, annotationStyle, targetId, } = renderContext;\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const { worldToCanvas } = viewport;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color } = annotationStyle;\n        if (highlighted ||\n            (newAnnotation &&\n                annotation.annotationUID === this.editData?.annotation?.annotationUID)) {\n            const handleGroupUID = '0';\n            const canvasHandles = handles.points.map(worldToCanvas);\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasHandles, {\n                color,\n                lineDash,\n                lineWidth,\n            });\n        }\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId]?.areaUnit === null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        return true;\n    }\n    updateAnnotation(livewirePath) {\n        if (!this.editData || !livewirePath) {\n            return;\n        }\n        const { annotation, sliceToWorld, worldToSlice, closed, newAnnotation } = this.editData;\n        let { pointArray: imagePoints } = livewirePath;\n        if (imagePoints.length > 1) {\n            imagePoints = [...imagePoints, imagePoints[0]];\n        }\n        const targetWindingDirection = newAnnotation && closed ? ContourWindingDirection.Clockwise : undefined;\n        this.updateContourPolyline(annotation, {\n            points: imagePoints,\n            closed,\n            targetWindingDirection,\n        }, {\n            canvasToWorld: sliceToWorld,\n            worldToCanvas: worldToSlice,\n        });\n    }\n}\nexport default LivewireContourTool;\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { ChangeTypes, Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nconst { transformWorldToIndex } = csUtils;\nclass ProbeTool extends AnnotationTool {\n    static { this.toolName = 'Probe'; }\n    static { this.probeDefaults = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            handleRadius: '6',\n        },\n    }; }\n    constructor(toolProps = {}, defaultToolProps) {\n        super(toolProps, AnnotationTool.mergeDefaultProps(ProbeTool.probeDefaults, defaultToolProps));\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const annotation = (this.constructor).createAnnotationForViewport(viewport, {\n                data: {\n                    handles: { points: [[...worldPos]] },\n                },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { viewportId, renderingEngine } = getEnabledElement(element);\n            this.eventDispatchDetail = {\n                viewportId,\n                renderingEngineId: renderingEngine.id,\n            };\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            if (newAnnotation) {\n                this.createMemo(element, annotation, { newAnnotation });\n            }\n            this.editData = null;\n            this.isDrawing = false;\n            this.doneEditMemo();\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            this.createMemo(element, annotation, { newAnnotation });\n            data.handles.points[0] = [...worldPos];\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const annotationUID = annotation.annotationUID;\n                const data = annotation.data;\n                const point = data.handles.points[0];\n                const canvasCoordinates = viewport.worldToCanvas(point);\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!data.cachedStats) {\n                    data.cachedStats = {};\n                }\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].value === null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        index: null,\n                        value: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement, ChangeTypes.StatsUpdated);\n                }\n                else if (annotation.invalidated) {\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const handleGroupUID = '0';\n                drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color, lineWidth, handleRadius: this.configuration.handleRadius });\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (textLines) {\n                    const textCanvasCoordinates = [\n                        canvasCoordinates[0] + 6,\n                        canvasCoordinates[1] - 6,\n                    ];\n                    const textUID = '0';\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], options);\n                }\n            }\n            return renderStatus;\n        };\n    }\n    isPointNearTool(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { data } = annotation;\n        const point = data.handles.points[0];\n        const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n        return vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity;\n    }\n    toolSelectedCallback() { }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, viewUp, instance, viewport, } = this.hydrateBase(ProbeTool, enabledElement, points, options);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { data } = annotation;\n        const point = data.handles.points[0];\n        const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n        const near = vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity;\n        if (near === true) {\n            return point;\n        }\n    }\n    handleSelectedCallback(evt, annotation) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement, changeType = ChangeTypes.StatsUpdated) {\n        const data = annotation.data;\n        const { renderingEngineId, viewport } = enabledElement;\n        const { element } = viewport;\n        const worldPos = data.handles.points[0];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const pixelUnitsOptions = {\n                isPreScaled: isViewportPreScaled(viewport, targetId),\n                isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n            };\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { dimensions, imageData, metadata, voxelManager } = image;\n            const modality = metadata.Modality;\n            let ijk = transformWorldToIndex(imageData, worldPos);\n            ijk = vec3.round(ijk, ijk);\n            if (csUtils.indexWithinDimensions(ijk, dimensions)) {\n                this.isHandleOutsideImage = false;\n                let value = voxelManager.getAtIJKPoint(ijk);\n                if (targetId.startsWith('imageId:')) {\n                    const imageId = targetId.split('imageId:')[1];\n                    const imageURI = csUtils.imageIdToURI(imageId);\n                    const viewports = csUtils.getViewportsWithImageURI(imageURI);\n                    const viewport = viewports[0];\n                    ijk[2] = viewport.getCurrentImageIdIndex();\n                }\n                let modalityUnit;\n                if (modality === 'US') {\n                    const calibratedResults = getCalibratedProbeUnitsAndValue(image, [\n                        ijk,\n                    ]);\n                    const hasEnhancedRegionValues = calibratedResults.values.every((value) => value !== null);\n                    value = (hasEnhancedRegionValues ? calibratedResults.values : value);\n                    modalityUnit = hasEnhancedRegionValues\n                        ? calibratedResults.units\n                        : 'raw';\n                }\n                else {\n                    modalityUnit = getPixelValueUnits(modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                }\n                cachedStats[targetId] = {\n                    index: ijk,\n                    value,\n                    Modality: modality,\n                    modalityUnit,\n                };\n            }\n            else {\n                this.isHandleOutsideImage = true;\n                cachedStats[targetId] = {\n                    index: ijk,\n                    Modality: modality,\n                };\n            }\n        }\n        const invalidated = annotation.invalidated;\n        annotation.invalidated = false;\n        if (invalidated) {\n            triggerAnnotationModified(annotation, element, changeType);\n        }\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined || !index) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    if (value instanceof Array && modalityUnit instanceof Array) {\n        for (let i = 0; i < value.length; i++) {\n            textLines.push(`${csUtils.roundNumber(value[i])} ${modalityUnit[i]}`);\n        }\n    }\n    else {\n        textLines.push(`${csUtils.roundNumber(value)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nexport default ProbeTool;\n","import { cache, utilities as csUtils, getEnabledElement, } from '@cornerstonejs/core';\nimport { growCut } from '../../utilities/segmentation';\nimport GrowCutBaseTool from '../base/GrowCutBaseTool';\nimport { calculateGrowCutSeeds } from '../../utilities/segmentation/growCut/runOneClickGrowCut';\nclass RegionSegmentPlusTool extends GrowCutBaseTool {\n    static { this.toolName = 'RegionSegmentPlus'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            isPartialVolume: false,\n            positiveSeedVariance: 0.4,\n            negativeSeedVariance: 0.9,\n            subVolumePaddingPercentage: 0.1,\n            islandRemoval: {\n                enabled: false,\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseTimer = null;\n        this.allowedToProceed = false;\n    }\n    mouseMoveCallback(evt) {\n        const eventData = evt.detail;\n        const { currentPoints, element } = eventData;\n        const { world: worldPoint } = currentPoints;\n        element.style.cursor = 'default';\n        if (this.mouseTimer !== null) {\n            window.clearTimeout(this.mouseTimer);\n            this.mouseTimer = null;\n        }\n        this.mouseTimer = window.setTimeout(() => {\n            this.onMouseStable(evt, worldPoint, element);\n        }, this.configuration.mouseStabilityDelay || 500);\n    }\n    async onMouseStable(evt, worldPoint, element) {\n        await super.preMouseDownCallback(evt);\n        const refVolume = cache.getVolume(this.growCutData.segmentation.referencedVolumeId);\n        const seeds = calculateGrowCutSeeds(refVolume, worldPoint, {});\n        const { positiveSeedIndices, negativeSeedIndices } = seeds;\n        let cursor;\n        if (positiveSeedIndices.size / negativeSeedIndices.size > 20 ||\n            negativeSeedIndices.size < 30) {\n            cursor = 'not-allowed';\n            this.allowedToProceed = false;\n        }\n        else {\n            cursor = 'copy';\n            this.allowedToProceed = true;\n        }\n        const enabledElement = getEnabledElement(element);\n        if (element) {\n            element.style.cursor = cursor;\n            requestAnimationFrame(() => {\n                if (element.style.cursor !== cursor) {\n                    element.style.cursor = cursor;\n                }\n            });\n        }\n        if (this.allowedToProceed) {\n            this.seeds = seeds;\n        }\n        if (enabledElement && enabledElement.viewport) {\n            enabledElement.viewport.render();\n        }\n    }\n    async preMouseDownCallback(evt) {\n        if (!this.allowedToProceed) {\n            return false;\n        }\n        const eventData = evt.detail;\n        const { currentPoints, element } = eventData;\n        const enabledElement = getEnabledElement(element);\n        if (enabledElement) {\n            element.style.cursor = 'wait';\n            requestAnimationFrame(() => {\n                if (element.style.cursor !== 'wait') {\n                    element.style.cursor = 'wait';\n                }\n            });\n        }\n        const { world: worldPoint } = currentPoints;\n        await super.preMouseDownCallback(evt);\n        this.growCutData = csUtils.deepMerge(this.growCutData, {\n            worldPoint,\n            islandRemoval: {\n                worldIslandPoints: [worldPoint],\n            },\n        });\n        this.growCutData.worldPoint = worldPoint;\n        this.growCutData.islandRemoval = {\n            worldIslandPoints: [worldPoint],\n        };\n        await this.runGrowCut();\n        if (element) {\n            element.style.cursor = 'default';\n        }\n        return true;\n    }\n    getRemoveIslandData(growCutData) {\n        const { worldPoint } = growCutData;\n        return {\n            worldIslandPoints: [worldPoint],\n        };\n    }\n    async getGrowCutLabelmap(growCutData) {\n        const { segmentation: { referencedVolumeId }, worldPoint, options, } = growCutData;\n        const { subVolumePaddingPercentage } = this.configuration;\n        const mergedOptions = {\n            ...options,\n            subVolumePaddingPercentage,\n            seeds: this.seeds,\n        };\n        return growCut.runOneClickGrowCut({\n            referencedVolumeId,\n            worldPosition: worldPoint,\n            options: mergedOptions,\n        });\n    }\n}\nexport default RegionSegmentPlusTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils, getRenderingEngine, } from '@cornerstonejs/core';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { Events } from '../../enums';\nimport triggerAnnotationRenderForViewportUIDs from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { growCut } from '../../utilities/segmentation';\nimport GrowCutBaseTool from '../base/GrowCutBaseTool';\nclass RegionSegmentTool extends GrowCutBaseTool {\n    static { this.toolName = 'RegionSegment'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            isPartialVolume: true,\n            positiveSeedVariance: 0.5,\n            negativeSeedVariance: 0.9,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const { world: currentWorldPoint } = currentPoints;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.growCutData.circleBorderPoint = currentWorldPoint;\n            triggerAnnotationRenderForViewportUIDs([viewport.id]);\n        };\n        this._endCallback = async (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.runGrowCut();\n            this._deactivateDraw(element);\n            this.growCutData = null;\n            resetElementCursor(element);\n            triggerAnnotationRenderForViewportUIDs([viewport.id]);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n    }\n    async preMouseDownCallback(evt) {\n        const eventData = evt.detail;\n        const { element, currentPoints } = eventData;\n        const { world: worldPoint } = currentPoints;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        await super.preMouseDownCallback(evt);\n        Object.assign(this.growCutData, {\n            circleCenterPoint: worldPoint,\n            circleBorderPoint: worldPoint,\n        });\n        this._activateDraw(element);\n        hideElementCursor(element);\n        triggerAnnotationRenderForViewportUIDs([viewport.id]);\n        return true;\n    }\n    async getGrowCutLabelmap(growCutData) {\n        const { segmentation: { referencedVolumeId }, renderingEngineId, viewportId, circleCenterPoint, circleBorderPoint, options, } = growCutData;\n        const renderingEngine = getRenderingEngine(renderingEngineId);\n        const viewport = renderingEngine.getViewport(viewportId);\n        const worldCircleRadius = vec3.len(vec3.sub(vec3.create(), circleCenterPoint, circleBorderPoint));\n        const sphereInfo = {\n            center: circleCenterPoint,\n            radius: worldCircleRadius,\n        };\n        return growCut.runGrowCutForSphere(referencedVolumeId, sphereInfo, viewport, options);\n    }\n    _activateDraw(element) {\n        element.addEventListener(Events.MOUSE_UP, this._endCallback);\n        element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n        element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this.growCutData) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const { segmentation: segmentationData, circleCenterPoint, circleBorderPoint, } = this.growCutData;\n        const canvasCenterPoint = viewport.worldToCanvas(circleCenterPoint);\n        const canvasBorderPoint = viewport.worldToCanvas(circleBorderPoint);\n        const vecCenterToBorder = vec2.sub(vec2.create(), canvasBorderPoint, canvasCenterPoint);\n        const circleRadius = vec2.len(vecCenterToBorder);\n        if (csUtils.isEqual(circleRadius, 0)) {\n            return;\n        }\n        const annotationUID = 'growcut';\n        const circleUID = '0';\n        const { color } = this.getSegmentStyle({\n            segmentationId: segmentationData.segmentationId,\n            segmentIndex: segmentationData.segmentIndex,\n            viewportId: viewport.id,\n        });\n        drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, canvasCenterPoint, circleRadius, {\n            color,\n        });\n    }\n}\nexport default RegionSegmentTool;\n","import { utilities } from '@cornerstonejs/core';\nimport SplineROITool from './SplineROITool';\nclass SplineContourSegmentationTool extends SplineROITool {\n    static { this.toolName = 'SplineContourSegmentationTool'; }\n    constructor(toolProps) {\n        const initialProps = utilities.deepMerge({\n            configuration: {\n                calculateStats: false,\n            },\n        }, toolProps);\n        super(initialProps);\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nexport default SplineContourSegmentationTool;\n","import { getEnabledElement, eventTarget, triggerEvent, utilities, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, getChildAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawPolyline as drawPolylineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, MouseBindings, KeyboardBindings, ChangeTypes, } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport * as math from '../../utilities/math';\nimport throttle from '../../utilities/throttle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { CardinalSpline } from './splines/CardinalSpline';\nimport { LinearSpline } from './splines/LinearSpline';\nimport { CatmullRomSpline } from './splines/CatmullRomSpline';\nimport { BSpline } from './splines/BSpline';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities';\nconst SPLINE_MIN_POINTS = 3;\nconst SPLINE_CLICK_CLOSE_CURVE_DIST = 10;\nconst DEFAULT_SPLINE_CONFIG = {\n    resolution: 20,\n    controlPointAdditionDistance: 6,\n    controlPointDeletionDistance: 6,\n    showControlPointsConnectors: false,\n    controlPointAdditionEnabled: true,\n    controlPointDeletionEnabled: true,\n};\nvar SplineTypesEnum;\n(function (SplineTypesEnum) {\n    SplineTypesEnum[\"Cardinal\"] = \"CARDINAL\";\n    SplineTypesEnum[\"Linear\"] = \"LINEAR\";\n    SplineTypesEnum[\"CatmullRom\"] = \"CATMULLROM\";\n    SplineTypesEnum[\"BSpline\"] = \"BSPLINE\";\n})(SplineTypesEnum || (SplineTypesEnum = {}));\nvar SplineToolActions;\n(function (SplineToolActions) {\n    SplineToolActions[\"AddControlPoint\"] = \"addControlPoint\";\n    SplineToolActions[\"DeleteControlPoint\"] = \"deleteControlPoint\";\n})(SplineToolActions || (SplineToolActions = {}));\nclass SplineROITool extends ContourSegmentationBaseTool {\n    static { this.toolName = 'SplineROI'; }\n    static { this.SplineTypes = SplineTypesEnum; }\n    static { this.Actions = SplineToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            calculateStats: true,\n            getTextLines: defaultGetTextLines,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            spline: {\n                configuration: {\n                    [SplineTypesEnum.Cardinal]: {\n                        Class: CardinalSpline,\n                        scale: 0.5,\n                    },\n                    [SplineTypesEnum.CatmullRom]: {\n                        Class: CatmullRomSpline,\n                    },\n                    [SplineTypesEnum.Linear]: {\n                        Class: LinearSpline,\n                    },\n                    [SplineTypesEnum.BSpline]: {\n                        Class: BSpline,\n                        controlPointAdditionEnabled: false,\n                        controlPointDeletionEnabled: false,\n                        showControlPointsConnectors: true,\n                    },\n                },\n                type: SplineTypesEnum.CatmullRom,\n                drawPreviewEnabled: true,\n                lastControlPointDeletionKeys: ['Backspace', 'Delete'],\n            },\n            actions: {\n                [SplineToolActions.AddControlPoint]: {\n                    method: 'addControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n                [SplineToolActions.DeleteControlPoint]: {\n                    method: 'deleteControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Ctrl,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.fireChangeOnUpdate = null;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { instance: spline } = annotation.data.spline;\n            return spline.isPointNearCurve(canvasCoords, proximity);\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            annotation.autoGenerated = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const image = this.getTargetImageData(this.getTargetId(enabledElement.viewport));\n            const { imageData, dimensions } = image;\n            this.isHandleOutsideImage = data.handles.points\n                .map((p) => utilities.transformWorldToIndex(imageData, p))\n                .some((index) => !utilities.indexWithinDimensions(index, dimensions));\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            if (!this.fireChangeOnUpdate) {\n                this.fireChangeOnUpdate = {\n                    annotationUID: annotation.annotationUID,\n                    changeType,\n                    contourHoleProcessingEnabled,\n                };\n            }\n            else {\n                this.fireChangeOnUpdate.annotationUID = annotation.annotationUID;\n                this.fireChangeOnUpdate.changeType = changeType;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.doneEditMemo();\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._keyDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const key = eventDetail.key ?? '';\n            const { lastControlPointDeletionKeys } = this.configuration.spline;\n            const deleteLastPoint = lastControlPointDeletionKeys.includes(key);\n            if (!deleteLastPoint) {\n                return;\n            }\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length === SPLINE_MIN_POINTS) {\n                this.cancel(element);\n                return;\n            }\n            else {\n                const controlPointIndex = data.handles.points.length - 1;\n                this._deleteControlPointByIndex(element, annotation, controlPointIndex);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { drawPreviewEnabled } = this.configuration.spline;\n            if (!drawPreviewEnabled) {\n                return;\n            }\n            const { element } = evt.detail;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = evt.detail.currentPoints.canvas;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            if (data.contour.closed) {\n                return;\n            }\n            this.doneEditMemo();\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const { canvas: canvasPoint, world: worldPoint } = currentPoints;\n            let closeContour = data.handles.points.length >= 2 && doubleClick;\n            let addNewPoint = true;\n            if (data.handles.points.length) {\n                this.createMemo(element, annotation, {\n                    newAnnotation: data.handles.points.length === 1,\n                });\n            }\n            if (data.handles.points.length >= 3) {\n                this.createMemo(element, annotation);\n                const { instance: spline } = data.spline;\n                const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n                if (closestControlPoint?.index === 0) {\n                    addNewPoint = false;\n                    closeContour = true;\n                }\n            }\n            if (addNewPoint) {\n                data.handles.points.push(worldPoint);\n            }\n            data.contour.closed = data.contour.closed || closeContour;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (data.contour.closed) {\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, newAnnotation, } = this.editData;\n            const { data } = annotation;\n            this.createMemo(element, annotation, { newAnnotation });\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                this.moveAnnotation(annotation, worldPosDelta);\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.triggerAnnotationCompleted = (annotation, contourHoleProcessingEnabled) => {\n            const eventType = Events.ANNOTATION_COMPLETED;\n            const eventDetail = {\n                annotation,\n                changeType: ChangeTypes.Completed,\n                contourHoleProcessingEnabled,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled) => {\n            if (changeType === ChangeTypes.Completed) {\n                this.triggerAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                this.triggerAnnotationModified(annotation, enabledElement, changeType);\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.spline.instance.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.addControlPointCallback = (evt, annotation) => {\n            const { data } = annotation;\n            const splineType = data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointAdditionDistance;\n            if (splineConfig.controlPointAdditionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { instance: spline } = data.spline;\n            const canvasPos = evt.detail.currentPoints.canvas;\n            const closestPointInfo = spline.getClosestPoint(canvasPos);\n            if (closestPointInfo.distance > maxDist) {\n                return;\n            }\n            const { index, point: canvasPoint } = spline.addControlPointAtU(closestPointInfo.uValue);\n            data.handles.points.splice(index, 0, canvasToWorld(canvasPoint));\n            annotation.invalidated = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.deleteControlPointCallback = (evt, annotation) => {\n            const splineType = annotation.data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointDeletionDistance;\n            if (splineConfig.controlPointDeletionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const { canvas: canvasPos } = currentPoints;\n            const { instance: spline } = annotation.data.spline;\n            const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPos, maxDist);\n            if (!closestControlPoint) {\n                return;\n            }\n            this._deleteControlPointByIndex(element, annotation, closestControlPoint.index);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit,\n                };\n            }\n            const invalidated = annotation.invalidated;\n            annotation.invalidated = false;\n            if (invalidated) {\n                this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            }\n            return cachedStats;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { canvas: canvasPos } = currentPoints;\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        const annotation = this.createAnnotation(evt);\n        this.isDrawing = true;\n        this.addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n            lastCanvasPoint: canvasPos,\n            contourHoleProcessingEnabled,\n        };\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n        if (newAnnotation) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        super.cancelAnnotation(annotation);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        this.editData = null;\n        return annotation.annotationUID;\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, targetId, svgDrawingHelper, annotationStyle } = renderContext;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { element } = viewport;\n        const annotation = renderContext.annotation;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const { points: controlPoints, activeHandleIndex } = handles;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color, locked: annotationLocked, } = annotationStyle;\n        const canvasCoordinates = controlPoints.map((p) => worldToCanvas(p));\n        const { drawPreviewEnabled } = this.configuration.spline;\n        const splineType = annotation.data.spline.type;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = annotation.data.spline.instance;\n        const childAnnotations = getChildAnnotations(annotation);\n        const missingAnnotation = childAnnotations.findIndex((it) => !it);\n        if (missingAnnotation !== -1) {\n            throw new Error(`Can't find annotation for child ${annotation.childAnnotationUIDs.join()}`);\n        }\n        const splineAnnotationsGroup = [annotation, ...childAnnotations].filter((annotation) => this._isSplineROIAnnotation(annotation));\n        splineAnnotationsGroup.forEach((annotation) => {\n            const spline = this._updateSplineInstance(element, annotation);\n            const splinePolylineCanvas = spline.getPolylinePoints();\n            this.updateContourPolyline(annotation, {\n                points: splinePolylineCanvas,\n                closed: data.contour.closed,\n                targetWindingDirection: ContourWindingDirection.Clockwise,\n            }, viewport, { updateWindingDirection: data.contour.closed });\n        });\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId].areaUnit == null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        let activeHandleCanvasCoords;\n        if (!annotationLocked && !this.editData && activeHandleIndex !== null) {\n            activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n        }\n        if (activeHandleCanvasCoords || newAnnotation || highlighted) {\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                color,\n                lineWidth,\n                handleRadius: '3',\n            });\n        }\n        if (drawPreviewEnabled &&\n            spline.numControlPoints > 1 &&\n            this.editData?.lastCanvasPoint &&\n            !spline.closed) {\n            const { lastCanvasPoint } = this.editData;\n            const previewPolylinePoints = spline.getPreviewPolylinePoints(lastCanvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'previewSplineChange', previewPolylinePoints, {\n                color: '#9EA0CA',\n                lineDash: lineDash,\n                lineWidth: 1,\n            });\n        }\n        if (splineConfig.showControlPointsConnectors) {\n            const controlPointsConnectors = [...canvasCoordinates];\n            if (spline.closed) {\n                controlPointsConnectors.push(canvasCoordinates[0]);\n            }\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'controlPointsConnectors', controlPointsConnectors, {\n                color: 'rgba(255, 255, 255, 0.5)',\n                lineWidth: 1,\n            });\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        if (this.fireChangeOnUpdate?.annotationUID === annotationUID) {\n            this.triggerChangeEvent(annotation, enabledElement, this.fireChangeOnUpdate.changeType, this.fireChangeOnUpdate.contourHoleProcessingEnabled);\n            this.fireChangeOnUpdate = null;\n        }\n        annotation.invalidated = false;\n        return true;\n    }\n    createInterpolatedSplineControl(annotation) {\n        if (annotation.data.handles.points?.length) {\n            return;\n        }\n        const { polyline } = annotation.data.contour;\n        if (!polyline || !polyline.length) {\n            return;\n        }\n        annotation.data.handles.points = [];\n        const { points } = annotation.data.handles;\n        const increment = Math.max(10, Math.floor(polyline.length / 20));\n        for (let i = 0; i < polyline.length - increment; i += increment) {\n            points.push(polyline[i]);\n        }\n        points.push(polyline[polyline.length - 1]);\n    }\n    createAnnotation(evt) {\n        const contourAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const { type: splineType } = this.configuration.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = new splineConfig.Class();\n        const createSpline = () => ({\n            type: splineConfig.type,\n            instance: spline,\n            resolution: splineConfig.resolution,\n        });\n        let onInterpolationComplete;\n        if (this.configuration.interpolation?.enabled) {\n            onInterpolationComplete = (annotation) => {\n                annotation.data.spline ||= createSpline();\n                this.createInterpolatedSplineControl(annotation);\n            };\n        }\n        return utilities.deepMerge(contourAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n                spline: createSpline(),\n                cachedStats: {},\n            },\n            onInterpolationComplete,\n        });\n    }\n    _deleteControlPointByIndex(element, annotation, controlPointIndex) {\n        const enabledElement = getEnabledElement(element);\n        const { points: controlPoints } = annotation.data.handles;\n        if (controlPoints.length === 3) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        else {\n            controlPoints.splice(controlPointIndex, 1);\n        }\n        const { renderingEngine } = enabledElement;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        annotation.invalidated = true;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    _isSplineROIAnnotation(annotation) {\n        return !!annotation.data?.spline;\n    }\n    _getSplineConfig(type) {\n        const { configuration: config } = this;\n        const splineConfigs = config.spline.configuration;\n        return Object.assign({ type }, DEFAULT_SPLINE_CONFIG, splineConfigs[type]);\n    }\n    _updateSplineInstance(element, annotation) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { data } = annotation;\n        const { type: splineType, instance: spline } = annotation.data.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const worldPoints = data.handles.points;\n        const canvasPoints = worldPoints.map(worldToCanvas);\n        const resolution = splineConfig.resolution !== undefined\n            ? parseInt(splineConfig.resolution)\n            : undefined;\n        const scale = splineConfig.scale !== undefined\n            ? parseFloat(splineConfig.scale)\n            : undefined;\n        spline.setControlPoints(canvasPoints);\n        spline.closed = !!data.contour.closed;\n        if (!spline.fixedResolution &&\n            resolution !== undefined &&\n            spline.resolution !== resolution) {\n            spline.resolution = resolution;\n            annotation.invalidated = true;\n        }\n        if (spline instanceof CardinalSpline &&\n            !spline.fixedScale &&\n            scale !== undefined &&\n            spline.scale !== scale) {\n            spline.scale = scale;\n            annotation.invalidated = true;\n        }\n        return spline;\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        if (points.length < SPLINE_MIN_POINTS) {\n            console.warn('Spline requires at least 3 control points');\n            return;\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, viewUp, instance, viewport, } = this.hydrateBase(SplineROITool, enabledElement, points, options);\n        const splineType = options?.splineType || SplineTypesEnum.CatmullRom;\n        const splineConfig = instance._getSplineConfig(splineType);\n        const SplineClass = splineConfig.Class;\n        const splineInstance = new SplineClass();\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n                label: '',\n                cachedStats: {},\n                spline: {\n                    type: splineType,\n                    instance: splineInstance,\n                },\n                contour: {\n                    closed: true,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: true,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, isEmptyArea, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${utilities.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\nexport default SplineROITool;\n","import { ChangeTypes, Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, StackViewport, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawHandle as drawHandleSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { distanceToPoint } from '../../utilities/math/point';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nimport { lineSegment } from '../../utilities/math';\nconst { transformWorldToIndex } = csUtils;\nclass UltrasoundDirectionalTool extends AnnotationTool {\n    static { this.toolName = 'UltrasoundDirectionalTool'; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            displayBothAxesDistances: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.startedDrawing) {\n                return;\n            }\n            this.startedDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('UltrasoundDirectionalTool can only be used on a StackViewport');\n            }\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.startedDrawing && data.handles.points.length === 1) {\n                this.editData.handleIndex = 1;\n                return;\n            }\n            this.startedDrawing = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.startedDrawing = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].xValues == null) {\n                    data.cachedStats[targetId] = {\n                        xValues: [0, 0],\n                        yValues: [0, 0],\n                        isHorizontal: false,\n                        units: [''],\n                        isUnitless: false,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let handleGroupUID = '0';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[0], {\n                    color,\n                }, 0);\n                renderStatus = true;\n                if (canvasCoordinates.length !== 2) {\n                    return renderStatus;\n                }\n                handleGroupUID = '1';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[1], {\n                    color,\n                }, 1);\n                const isUnitless = data.cachedStats[targetId].isUnitless;\n                if (!isUnitless) {\n                    const canvasPoint1 = canvasCoordinates[0];\n                    const canvasPoint2 = canvasCoordinates[1];\n                    const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                    const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                    const isHorizontal = data.cachedStats[targetId].isHorizontal;\n                    let projectedPointCanvas = [0, 0];\n                    if (isHorizontal) {\n                        projectedPointCanvas = [\n                            canvasPoint1[0] + canvasDeltaX,\n                            canvasPoint1[1],\n                        ];\n                    }\n                    else {\n                        projectedPointCanvas = [\n                            canvasPoint1[0],\n                            canvasPoint1[1] + canvasDeltaY,\n                        ];\n                    }\n                    let dataId = `${annotationUID}-line-1`;\n                    let lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                    dataId = `${annotationUID}-line-2`;\n                    lineUID = '2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        lineDash: [1, 1],\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                else {\n                    const dataId = `${annotationUID}-line-1`;\n                    const lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId, this.configuration);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    toolSelectedCallback(evt, annotation, interactionType, canvasCoords) {\n        return;\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        this.editData = {\n            handleIndex,\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 2) {\n            return;\n        }\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData } = image;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const imageIndex1 = transformWorldToIndex(imageData, worldPos1);\n            const imageIndex2 = transformWorldToIndex(imageData, worldPos2);\n            const { values: values1, units: units1 } = getCalibratedProbeUnitsAndValue(image, [imageIndex1]);\n            const { values: values2, units: units2 } = getCalibratedProbeUnitsAndValue(image, [imageIndex2]);\n            let xValues, yValues, units, isHorizontal;\n            let isUnitless = false;\n            if (units1[0] !== units2[0] ||\n                units1[1] !== units2[1] ||\n                (units1[0] === 'raw' && units2[0] === 'raw')) {\n                const value = distanceToPoint(worldPos1, worldPos2);\n                xValues = [value, 0];\n                yValues = [value, 0];\n                units = ['px'];\n                isUnitless = true;\n            }\n            else {\n                const canvasPoint1 = enabledElement.viewport.worldToCanvas(worldPos1);\n                const canvasPoint2 = enabledElement.viewport.worldToCanvas(worldPos2);\n                const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                isHorizontal = Math.abs(canvasDeltaX) > Math.abs(canvasDeltaY);\n                xValues = [values1[0], values2[0]];\n                yValues = [values1[1], values2[1]];\n                units = [units1[0], units1[1]];\n            }\n            cachedStats[targetId] = {\n                xValues,\n                yValues,\n                isHorizontal,\n                units,\n                isUnitless,\n            };\n        }\n        const invalidated = annotation.invalidated;\n        annotation.invalidated = false;\n        if (invalidated) {\n            triggerAnnotationModified(annotation, element, ChangeTypes.StatsUpdated);\n        }\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId, configuration) {\n    const cachedStats = data.cachedStats[targetId];\n    const { xValues, yValues, units, isUnitless, isHorizontal } = cachedStats;\n    if (isUnitless) {\n        return [`${csUtils.roundNumber(xValues[0])} px`];\n    }\n    if (configuration.displayBothAxesDistances) {\n        const dist1 = Math.abs(xValues[1] - xValues[0]);\n        const dist2 = Math.abs(yValues[1] - yValues[0]);\n        return [\n            `${csUtils.roundNumber(dist1)} ${units[0]}`,\n            `${csUtils.roundNumber(dist2)} ${units[1]}`,\n        ];\n    }\n    if (isHorizontal) {\n        const dist = Math.abs(xValues[1] - xValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[0]}`];\n    }\n    else {\n        const dist = Math.abs(yValues[1] - yValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[1]}`];\n    }\n}\nexport default UltrasoundDirectionalTool;\n","import { vec3, vec2 } from 'gl-matrix';\nimport { getEnabledElement, triggerEvent, eventTarget, utilities as csUtils, cache, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { drawHandles as drawHandlesSvg, drawRedactionRect as drawRedactionRectSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { ChangeTypes, Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as rectangle from '../../utilities/math/rectangle';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nclass VideoRedactionTool extends AnnotationTool {\n    static { this.toolName = 'VideoRedaction'; }\n    constructor(toolConfiguration = {}) {\n        super(toolConfiguration, {\n            supportedInteractionTypes: ['Mouse', 'Touch'],\n            configuration: { shadow: true, preventHandleOutsideImage: false },\n        });\n        this.addNewAnnotation = (evt) => {\n            const eventData = evt.detail;\n            const { currentPoints, element } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const annotation = (this.constructor).createAnnotationForViewport(viewport, {\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                    },\n                },\n            });\n            addAnnotation(annotation, element);\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            return annotation;\n        };\n        this.getHandleNearImagePoint = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            for (let i = 0; i < points.length; i++) {\n                const point = points[i];\n                const toolDataCanvasCoordinate = viewport.worldToCanvas(point);\n                const near = vec2.distance(canvasCoords, toolDataCanvasCoordinate) < proximity;\n                if (near === true) {\n                    data.handles.activeHandleIndex = i;\n                    return point;\n                }\n            }\n            data.handles.activeHandleIndex = null;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasPoint1 = viewport.worldToCanvas(points[0]);\n            const canvasPoint2 = viewport.worldToCanvas(points[3]);\n            const rect = this._getRectangleImageCoordinates([\n                canvasPoint1,\n                canvasPoint2,\n            ]);\n            const point = [canvasCoords[0], canvasCoords[1]];\n            const { left, top, width, height } = rect;\n            const distanceToPoint = rectangle.distanceToPoint([left, top, width, height], point);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            this.doneEditMemo();\n            data.active = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, handleIndex, newAnnotation } = this.editData;\n            this.createMemo(element, annotation, { newAnnotation });\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventData;\n                const worldPosDelta = deltaPoints.world;\n                const { points } = data.handles;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                data.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventData;\n                const enabledElement = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n                const worldPos = currentPoints.world;\n                const { points } = data.handles;\n                points[handleIndex] = [...worldPos];\n                let bottomLeftCanvas;\n                let bottomRightCanvas;\n                let topLeftCanvas;\n                let topRightCanvas;\n                let bottomLeftWorld;\n                let bottomRightWorld;\n                let topLeftWorld;\n                let topRightWorld;\n                switch (handleIndex) {\n                    case 0:\n                    case 3:\n                        bottomLeftCanvas = worldToCanvas(points[0]);\n                        topRightCanvas = worldToCanvas(points[3]);\n                        bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                        topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                        bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                        topLeftWorld = canvasToWorld(topLeftCanvas);\n                        points[1] = bottomRightWorld;\n                        points[2] = topLeftWorld;\n                        break;\n                    case 1:\n                    case 2:\n                        bottomRightCanvas = worldToCanvas(points[1]);\n                        topLeftCanvas = worldToCanvas(points[2]);\n                        bottomLeftCanvas = [\n                            topLeftCanvas[0],\n                            bottomRightCanvas[1],\n                        ];\n                        topRightCanvas = [\n                            bottomRightCanvas[0],\n                            topLeftCanvas[1],\n                        ];\n                        bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                        topRightWorld = canvasToWorld(topRightCanvas);\n                        points[0] = bottomLeftWorld;\n                        points[3] = topRightWorld;\n                        break;\n                }\n                data.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID } = annotation;\n                const data = annotation.data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return;\n                }\n                let activeHandleCanvasCoords;\n                if (!this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRedactionRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color: 'black',\n                    lineDash,\n                    lineWidth,\n                });\n            }\n        };\n        this._getRectangleImageCoordinates = (points) => {\n            const [point0, point1] = points;\n            return {\n                left: Math.min(point0[0], point1[0]),\n                top: Math.min(point0[1], point1[1]),\n                width: Math.abs(point0[0] - point1[0]),\n                height: Math.abs(point0[1] - point1[1]),\n            };\n        };\n        this._calculateCachedStats = (annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { viewportUID, renderingEngineUID, sceneUID } = enabledElement;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetUIDs = Object.keys(cachedStats);\n            for (let i = 0; i < targetUIDs.length; i++) {\n                const targetUID = targetUIDs[i];\n                const { imageVolume } = this._getImageVolumeFromTargetUID(targetUID, renderingEngine);\n                const { dimensions, scalarData, vtkImageData: imageData, metadata, } = imageVolume;\n                const worldPos1Index = vec3.fromValues(0, 0, 0);\n                const worldPos2Index = vec3.fromValues(0, 0, 0);\n                imageData.worldToIndexVec3(worldPos1, worldPos1Index);\n                worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n                worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n                worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n                imageData.worldToIndexVec3(worldPos2, worldPos2Index);\n                worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n                worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n                worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n                if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                    this.isHandleOutsideImage = false;\n                    const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                    const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                    const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                    const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                    const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                    const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const area = worldWidth * worldHeight;\n                    let count = 0;\n                    let mean = 0;\n                    let stdDev = 0;\n                    const yMultiple = dimensions[0];\n                    const zMultiple = dimensions[0] * dimensions[1];\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                count++;\n                                mean += value;\n                            }\n                        }\n                    }\n                    mean /= count;\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                const valueMinusMean = value - mean;\n                                stdDev += valueMinusMean * valueMinusMean;\n                            }\n                        }\n                    }\n                    stdDev /= count;\n                    stdDev = Math.sqrt(stdDev);\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean,\n                        stdDev,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            const invalidated = annotation.invalidated;\n            annotation.invalidated = false;\n            if (invalidated) {\n                const eventType = Events.ANNOTATION_MODIFIED;\n                const eventDetail = {\n                    annotation,\n                    viewportUID,\n                    renderingEngineUID,\n                    sceneUID: sceneUID,\n                    changeType: ChangeTypes.StatsUpdated,\n                };\n                triggerEvent(eventTarget, eventType, eventDetail);\n            }\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._getTargetVolumeUID = (scene) => {\n            if (this.configuration.volumeUID) {\n                return this.configuration.volumeUID;\n            }\n            const volumeActors = scene.getVolumeActors();\n            if (!volumeActors && !volumeActors.length) {\n                return;\n            }\n            return volumeActors[0].uid;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportUIDsToRender } = this.editData;\n        const { data } = annotation;\n        data.active = false;\n        data.handles.activeHandleIndex = null;\n        triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        this.editData = null;\n        return annotation.metadata.annotationUID;\n    }\n    _getImageVolumeFromTargetUID(targetUID, renderingEngine) {\n        let imageVolume, viewport;\n        if (targetUID.startsWith('stackTarget')) {\n            const coloneIndex = targetUID.indexOf(':');\n            const viewportUID = targetUID.substring(coloneIndex + 1);\n            const viewport = renderingEngine.getViewport(viewportUID);\n            imageVolume = viewport.getImageData();\n        }\n        else {\n            imageVolume = cache.getVolume(targetUID);\n        }\n        return { imageVolume, viewport };\n    }\n    _getTargetStackUID(viewport) {\n        return `stackTarget:${viewport.uid}`;\n    }\n}\nexport default VideoRedactionTool;\n","import { vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils, cache, getRenderingEngine, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport { drawPolyline as drawPolylineSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { Events } from '../../enums';\nimport triggerAnnotationRenderForViewportUIDs from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { growCut } from '../../utilities/segmentation';\nimport GrowCutBaseTool from '../base/GrowCutBaseTool';\nconst NEGATIVE_PIXEL_RANGE = [-Infinity, -995];\nconst POSITIVE_PIXEL_RANGE = [0, 1900];\nconst ISLAND_PIXEL_RANGE = [1000, 1900];\nconst { transformWorldToIndex, transformIndexToWorld } = csUtils;\nclass WholeBodySegmentTool extends GrowCutBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            isPartialVolume: true,\n            positivePixelRange: POSITIVE_PIXEL_RANGE,\n            negativePixelRange: NEGATIVE_PIXEL_RANGE,\n            islandRemoval: {\n                enabled: true,\n                islandPixelRange: ISLAND_PIXEL_RANGE,\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const { world: currentWorldPoint } = currentPoints;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const linePoints = this._getHorizontalLineWorldPoints(enabledElement, currentWorldPoint);\n            this.growCutData.horizontalLines[1] = linePoints;\n            triggerAnnotationRenderForViewportUIDs([viewport.id]);\n        };\n        this._endCallback = async (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            await this.runGrowCut();\n            this._deactivateDraw(element);\n            this.growCutData = null;\n            resetElementCursor(element);\n            triggerAnnotationRenderForViewportUIDs([viewport.id]);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n    }\n    async preMouseDownCallback(evt) {\n        const eventData = evt.detail;\n        const { element, currentPoints } = eventData;\n        const { world: worldPoint } = currentPoints;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        const linePoints = this._getHorizontalLineWorldPoints(enabledElement, worldPoint);\n        await super.preMouseDownCallback(evt);\n        this.growCutData.horizontalLines = [linePoints, linePoints];\n        this._activateDraw(element);\n        hideElementCursor(element);\n        triggerAnnotationRenderForViewportUIDs([viewport.id]);\n        return true;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this.growCutData) {\n            return;\n        }\n        const { segmentation: segmentationData, horizontalLines } = this.growCutData;\n        if (horizontalLines.length !== 2) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const { segmentationId, segmentIndex } = segmentationData;\n        const [line1, line2] = horizontalLines;\n        const [worldLine1P1, worldLine1P2] = line1;\n        const [worldLine2P1, worldLine2P2] = line2;\n        const canvasPoints = [\n            worldLine1P1,\n            worldLine1P2,\n            worldLine2P2,\n            worldLine2P1,\n        ].map((worldPoint) => viewport.worldToCanvas(worldPoint));\n        const annotationUID = 'growCutRect';\n        const squareGroupUID = '0';\n        const { color, fillColor, lineWidth, fillOpacity, lineDash } = this.getSegmentStyle({\n            segmentationId,\n            segmentIndex,\n            viewportId: viewport.id,\n        });\n        drawPolylineSvg(svgDrawingHelper, annotationUID, squareGroupUID, canvasPoints, {\n            color,\n            fillColor,\n            fillOpacity,\n            lineWidth,\n            lineDash,\n            closePath: true,\n        });\n    }\n    async getGrowCutLabelmap(growCutData) {\n        const { segmentation: { segmentIndex, referencedVolumeId }, renderingEngineId, viewportId, horizontalLines, } = growCutData;\n        const renderingEngine = getRenderingEngine(renderingEngineId);\n        const viewport = renderingEngine.getViewport(viewportId);\n        const [line1, line2] = horizontalLines;\n        const worldSquarePoints = [line1[0], line1[1], line2[1], line2[0]];\n        const referencedVolume = cache.getVolume(referencedVolumeId);\n        const { topLeft: worldTopLeft, bottomRight: worldBottomRight } = this._getWorldBoundingBoxFromProjectedSquare(viewport, worldSquarePoints);\n        const ijkTopLeft = transformWorldToIndex(referencedVolume.imageData, worldTopLeft);\n        const ijkBottomRight = transformWorldToIndex(referencedVolume.imageData, worldBottomRight);\n        const boundingBoxInfo = {\n            boundingBox: {\n                ijkTopLeft,\n                ijkBottomRight,\n            },\n        };\n        const config = this.configuration;\n        const options = {\n            positiveSeedValue: segmentIndex,\n            negativeSeedValue: 255,\n            negativePixelRange: config.negativePixelRange,\n            positivePixelRange: config.positivePixelRange,\n        };\n        return growCut.runGrowCutForBoundingBox(referencedVolumeId, boundingBoxInfo, options);\n    }\n    getRemoveIslandData() {\n        const { segmentation: { segmentIndex, referencedVolumeId, labelmapVolumeId }, } = this.growCutData;\n        const referencedVolume = cache.getVolume(referencedVolumeId);\n        const labelmapVolume = cache.getVolume(labelmapVolumeId);\n        const referencedVolumeData = referencedVolume.voxelManager.getCompleteScalarDataArray();\n        const labelmapData = labelmapVolume.voxelManager.getCompleteScalarDataArray();\n        const { islandPixelRange } = this.configuration.islandRemoval;\n        const islandPointIndexes = [];\n        for (let i = 0, len = labelmapData.length; i < len; i++) {\n            if (labelmapData[i] !== segmentIndex) {\n                continue;\n            }\n            const pixelValue = referencedVolumeData[i];\n            if (pixelValue >= islandPixelRange[0] &&\n                pixelValue <= islandPixelRange[1]) {\n                islandPointIndexes.push(i);\n            }\n        }\n        return {\n            islandPointIndexes,\n        };\n    }\n    _activateDraw(element) {\n        element.addEventListener(Events.MOUSE_UP, this._endCallback);\n        element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n        element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n    }\n    _projectWorldPointAcrossSlices(viewport, worldEdgePoint, vecDirection) {\n        const volume = this._getViewportVolume(viewport);\n        const { dimensions } = volume;\n        const ijkPoint = transformWorldToIndex(volume.imageData, worldEdgePoint);\n        const axis = vecDirection.findIndex((n) => csUtils.isEqual(Math.abs(n), 1));\n        if (axis === -1) {\n            throw new Error('Non-orthogonal direction vector');\n        }\n        const ijkLineP1 = [...ijkPoint];\n        const ijkLineP2 = [...ijkPoint];\n        ijkLineP1[axis] = 0;\n        ijkLineP2[axis] = dimensions[axis] - 1;\n        return [ijkLineP1, ijkLineP2];\n    }\n    _getCuboidIJKEdgePointsFromProjectedWorldPoint(viewport, worldEdgePoint) {\n        const { viewPlaneNormal } = viewport.getCamera();\n        return this._projectWorldPointAcrossSlices(viewport, worldEdgePoint, viewPlaneNormal);\n    }\n    _getWorldCuboidCornerPoints(viewport, worldSquarePoints) {\n        const cuboidPoints = [];\n        const volume = this._getViewportVolume(viewport);\n        worldSquarePoints.forEach((worldSquarePoint) => {\n            const ijkEdgePoints = this._getCuboidIJKEdgePointsFromProjectedWorldPoint(viewport, worldSquarePoint);\n            const worldEdgePoints = ijkEdgePoints.map((ijkPoint) => transformIndexToWorld(volume.imageData, ijkPoint));\n            cuboidPoints.push(...worldEdgePoints);\n        });\n        return cuboidPoints;\n    }\n    _getWorldBoundingBoxFromProjectedSquare(viewport, worldSquarePoints) {\n        const worldCuboidPoints = this._getWorldCuboidCornerPoints(viewport, worldSquarePoints);\n        const topLeft = [...worldCuboidPoints[0]];\n        const bottomRight = [...worldCuboidPoints[0]];\n        worldCuboidPoints.forEach((worldPoint) => {\n            vec3.min(topLeft, topLeft, worldPoint);\n            vec3.max(bottomRight, bottomRight, worldPoint);\n        });\n        return { topLeft, bottomRight };\n    }\n    _getViewportVolume(viewport) {\n        if (!(viewport instanceof BaseVolumeViewport)) {\n            throw new Error('Viewport is not a BaseVolumeViewport');\n        }\n        const volumeId = viewport.getAllVolumeIds()[0];\n        return cache.getVolume(volumeId);\n    }\n    _getHorizontalLineIJKPoints(enabledElement, worldPoint) {\n        const { viewport } = enabledElement;\n        const volume = this._getViewportVolume(viewport);\n        const { dimensions } = volume;\n        const ijkPoint = transformWorldToIndex(volume.imageData, worldPoint);\n        const { viewUp, viewPlaneNormal } = viewport.getCamera();\n        const vecRow = vec3.cross(vec3.create(), viewUp, viewPlaneNormal);\n        const axis = vecRow.findIndex((n) => csUtils.isEqual(Math.abs(n), 1));\n        const ijkLineP1 = [...ijkPoint];\n        const ijkLineP2 = [...ijkPoint];\n        ijkLineP1[axis] = 0;\n        ijkLineP2[axis] = dimensions[axis] - 1;\n        return [ijkLineP1, ijkLineP2];\n    }\n    _getHorizontalLineWorldPoints(enabledElement, worldPoint) {\n        const { viewport } = enabledElement;\n        const volume = this._getViewportVolume(viewport);\n        const [ijkPoint1, ijkPoint2] = this._getHorizontalLineIJKPoints(enabledElement, worldPoint);\n        const worldPoint1 = transformIndexToWorld(volume.imageData, ijkPoint1);\n        const worldPoint2 = transformIndexToWorld(volume.imageData, ijkPoint2);\n        return [worldPoint1, worldPoint2];\n    }\n}\nWholeBodySegmentTool.toolName = 'WholeBodySegment';\nexport default WholeBodySegmentTool;\n","import { mat4 } from 'gl-matrix';\nimport { CubicSpline } from './CubicSpline';\nconst TRANSFORM_MATRIX = mat4.multiplyScalar(mat4.create(), mat4.fromValues(1, 4, 1, 0, -3, 0, 3, 0, 3, -6, 3, 0, -1, 3, -3, 1), 1 / 6);\nclass BSpline extends CubicSpline {\n    getTransformMatrix() {\n        return TRANSFORM_MATRIX;\n    }\n}\nexport { BSpline as default, BSpline };\n","import { CubicSpline } from './CubicSpline';\nclass CardinalSpline extends CubicSpline {\n    constructor(props) {\n        super(props);\n        this._scale = props?.scale ?? 0.5;\n        this._fixedScale = props?.fixedScale ?? false;\n    }\n    get scale() {\n        return this._scale;\n    }\n    set scale(scale) {\n        if (this._fixedScale || this._scale === scale) {\n            return;\n        }\n        this._scale = scale;\n        this.invalidated = true;\n    }\n    get fixedScale() {\n        return this._fixedScale;\n    }\n    getTransformMatrix() {\n        const { scale: s } = this;\n        const s2 = 2 * s;\n        return [\n            0, 1, 0, 0,\n            -s, 0, s, 0,\n            s2, s - 3, 3 - s2, -s,\n            -s, 2 - s, s - 2, s\n        ];\n    }\n}\nexport { CardinalSpline as default, CardinalSpline };\n","import { CardinalSpline } from './CardinalSpline';\nclass CatmullRomSpline extends CardinalSpline {\n    constructor() {\n        super({ scale: 0.5, fixedScale: true });\n    }\n}\nexport { CatmullRomSpline as default, CatmullRomSpline };\n","import { vec4 } from 'gl-matrix';\nimport { Spline } from './Spline';\nimport * as math from '../../../utilities/math';\nconst MAX_U_ERROR = 1e-8;\nclass CubicSpline extends Spline {\n    getPreviewCurveSegments(controlPointPreview, closeSpline) {\n        const previewNumCurveSegments = this._getNumCurveSegments() + 1;\n        const startCurveSegIndex = Math.max(0, previewNumCurveSegments - 2);\n        const endCurveSegIndex = closeSpline\n            ? previewNumCurveSegments\n            : previewNumCurveSegments - 1;\n        const transformMatrix = this.getTransformMatrix();\n        const controlPoints = [...this.controlPoints];\n        const curveSegments = [];\n        if (!closeSpline) {\n            controlPoints.push(controlPointPreview);\n        }\n        for (let i = startCurveSegIndex; i <= endCurveSegIndex; i++) {\n            const curveSegment = this._getCurveSegment(i, transformMatrix, controlPoints, closeSpline);\n            curveSegments.push(curveSegment);\n        }\n        return curveSegments;\n    }\n    getSplineCurves() {\n        const numCurveSegments = this._getNumCurveSegments();\n        const curveSegments = new Array(numCurveSegments);\n        if (numCurveSegments <= 0) {\n            return [];\n        }\n        const transformMatrix = this.getTransformMatrix();\n        let previousCurveSegmentsLength = 0;\n        for (let i = 0; i < numCurveSegments; i++) {\n            const curveSegment = this._getCurveSegment(i, transformMatrix);\n            curveSegment.previousCurveSegmentsLength = previousCurveSegmentsLength;\n            curveSegments[i] = curveSegment;\n            previousCurveSegmentsLength += curveSegment.length;\n        }\n        return curveSegments;\n    }\n    _getNumCurveSegments(controlPoints = this.controlPoints, closed = this.closed) {\n        return closed\n            ? controlPoints.length\n            : Math.max(0, controlPoints.length - 1);\n    }\n    _getPoint(u, transformMatrix, controlPoints = this.controlPoints, closed = this.closed) {\n        const numCurveSegments = this._getNumCurveSegments(controlPoints, closed);\n        const uInt = Math.floor(u);\n        let curveSegmentIndex = uInt % numCurveSegments;\n        const t = u - uInt;\n        const curveSegmentIndexOutOfBounds = curveSegmentIndex < 0 || curveSegmentIndex >= numCurveSegments;\n        if (curveSegmentIndexOutOfBounds) {\n            if (this.closed) {\n                curveSegmentIndex =\n                    (numCurveSegments + curveSegmentIndex) % numCurveSegments;\n            }\n            else {\n                return;\n            }\n        }\n        const { p0, p1, p2, p3 } = this._getCurveSegmentPoints(curveSegmentIndex, controlPoints, closed);\n        const tt = t * t;\n        const ttt = tt * t;\n        const tValues = vec4.fromValues(1, t, tt, ttt);\n        const qValues = vec4.transformMat4(vec4.create(), tValues, transformMatrix);\n        return [\n            vec4.dot(qValues, vec4.fromValues(p0[0], p1[0], p2[0], p3[0])),\n            vec4.dot(qValues, vec4.fromValues(p0[1], p1[1], p2[1], p3[1])),\n        ];\n    }\n    _getCurveSegmentPoints(curveSegmentIndex, controlPoints = this.controlPoints, closed = this.closed) {\n        const numCurveSegments = this._getNumCurveSegments(controlPoints, closed);\n        const p1Index = curveSegmentIndex;\n        const p0Index = p1Index - 1;\n        const p2Index = closed ? (p1Index + 1) % numCurveSegments : p1Index + 1;\n        const p3Index = p2Index + 1;\n        const p1 = controlPoints[p1Index];\n        const p2 = controlPoints[p2Index];\n        let p0;\n        let p3;\n        if (p0Index >= 0) {\n            p0 = controlPoints[p0Index];\n        }\n        else {\n            p0 = closed\n                ? controlPoints[controlPoints.length - 1]\n                : math.point.mirror(p2, p1);\n        }\n        if (p3Index < controlPoints.length) {\n            p3 = controlPoints[p3Index];\n        }\n        else {\n            p3 = closed ? controlPoints[0] : math.point.mirror(p1, p2);\n        }\n        return { p0, p1, p2, p3 };\n    }\n    _getLineSegments(curveSegmentIndex, transformMatrix, controlPoints = this.controlPoints, closed = this.closed) {\n        const numCurveSegments = this._getNumCurveSegments(controlPoints, closed);\n        const numLineSegments = this.resolution + 1;\n        const inc = 1 / numLineSegments;\n        const minU = curveSegmentIndex;\n        let maxU = minU + 1;\n        if (!closed && curveSegmentIndex === numCurveSegments - 1) {\n            maxU -= MAX_U_ERROR;\n        }\n        const lineSegments = [];\n        let startPoint;\n        let endPoint;\n        let previousLineSegmentsLength = 0;\n        for (let i = 0, u = minU; i <= numLineSegments; i++, u += inc) {\n            u = u > maxU ? maxU : u;\n            const point = this._getPoint(u, transformMatrix, controlPoints, closed);\n            if (!i) {\n                startPoint = point;\n                continue;\n            }\n            endPoint = point;\n            const dx = endPoint[0] - startPoint[0];\n            const dy = endPoint[1] - startPoint[1];\n            const length = Math.sqrt(dx ** 2 + dy ** 2);\n            const aabb = {\n                minX: startPoint[0] <= endPoint[0] ? startPoint[0] : endPoint[0],\n                maxX: startPoint[0] >= endPoint[0] ? startPoint[0] : endPoint[0],\n                minY: startPoint[1] <= endPoint[1] ? startPoint[1] : endPoint[1],\n                maxY: startPoint[1] >= endPoint[1] ? startPoint[1] : endPoint[1],\n            };\n            lineSegments.push({\n                points: {\n                    start: startPoint,\n                    end: endPoint,\n                },\n                aabb,\n                length,\n                previousLineSegmentsLength,\n            });\n            startPoint = endPoint;\n            previousLineSegmentsLength += length;\n        }\n        return lineSegments;\n    }\n    _getCurveSegment(curveSegmentIndex, transformMatrix = this.getTransformMatrix(), controlPoints = this.controlPoints, closed = this.closed) {\n        const { p0, p1, p2, p3 } = this._getCurveSegmentPoints(curveSegmentIndex, controlPoints, closed);\n        const lineSegments = this._getLineSegments(curveSegmentIndex, transformMatrix, controlPoints, closed);\n        let curveSegmentLength = 0;\n        let minX = Infinity;\n        let minY = Infinity;\n        let maxX = -Infinity;\n        let maxY = -Infinity;\n        lineSegments.forEach(({ aabb: lineSegAABB, length: lineSegLength }) => {\n            minX = Math.min(minX, lineSegAABB.minX);\n            minY = Math.min(minY, lineSegAABB.minY);\n            maxX = Math.max(maxX, lineSegAABB.maxX);\n            maxY = Math.max(maxY, lineSegAABB.maxY);\n            curveSegmentLength += lineSegLength;\n        });\n        return {\n            controlPoints: { p0, p1, p2, p3 },\n            aabb: { minX, minY, maxX, maxY },\n            length: curveSegmentLength,\n            previousCurveSegmentsLength: 0,\n            lineSegments,\n        };\n    }\n}\nexport { CubicSpline as default, CubicSpline };\n","import { CardinalSpline } from './CardinalSpline';\nclass LinearSpline extends CardinalSpline {\n    constructor() {\n        super({ resolution: 0, fixedResolution: true, scale: 0, fixedScale: true });\n    }\n}\nexport { LinearSpline as default, LinearSpline };\n","import { QuadraticSpline } from './QuadraticSpline';\nconst TRANSFORM_MATRIX = [\n    1, 0, 0,\n    -2, 2, 0,\n    1, -2, 1,\n];\nclass QuadraticBezier extends QuadraticSpline {\n    hasTangentPoints() {\n        return true;\n    }\n    getTransformMatrix() {\n        return TRANSFORM_MATRIX;\n    }\n}\nexport { QuadraticBezier as default, QuadraticBezier };\n","import { Spline } from './Spline';\nclass QuadraticSpline extends Spline {\n    getSplineCurves() {\n        return [];\n    }\n    getLineSegments() {\n        return [];\n    }\n    getPreviewCurveSegments(controlPointPreview, closeSpline) {\n        return [];\n    }\n}\nexport { QuadraticSpline as default, QuadraticSpline };\n","import * as math from '../../../utilities/math';\nclass Spline {\n    constructor(props) {\n        this._controlPoints = [];\n        this._invalidated = false;\n        this._length = 0;\n        this._controlPoints = [];\n        this._resolution = props?.resolution ?? 20;\n        this._fixedResolution = props?.fixedResolution ?? false;\n        this._closed = props?.closed ?? false;\n        this._invalidated = true;\n    }\n    get controlPoints() {\n        return this._controlPoints;\n    }\n    get numControlPoints() {\n        return this._controlPoints.length;\n    }\n    get resolution() {\n        return this._resolution;\n    }\n    set resolution(resolution) {\n        if (this._fixedResolution || this._resolution === resolution) {\n            return;\n        }\n        this._resolution = resolution;\n        this.invalidated = true;\n    }\n    get fixedResolution() {\n        return this._fixedResolution;\n    }\n    get closed() {\n        return this._closed;\n    }\n    set closed(closed) {\n        if (this._closed === closed) {\n            return;\n        }\n        this._closed = closed;\n        this.invalidated = true;\n    }\n    get aabb() {\n        this._update();\n        return this._aabb;\n    }\n    get length() {\n        this._update();\n        return this._length;\n    }\n    get invalidated() {\n        return this._invalidated;\n    }\n    set invalidated(invalidated) {\n        this._invalidated = invalidated;\n    }\n    hasTangentPoints() {\n        return false;\n    }\n    addControlPoint(point) {\n        this._controlPoints.push([point[0], point[1]]);\n        this.invalidated = true;\n    }\n    addControlPoints(points) {\n        points.forEach((point) => this.addControlPoint(point));\n    }\n    addControlPointAtU(u) {\n        const lineSegment = this._getLineSegmentAt(u);\n        const { start: startPoint, end: endPoint } = lineSegment.points;\n        const curveSegmentIndex = Math.floor(u);\n        const curveSegment = this._curveSegments[curveSegmentIndex];\n        const t = u - Math.floor(curveSegmentIndex);\n        const controlPointPos = [\n            startPoint[0] + t * (endPoint[0] - startPoint[0]),\n            startPoint[1] + t * (endPoint[1] - startPoint[1]),\n        ];\n        const insertIndex = this._controlPoints.indexOf(curveSegment.controlPoints.p1) + 1;\n        this._controlPoints.splice(insertIndex, 0, controlPointPos);\n        this.invalidated = true;\n        return {\n            index: insertIndex,\n            point: controlPointPos,\n        };\n    }\n    deleteControlPointByIndex(index) {\n        const minControlPoints = this._closed ? 3 : 1;\n        const canDelete = index >= 0 &&\n            index < this._controlPoints.length &&\n            this._controlPoints.length > minControlPoints;\n        if (!canDelete) {\n            return false;\n        }\n        this._controlPoints.splice(index, 1);\n        this.invalidated = true;\n        return true;\n    }\n    clearControlPoints() {\n        this._controlPoints = [];\n        this.invalidated = true;\n    }\n    setControlPoints(points) {\n        this.clearControlPoints();\n        this.addControlPoints(points);\n    }\n    updateControlPoint(index, newControlPoint) {\n        if (index < 0 || index >= this._controlPoints.length) {\n            throw new Error('Index out of bounds');\n        }\n        this._controlPoints[index] = [...newControlPoint];\n        this.invalidated = true;\n    }\n    getControlPoints() {\n        return this._controlPoints.map((controlPoint) => [\n            controlPoint[0],\n            controlPoint[1],\n        ]);\n    }\n    getClosestControlPoint(point) {\n        const controlPoints = this._controlPoints;\n        let minSquaredDist = Infinity;\n        let closestPointIndex = -1;\n        for (let i = 0, len = controlPoints.length; i < len; i++) {\n            const controlPoint = controlPoints[i];\n            const dx = point[0] - controlPoint[0];\n            const dy = point[1] - controlPoint[1];\n            const squaredDist = dx * dx + dy * dy;\n            if (squaredDist < minSquaredDist) {\n                minSquaredDist = squaredDist;\n                closestPointIndex = i;\n            }\n        }\n        return {\n            index: closestPointIndex,\n            point: closestPointIndex === -1\n                ? undefined\n                : [...controlPoints[closestPointIndex]],\n            distance: Math.sqrt(minSquaredDist),\n        };\n    }\n    getClosestControlPointWithinDistance(point, maxDist) {\n        const closestControlPoint = this.getClosestControlPoint(point);\n        return closestControlPoint.distance <= maxDist\n            ? closestControlPoint\n            : undefined;\n    }\n    getClosestPoint(point) {\n        this._update();\n        const curveSegmentsDistInfo = this._getCurveSegmmentsDistanceSquaredInfo(point);\n        if (!curveSegmentsDistInfo.length) {\n            return;\n        }\n        curveSegmentsDistInfo.sort((csA, csB) => csA.distanceSquared - csB.distanceSquared);\n        let closestPoint;\n        let closestPointCurveSegmentIndex = -1;\n        let minDistSquared = Infinity;\n        let minDistCurveSegment;\n        let minDistLineSegment;\n        for (let i = 0; i < curveSegmentsDistInfo.length; i++) {\n            const curveSegmentDistInfo = curveSegmentsDistInfo[i];\n            if (curveSegmentDistInfo.distanceSquared > minDistSquared) {\n                continue;\n            }\n            const { curveSegmentIndex, curveSegment } = curveSegmentDistInfo;\n            const { lineSegments } = curveSegment;\n            for (let j = 0; j < lineSegments.length; j++) {\n                const lineSegment = lineSegments[j];\n                const { point: lineSegPoint, distanceSquared: lineSegDistSquared } = math.lineSegment.distanceToPointSquaredInfo(lineSegment.points.start, lineSegment.points.end, point);\n                if (lineSegDistSquared < minDistSquared) {\n                    minDistLineSegment = lineSegment;\n                    closestPointCurveSegmentIndex = curveSegmentIndex;\n                    minDistCurveSegment = curveSegmentDistInfo.curveSegment;\n                    closestPoint = lineSegPoint;\n                    minDistSquared = lineSegDistSquared;\n                }\n            }\n        }\n        const curveSegmentLengthToPoint = minDistLineSegment.previousLineSegmentsLength +\n            math.point.distanceToPoint(minDistLineSegment.points.start, closestPoint);\n        const t = curveSegmentLengthToPoint / minDistCurveSegment.length;\n        const u = closestPointCurveSegmentIndex + t;\n        return {\n            point: closestPoint,\n            uValue: u,\n            distance: Math.sqrt(minDistSquared),\n        };\n    }\n    getClosestPointOnControlPointLines(point) {\n        const linePoints = [...this._controlPoints];\n        if (this._closed) {\n            linePoints.push(this._controlPoints[0]);\n        }\n        if (!linePoints.length) {\n            return;\n        }\n        let closestPoint;\n        let minDistSquared = Infinity;\n        let startPoint = linePoints[0];\n        for (let i = 1, len = linePoints.length; i < len; i++) {\n            const endPoint = linePoints[i];\n            const { point: lineSegPoint, distanceSquared: lineSegDistSquared } = math.lineSegment.distanceToPointSquaredInfo(startPoint, endPoint, point);\n            if (lineSegDistSquared < minDistSquared) {\n                closestPoint = lineSegPoint;\n                minDistSquared = lineSegDistSquared;\n            }\n            startPoint = endPoint;\n        }\n        return {\n            point: closestPoint,\n            distance: Math.sqrt(minDistSquared),\n        };\n    }\n    getPolylinePoints() {\n        this._update();\n        return this._convertCurveSegmentsToPolyline(this._curveSegments);\n    }\n    getPreviewPolylinePoints(controlPointPreview, closeDistance) {\n        if (this._closed) {\n            return [];\n        }\n        this._update();\n        const closestControlPoint = this.getClosestControlPointWithinDistance(controlPointPreview, closeDistance);\n        const closeSpline = closestControlPoint?.index === 0;\n        const previewCurveSegments = this.getPreviewCurveSegments(controlPointPreview, closeSpline);\n        return previewCurveSegments?.length\n            ? this._convertCurveSegmentsToPolyline(previewCurveSegments)\n            : [];\n    }\n    isPointNearCurve(point, maxDist) {\n        this._update();\n        const curveSegments = this._getCurveSegmmentsWithinDistance(point, maxDist);\n        const maxDistSquared = maxDist * maxDist;\n        for (let i = 0; i < curveSegments.length; i++) {\n            const { lineSegments } = curveSegments[i];\n            for (let j = 0; j < lineSegments.length; j++) {\n                const lineSegment = lineSegments[j];\n                const lineDistSquared = math.lineSegment.distanceToPointSquared(lineSegment.points.start, lineSegment.points.end, point);\n                if (lineDistSquared <= maxDistSquared) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    containsPoint(point) {\n        this._update();\n        const controlPoints = this._controlPoints;\n        if (controlPoints.length < 3) {\n            return false;\n        }\n        const curveSegments = [...this._curveSegments];\n        const closingCurveSegment = this._getClosingCurveSegmentWithStraightLineSegment();\n        if (closingCurveSegment) {\n            curveSegments.push(closingCurveSegment);\n        }\n        let numIntersections = 0;\n        for (let i = 0; i < curveSegments.length; i++) {\n            const curveSegment = curveSegments[i];\n            const { aabb: curveSegAABB } = curveSegment;\n            const mayIntersectCurveSegment = point[0] <= curveSegAABB.maxX &&\n                point[1] >= curveSegAABB.minY &&\n                point[1] < curveSegAABB.maxY;\n            if (!mayIntersectCurveSegment) {\n                continue;\n            }\n            const { lineSegments } = curveSegment;\n            for (let i = 0; i < lineSegments.length; i++) {\n                const lineSegment = lineSegments[i];\n                const { aabb: lineSegmentAABB } = lineSegment;\n                const mayIntersectLineSegment = point[0] <= lineSegmentAABB.maxX &&\n                    point[1] >= lineSegmentAABB.minY &&\n                    point[1] < lineSegmentAABB.maxY;\n                if (mayIntersectLineSegment) {\n                    const { start: p1, end: p2 } = lineSegment.points;\n                    const isVerticalLine = p1[0] === p2[0];\n                    const xIntersection = ((point[1] - p1[1]) * (p2[0] - p1[0])) / (p2[1] - p1[1]) + p1[0];\n                    numIntersections +=\n                        isVerticalLine || point[0] <= xIntersection ? 1 : 0;\n                }\n            }\n        }\n        return numIntersections % 2 === 1;\n    }\n    _update() {\n        if (!this._invalidated) {\n            return;\n        }\n        const curveSegments = this.getSplineCurves();\n        let length = 0;\n        let minX = Infinity;\n        let minY = Infinity;\n        let maxX = -Infinity;\n        let maxY = -Infinity;\n        for (let i = 0, len = curveSegments.length; i < len; i++) {\n            const { aabb: curveSegAABB, length: curveSegLength } = curveSegments[i];\n            minX = minX <= curveSegAABB.minX ? minX : curveSegAABB.minX;\n            minY = minY <= curveSegAABB.minY ? minY : curveSegAABB.minY;\n            maxX = maxX >= curveSegAABB.maxX ? maxX : curveSegAABB.maxX;\n            maxY = maxY >= curveSegAABB.maxY ? maxY : curveSegAABB.maxY;\n            length += curveSegLength;\n        }\n        this._curveSegments = curveSegments;\n        this._aabb = { minX, minY, maxX, maxY };\n        this._length = length;\n        this._invalidated = false;\n    }\n    _convertCurveSegmentsToPolyline(curveSegments) {\n        this._update();\n        const polylinePoints = [];\n        curveSegments.forEach(({ lineSegments }, curveSegIndex) => {\n            lineSegments.forEach((lineSegment, lineSegIndex) => {\n                if (curveSegIndex === 0 && lineSegIndex === 0) {\n                    polylinePoints.push([...lineSegment.points.start]);\n                }\n                polylinePoints.push([...lineSegment.points.end]);\n            });\n        });\n        return polylinePoints;\n    }\n    _getCurveSegmmentsDistanceSquaredInfo(point) {\n        this._update();\n        const curveSegmentsDistanceSquared = [];\n        const { _curveSegments: curveSegments } = this;\n        for (let i = 0; i < curveSegments.length; i++) {\n            const curveSegment = curveSegments[i];\n            const distanceSquared = math.aabb.distanceToPointSquared(curveSegment.aabb, point);\n            curveSegmentsDistanceSquared.push({\n                curveSegmentIndex: i,\n                curveSegment,\n                distanceSquared,\n            });\n        }\n        return curveSegmentsDistanceSquared;\n    }\n    _getCurveSegmmentsWithinDistance(point, maxDist) {\n        this._update();\n        const maxDistSquared = maxDist * maxDist;\n        if (math.aabb.distanceToPointSquared(this.aabb, point) > maxDistSquared) {\n            return [];\n        }\n        const curveSegmentsDistance = this._getCurveSegmmentsDistanceSquaredInfo(point);\n        const curveSegmentsWithinRange = [];\n        for (let i = 0, len = curveSegmentsDistance.length; i < len; i++) {\n            const { curveSegment, distanceSquared: curveSegmentDistSquared } = curveSegmentsDistance[i];\n            if (curveSegmentDistSquared <= maxDistSquared) {\n                curveSegmentsWithinRange.push(curveSegment);\n            }\n        }\n        return curveSegmentsWithinRange;\n    }\n    _getLineSegmentAt(u) {\n        this._update();\n        const curveSegmentIndex = Math.floor(u);\n        const t = u - curveSegmentIndex;\n        const curveSegment = this._curveSegments[curveSegmentIndex];\n        const { lineSegments } = curveSegment;\n        const pointLength = curveSegment.length * t;\n        for (let i = 0; i < lineSegments.length; i++) {\n            const lineSegment = lineSegments[i];\n            const lengthEnd = lineSegment.previousLineSegmentsLength + lineSegment.length;\n            if (pointLength >= lineSegment.previousLineSegmentsLength &&\n                pointLength <= lengthEnd) {\n                return lineSegment;\n            }\n        }\n    }\n    _getClosingCurveSegmentWithStraightLineSegment() {\n        if (this.closed) {\n            return;\n        }\n        const controlPoints = this._controlPoints;\n        const startControlPoint = controlPoints[0];\n        const endControlPoint = controlPoints[controlPoints.length - 1];\n        const closingLineSegment = {\n            points: {\n                start: [...startControlPoint],\n                end: [...endControlPoint],\n            },\n            aabb: {\n                minX: Math.min(startControlPoint[0], endControlPoint[0]),\n                minY: Math.min(startControlPoint[1], endControlPoint[1]),\n                maxX: Math.max(startControlPoint[0], endControlPoint[0]),\n                maxY: Math.max(startControlPoint[1], endControlPoint[1]),\n            },\n        };\n        return {\n            aabb: {\n                minX: closingLineSegment.aabb.minX,\n                minY: closingLineSegment.aabb.minY,\n                maxX: closingLineSegment.aabb.maxX,\n                maxY: closingLineSegment.aabb.maxY,\n            },\n            lineSegments: [closingLineSegment],\n        };\n    }\n}\nexport { Spline as default, Spline };\n","import { utilities, getEnabledElement, cache, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport BaseTool from './BaseTool';\nimport { getAnnotationManager } from '../../stateManagement/annotation/annotationState';\nimport triggerAnnotationRender from '../../utilities/triggerAnnotationRender';\nimport filterAnnotationsForDisplay from '../../utilities/planar/filterAnnotationsForDisplay';\nimport { getStyleProperty } from '../../stateManagement/annotation/config/helpers';\nimport { getState } from '../../stateManagement/annotation/config';\nclass AnnotationDisplayTool extends BaseTool {\n    constructor() {\n        super(...arguments);\n        this.onImageSpacingCalibrated = (evt) => {\n            const { element, imageId } = evt.detail;\n            const imageURI = utilities.imageIdToURI(imageId);\n            const annotationManager = getAnnotationManager();\n            const framesOfReference = annotationManager.getFramesOfReference();\n            framesOfReference.forEach((frameOfReference) => {\n                const frameOfReferenceSpecificAnnotations = annotationManager.getAnnotations(frameOfReference);\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[this.getToolName()];\n                if (!toolSpecificAnnotations || !toolSpecificAnnotations.length) {\n                    return;\n                }\n                toolSpecificAnnotations.forEach((annotation) => {\n                    if (!annotation.metadata?.referencedImageId) {\n                        return;\n                    }\n                    const referencedImageURI = utilities.imageIdToURI(annotation.metadata.referencedImageId);\n                    if (referencedImageURI === imageURI) {\n                        annotation.invalidated = true;\n                        annotation.data.cachedStats = {};\n                    }\n                });\n                triggerAnnotationRender(element);\n            });\n        };\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!annotations?.length) {\n            return [];\n        }\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        return filterAnnotationsForDisplay(viewport, annotations);\n    }\n    createAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { world: worldPos } = currentPoints;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp, position: cameraPosition } = camera;\n        const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n        const viewReference = viewport.getViewReference({ points: [worldPos] });\n        return {\n            highlighted: true,\n            invalidated: true,\n            metadata: {\n                toolName: this.getToolName(),\n                ...viewReference,\n                referencedImageId,\n                viewUp,\n                cameraPosition,\n            },\n            data: {\n                cachedStats: {},\n                handles: {\n                    points: [],\n                    activeHandleIndex: null,\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                },\n            },\n        };\n    }\n    getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId = targetId.split(/^[a-zA-Z]+:/)[1];\n        if (viewport instanceof BaseVolumeViewport) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const imageVolume = cache.getVolume(volumeId);\n            referencedImageId = utilities.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n        }\n        return referencedImageId;\n    }\n    getStyle(property, specifications, annotation) {\n        return getStyleProperty(property, specifications, getState(annotation), this.mode);\n    }\n}\nAnnotationDisplayTool.toolName = 'AnnotationDisplayTool';\nexport default AnnotationDisplayTool;\n","import { utilities } from '@cornerstonejs/core';\nimport ToolModes from '../../enums/ToolModes';\nconst { DefaultHistoryMemo } = utilities.HistoryMemo;\nclass BaseTool {\n    static { this.defaults = {\n        configuration: {\n            strategies: {},\n            defaultStrategy: undefined,\n            activeStrategy: undefined,\n            strategyOptions: {},\n        },\n    }; }\n    constructor(toolProps, defaultToolProps) {\n        const mergedDefaults = BaseTool.mergeDefaultProps(BaseTool.defaults, defaultToolProps);\n        const initialProps = utilities.deepMerge(mergedDefaults, toolProps);\n        const { configuration = {}, supportedInteractionTypes, toolGroupId, } = initialProps;\n        this.toolGroupId = toolGroupId;\n        this.supportedInteractionTypes = supportedInteractionTypes || [];\n        this.configuration = Object.assign({}, configuration);\n        this.mode = ToolModes.Disabled;\n    }\n    static mergeDefaultProps(defaultProps = {}, additionalProps) {\n        if (!additionalProps) {\n            return defaultProps;\n        }\n        return utilities.deepMerge(defaultProps, additionalProps);\n    }\n    get toolName() {\n        return this.getToolName();\n    }\n    getToolName() {\n        return this.constructor.toolName;\n    }\n    applyActiveStrategy(enabledElement, operationData) {\n        const { strategies, activeStrategy } = this.configuration;\n        return strategies[activeStrategy]?.call(this, enabledElement, operationData);\n    }\n    applyActiveStrategyCallback(enabledElement, operationData, callbackType, ...extraArgs) {\n        const { strategies, activeStrategy } = this.configuration;\n        if (!strategies[activeStrategy]) {\n            throw new Error(`applyActiveStrategyCallback: active strategy ${activeStrategy} not found, check tool configuration or spellings`);\n        }\n        return strategies[activeStrategy][callbackType]?.call(this, enabledElement, operationData, ...extraArgs);\n    }\n    setConfiguration(newConfiguration) {\n        this.configuration = utilities.deepMerge(this.configuration, newConfiguration);\n    }\n    setActiveStrategy(strategyName) {\n        this.setConfiguration({ activeStrategy: strategyName });\n    }\n    getTargetImageData(targetId) {\n        if (targetId.startsWith('imageId:')) {\n            const imageId = targetId.split('imageId:')[1];\n            const imageURI = utilities.imageIdToURI(imageId);\n            let viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            viewports = viewports.filter((viewport) => {\n                return viewport.getCurrentImageId() === imageId;\n            });\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('volumeId:')) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const viewports = utilities.getViewportsWithVolumeId(volumeId);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('videoId:')) {\n            const imageURI = utilities.imageIdToURI(targetId);\n            const viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else {\n            throw new Error('getTargetIdImage: targetId must start with \"imageId:\" or \"volumeId:\"');\n        }\n    }\n    getTargetId(viewport) {\n        const targetId = viewport.getViewReferenceId?.();\n        if (targetId) {\n            return targetId;\n        }\n        throw new Error('getTargetId: viewport must have a getViewReferenceId method');\n    }\n    undo() {\n        this.doneEditMemo();\n        DefaultHistoryMemo.undo();\n    }\n    redo() {\n        DefaultHistoryMemo.redo();\n    }\n    static createZoomPanMemo(viewport) {\n        const state = {\n            pan: viewport.getPan(),\n            zoom: viewport.getZoom(),\n        };\n        const zoomPanMemo = {\n            restoreMemo: () => {\n                const currentPan = viewport.getPan();\n                const currentZoom = viewport.getZoom();\n                viewport.setZoom(state.zoom);\n                viewport.setPan(state.pan);\n                viewport.render();\n                state.pan = currentPan;\n                state.zoom = currentZoom;\n            },\n        };\n        DefaultHistoryMemo.push(zoomPanMemo);\n        return zoomPanMemo;\n    }\n    doneEditMemo() {\n        if (this.memo?.commitMemo?.()) {\n            DefaultHistoryMemo.push(this.memo);\n        }\n        this.memo = null;\n    }\n}\nBaseTool.toolName = 'BaseTool';\nexport default BaseTool;\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport { handleContourSegmentation } from './contourHandler/handleContourSegmentation';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport removeContourFromElement from './removeContourFromElement';\nimport { getPolySeg } from '../../../config';\nimport { computeAndAddRepresentation } from '../../../utilities/segmentation/computeAndAddRepresentation';\nlet polySegConversionInProgress = false;\nconst processedViewportSegmentations = new Map();\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    if (!renderImmediate) {\n        return;\n    }\n    removeContourFromElement(viewportId, segmentationId);\n    viewport.render();\n}\nasync function render(viewport, contourRepresentation) {\n    const { segmentationId } = contourRepresentation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let contourData = segmentation.representationData[Representations.Contour];\n    if (!contourData &&\n        getPolySeg()?.canComputeRequestedRepresentation(segmentationId, Representations.Contour) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        const polySeg = getPolySeg();\n        contourData = await computeAndAddRepresentation(segmentationId, Representations.Contour, () => polySeg.computeContourData(segmentationId, { viewport }), () => undefined);\n        polySegConversionInProgress = false;\n    }\n    else if (!contourData && !getPolySeg()) {\n        console.debug(`No contour data found for segmentationId ${segmentationId} and PolySeg add-on is not configured. Unable to convert from other representations to contour. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);\n    }\n    if (!contourData) {\n        return;\n    }\n    if (!contourData.geometryIds?.length) {\n        return;\n    }\n    handleContourSegmentation(viewport, contourData.geometryIds, contourData.annotationUIDsMap, contourRepresentation);\n}\nexport default {\n    render,\n    removeRepresentation,\n};\n","import { getEnabledElementByViewportId, VolumeViewport, } from '@cornerstonejs/core';\nimport addLabelmapToElement from './addLabelmapToElement';\nimport removeLabelmapFromElement from './removeLabelmapFromElement';\nimport { getActiveSegmentation } from '../../../stateManagement/segmentation/activeSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { getCurrentLabelmapImageIdsForViewport } from '../../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { segmentationStyle } from '../../../stateManagement/segmentation/SegmentationStyle';\nimport SegmentationRepresentations from '../../../enums/SegmentationRepresentations';\nimport { internalGetHiddenSegmentIndices } from '../../../stateManagement/segmentation/helpers/internalGetHiddenSegmentIndices';\nimport { getActiveSegmentIndex } from '../../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getLabelmapActorEntries } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nimport { getPolySeg } from '../../../config';\nimport { computeAndAddRepresentation } from '../../../utilities/segmentation/computeAndAddRepresentation';\nimport { triggerSegmentationDataModified } from '../../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { defaultSegmentationStateManager } from '../../../stateManagement/segmentation/SegmentationStateManager';\nexport const MAX_NUMBER_COLORS = 255;\nconst labelMapConfigCache = new Map();\nlet polySegConversionInProgress = false;\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    labelMapConfigCache.forEach((value, key) => {\n        if (key.includes(segmentationId)) {\n            labelMapConfigCache.delete(key);\n        }\n    });\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeLabelmapFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId, config } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        console.warn('No segmentation found for segmentationId: ', segmentationId);\n        return;\n    }\n    let labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    let labelmapActorEntries = getLabelmapActorEntries(viewport.id, segmentationId);\n    if (!labelmapData &&\n        getPolySeg()?.canComputeRequestedRepresentation(segmentationId, SegmentationRepresentations.Labelmap) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        const polySeg = getPolySeg();\n        labelmapData = await computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Labelmap, () => polySeg.computeLabelmapData(segmentationId, { viewport }), () => null, () => {\n            defaultSegmentationStateManager.processLabelmapRepresentationAddition(viewport.id, segmentationId);\n            setTimeout(() => {\n                triggerSegmentationDataModified(segmentationId);\n            }, 0);\n        });\n        if (!labelmapData) {\n            throw new Error(`No labelmap data found for segmentationId ${segmentationId}.`);\n        }\n        polySegConversionInProgress = false;\n    }\n    else if (!labelmapData && !getPolySeg()) {\n        console.debug(`No labelmap data found for segmentationId ${segmentationId} and PolySeg add-on is not configured. Unable to convert from other representations to labelmap. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);\n    }\n    if (!labelmapData) {\n        return;\n    }\n    if (viewport instanceof VolumeViewport) {\n        if (!labelmapActorEntries?.length) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId, config);\n        }\n        labelmapActorEntries = getLabelmapActorEntries(viewport.id, segmentationId);\n    }\n    else {\n        const labelmapImageIds = getCurrentLabelmapImageIdsForViewport(viewport.id, segmentationId);\n        if (!labelmapImageIds?.length) {\n            return;\n        }\n        if (!labelmapActorEntries) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId, config);\n        }\n        labelmapActorEntries = getLabelmapActorEntries(viewport.id, segmentationId);\n    }\n    if (!labelmapActorEntries?.length) {\n        return;\n    }\n    for (const labelmapActorEntry of labelmapActorEntries) {\n        _setLabelmapColorAndOpacity(viewport.id, labelmapActorEntry, representation);\n    }\n}\nfunction _setLabelmapColorAndOpacity(viewportId, labelmapActorEntry, segmentationRepresentation) {\n    const { segmentationId } = segmentationRepresentation;\n    const { cfun, ofun } = segmentationRepresentation.config;\n    const { colorLUTIndex } = segmentationRepresentation;\n    const activeSegmentation = getActiveSegmentation(viewportId);\n    const isActiveLabelmap = activeSegmentation?.segmentationId === segmentationId;\n    const labelmapStyle = segmentationStyle.getStyle({\n        viewportId,\n        type: SegmentationRepresentations.Labelmap,\n        segmentationId,\n    });\n    const renderInactiveSegmentations = segmentationStyle.getRenderInactiveSegmentations(viewportId);\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const numColors = Math.min(256, colorLUT.length);\n    const { outlineWidth, renderOutline, outlineOpacity, activeSegmentOutlineWidthDelta, } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap);\n    const segmentsHidden = internalGetHiddenSegmentIndices(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    });\n    for (let i = 0; i < numColors; i++) {\n        const segmentIndex = i;\n        const segmentColor = colorLUT[segmentIndex];\n        const perSegmentStyle = segmentationStyle.getStyle({\n            viewportId,\n            type: SegmentationRepresentations.Labelmap,\n            segmentationId,\n            segmentIndex,\n        });\n        const segmentSpecificLabelmapConfig = perSegmentStyle;\n        const { fillAlpha, outlineWidth, renderFill, renderOutline } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap, segmentSpecificLabelmapConfig);\n        const { forceOpacityUpdate, forceColorUpdate } = _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            segmentColor,\n            outlineWidth,\n            segmentsHidden: segmentsHidden,\n            cfun,\n            ofun,\n        });\n        if (forceColorUpdate) {\n            cfun.addRGBPoint(segmentIndex, segmentColor[0] / MAX_NUMBER_COLORS, segmentColor[1] / MAX_NUMBER_COLORS, segmentColor[2] / MAX_NUMBER_COLORS);\n        }\n        if (forceOpacityUpdate) {\n            if (renderFill) {\n                const segmentOpacity = segmentsHidden.has(segmentIndex)\n                    ? 0\n                    : (segmentColor[3] / 255) * fillAlpha;\n                ofun.removePoint(segmentIndex);\n                ofun.addPointLong(segmentIndex, segmentOpacity, 0.5, 1.0);\n            }\n            else {\n                ofun.addPointLong(segmentIndex, 0.01, 0.5, 1.0);\n            }\n        }\n    }\n    ofun.setClamping(false);\n    const labelmapActor = labelmapActorEntry.actor;\n    const { preLoad } = labelmapActor.get?.('preLoad') || { preLoad: null };\n    if (preLoad) {\n        preLoad({ cfun, ofun, actor: labelmapActor });\n    }\n    else {\n        labelmapActor.getProperty().setRGBTransferFunction(0, cfun);\n        labelmapActor.getProperty().setScalarOpacity(0, ofun);\n        labelmapActor.getProperty().setInterpolationTypeToNearest();\n    }\n    if (renderOutline) {\n        labelmapActor.getProperty().setUseLabelOutline(renderOutline);\n        labelmapActor.getProperty().setLabelOutlineOpacity(outlineOpacity);\n        const activeSegmentIndex = getActiveSegmentIndex(segmentationRepresentation.segmentationId);\n        const outlineWidths = new Array(numColors - 1);\n        for (let i = 1; i < numColors; i++) {\n            const isHidden = segmentsHidden.has(i);\n            if (isHidden) {\n                outlineWidths[i - 1] = 0;\n                continue;\n            }\n            outlineWidths[i - 1] =\n                i === activeSegmentIndex\n                    ? outlineWidth + activeSegmentOutlineWidthDelta\n                    : outlineWidth;\n        }\n        labelmapActor.getProperty().setLabelOutlineThickness(outlineWidths);\n    }\n    else {\n        labelmapActor\n            .getProperty()\n            .setLabelOutlineThickness(new Array(numColors - 1).fill(0));\n    }\n    const visible = isActiveLabelmap || renderInactiveSegmentations;\n    labelmapActor.setVisibility(visible);\n}\nfunction _getLabelmapConfig(labelmapConfig, isActiveLabelmap, segmentsLabelmapConfig) {\n    const segmentLabelmapConfig = segmentsLabelmapConfig || {};\n    const configToUse = {\n        ...labelmapConfig,\n        ...segmentLabelmapConfig,\n    };\n    const fillAlpha = isActiveLabelmap\n        ? configToUse.fillAlpha\n        : configToUse.fillAlphaInactive;\n    const outlineWidth = isActiveLabelmap\n        ? configToUse.outlineWidth\n        : configToUse.outlineWidthInactive;\n    const renderFill = isActiveLabelmap\n        ? configToUse.renderFill\n        : configToUse.renderFillInactive;\n    const renderOutline = isActiveLabelmap\n        ? configToUse.renderOutline\n        : configToUse.renderOutlineInactive;\n    const outlineOpacity = isActiveLabelmap\n        ? configToUse.outlineOpacity\n        : configToUse.outlineOpacityInactive;\n    const activeSegmentOutlineWidthDelta = configToUse.activeSegmentOutlineWidthDelta;\n    return {\n        fillAlpha,\n        outlineWidth,\n        renderFill,\n        renderOutline,\n        outlineOpacity,\n        activeSegmentOutlineWidthDelta,\n    };\n}\nfunction _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, { fillAlpha, renderFill, renderOutline, segmentColor, outlineWidth, segmentsHidden, cfun, ofun, }) {\n    const cacheUID = `${viewportId}-${segmentationId}-${segmentIndex}`;\n    const oldConfig = labelMapConfigCache.get(cacheUID);\n    if (!oldConfig) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n        return {\n            forceOpacityUpdate: true,\n            forceColorUpdate: true,\n        };\n    }\n    const { fillAlpha: oldFillAlpha, renderFill: oldRenderFill, renderOutline: oldRenderOutline, outlineWidth: oldOutlineWidth, segmentColor: oldSegmentColor, segmentsHidden: oldSegmentsHidden, cfunMTime: oldCfunMTime, ofunMTime: oldOfunMTime, } = oldConfig;\n    const forceColorUpdate = oldSegmentColor[0] !== segmentColor[0] ||\n        oldSegmentColor[1] !== segmentColor[1] ||\n        oldSegmentColor[2] !== segmentColor[2];\n    const forceOpacityUpdate = oldSegmentColor[3] !== segmentColor[3] ||\n        oldFillAlpha !== fillAlpha ||\n        oldRenderFill !== renderFill ||\n        oldRenderOutline !== renderOutline ||\n        oldOutlineWidth !== outlineWidth ||\n        oldSegmentsHidden !== segmentsHidden;\n    if (forceOpacityUpdate || forceColorUpdate) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n    }\n    return {\n        forceOpacityUpdate,\n        forceColorUpdate,\n    };\n}\nasync function _addLabelmapToViewport(viewport, labelmapData, segmentationId, config) {\n    const result = await addLabelmapToElement(viewport.element, labelmapData, segmentationId, config);\n    return result || undefined;\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { cache, getEnabledElementByViewportId, Enums, } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport removeSurfaceFromElement from './removeSurfaceFromElement';\nimport addOrUpdateSurfaceToElement from './addOrUpdateSurfaceToElement';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { getPolySeg } from '../../../config';\nimport { computeAndAddRepresentation } from '../../../utilities/segmentation/computeAndAddRepresentation';\nimport { internalGetHiddenSegmentIndices } from '../../../stateManagement/segmentation/helpers/internalGetHiddenSegmentIndices';\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeSurfaceFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId, type } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let SurfaceData = segmentation.representationData[Representations.Surface];\n    if (!SurfaceData &&\n        getPolySeg()?.canComputeRequestedRepresentation(segmentationId, Representations.Surface)) {\n        const polySeg = getPolySeg();\n        SurfaceData = await computeAndAddRepresentation(segmentationId, Representations.Surface, () => polySeg.computeSurfaceData(segmentationId, { viewport }), () => polySeg.updateSurfaceData(segmentationId, { viewport }));\n        if (!SurfaceData) {\n            throw new Error(`No Surface data found for segmentationId ${segmentationId} even we tried to compute it`);\n        }\n    }\n    else if (!SurfaceData && !getPolySeg()) {\n        console.debug(`No surface data found for segmentationId ${segmentationId} and PolySeg add-on is not configured. Unable to convert from other representations to surface. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);\n    }\n    if (!SurfaceData) {\n        console.warn(`No Surface data found for segmentationId ${segmentationId}. Skipping render.`);\n        return;\n    }\n    const { geometryIds } = SurfaceData;\n    if (!geometryIds?.size) {\n        console.warn(`No Surfaces found for segmentationId ${segmentationId}. Skipping render.`);\n    }\n    const { colorLUTIndex } = representation;\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const surfaces = [];\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (!geometry?.data) {\n            console.warn(`No Surfaces found for geometryId ${geometryId}. Skipping render.`);\n            return;\n        }\n        const segmentIndex = geometry.data.segmentIndex;\n        const hiddenSegments = internalGetHiddenSegmentIndices(viewport.id, {\n            segmentationId,\n            type,\n        });\n        const isHidden = hiddenSegments.has(segmentIndex);\n        const surface = geometry.data;\n        const color = colorLUT[segmentIndex];\n        surface.color = color.slice(0, 3);\n        surface.visible = !isHidden;\n        surfaces.push(surface);\n        addOrUpdateSurfaceToElement(viewport.element, surface, segmentationId);\n    });\n    viewport.render();\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { getEnabledElement, eventTarget } from '@cornerstonejs/core';\nimport { vec3, vec2 } from 'gl-matrix';\nimport { Events, ToolModes, StrategyCallbacks } from '../../enums';\nimport { fillInsideSphere, thresholdInsideSphere, thresholdInsideSphereIsland, } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { thresholdInsideCircle, fillInsideCircle, } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportUIDs from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport LabelmapBaseTool from './LabelmapBaseTool';\nimport { getStrategyData } from './strategies/utils/getStrategyData';\nclass BrushTool extends LabelmapBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE_CIRCLE: fillInsideCircle,\n                ERASE_INSIDE_CIRCLE: eraseInsideCircle,\n                FILL_INSIDE_SPHERE: fillInsideSphere,\n                ERASE_INSIDE_SPHERE: eraseInsideSphere,\n                THRESHOLD_INSIDE_CIRCLE: thresholdInsideCircle,\n                THRESHOLD_INSIDE_SPHERE: thresholdInsideSphere,\n                THRESHOLD_INSIDE_SPHERE_WITH_ISLAND_REMOVAL: thresholdInsideSphereIsland,\n            },\n            defaultStrategy: 'FILL_INSIDE_CIRCLE',\n            activeStrategy: 'FILL_INSIDE_CIRCLE',\n            brushSize: 25,\n            useCenterSegmentIndex: false,\n            preview: {\n                enabled: false,\n                previewColors: {\n                    0: [255, 255, 255, 128],\n                },\n                previewTimeMs: 250,\n                previewMoveDistance: 8,\n                dragMoveDistance: 4,\n                dragTimeMs: 500,\n            },\n            actions: {\n                [StrategyCallbacks.AcceptPreview]: {\n                    method: StrategyCallbacks.AcceptPreview,\n                    bindings: [\n                        {\n                            key: 'Enter',\n                        },\n                    ],\n                },\n                [StrategyCallbacks.RejectPreview]: {\n                    method: StrategyCallbacks.RejectPreview,\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n                [StrategyCallbacks.Interpolate]: {\n                    method: StrategyCallbacks.Interpolate,\n                    bindings: [\n                        {\n                            key: 'i',\n                        },\n                    ],\n                    configuration: {\n                        useBallStructuringElement: true,\n                        noUseDistanceTransform: true,\n                        noUseExtrapolation: true,\n                    },\n                },\n                interpolateExtrapolation: {\n                    method: StrategyCallbacks.Interpolate,\n                    bindings: [\n                        {\n                            key: 'e',\n                        },\n                    ],\n                    configuration: {},\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.onSetToolPassive = (evt) => {\n            this.disableCursor();\n        };\n        this.onSetToolEnabled = () => {\n            this.disableCursor();\n        };\n        this.onSetToolDisabled = (evt) => {\n            this.disableCursor();\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this._editData = this.createEditData(element);\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            this._previewData.isDrag = false;\n            this._previewData.timerStart = Date.now();\n            const hoverData = this._hoverData || this.createHoverData(element);\n            triggerAnnotationRenderForViewportUIDs(hoverData.viewportIdsToRender);\n            const operationData = this.getOperationData(element);\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionStart);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.updateCursor(evt);\n                if (!this.configuration.preview.enabled) {\n                    return;\n                }\n                const { previewTimeMs, previewMoveDistance, dragMoveDistance } = this.configuration.preview;\n                const { currentPoints, element } = evt.detail;\n                const { canvas } = currentPoints;\n                const { startPoint, timer, timerStart, isDrag } = this._previewData;\n                if (isDrag) {\n                    return;\n                }\n                const delta = vec2.distance(canvas, startPoint);\n                const time = Date.now() - timerStart;\n                if (delta > previewMoveDistance ||\n                    (time > previewTimeMs && delta > dragMoveDistance)) {\n                    if (timer) {\n                        window.clearTimeout(timer);\n                        this._previewData.timer = null;\n                    }\n                    if (!isDrag) {\n                        this.rejectPreview(element);\n                    }\n                }\n                if (!this._previewData.timer) {\n                    const timer = window.setTimeout(this.previewCallback, 250);\n                    Object.assign(this._previewData, {\n                        timerStart: Date.now(),\n                        timer,\n                        startPoint: canvas,\n                        element,\n                    });\n                }\n            }\n        };\n        this.previewCallback = () => {\n            if (this._previewData.isDrag) {\n                this._previewData.timer = null;\n                return;\n            }\n            this._previewData.timer = null;\n            const operationData = this.getOperationData(this._previewData.element);\n            const enabledElement = getEnabledElement(this._previewData.element);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            const activeStrategy = this.configuration.activeStrategy;\n            const strategyData = getStrategyData({\n                operationData,\n                viewport,\n                strategy: activeStrategy,\n            });\n            if (!operationData) {\n                return;\n            }\n            const memo = this.createMemo(operationData.segmentationId, strategyData.segmentationVoxelManager);\n            this._previewData.preview = this.applyActiveStrategyCallback(getEnabledElement(this._previewData.element), {\n                ...operationData,\n                ...strategyData,\n                memo,\n            }, StrategyCallbacks.Preview);\n        };\n        this._dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this.updateCursor(evt);\n            const { viewportIdsToRender } = this._hoverData;\n            triggerAnnotationRenderForViewportUIDs(viewportIdsToRender);\n            const delta = vec2.distance(currentPoints.canvas, this._previewData.startPoint);\n            const { dragTimeMs, dragMoveDistance } = this.configuration.preview;\n            if (!this._previewData.isDrag &&\n                Date.now() - this._previewData.timerStart < dragTimeMs &&\n                delta < dragMoveDistance) {\n                return;\n            }\n            if (this._previewData.timer) {\n                window.clearTimeout(this._previewData.timer);\n                this._previewData.timer = null;\n            }\n            this._previewData.preview = this.applyActiveStrategy(enabledElement, this.getOperationData(element));\n            this._previewData.element = element;\n            this._previewData.timerStart = Date.now() + dragTimeMs;\n            this._previewData.isDrag = true;\n            this._previewData.startPoint = currentPoints.canvas;\n        };\n        this._endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            const operationData = this.getOperationData(element);\n            if (!this._previewData.preview && !this._previewData.isDrag) {\n                this.applyActiveStrategy(enabledElement, operationData);\n                this.doneEditMemo();\n            }\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.updateCursor(evt);\n            this._editData = null;\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionEnd);\n            if (!this._previewData.isDrag) {\n                this.acceptPreview(element);\n            }\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n    }\n    disableCursor() {\n        this._hoverData = undefined;\n        this.rejectPreview();\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const { element } = eventData;\n        const { currentPoints } = eventData;\n        const centerCanvas = currentPoints.canvas;\n        this._hoverData = this.createHoverData(element, centerCanvas);\n        this._calculateCursor(element, centerCanvas);\n        if (!this._hoverData) {\n            return;\n        }\n        triggerAnnotationRenderForViewportUIDs(this._hoverData.viewportIdsToRender);\n    }\n    _calculateCursor(element, centerCanvas) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvasToWorld } = viewport;\n        const camera = viewport.getCamera();\n        const { brushSize } = this.configuration;\n        const viewUp = vec3.fromValues(camera.viewUp[0], camera.viewUp[1], camera.viewUp[2]);\n        const viewPlaneNormal = vec3.fromValues(camera.viewPlaneNormal[0], camera.viewPlaneNormal[1], camera.viewPlaneNormal[2]);\n        const viewRight = vec3.create();\n        vec3.cross(viewRight, viewUp, viewPlaneNormal);\n        const centerCursorInWorld = canvasToWorld([\n            centerCanvas[0],\n            centerCanvas[1],\n        ]);\n        const bottomCursorInWorld = vec3.create();\n        const topCursorInWorld = vec3.create();\n        const leftCursorInWorld = vec3.create();\n        const rightCursorInWorld = vec3.create();\n        for (let i = 0; i <= 2; i++) {\n            bottomCursorInWorld[i] = centerCursorInWorld[i] - viewUp[i] * brushSize;\n            topCursorInWorld[i] = centerCursorInWorld[i] + viewUp[i] * brushSize;\n            leftCursorInWorld[i] = centerCursorInWorld[i] - viewRight[i] * brushSize;\n            rightCursorInWorld[i] = centerCursorInWorld[i] + viewRight[i] * brushSize;\n        }\n        if (!this._hoverData) {\n            return;\n        }\n        const { brushCursor } = this._hoverData;\n        const { data } = brushCursor;\n        if (data.handles === undefined) {\n            data.handles = {};\n        }\n        data.handles.points = [\n            bottomCursorInWorld,\n            topCursorInWorld,\n            leftCursorInWorld,\n            rightCursorInWorld,\n        ];\n        const activeStrategy = this.configuration.activeStrategy;\n        const strategy = this.configuration.strategies[activeStrategy];\n        if (typeof strategy?.computeInnerCircleRadius === 'function') {\n            strategy.computeInnerCircleRadius({\n                configuration: this.configuration,\n                viewport,\n            });\n        }\n        data.invalidated = false;\n    }\n    getStatistics(element, segmentIndices) {\n        if (!element) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        const stats = this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.GetStatistics, segmentIndices);\n        return stats;\n    }\n    rejectPreview(element = this._previewData.element) {\n        if (!element) {\n            return;\n        }\n        this.doneEditMemo();\n        const enabledElement = getEnabledElement(element);\n        this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.RejectPreview);\n        this._previewData.preview = null;\n        this._previewData.isDrag = false;\n    }\n    acceptPreview(element = this._previewData.element) {\n        if (!element) {\n            return;\n        }\n        super.acceptPreview(element);\n    }\n    interpolate(element, config) {\n        if (!element) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        this._previewData.preview = this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.Interpolate, config.configuration);\n        this._previewData.isDrag = true;\n    }\n    invalidateBrushCursor() {\n        if (this._hoverData === undefined) {\n            return;\n        }\n        const { data } = this._hoverData.brushCursor;\n        const { viewport } = this._hoverData;\n        data.invalidated = true;\n        const { segmentColor } = this.getActiveSegmentationData(viewport) || {};\n        this._hoverData.brushCursor.metadata.segmentColor = segmentColor;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this._hoverData) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const viewportIdsToRender = this._hoverData.viewportIdsToRender;\n        if (!viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const brushCursor = this._hoverData.brushCursor;\n        if (brushCursor.data.invalidated === true) {\n            const { centerCanvas } = this._hoverData;\n            const { element } = viewport;\n            this._calculateCursor(element, centerCanvas);\n        }\n        const toolMetadata = brushCursor.metadata;\n        if (!toolMetadata) {\n            return;\n        }\n        const annotationUID = toolMetadata.brushCursorUID;\n        const data = brushCursor.data;\n        const { points } = data.handles;\n        const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n        const bottom = canvasCoordinates[0];\n        const top = canvasCoordinates[1];\n        const center = [\n            Math.floor((bottom[0] + top[0]) / 2),\n            Math.floor((bottom[1] + top[1]) / 2),\n        ];\n        const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n        const color = `rgb(${toolMetadata.segmentColor?.slice(0, 3) || [0, 0, 0]})`;\n        if (!viewport.getRenderingEngine()) {\n            console.warn('Rendering Engine has been destroyed');\n            return;\n        }\n        const circleUID = '0';\n        drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n            color,\n            lineDash: this.centerSegmentIndexInfo.segmentIndex === 0 ? [1, 2] : null,\n        });\n        const { dynamicRadiusInCanvas } = this.configuration?.threshold || {\n            dynamicRadiusInCanvas: 0,\n        };\n        if (dynamicRadiusInCanvas) {\n            const circleUID1 = '1';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID1, center, dynamicRadiusInCanvas, {\n                color,\n            });\n        }\n    }\n}\nBrushTool.toolName = 'Brush';\nexport default BrushTool;\n","import { StackViewport, cache, getEnabledElement, utilities as csUtils, utilities as coreUtils, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, removeAnnotation, getAnnotations, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport throttle from '../../utilities/throttle';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport CircleROITool from '../annotation/CircleROITool';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedAspect, } from '../../utilities/getCalibratedUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROIStartEndThresholdTool extends CircleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            calculatePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    volumeId,\n                    spacingInNormal,\n                    enabledElement,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        statistics: [],\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data, metadata } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let tempStartCoordinate = startCoordinate;\n                let tempEndCoordinate = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    tempStartCoordinate = this._getCoordinateForViewplaneNormal(tempStartCoordinate, viewplaneNormal);\n                    data.startCoordinate = tempStartCoordinate;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    tempEndCoordinate = this._getCoordinateForViewplaneNormal(tempEndCoordinate, viewplaneNormal);\n                    data.endCoordinate = tempEndCoordinate;\n                }\n                const roundedStartCoordinate = coreUtils.roundToPrecision(data.startCoordinate);\n                const roundedEndCoordinate = coreUtils.roundToPrecision(data.endCoordinate);\n                const cameraCoordinate = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCameraCoordinate = coreUtils.roundToPrecision(cameraCoordinate);\n                if (roundedCameraCoordinate <\n                    Math.min(roundedStartCoordinate, roundedEndCoordinate) ||\n                    roundedCameraCoordinate >\n                        Math.max(roundedStartCoordinate, roundedEndCoordinate)) {\n                    continue;\n                }\n                const middleCoordinate = coreUtils.roundToPrecision((data.startCoordinate + data.endCoordinate) / 2);\n                let isMiddleSlice = false;\n                if (roundedCameraCoordinate === middleCoordinate) {\n                    isMiddleSlice = true;\n                }\n                data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = middleCoordinate;\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    isMiddleSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineWidthToUse = lineWidth;\n                let lineDashToUse = lineDash;\n                if (isMiddleSlice) {\n                    lineWidthToUse = lineWidth;\n                    lineDashToUse = [];\n                }\n                else {\n                    lineDashToUse = [5, 5];\n                }\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth: lineWidthToUse,\n                });\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                if (this.configuration.showTextBox == true &&\n                    this.configuration.calculatePointsInsideVolume == true) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data, { metadata });\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    let canvasTextBoxCoords;\n                    if (!data.handles.textBox.hasMoved) {\n                        canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const handlesToStart = csUtils.deepClone(points);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n            handlesToStart[0][2] = startCoordinate;\n            handlesToStart[1][2] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n            handlesToStart[0][0] = startCoordinate;\n            handlesToStart[1][0] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n            handlesToStart[0][1] = startCoordinate;\n            handlesToStart[1][1] = startCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(handlesToStart.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n        const pos1 = viewport.canvasToWorld(topLeftCanvas);\n        const pos2 = viewport.canvasToWorld(bottomRightCanvas);\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, pos1, pos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.handles);\n        const aspect = getCalibratedAspect(image);\n        const area = Math.abs(Math.PI *\n            (worldWidth / measureInfo.scale / 2) *\n            (worldHeight / aspect / measureInfo.scale / 2));\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const centerWorld = projectionPoints[i][0];\n            const canvasCoordinates = projectionPoints[i].map((p) => viewport.worldToCanvas(p));\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, centerWorld);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = centerWorld;\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS),\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateFromStart = Math.round(numSlicesToPropagate / 2);\n        const startPos = vec3.create();\n        vec3.scaleAndAdd(startPos, worldPos, viewPlaneNormal, numSlicesToPropagateFromStart * -spacingInNormal);\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateToEnd = numSlicesToPropagate - Math.round(numSlicesToPropagate / 2);\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagateToEnd * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data, _context = {}) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nCircleROIStartEndThresholdTool.toolName = 'CircleROIStartEndThreshold';\nexport default CircleROIStartEndThresholdTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideCircle } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { Events } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, config as segmentationConfig, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nimport LabelmapBaseTool from './LabelmapBaseTool';\nclass CircleScissorsTool extends LabelmapBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideCircle,\n                ERASE_INSIDE: eraseInsideCircle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData.Labelmap;\n            if (!labelmapData) {\n                throw new Error('No labelmap data found for the active segmentation, create one before using scissors tool');\n            }\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    isDrawing: true,\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                viewPlaneNormal,\n                viewUp,\n                createMemo: this.createMemo.bind(this),\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n            this.doneEditMemo();\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nCircleScissorsTool.toolName = 'CircleScissor';\nexport default CircleScissorsTool;\n","import { cache, getEnabledElement, utilities as csUtils, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, } from '../../stateManagement/segmentation';\nimport floodFill from '../../utilities/segmentation/floodFill';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nconst { transformWorldToIndex, isEqual } = csUtils;\nclass PaintFillTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const { representationData } = getSegmentation(segmentationId);\n            let dimensions;\n            let direction;\n            let index;\n            let voxelManager;\n            this.doneEditMemo();\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = representationData[SegmentationRepresentations.Labelmap];\n                const segmentation = cache.getVolume(volumeId);\n                ({ dimensions, direction } = segmentation);\n                voxelManager = segmentation.voxelManager;\n                index = transformWorldToIndex(segmentation.imageData, worldPos);\n            }\n            else {\n                const currentSegmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                if (!currentSegmentationImageId) {\n                    throw new Error('No active segmentation imageId detected, create one before using scissors tool');\n                }\n                const { imageData } = viewport.getImageData();\n                dimensions = imageData.getDimensions();\n                direction = imageData.getDirection();\n                const image = cache.getImage(currentSegmentationImageId);\n                voxelManager = image.voxelManager;\n                index = transformWorldToIndex(imageData, worldPos);\n            }\n            const fixedDimension = this.getFixedDimension(viewPlaneNormal, direction);\n            if (fixedDimension === undefined) {\n                console.warn('Oblique paint fill not yet supported');\n                return;\n            }\n            const { floodFillGetter, getLabelValue, getScalarDataPositionFromPlane, inPlaneSeedPoint, fixedDimensionValue, } = this.generateHelpers(voxelManager, dimensions, index, fixedDimension);\n            if (index[0] < 0 ||\n                index[0] >= dimensions[0] ||\n                index[1] < 0 ||\n                index[1] >= dimensions[1] ||\n                index[2] < 0 ||\n                index[2] >= dimensions[2]) {\n                return;\n            }\n            const clickedLabelValue = getLabelValue(index[0], index[1], index[2]);\n            if (segmentsLocked.includes(clickedLabelValue)) {\n                return;\n            }\n            const floodFillResult = floodFill(floodFillGetter, inPlaneSeedPoint);\n            const { flooded } = floodFillResult;\n            flooded.forEach((index) => {\n                const scalarDataIndex = getScalarDataPositionFromPlane(index[0], index[1]);\n                voxelManager.setAtIndex(scalarDataIndex, segmentIndex);\n            });\n            const framesModified = this.getFramesModified(fixedDimension, fixedDimensionValue, floodFillResult);\n            triggerSegmentationDataModified(segmentationId, framesModified);\n            return true;\n        };\n        this.getFramesModified = (fixedDimension, fixedDimensionValue, floodFillResult) => {\n            const { flooded: boundaries } = floodFillResult;\n            if (fixedDimension === 2) {\n                return [fixedDimensionValue];\n            }\n            let minJ = Infinity;\n            let maxJ = -Infinity;\n            for (let b = 0; b < boundaries.length; b++) {\n                const j = boundaries[b][1];\n                if (j < minJ) {\n                    minJ = j;\n                }\n                if (j > maxJ) {\n                    maxJ = j;\n                }\n            }\n            const framesModified = [];\n            for (let frame = minJ; frame <= maxJ; frame++) {\n                framesModified.push(frame);\n            }\n            return framesModified;\n        };\n        this.generateHelpers = (voxelManager, dimensions, seedIndex3D, fixedDimension = 2) => {\n            let fixedDimensionValue;\n            let inPlaneSeedPoint;\n            switch (fixedDimension) {\n                case 0:\n                    fixedDimensionValue = seedIndex3D[0];\n                    inPlaneSeedPoint = [seedIndex3D[1], seedIndex3D[2]];\n                    break;\n                case 1:\n                    fixedDimensionValue = seedIndex3D[1];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[2]];\n                    break;\n                case 2:\n                    fixedDimensionValue = seedIndex3D[2];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[1]];\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            const getScalarDataPosition = (x, y, z) => {\n                return voxelManager.toIndex([x, y, z]);\n            };\n            const getLabelValue = (x, y, z) => {\n                return voxelManager.getAtIJK(x, y, z);\n            };\n            const floodFillGetter = this.generateFloodFillGetter(dimensions, fixedDimension, fixedDimensionValue, getLabelValue);\n            const getScalarDataPositionFromPlane = this.generateGetScalarDataPositionFromPlane(getScalarDataPosition, fixedDimension, fixedDimensionValue);\n            return {\n                getScalarDataPositionFromPlane,\n                getLabelValue,\n                floodFillGetter,\n                inPlaneSeedPoint,\n                fixedDimensionValue,\n            };\n        };\n        this.generateFloodFillGetter = (dimensions, fixedDimension, fixedDimensionValue, getLabelValue) => {\n            let floodFillGetter;\n            switch (fixedDimension) {\n                case 0:\n                    floodFillGetter = (y, z) => {\n                        if (y >= dimensions[1] || y < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    floodFillGetter = (x, z) => {\n                        if (x >= dimensions[0] || x < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    floodFillGetter = (x, y) => {\n                        if (x >= dimensions[0] || x < 0 || y >= dimensions[1] || y < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return floodFillGetter;\n        };\n        this.generateGetScalarDataPositionFromPlane = (getScalarDataPosition, fixedDimension, fixedDimensionValue) => {\n            let getScalarDataPositionFromPlane;\n            switch (fixedDimension) {\n                case 0:\n                    getScalarDataPositionFromPlane = (y, z) => {\n                        return getScalarDataPosition(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    getScalarDataPositionFromPlane = (x, z) => {\n                        return getScalarDataPosition(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    getScalarDataPositionFromPlane = (x, y) => {\n                        return getScalarDataPosition(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return getScalarDataPositionFromPlane;\n        };\n    }\n    getFixedDimension(viewPlaneNormal, direction) {\n        const xDirection = direction.slice(0, 3);\n        const yDirection = direction.slice(3, 6);\n        const zDirection = direction.slice(6, 9);\n        const absoluteOfViewPlaneNormal = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const absoluteOfXDirection = [\n            Math.abs(xDirection[0]),\n            Math.abs(xDirection[1]),\n            Math.abs(xDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfXDirection)) {\n            return 0;\n        }\n        const absoluteOfYDirection = [\n            Math.abs(yDirection[0]),\n            Math.abs(yDirection[1]),\n            Math.abs(yDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfYDirection)) {\n            return 1;\n        }\n        const absoluteOfZDirection = [\n            Math.abs(zDirection[0]),\n            Math.abs(zDirection[1]),\n            Math.abs(zDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfZDirection)) {\n            return 2;\n        }\n    }\n}\nPaintFillTool.toolName = 'PaintFill';\nexport default PaintFillTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport throttle from '../../utilities/throttle';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromCorners from '../../utilities/planar/getWorldWidthAndHeightFromCorners';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass RectangleROIStartEndThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            computePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                    spacingInNormal,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        projectionPointsImageIds: [referencedImageId],\n                        statistics: [],\n                    },\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data, metadata } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let startCoord = startCoordinate;\n                let endCoord = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    startCoord = this._getCoordinateForViewplaneNormal(startCoord, viewplaneNormal);\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    endCoord = this._getCoordinateForViewplaneNormal(endCoord, viewplaneNormal);\n                    data.endCoordinate = endCoord;\n                    data.endCoordinate = endCoord;\n                }\n                const roundedStartCoord = csUtils.roundToPrecision(startCoord);\n                const roundedEndCoord = csUtils.roundToPrecision(endCoord);\n                const coord = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCoord = csUtils.roundToPrecision(coord);\n                if (roundedCoord < Math.min(roundedStartCoord, roundedEndCoord) ||\n                    roundedCoord > Math.max(roundedStartCoord, roundedEndCoord)) {\n                    continue;\n                }\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                let firstOrLastSlice = false;\n                if (roundedCoord === roundedStartCoord ||\n                    roundedCoord === roundedEndCoord) {\n                    firstOrLastSlice = true;\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    firstOrLastSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineDashToUse = lineDash;\n                if (!firstOrLastSlice) {\n                    lineDashToUse = 2;\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth,\n                });\n                renderStatus = true;\n                if (this.configuration.showTextBox &&\n                    this.configuration.calculatePointsInsideVolume) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data, { metadata });\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    if (!data.handles.textBox.hasMoved) {\n                        const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(points.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[3];\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromCorners(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.habdles);\n        const area = Math.abs(worldWidth * worldHeight) /\n            (measureInfo.scale * measureInfo.scale);\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const projectionPoint = projectionPoints[i][0];\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, projectionPoint);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                this.isHandleOutsideImage = false;\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, viewPlaneNormal) {\n        const startPos = worldPos;\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagate * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data, _context = {}) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nRectangleROIStartEndThresholdTool.toolName = 'RectangleROIStartEndThreshold';\nexport default RectangleROIStartEndThresholdTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nclass RectangleROIThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const targetId = this.getTargetId(viewport);\n            let referencedImageId, volumeId;\n            if (viewport instanceof StackViewport) {\n                referencedImageId = targetId.split('imageId:')[1];\n            }\n            else {\n                volumeId = csUtils.getVolumeId(targetId);\n                const imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: null,\n                            worldBoundingBox: null,\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    segmentationId: null,\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                triggerAnnotationModified(annotation, element);\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n}\nRectangleROIThresholdTool.toolName = 'RectangleROIThreshold';\nexport default RectangleROIThresholdTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideRectangle } from './strategies/fillRectangle';\nimport { eraseInsideRectangle } from './strategies/eraseRectangle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawRect as drawRectSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nimport LabelmapBaseTool from './LabelmapBaseTool';\nclass RectangleScissorsTool extends LabelmapBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideRectangle,\n                ERASE_INSIDE: eraseInsideRectangle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            points[handleIndex] = [...worldPos];\n            let bottomLeftCanvas;\n            let bottomRightCanvas;\n            let topLeftCanvas;\n            let topRightCanvas;\n            let bottomLeftWorld;\n            let bottomRightWorld;\n            let topLeftWorld;\n            let topRightWorld;\n            switch (handleIndex) {\n                case 0:\n                case 3:\n                    bottomLeftCanvas = worldToCanvas(points[0]);\n                    topRightCanvas = worldToCanvas(points[3]);\n                    bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                    topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                    bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                    topLeftWorld = canvasToWorld(topLeftCanvas);\n                    points[1] = bottomRightWorld;\n                    points[2] = topLeftWorld;\n                    break;\n                case 1:\n                case 2:\n                    bottomRightCanvas = worldToCanvas(points[1]);\n                    topLeftCanvas = worldToCanvas(points[2]);\n                    bottomLeftCanvas = [\n                        topLeftCanvas[0],\n                        bottomRightCanvas[1],\n                    ];\n                    topRightCanvas = [bottomRightCanvas[0], topLeftCanvas[1]];\n                    bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                    topRightWorld = canvasToWorld(topRightCanvas);\n                    points[0] = bottomLeftWorld;\n                    points[3] = topRightWorld;\n                    break;\n            }\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                createMemo: this.createMemo.bind(this),\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n            this.doneEditMemo();\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const rectangleUID = '0';\n            drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nRectangleScissorsTool.toolName = 'RectangleScissor';\nexport default RectangleScissorsTool;\n","import { getEnabledElement, utilities as csUtils, getEnabledElementByViewportId, utilities, } from '@cornerstonejs/core';\nimport { addAnnotation, getAllAnnotations, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { drawLine as drawLineSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport BidirectionalTool from '../annotation/BidirectionalTool';\nimport { getSegmentIndexColor } from '../../stateManagement/segmentation/config/segmentationColor';\nclass SegmentBidirectionalTool extends BidirectionalTool {\n    static { this.toolName = 'SegmentBidirectional'; }\n    constructor(toolProps = {}) {\n        super(toolProps);\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = true;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const viewportId = viewport.id;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { segmentIndex, segmentationId } = annotation.metadata;\n                const { lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const colorArray = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n                const color = `rgb(${colorArray.slice(0, 3).join(',')})`;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        width: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId1 = `${annotationUID}-line-1`;\n                const dataId2 = `${annotationUID}-line-2`;\n                const lineUID = '0';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId1);\n                const secondLineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, secondLineUID, canvasCoordinates[2], canvasCoordinates[3], {\n                    color,\n                    lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId2);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                options.color = color;\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const worldPos = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        this.isDrawing = true;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const annotation = {\n            highlighted: true,\n            invalidated: true,\n            metadata: {\n                toolName: this.getToolName(),\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...viewport.getViewReference({ points: [worldPos] }),\n            },\n            data: {\n                handles: {\n                    points: [\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                    ],\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n        };\n        addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex: 1,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n        };\n        this._activateDraw(element);\n        hideElementCursor(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    static { this.hydrate = (viewportId, axis, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const existingAnnotations = getAllAnnotations();\n        const toolAnnotations = existingAnnotations.filter((annotation) => annotation.metadata.toolName === 'SegmentBidirectional');\n        const existingAnnotation = toolAnnotations.find((annotation) => {\n            const { metadata } = annotation;\n            if (metadata.segmentIndex === options?.segmentIndex &&\n                metadata.segmentationId === options?.segmentationId) {\n                return true;\n            }\n            return false;\n        });\n        if (existingAnnotation) {\n            removeAnnotation(existingAnnotation.annotationUID);\n        }\n        const { FrameOfReferenceUID, referencedImageId, viewPlaneNormal, instance, } = this.hydrateBase(SegmentBidirectionalTool, enabledElement, axis[0], options);\n        const [majorAxis, minorAxis] = axis;\n        const [major0, major1] = majorAxis;\n        const [minor0, minor1] = minorAxis;\n        const points = [major0, major1, minor0, minor1];\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    activeHandleIndex: null,\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                },\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                segmentIndex: options?.segmentIndex,\n                segmentationId: options?.segmentationId,\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n        return annotation;\n    }; }\n}\nexport default SegmentBidirectionalTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { triggerSegmentationModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getActiveSegmentation } from '../../stateManagement/segmentation/activeSegmentation';\nimport RepresentationTypes from '../../enums/SegmentationRepresentations';\nimport { setActiveSegmentIndex } from '../../stateManagement/segmentation/segmentIndex';\nimport { getHoveredContourSegmentationAnnotation, getSegmentIndexAtLabelmapBorder, getSegmentIndexAtWorldPoint, } from '../../utilities/segmentation';\nimport { state } from '../../store/state';\nclass SegmentSelectTool extends BaseTool {\n    static { this.SelectMode = {\n        Inside: 'Inside',\n        Border: 'Border',\n    }; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            hoverTimeout: 100,\n            mode: SegmentSelectTool.SelectMode.Border,\n            searchRadius: 6,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseMoveCallback = (evt) => {\n            if (this.hoverTimer) {\n                clearTimeout(this.hoverTimer);\n            }\n            this.hoverTimer = setTimeout(() => {\n                this._setActiveSegment(evt);\n                this.hoverTimer = null;\n            }, this.configuration.hoverTimeout);\n            return true;\n        };\n        this.onSetToolEnabled = () => {\n            this.onSetToolActive();\n        };\n        this.onSetToolActive = () => {\n            this.hoverTimer = null;\n        };\n        this.onSetToolDisabled = () => {\n            this.hoverTimer = null;\n        };\n        this.hoverTimer = null;\n    }\n    _setActiveSegment(evt = {}) {\n        if (state.isInteractingWithTool) {\n            return;\n        }\n        const { element, currentPoints } = evt.detail;\n        const worldPoint = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const activeSegmentation = getActiveSegmentation(viewport.id);\n        if (!activeSegmentation) {\n            return;\n        }\n        this._setActiveSegmentForType(activeSegmentation, worldPoint, viewport);\n    }\n    _setActiveSegmentForType(activeSegmentation, worldPoint, viewport) {\n        const imageDataInfo = viewport.getImageData();\n        if (!imageDataInfo) {\n            return;\n        }\n        const { segmentationId, representationData } = activeSegmentation;\n        let hoveredSegmentIndex;\n        if (this.configuration.mode === SegmentSelectTool.SelectMode.Inside) {\n            hoveredSegmentIndex = getSegmentIndexAtWorldPoint(segmentationId, worldPoint, {\n                viewport,\n            });\n        }\n        else {\n            if (representationData.Labelmap) {\n                hoveredSegmentIndex = getSegmentIndexAtLabelmapBorder(segmentationId, worldPoint, {\n                    viewport,\n                    searchRadius: this.configuration.searchRadius,\n                });\n            }\n            else if (representationData.Contour) {\n                hoveredSegmentIndex =\n                    getHoveredContourSegmentationAnnotation(segmentationId);\n            }\n            else if (representationData.Surface) {\n            }\n        }\n        if (!hoveredSegmentIndex || hoveredSegmentIndex === 0) {\n            return;\n        }\n        setActiveSegmentIndex(segmentationId, hoveredSegmentIndex);\n        const renderingEngine = viewport.getRenderingEngine();\n        const viewportIds = renderingEngine.getViewports().map((v) => v.id);\n        triggerSegmentationModified(segmentationId);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    }\n}\nSegmentSelectTool.toolName = 'SegmentSelectTool';\nexport default SegmentSelectTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { fillInsideSphere } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getSegmentation } from '../../stateManagement/segmentation/segmentationState';\nimport LabelmapBaseTool from './LabelmapBaseTool';\nclass SphereScissorsTool extends LabelmapBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideSphere,\n                ERASE_INSIDE: eraseInsideSphere,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            this.doneEditMemo();\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            this.isDrawing = true;\n            const annotation = {\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    invalidated: true,\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    highlighted: true,\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                toolGroupId: this.toolGroupId,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            const { representationData } = getSegmentation(segmentationId);\n            const editData = this.getEditData({\n                viewport,\n                representationData,\n                segmentsLocked,\n                segmentationId,\n            });\n            this.editData = {\n                ...this.editData,\n                ...editData,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved, segmentIndex, segmentsLocked, } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                segmentIndex,\n                segmentsLocked,\n                viewPlaneNormal,\n                viewUp,\n                createMemo: this.createMemo.bind(this),\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n            this.doneEditMemo();\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nSphereScissorsTool.toolName = 'SphereScissor';\nexport default SphereScissorsTool;\n","import { cache, utilities as csUtils } from '@cornerstonejs/core';\nimport StrategyCallbacks from '../../../../enums/StrategyCallbacks';\nimport { getSegmentation } from '../../../../stateManagement/segmentation/getSegmentation';\nimport getOrCreateImageVolume from '../../../../utilities/segmentation/getOrCreateImageVolume';\nexport default {\n    [StrategyCallbacks.EnsureImageVolumeFor3DManipulation]: (data) => {\n        const { operationData, viewport } = data;\n        let referencedImageIds;\n        if (viewport) {\n            referencedImageIds = viewport.getImageIds();\n            const isValidVolumeForSphere = csUtils.isValidVolume(referencedImageIds);\n            if (!isValidVolumeForSphere) {\n                throw new Error('Volume is not reconstructable for sphere manipulation');\n            }\n        }\n        else {\n            const segmentation = getSegmentation(operationData.segmentationId);\n            const imageIds = segmentation.representationData\n                .Labelmap.imageIds;\n            referencedImageIds = imageIds.map((imageId) => {\n                const image = cache.getImage(imageId);\n                return image.referencedImageId;\n            });\n        }\n        const imageVolume = getOrCreateImageVolume(referencedImageIds);\n        if (!imageVolume) {\n            throw new Error('Failed to create or get image volume');\n        }\n        operationData.imageVoxelManager = imageVolume.voxelManager;\n        operationData.imageData = imageVolume.imageData;\n    },\n};\n","import { utilities, cache } from '@cornerstonejs/core';\nimport StrategyCallbacks from '../../../../enums/StrategyCallbacks';\nimport getOrCreateSegmentationVolume from '../../../../utilities/segmentation/getOrCreateSegmentationVolume';\nexport default {\n    [StrategyCallbacks.EnsureSegmentationVolumeFor3DManipulation]: (data) => {\n        const { operationData, viewport } = data;\n        const { segmentationId, imageIds: segImageIds } = operationData;\n        const referencedImageIds = viewport\n            ? viewport.getImageIds()\n            : segImageIds.map((imageId) => cache.getImage(imageId).referencedImageId);\n        const isValidVolumeForSphere = utilities.isValidVolume(referencedImageIds);\n        if (!isValidVolumeForSphere) {\n            throw new Error('Volume is not reconstructable for sphere manipulation');\n        }\n        const segVolume = getOrCreateSegmentationVolume(segmentationId);\n        if (!segVolume) {\n            return;\n        }\n        operationData.segmentationVoxelManager = segVolume.voxelManager;\n        operationData.segmentationImageData = segVolume.imageData;\n        return;\n    },\n};\n","import { vec3 } from 'gl-matrix';\nimport { utilities as csUtils } from '@cornerstonejs/core';\nimport { getCanvasEllipseCorners, precalculatePointInEllipse, } from '../../../utilities/math/ellipse';\nimport { getBoundingBoxAroundShapeIJK } from '../../../utilities/boundingBox';\nimport BrushStrategy from './BrushStrategy';\nimport { StrategyCallbacks } from '../../../enums';\nimport compositions from './compositions';\nimport { pointInSphere } from '../../../utilities/math/sphere';\nconst { transformWorldToIndex, isEqual } = csUtils;\nconst initializeCircle = {\n    [StrategyCallbacks.Initialize]: (operationData) => {\n        const { points, viewport, segmentationImageData, } = operationData;\n        if (!points) {\n            return;\n        }\n        const center = vec3.fromValues(0, 0, 0);\n        points.forEach((point) => {\n            vec3.add(center, center, point);\n        });\n        vec3.scale(center, center, 1 / points.length);\n        operationData.centerWorld = center;\n        operationData.centerIJK = transformWorldToIndex(segmentationImageData, center);\n        const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n        const [topLeftCanvas, bottomRightCanvas] = getCanvasEllipseCorners(canvasCoordinates);\n        const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n        const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n        const circleCornersIJK = points.map((world) => {\n            return transformWorldToIndex(segmentationImageData, world);\n        });\n        const boundsIJK = getBoundingBoxAroundShapeIJK(circleCornersIJK, segmentationImageData.getDimensions());\n        operationData.isInObject = createPointInEllipse({\n            topLeftWorld,\n            bottomRightWorld,\n            center,\n        });\n        operationData.isInObjectBoundsIJK = boundsIJK;\n    },\n};\nfunction createPointInEllipse(worldInfo) {\n    const { topLeftWorld, bottomRightWorld, center } = worldInfo;\n    const xRadius = Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2;\n    const yRadius = Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2;\n    const zRadius = Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2;\n    const radius = Math.max(xRadius, yRadius, zRadius);\n    if (isEqual(xRadius, radius) &&\n        isEqual(yRadius, radius) &&\n        isEqual(zRadius, radius)) {\n        const sphereObj = {\n            center,\n            radius,\n            radius2: radius * radius,\n        };\n        return (pointLPS) => pointInSphere(sphereObj, pointLPS);\n    }\n    const ellipseObj = {\n        center: center,\n        xRadius,\n        yRadius,\n        zRadius,\n    };\n    const { precalculated } = precalculatePointInEllipse(ellipseObj, {});\n    return precalculated;\n}\nconst CIRCLE_STRATEGY = new BrushStrategy('Circle', compositions.regionFill, compositions.setValue, initializeCircle, compositions.determineSegmentIndex, compositions.preview, compositions.labelmapStatistics);\nconst CIRCLE_THRESHOLD_STRATEGY = new BrushStrategy('CircleThreshold', compositions.regionFill, compositions.setValue, initializeCircle, compositions.determineSegmentIndex, compositions.dynamicThreshold, compositions.threshold, compositions.preview, compositions.islandRemoval, compositions.labelmapStatistics);\nconst fillInsideCircle = CIRCLE_STRATEGY.strategyFunction;\nconst thresholdInsideCircle = CIRCLE_THRESHOLD_STRATEGY.strategyFunction;\nexport function fillOutsideCircle() {\n    throw new Error('Not yet implemented');\n}\nexport { CIRCLE_STRATEGY, CIRCLE_THRESHOLD_STRATEGY, fillInsideCircle, thresholdInsideCircle, createPointInEllipse as createEllipseInPoint, };\n","import { vec3 } from 'gl-matrix';\nimport { utilities as csUtils, StackViewport } from '@cornerstonejs/core';\nimport { getBoundingBoxAroundShapeIJK, getBoundingBoxAroundShapeWorld, } from '../../../utilities/boundingBox';\nimport { triggerSegmentationDataModified } from '../../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { getStrategyData } from './utils/getStrategyData';\nimport { isAxisAlignedRectangle } from '../../../utilities/rectangleROITool/isAxisAlignedRectangle';\nimport BrushStrategy from './BrushStrategy';\nimport { StrategyCallbacks } from '../../../enums';\nimport compositions from './compositions';\nconst { transformWorldToIndex } = csUtils;\nconst initializeRectangle = {\n    [StrategyCallbacks.Initialize]: (operationData) => {\n        const { points, imageVoxelManager, viewport, segmentationImageData, segmentationVoxelManager, } = operationData;\n        if (!points) {\n            return;\n        }\n        const center = vec3.fromValues(0, 0, 0);\n        points.forEach((point) => {\n            vec3.add(center, center, point);\n        });\n        vec3.scale(center, center, 1 / points.length);\n        operationData.centerWorld = center;\n        operationData.centerIJK = transformWorldToIndex(segmentationImageData, center);\n        const { boundsIJK, pointInShapeFn } = createPointInRectangle(viewport, points, segmentationImageData);\n        operationData.isInObject = pointInShapeFn;\n        operationData.isInObjectBoundsIJK = boundsIJK;\n    },\n};\nfunction createPointInRectangle(viewport, points, segmentationImageData) {\n    let rectangleCornersIJK = points.map((world) => {\n        return transformWorldToIndex(segmentationImageData, world);\n    });\n    rectangleCornersIJK = rectangleCornersIJK.map((point) => {\n        return point.map((coord) => {\n            return Math.round(coord);\n        });\n    });\n    const boundsIJK = getBoundingBoxAroundShapeIJK(rectangleCornersIJK, segmentationImageData.getDimensions());\n    const isStackViewport = viewport instanceof StackViewport;\n    const isAligned = isStackViewport || isAxisAlignedRectangle(rectangleCornersIJK);\n    const direction = segmentationImageData.getDirection();\n    const spacing = segmentationImageData.getSpacing();\n    const { viewPlaneNormal } = viewport.getCamera();\n    const EPS = csUtils.getSpacingInNormalDirection({\n        direction,\n        spacing,\n    }, viewPlaneNormal);\n    const pointsBoundsLPS = getBoundingBoxAroundShapeWorld(points);\n    let [[xMin, xMax], [yMin, yMax], [zMin, zMax]] = pointsBoundsLPS;\n    xMin -= EPS;\n    xMax += EPS;\n    yMin -= EPS;\n    yMax += EPS;\n    zMin -= EPS;\n    zMax += EPS;\n    const pointInShapeFn = isAligned\n        ? () => true\n        : (pointLPS) => {\n            const [x, y, z] = pointLPS;\n            const xInside = x >= xMin && x <= xMax;\n            const yInside = y >= yMin && y <= yMax;\n            const zInside = z >= zMin && z <= zMax;\n            return xInside && yInside && zInside;\n        };\n    return { boundsIJK, pointInShapeFn };\n}\nconst RECTANGLE_STRATEGY = new BrushStrategy('Rectangle', compositions.regionFill, compositions.setValue, initializeRectangle, compositions.determineSegmentIndex, compositions.preview, compositions.labelmapStatistics);\nconst RECTANGLE_THRESHOLD_STRATEGY = new BrushStrategy('RectangleThreshold', compositions.regionFill, compositions.setValue, initializeRectangle, compositions.determineSegmentIndex, compositions.dynamicThreshold, compositions.threshold, compositions.preview, compositions.islandRemoval, compositions.labelmapStatistics);\nconst fillInsideRectangle = RECTANGLE_STRATEGY.strategyFunction;\nconst thresholdInsideRectangle = RECTANGLE_THRESHOLD_STRATEGY.strategyFunction;\nexport { RECTANGLE_STRATEGY, RECTANGLE_THRESHOLD_STRATEGY, fillInsideRectangle, thresholdInsideRectangle, };\n","export var ContourWindingDirection;\n(function (ContourWindingDirection) {\n    ContourWindingDirection[ContourWindingDirection[\"CounterClockwise\"] = -1] = \"CounterClockwise\";\n    ContourWindingDirection[ContourWindingDirection[\"Unknown\"] = 0] = \"Unknown\";\n    ContourWindingDirection[ContourWindingDirection[\"Clockwise\"] = 1] = \"Clockwise\";\n})(ContourWindingDirection || (ContourWindingDirection = {}));\n","import { triggerEvent, eventTarget } from '@cornerstonejs/core';\nimport Events from '../enums/Events';\nimport { ChangeTypes } from '../enums';\nexport default class AnnotationMultiSlice {\n    static setStartRange(viewport, annotation, startRange = viewport.getCurrentImageIdIndex()) {\n        this.setRange(viewport, annotation, startRange);\n    }\n    static setEndRange(viewport, annotation, endRange = viewport.getCurrentImageIdIndex()) {\n        this.setRange(viewport, annotation, undefined, endRange);\n    }\n    static setRange(viewport, annotation, startRange, endRange) {\n        const { metadata } = annotation;\n        if (startRange === undefined) {\n            startRange = metadata.sliceIndex < endRange ? metadata.sliceIndex : 0;\n            if (endRange === undefined) {\n                endRange = viewport.getNumberOfSlices() - 1;\n            }\n        }\n        const rangeEndSliceIndex = viewport.getSliceIndexForImage(metadata.multiSliceReference);\n        if (endRange === undefined) {\n            endRange =\n                rangeEndSliceIndex >= startRange\n                    ? rangeEndSliceIndex\n                    : viewport.getNumberOfSlices() - 1;\n        }\n        endRange = Math.max(startRange, endRange);\n        metadata.sliceIndex = Math.min(startRange, endRange);\n        metadata.referencedImageId = viewport.getCurrentImageId(metadata.sliceIndex);\n        metadata.referencedImageURI = undefined;\n        if (endRange === metadata.sliceIndex) {\n            metadata.multiSliceReference = undefined;\n        }\n        else if (endRange !== metadata.multiSliceReference?.sliceIndex) {\n            metadata.multiSliceReference = {\n                referencedImageId: viewport.getCurrentImageId(endRange),\n                sliceIndex: endRange,\n            };\n        }\n        const eventDetail = {\n            viewportId: viewport.id,\n            renderingEngineId: viewport.renderingEngineId,\n            changeType: ChangeTypes.MetadataReferenceModified,\n            annotation,\n        };\n        triggerEvent(eventTarget, Events.ANNOTATION_MODIFIED, eventDetail);\n        this.setViewportFrameRange(viewport, metadata);\n    }\n    static setSingle(viewport, annotation, current = viewport.getCurrentImageIdIndex()) {\n        this.setRange(viewport, annotation, current, current);\n    }\n    static getFrameRange(annotation) {\n        const { metadata } = annotation;\n        const { sliceIndex, multiSliceReference } = metadata;\n        const rangeEndSliceIndex = multiSliceReference?.sliceIndex;\n        return rangeEndSliceIndex\n            ? [sliceIndex + 1, rangeEndSliceIndex + 1]\n            : sliceIndex + 1;\n    }\n    static getFrameRangeStr(annotation) {\n        const range = this.getFrameRange(annotation);\n        return Array.isArray(range) ? `${range[0]}-${range[1]}` : String(range);\n    }\n    static setViewportFrameRange(viewport, specifier) {\n        if (viewport.setFrameRange && specifier.multiSliceReference?.sliceIndex) {\n            viewport.setFrameRange(specifier.sliceIndex + 1, specifier.multiSliceReference.sliceIndex + 1);\n        }\n    }\n}\n","import { utilities, BaseVolumeViewport, StackViewport, cache, metaData, } from '@cornerstonejs/core';\nimport { addAnnotation } from '../stateManagement/annotation/annotationState';\nimport { vec3 } from 'gl-matrix';\nfunction annotationHydration(viewport, toolName, worldPoints, options) {\n    const viewReference = viewport.getViewReference();\n    const { viewPlaneNormal, FrameOfReferenceUID } = viewReference;\n    const annotation = {\n        annotationUID: options?.annotationUID || utilities.uuidv4(),\n        data: {\n            handles: {\n                points: worldPoints,\n            },\n        },\n        highlighted: false,\n        autoGenerated: false,\n        invalidated: false,\n        isLocked: false,\n        isVisible: true,\n        metadata: {\n            toolName,\n            viewPlaneNormal,\n            FrameOfReferenceUID,\n            referencedImageId: getReferencedImageId(viewport, worldPoints[0], viewPlaneNormal),\n            ...options,\n        },\n    };\n    addAnnotation(annotation, viewport.element);\n    return annotation;\n}\nfunction getReferencedImageId(viewport, worldPos, viewPlaneNormal) {\n    let referencedImageId;\n    if (viewport instanceof StackViewport) {\n        referencedImageId = getClosestImageIdForStackViewport(viewport, worldPos, viewPlaneNormal);\n    }\n    else if (viewport instanceof BaseVolumeViewport) {\n        const targetId = getTargetId(viewport);\n        const volumeId = utilities.getVolumeId(targetId);\n        const imageVolume = cache.getVolume(volumeId);\n        referencedImageId = utilities.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n    }\n    else {\n        throw new Error('getReferencedImageId: viewport must be a StackViewport or BaseVolumeViewport');\n    }\n    return referencedImageId;\n}\nfunction getTargetId(viewport) {\n    const targetId = viewport.getViewReferenceId?.();\n    if (targetId) {\n        return targetId;\n    }\n    if (viewport instanceof BaseVolumeViewport) {\n        return `volumeId:${getTargetVolumeId(viewport)}`;\n    }\n    throw new Error('getTargetId: viewport must have a getTargetId method');\n}\nfunction getTargetVolumeId(viewport) {\n    const actorEntries = viewport.getActors();\n    if (!actorEntries) {\n        return;\n    }\n    return actorEntries.find((actorEntry) => actorEntry.actor.getClassName() === 'vtkVolume')?.uid;\n}\nfunction getClosestImageIdForStackViewport(viewport, worldPos, viewPlaneNormal) {\n    const imageIds = viewport.getImageIds();\n    if (!imageIds || !imageIds.length) {\n        return;\n    }\n    const distanceImagePairs = imageIds.map((imageId) => {\n        const { imagePositionPatient } = metaData.get('imagePlaneModule', imageId);\n        const distance = calculateDistanceToImage(worldPos, imagePositionPatient, viewPlaneNormal);\n        return { imageId, distance };\n    });\n    distanceImagePairs.sort((a, b) => a.distance - b.distance);\n    return distanceImagePairs[0].imageId;\n}\nfunction calculateDistanceToImage(worldPos, ImagePositionPatient, viewPlaneNormal) {\n    const dir = vec3.create();\n    vec3.sub(dir, worldPos, ImagePositionPatient);\n    const dot = vec3.dot(dir, viewPlaneNormal);\n    return Math.abs(dot);\n}\nexport { annotationHydration, getClosestImageIdForStackViewport };\n","function extend2DBoundingBoxInViewAxis(boundsIJK, numSlicesToProject) {\n    const sliceNormalIndex = boundsIJK.findIndex(([min, max]) => min === max);\n    if (sliceNormalIndex === -1) {\n        throw new Error('3D bounding boxes not supported in an oblique plane');\n    }\n    boundsIJK[sliceNormalIndex][0] -= numSlicesToProject;\n    boundsIJK[sliceNormalIndex][1] += numSlicesToProject;\n    return boundsIJK;\n}\nexport default extend2DBoundingBoxInViewAxis;\n","import { CONSTANTS } from '@cornerstonejs/core';\nconst { EPSILON } = CONSTANTS;\nfunction calculateBoundingBox(points, dimensions, isWorld = false) {\n    let xMin = Infinity;\n    let xMax = isWorld ? -Infinity : 0;\n    let yMin = Infinity;\n    let yMax = isWorld ? -Infinity : 0;\n    let zMin = Infinity;\n    let zMax = isWorld ? -Infinity : 0;\n    const is3D = points[0]?.length === 3;\n    for (let i = 0; i < points.length; i++) {\n        const p = points[i];\n        xMin = Math.min(p[0], xMin);\n        xMax = Math.max(p[0], xMax);\n        yMin = Math.min(p[1], yMin);\n        yMax = Math.max(p[1], yMax);\n        if (is3D) {\n            zMin = Math.min(p[2] ?? zMin, zMin);\n            zMax = Math.max(p[2] ?? zMax, zMax);\n        }\n    }\n    if (dimensions) {\n        xMin = Math.max(isWorld ? dimensions[0] + EPSILON : 0, xMin);\n        xMax = Math.min(isWorld ? dimensions[0] - EPSILON : dimensions[0] - 1, xMax);\n        yMin = Math.max(isWorld ? dimensions[1] + EPSILON : 0, yMin);\n        yMax = Math.min(isWorld ? dimensions[1] - EPSILON : dimensions[1] - 1, yMax);\n        if (is3D && dimensions.length === 3) {\n            zMin = Math.max(isWorld ? dimensions[2] + EPSILON : 0, zMin);\n            zMax = Math.min(isWorld ? dimensions[2] - EPSILON : dimensions[2] - 1, zMax);\n        }\n    }\n    else if (!isWorld) {\n        xMin = Math.max(0, xMin);\n        xMax = Math.min(Infinity, xMax);\n        yMin = Math.max(0, yMin);\n        yMax = Math.min(Infinity, yMax);\n        if (is3D) {\n            zMin = Math.max(0, zMin);\n            zMax = Math.min(Infinity, zMax);\n        }\n    }\n    return is3D\n        ? [\n            [xMin, xMax],\n            [yMin, yMax],\n            [zMin, zMax],\n        ]\n        : [[xMin, xMax], [yMin, yMax], null];\n}\nexport function getBoundingBoxAroundShapeIJK(points, dimensions) {\n    return calculateBoundingBox(points, dimensions, false);\n}\nexport function getBoundingBoxAroundShapeWorld(points, clipBounds) {\n    return calculateBoundingBox(points, clipBounds, true);\n}\n","import { utilities, Enums } from '@cornerstonejs/core';\nconst { calibratedPixelSpacingMetadataProvider } = utilities;\nexport default function calibrateImageSpacing(imageId, renderingEngine, calibrationOrScale) {\n    if (typeof calibrationOrScale === 'number') {\n        calibrationOrScale = {\n            type: Enums.CalibrationTypes.USER,\n            scale: calibrationOrScale,\n        };\n    }\n    calibratedPixelSpacingMetadataProvider.add(imageId, calibrationOrScale);\n    const viewports = renderingEngine.getStackViewports();\n    viewports.forEach((viewport) => {\n        const imageIds = viewport.getImageIds();\n        if (imageIds.includes(imageId)) {\n            viewport.calibrateSpacing(imageId);\n        }\n    });\n}\n","var Events;\n(function (Events) {\n    Events[\"CLIP_STOPPED\"] = \"CORNERSTONE_CINE_TOOL_STOPPED\";\n    Events[\"CLIP_STARTED\"] = \"CORNERSTONE_CINE_TOOL_STARTED\";\n})(Events || (Events = {}));\nexport default Events;\n","import { glMatrix, vec3 } from 'gl-matrix';\nimport { utilities as csUtils, getEnabledElement, StackViewport, VideoViewport, VolumeViewport, cache, BaseVolumeViewport, Enums, } from '@cornerstonejs/core';\nimport CINE_EVENTS from './events';\nimport { addToolState, getToolState, getToolStateByViewportId } from './state';\nconst { ViewportStatus } = Enums;\nconst { triggerEvent } = csUtils;\nconst debounced = true;\nconst dynamicVolumesPlayingMap = new Map();\nfunction playClip(element, playClipOptions) {\n    let playClipTimeouts;\n    let playClipIsTimeVarying;\n    if (element === undefined) {\n        throw new Error('playClip: element must not be undefined');\n    }\n    const enabledElement = getEnabledElement(element);\n    if (!enabledElement) {\n        throw new Error('playClip: element must be a valid Cornerstone enabled element');\n    }\n    if (!playClipOptions) {\n        playClipOptions = {};\n    }\n    playClipOptions.dynamicCineEnabled =\n        playClipOptions.dynamicCineEnabled ?? true;\n    const { viewport } = enabledElement;\n    const playClipContext = _createCinePlayContext(viewport, playClipOptions);\n    let playClipData = getToolState(element);\n    const isDynamicCinePlaying = playClipOptions.dynamicCineEnabled;\n    if (isDynamicCinePlaying) {\n        _stopDynamicVolumeCine(element);\n    }\n    if (!playClipData) {\n        playClipData = {\n            intervalId: undefined,\n            framesPerSecond: 30,\n            lastFrameTimeStamp: undefined,\n            ignoreFrameTimeVector: false,\n            usingFrameTimeVector: false,\n            frameTimeVector: playClipOptions.frameTimeVector ?? undefined,\n            speed: playClipOptions.frameTimeVectorSpeedMultiplier ?? 1,\n            reverse: playClipOptions.reverse ?? false,\n            loop: playClipOptions.loop ?? true,\n        };\n        addToolState(element, playClipData);\n    }\n    else {\n        _stopClip(element, {\n            stopDynamicCine: !isDynamicCinePlaying,\n            viewportId: viewport.id,\n        });\n    }\n    playClipData.dynamicCineEnabled = playClipOptions.dynamicCineEnabled;\n    if (playClipOptions.framesPerSecond < 0 ||\n        playClipOptions.framesPerSecond > 0) {\n        playClipData.framesPerSecond = Number(playClipOptions.framesPerSecond);\n        playClipData.reverse = playClipData.framesPerSecond < 0;\n        playClipData.ignoreFrameTimeVector = true;\n    }\n    if (playClipData.ignoreFrameTimeVector !== true &&\n        playClipData.frameTimeVector &&\n        playClipData.frameTimeVector.length === playClipContext.numScrollSteps &&\n        playClipContext.frameTimeVectorEnabled) {\n        const { timeouts, isTimeVarying } = _getPlayClipTimeouts(playClipData.frameTimeVector, playClipData.speed);\n        playClipTimeouts = timeouts;\n        playClipIsTimeVarying = isTimeVarying;\n    }\n    const playClipAction = () => {\n        const { numScrollSteps, currentStepIndex } = playClipContext;\n        let newStepIndex = currentStepIndex + (playClipData.reverse ? -1 : 1);\n        const newStepIndexOutOfRange = newStepIndex < 0 || newStepIndex >= numScrollSteps;\n        if (!playClipData.loop && newStepIndexOutOfRange) {\n            _stopClip(element, {\n                stopDynamicCine: !isDynamicCinePlaying,\n                viewportId: viewport.id,\n            });\n            const eventDetail = { element };\n            triggerEvent(element, CINE_EVENTS.CLIP_STOPPED, eventDetail);\n            return;\n        }\n        if (newStepIndex >= numScrollSteps) {\n            newStepIndex = 0;\n        }\n        else if (newStepIndex < 0) {\n            newStepIndex = numScrollSteps - 1;\n        }\n        const delta = newStepIndex - currentStepIndex;\n        if (delta) {\n            try {\n                playClipContext.scroll(delta);\n            }\n            catch (e) {\n                console.warn('Play clip not scrolling', e);\n                _stopClipWithData(playClipData);\n                triggerEvent(element, CINE_EVENTS.CLIP_STOPPED, eventDetail);\n                return;\n            }\n        }\n    };\n    if (isDynamicCinePlaying) {\n        const volume = _getVolumeFromViewport(viewport);\n        if (volume) {\n            dynamicVolumesPlayingMap.set(volume.volumeId, element);\n        }\n    }\n    if (playClipContext.play) {\n        playClipData.framesPerSecond = playClipContext.play(playClipOptions.framesPerSecond);\n    }\n    else if (playClipTimeouts &&\n        playClipTimeouts.length > 0 &&\n        playClipIsTimeVarying) {\n        playClipData.usingFrameTimeVector = true;\n        playClipData.intervalId = window.setTimeout(function playClipTimeoutHandler() {\n            playClipData.intervalId = window.setTimeout(playClipTimeoutHandler, playClipTimeouts[playClipContext.currentStepIndex]);\n            playClipAction();\n        }, 0);\n    }\n    else {\n        playClipData.usingFrameTimeVector = false;\n        playClipData.intervalId = window.setInterval(playClipAction, 1000 / Math.abs(playClipData.framesPerSecond));\n    }\n    const eventDetail = {\n        element,\n    };\n    triggerEvent(element, CINE_EVENTS.CLIP_STARTED, eventDetail);\n}\nfunction stopClip(element, options = {}) {\n    _stopClip(element, {\n        stopDynamicCine: true,\n        ...options,\n    });\n}\nfunction _stopClip(element, options = { stopDynamicCine: true, viewportId: undefined }) {\n    const { stopDynamicCine, viewportId } = options;\n    const enabledElement = getEnabledElement(element);\n    let toolState;\n    const viewport = enabledElement?.viewport;\n    if (!enabledElement) {\n        if (viewportId) {\n            toolState = getToolStateByViewportId(viewportId);\n        }\n        else {\n            return;\n        }\n    }\n    else {\n        const { viewport } = enabledElement;\n        toolState = getToolState(viewport.element);\n    }\n    if (toolState) {\n        _stopClipWithData(toolState);\n    }\n    if (viewport instanceof VideoViewport) {\n        viewport.pause();\n    }\n    else if (stopDynamicCine && viewport instanceof BaseVolumeViewport) {\n        _stopDynamicVolumeCine(element);\n    }\n}\nfunction _stopDynamicVolumeCine(element) {\n    const { viewport } = getEnabledElement(element);\n    if (viewport instanceof VolumeViewport) {\n        const volume = _getVolumeFromViewport(viewport);\n        if (volume?.isDynamicVolume()) {\n            const dynamicCineElement = dynamicVolumesPlayingMap.get(volume.volumeId);\n            dynamicVolumesPlayingMap.delete(volume.volumeId);\n            if (dynamicCineElement && dynamicCineElement !== element) {\n                stopClip(dynamicCineElement);\n            }\n        }\n    }\n}\nfunction _getPlayClipTimeouts(vector, speed) {\n    let i;\n    let sample;\n    let delay;\n    let sum = 0;\n    const limit = vector.length;\n    const timeouts = [];\n    let isTimeVarying = false;\n    if (typeof speed !== 'number' || speed <= 0) {\n        speed = 1;\n    }\n    for (i = 1; i < limit; i++) {\n        delay = (Number(vector[i]) / speed) | 0;\n        timeouts.push(delay);\n        if (i === 1) {\n            sample = delay;\n        }\n        else if (delay !== sample) {\n            isTimeVarying = true;\n        }\n        sum += delay;\n    }\n    if (timeouts.length > 0) {\n        if (isTimeVarying) {\n            delay = (sum / timeouts.length) | 0;\n        }\n        else {\n            delay = timeouts[0];\n        }\n        timeouts.push(delay);\n    }\n    return { timeouts, isTimeVarying };\n}\nfunction _stopClipWithData(playClipData) {\n    const id = playClipData.intervalId;\n    if (typeof id !== 'undefined') {\n        playClipData.intervalId = undefined;\n        if (playClipData.usingFrameTimeVector) {\n            clearTimeout(id);\n        }\n        else {\n            clearInterval(id);\n        }\n    }\n}\nfunction _getVolumeFromViewport(viewport) {\n    if (!(viewport instanceof VolumeViewport)) {\n        return undefined;\n    }\n    const volumeIds = viewport.getAllVolumeIds();\n    if (!volumeIds?.length) {\n        return undefined;\n    }\n    const dynamicVolumeId = volumeIds.find((volumeId) => cache.getVolume(volumeId)?.isDynamicVolume());\n    const volumeId = dynamicVolumeId ?? volumeIds[0];\n    return cache.getVolume(volumeId);\n}\nfunction _createStackViewportCinePlayContext(viewport, waitForRendered) {\n    const imageIds = viewport.getImageIds();\n    return {\n        get numScrollSteps() {\n            return imageIds.length;\n        },\n        get currentStepIndex() {\n            return viewport.getTargetImageIdIndex();\n        },\n        get frameTimeVectorEnabled() {\n            return true;\n        },\n        waitForRenderedCount: 0,\n        scroll(delta) {\n            if (this.waitForRenderedCount <= waitForRendered &&\n                viewport.viewportStatus !== ViewportStatus.RENDERED) {\n                this.waitForRenderedCount++;\n                return;\n            }\n            this.waitForRenderedCount = 0;\n            csUtils.scroll(viewport, { delta, debounceLoading: debounced });\n        },\n    };\n}\nfunction _createVideoViewportCinePlayContext(viewport, waitForRendered) {\n    return {\n        get numScrollSteps() {\n            return viewport.getNumberOfSlices();\n        },\n        get currentStepIndex() {\n            return viewport.getSliceIndex();\n        },\n        get frameTimeVectorEnabled() {\n            return true;\n        },\n        waitForRenderedCount: 0,\n        scroll(delta) {\n            if (this.waitForRenderedCount <= waitForRendered &&\n                viewport.viewportStatus !== ViewportStatus.RENDERED) {\n                this.waitForRenderedCount++;\n                return;\n            }\n            this.waitForRenderedCount = 0;\n            csUtils.scroll(viewport, { delta, debounceLoading: debounced });\n        },\n        play(fps) {\n            if (fps) {\n                viewport.setPlaybackRate(fps / 24);\n            }\n            viewport.play();\n            return viewport.getFrameRate();\n        },\n    };\n}\nfunction _createVolumeViewportCinePlayContext(viewport, volume) {\n    const { volumeId } = volume;\n    const cachedScrollInfo = {\n        viewPlaneNormal: vec3.create(),\n        scrollInfo: null,\n    };\n    const getScrollInfo = () => {\n        const camera = viewport.getCamera();\n        const updateCache = !cachedScrollInfo.scrollInfo ||\n            !vec3.equals(camera.viewPlaneNormal, cachedScrollInfo.viewPlaneNormal);\n        if (updateCache) {\n            const scrollInfo = csUtils.getVolumeViewportScrollInfo(viewport, volumeId);\n            cachedScrollInfo.viewPlaneNormal = camera.viewPlaneNormal;\n            cachedScrollInfo.scrollInfo = scrollInfo;\n        }\n        return cachedScrollInfo.scrollInfo;\n    };\n    return {\n        get numScrollSteps() {\n            return getScrollInfo().numScrollSteps;\n        },\n        get currentStepIndex() {\n            return getScrollInfo().currentStepIndex;\n        },\n        get frameTimeVectorEnabled() {\n            const camera = viewport.getCamera();\n            const volumeViewPlaneNormal = volume.direction\n                .slice(6, 9)\n                .map((x) => -x);\n            const dot = vec3.dot(volumeViewPlaneNormal, camera.viewPlaneNormal);\n            return glMatrix.equals(dot, 1);\n        },\n        scroll(delta) {\n            getScrollInfo().currentStepIndex += delta;\n            csUtils.scroll(viewport, { delta });\n        },\n    };\n}\nfunction _createDynamicVolumeViewportCinePlayContext(volume) {\n    return {\n        get numScrollSteps() {\n            return volume.numDimensionGroups;\n        },\n        get currentStepIndex() {\n            return volume.dimensionGroupNumber - 1;\n        },\n        get frameTimeVectorEnabled() {\n            return false;\n        },\n        scroll(delta) {\n            volume.scroll(delta);\n        },\n    };\n}\nfunction _createCinePlayContext(viewport, playClipOptions) {\n    if (viewport instanceof StackViewport) {\n        return _createStackViewportCinePlayContext(viewport, playClipOptions.waitForRendered ?? 30);\n    }\n    if (viewport instanceof VolumeViewport) {\n        const volume = _getVolumeFromViewport(viewport);\n        if (playClipOptions.dynamicCineEnabled && volume?.isDynamicVolume()) {\n            return _createDynamicVolumeViewportCinePlayContext(volume);\n        }\n        return _createVolumeViewportCinePlayContext(viewport, volume);\n    }\n    if (viewport instanceof VideoViewport) {\n        return _createVideoViewportCinePlayContext(viewport, playClipOptions.waitForRendered ?? 30);\n    }\n    throw new Error('Unknown viewport type');\n}\nexport { playClip, stopClip };\n","import { getEnabledElement } from '@cornerstonejs/core';\nconst state = {};\nfunction addToolState(element, data) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId } = enabledElement;\n    state[viewportId] = data;\n}\nfunction getToolState(element) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId } = enabledElement;\n    return state[viewportId];\n}\nfunction getToolStateByViewportId(viewportId) {\n    return state[viewportId];\n}\nexport { addToolState, getToolState, getToolStateByViewportId };\n","export default function areSameSegment(firstAnnotation, secondAnnotation) {\n    const { segmentation: firstSegmentation } = firstAnnotation.data;\n    const { segmentation: secondSegmentation } = secondAnnotation.data;\n    return (firstSegmentation.segmentationId === secondSegmentation.segmentationId &&\n        firstSegmentation.segmentIndex === secondSegmentation.segmentIndex);\n}\n","export default function isContourSegmentationAnnotation(annotation) {\n    return !!annotation.data?.segmentation;\n}\n","import { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nexport function removeContourSegmentationAnnotation(annotation) {\n    if (!annotation.data.segmentation) {\n        throw new Error('removeContourSegmentationAnnotation: annotation does not have a segmentation data');\n    }\n    const { segmentationId, segmentIndex } = annotation.data.segmentation;\n    const segmentation = getSegmentation(segmentationId);\n    const { annotationUIDsMap } = segmentation?.representationData.Contour || {};\n    const annotationsUIDsSet = annotationUIDsMap?.get(segmentIndex);\n    if (!annotationsUIDsSet) {\n        return;\n    }\n    annotationsUIDsSet.delete(annotation.annotationUID);\n    if (!annotationsUIDsSet.size) {\n        annotationUIDsMap.delete(segmentIndex);\n    }\n}\n","function calculatePerimeter(polyline, closed) {\n    let perimeter = 0;\n    for (let i = 0; i < polyline.length - 1; i++) {\n        const point1 = polyline[i];\n        const point2 = polyline[i + 1];\n        perimeter += Math.sqrt(Math.pow(point2[0] - point1[0], 2) + Math.pow(point2[1] - point1[1], 2));\n    }\n    if (closed) {\n        const firstPoint = polyline[0];\n        const lastPoint = polyline[polyline.length - 1];\n        perimeter += Math.sqrt(Math.pow(lastPoint[0] - firstPoint[0], 2) +\n            Math.pow(lastPoint[1] - firstPoint[1], 2));\n    }\n    return perimeter;\n}\nexport default calculatePerimeter;\n","function findNextLink(line, lines, contourPoints) {\n    let index = -1;\n    lines.forEach((cell, i) => {\n        if (index >= 0) {\n            return;\n        }\n        if (cell.a == line.b) {\n            index = i;\n        }\n    });\n    if (index >= 0) {\n        const nextLine = lines[index];\n        lines.splice(index, 1);\n        contourPoints.push(nextLine.b);\n        if (contourPoints[0] == nextLine.b) {\n            return {\n                remainingLines: lines,\n                contourPoints,\n                type: 'CLOSED_PLANAR',\n            };\n        }\n        return findNextLink(nextLine, lines, contourPoints);\n    }\n    return {\n        remainingLines: lines,\n        contourPoints,\n        type: 'OPEN_PLANAR',\n    };\n}\nexport function findContours(lines) {\n    if (lines.length == 0) {\n        return [];\n    }\n    const contourPoints = [];\n    const firstCell = lines.shift();\n    contourPoints.push(firstCell.a);\n    contourPoints.push(firstCell.b);\n    const result = findNextLink(firstCell, lines, contourPoints);\n    if (result.remainingLines.length == 0) {\n        return [\n            {\n                type: result.type,\n                contourPoints: result.contourPoints,\n            },\n        ];\n    }\n    else {\n        const extraContours = findContours(result.remainingLines);\n        extraContours.push({\n            type: result.type,\n            contourPoints: result.contourPoints,\n        });\n        return extraContours;\n    }\n}\nexport function findContoursFromReducedSet(lines) {\n    return findContours(lines);\n}\nexport default {\n    findContours,\n    findContoursFromReducedSet,\n};\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nconst { isEqual } = csUtils;\nexport default function findHandlePolylineIndex(annotation, handleIndex) {\n    const { polyline } = annotation.data.contour;\n    const { points } = annotation.data.handles;\n    const { length } = points;\n    if (handleIndex === length) {\n        return polyline.length;\n    }\n    if (handleIndex < 0) {\n        handleIndex = (handleIndex + length) % length;\n    }\n    if (handleIndex === 0) {\n        return 0;\n    }\n    const handle = points[handleIndex];\n    const index = polyline.findIndex((point) => isEqual(handle, point));\n    if (index !== -1) {\n        return index;\n    }\n    let closestDistance = Infinity;\n    return polyline.reduce((closestIndex, point, testIndex) => {\n        const distance = vec3.squaredDistance(point, handle);\n        if (distance < closestDistance) {\n            closestDistance = distance;\n            return testIndex;\n        }\n        return closestIndex;\n    }, -1);\n}\n","import getContourHolesDataWorld from './getContourHolesDataWorld';\nexport default function getContourHolesDataCanvas(annotation, viewport) {\n    const worldHoleContours = getContourHolesDataWorld(annotation);\n    const canvasHoleContours = [];\n    worldHoleContours.forEach((worldHoleContour) => {\n        const numPoints = worldHoleContour.length;\n        const canvasHoleContour = new Array(numPoints);\n        for (let i = 0; i < numPoints; i++) {\n            canvasHoleContour[i] = viewport.worldToCanvas(worldHoleContour[i]);\n        }\n        canvasHoleContours.push(canvasHoleContour);\n    });\n    return canvasHoleContours;\n}\n","import { getAnnotation } from '../../stateManagement/annotation/annotationState';\nexport default function getContourHolesDataWorld(annotation) {\n    const childAnnotationUIDs = annotation.childAnnotationUIDs ?? [];\n    return childAnnotationUIDs.map((uid) => getAnnotation(uid).data.contour.polyline);\n}\n","export function getDeduplicatedVTKPolyDataPoints(polyData, bypass = false) {\n    const points = polyData.getPoints();\n    const lines = polyData.getLines();\n    const pointsArray = new Array(points.getNumberOfPoints())\n        .fill(0)\n        .map((_, i) => points.getPoint(i).slice());\n    const linesArray = new Array(lines.getNumberOfCells()).fill(0).map((_, i) => {\n        const cell = lines.getCell(i * 3).slice();\n        return { a: cell[0], b: cell[1] };\n    });\n    if (bypass) {\n        return { points: pointsArray, lines: linesArray };\n    }\n    const newPoints = [];\n    for (const [i, pt] of pointsArray.entries()) {\n        const index = newPoints.findIndex((point) => point[0] === pt[0] && point[1] === pt[1] && point[2] === pt[2]);\n        if (index >= 0) {\n            linesArray.map((line) => {\n                if (line.a === i) {\n                    line.a = index;\n                }\n                if (line.b === i) {\n                    line.b = index;\n                }\n                return line;\n            });\n        }\n        else {\n            const newIndex = newPoints.length;\n            newPoints.push(pt);\n            linesArray.map((line) => {\n                if (line.a === i) {\n                    line.a = newIndex;\n                }\n                if (line.b === i) {\n                    line.b = newIndex;\n                }\n                return line;\n            });\n        }\n    }\n    const newLines = linesArray.filter((line) => line.a !== line.b);\n    return { points: newPoints, lines: newLines };\n}\nexport default { getDeduplicatedVTKPolyDataPoints };\n","import { glMatrix, vec3 } from 'gl-matrix';\nexport default function areCoplanarContours(firstAnnotation, secondAnnotation) {\n    const { viewPlaneNormal: firstViewPlaneNormal } = firstAnnotation.metadata;\n    const { viewPlaneNormal: secondViewPlaneNormal } = secondAnnotation.metadata;\n    const dot = vec3.dot(firstViewPlaneNormal, secondViewPlaneNormal);\n    const parallelPlanes = glMatrix.equals(1, Math.abs(dot));\n    if (!parallelPlanes) {\n        return false;\n    }\n    const { polyline: firstPolyline } = firstAnnotation.data.contour;\n    const { polyline: secondPolyline } = secondAnnotation.data.contour;\n    const firstDistance = vec3.dot(firstViewPlaneNormal, firstPolyline[0]);\n    const secondDistance = vec3.dot(firstViewPlaneNormal, secondPolyline[0]);\n    return glMatrix.equals(firstDistance, secondDistance);\n}\n","const getIsPointInsidePolygon = (point, vertices) => {\n    const x = point[0];\n    const y = point[1];\n    let inside = false;\n    for (let i = 0, j = vertices.length - 1; i < vertices.length; j = i++) {\n        const xi = vertices[i][0], yi = vertices[i][1];\n        const xj = vertices[j][0], yj = vertices[j][1];\n        const intersect = yi > y != yj > y && x < ((xj - xi) * (y - yi)) / (yj - yi) + xi;\n        if (intersect) {\n            inside = !inside;\n        }\n    }\n    return inside;\n};\nfunction checkEnclosed(outerContour, innerContour, points) {\n    const vertices = [];\n    outerContour.contourPoints.forEach((point) => {\n        vertices.push([points[point][0], points[point][1]]);\n    });\n    let pointsNotEnclosed = 0;\n    innerContour.contourPoints.forEach((point) => {\n        const result = getIsPointInsidePolygon([points[point][0], points[point][1]], vertices);\n        if (!result) {\n            pointsNotEnclosed++;\n        }\n    });\n    return pointsNotEnclosed === 0;\n}\nexport function processContourHoles(contours, points, useXOR = true) {\n    const retContours = contours.filter((contour) => contour.type !== 'CLOSED_PLANAR');\n    const closedContours = contours.filter((contour) => contour.type === 'CLOSED_PLANAR');\n    const contourWithHoles = [];\n    let contourWithoutHoles = [];\n    closedContours.forEach((contour, index) => {\n        const holes = [];\n        closedContours.forEach((hContour, hIndex) => {\n            if (index != hIndex) {\n                if (checkEnclosed(contour, hContour, points)) {\n                    holes.push(hIndex);\n                }\n            }\n        });\n        if (holes.length > 0) {\n            contourWithHoles.push({\n                contour,\n                holes,\n            });\n        }\n        else {\n            contourWithoutHoles.push(index);\n        }\n    });\n    if (useXOR) {\n        contourWithHoles.forEach((contourHoleSet) => {\n            contourHoleSet.contour.type = 'CLOSEDPLANAR_XOR';\n            retContours.push(contourHoleSet.contour);\n            contourHoleSet.holes.forEach((holeIndex) => {\n                closedContours[holeIndex].type = 'CLOSEDPLANAR_XOR';\n                retContours.push(closedContours[holeIndex]);\n                contourWithoutHoles = contourWithoutHoles.filter((contourIndex) => {\n                    return contourIndex !== holeIndex;\n                });\n            });\n        });\n        contourWithoutHoles.forEach((contourIndex) => {\n            retContours.push(closedContours[contourIndex]);\n        });\n    }\n    else {\n    }\n    return retContours;\n}\nexport default { processContourHoles };\n","import { cache as cornerstoneCache } from '@cornerstonejs/core';\nimport vtkImageMarchingSquares from '@kitware/vtk.js/Filters/General/ImageMarchingSquares';\nimport vtkDataArray from '@kitware/vtk.js/Common/Core/DataArray';\nimport vtkImageData from '@kitware/vtk.js/Common/DataModel/ImageData';\nimport { getDeduplicatedVTKPolyDataPoints } from './getDeduplicatedVTKPolyDataPoints';\nimport { findContoursFromReducedSet } from './contourFinder';\nimport SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nconst { Labelmap } = SegmentationRepresentations;\nfunction generateContourSetsFromLabelmap({ segmentations }) {\n    console.warn('Deprecation Alert: This function will be removed in a future version of Cornerstone Tools. Please use the worker version of this function in computeWorker.');\n    const { representationData, segments = [0, 1] } = segmentations;\n    const { volumeId: segVolumeId } = representationData[Labelmap];\n    const vol = cornerstoneCache.getVolume(segVolumeId);\n    if (!vol) {\n        console.warn(`No volume found for ${segVolumeId}`);\n        return;\n    }\n    const voxelManager = vol.voxelManager;\n    const segData = voxelManager.getCompleteScalarDataArray();\n    const numSlices = vol.dimensions[2];\n    const pixelsPerSlice = vol.dimensions[0] * vol.dimensions[1];\n    for (let z = 0; z < numSlices; z++) {\n        for (let y = 0; y < vol.dimensions[1]; y++) {\n            const index = y * vol.dimensions[0] + z * pixelsPerSlice;\n            segData[index] = 0;\n            segData[index + vol.dimensions[0] - 1] = 0;\n        }\n    }\n    const ContourSets = [];\n    const { FrameOfReferenceUID } = vol.metadata;\n    const numSegments = segments.length;\n    for (let segIndex = 0; segIndex < numSegments; segIndex++) {\n        const segment = segments[segIndex];\n        if (!segment) {\n            continue;\n        }\n        const sliceContours = [];\n        const scalars = vtkDataArray.newInstance({\n            name: 'Scalars',\n            numberOfComponents: 1,\n            size: pixelsPerSlice * numSlices,\n            dataType: 'Uint8Array',\n        });\n        const { containedSegmentIndices } = segment;\n        for (let sliceIndex = 0; sliceIndex < numSlices; sliceIndex++) {\n            if (isSliceEmptyForSegment(sliceIndex, segData, pixelsPerSlice, segIndex)) {\n                continue;\n            }\n            const frameStart = sliceIndex * pixelsPerSlice;\n            try {\n                for (let i = 0; i < pixelsPerSlice; i++) {\n                    const value = segData[i + frameStart];\n                    if (value === segIndex || containedSegmentIndices?.has(value)) {\n                        scalars.setValue(i + frameStart, 1);\n                    }\n                    else {\n                        scalars.setValue(i, 0);\n                    }\n                }\n                const mSquares = vtkImageMarchingSquares.newInstance({\n                    slice: sliceIndex,\n                });\n                const imageDataCopy = vtkImageData.newInstance();\n                imageDataCopy.shallowCopy(vol.imageData);\n                imageDataCopy.getPointData().setScalars(scalars);\n                mSquares.setInputData(imageDataCopy);\n                const cValues = [1];\n                mSquares.setContourValues(cValues);\n                mSquares.setMergePoints(false);\n                const msOutput = mSquares.getOutputData();\n                const reducedSet = getDeduplicatedVTKPolyDataPoints(msOutput);\n                if (reducedSet.points?.length) {\n                    const contours = findContoursFromReducedSet(reducedSet.lines);\n                    sliceContours.push({\n                        contours,\n                        polyData: reducedSet,\n                        FrameNumber: sliceIndex + 1,\n                        sliceIndex,\n                        FrameOfReferenceUID,\n                    });\n                }\n            }\n            catch (e) {\n                console.warn(sliceIndex);\n                console.warn(e);\n            }\n        }\n        const metadata = {\n            FrameOfReferenceUID,\n        };\n        const ContourSet = {\n            label: segment.label,\n            color: segment.color,\n            metadata,\n            sliceContours,\n        };\n        ContourSets.push(ContourSet);\n    }\n    return ContourSets;\n}\nfunction isSliceEmptyForSegment(sliceIndex, segData, pixelsPerSlice, segIndex) {\n    const startIdx = sliceIndex * pixelsPerSlice;\n    const endIdx = startIdx + pixelsPerSlice;\n    for (let i = startIdx; i < endIdx; i++) {\n        if (segData[i] === segIndex) {\n            return false;\n        }\n    }\n    return true;\n}\nexport { generateContourSetsFromLabelmap };\n","import RectangleROIStartEndThreshold from './RectangleROIStartEndThreshold';\nfunction validateAnnotation(annotation) {\n    if (!annotation?.data) {\n        throw new Error('Tool data is empty');\n    }\n    if (!annotation.metadata || annotation.metadata.referencedImageId) {\n        throw new Error('Tool data is not associated with any imageId');\n    }\n}\nclass AnnotationToPointData {\n    static { this.TOOL_NAMES = {}; }\n    constructor() {\n    }\n    static convert(annotation, index, metadataProvider) {\n        validateAnnotation(annotation);\n        const { toolName } = annotation.metadata;\n        const toolClass = AnnotationToPointData.TOOL_NAMES[toolName];\n        if (!toolClass) {\n            throw new Error(`Unknown tool type: ${toolName}, cannot convert to RTSSReport`);\n        }\n        const ContourSequence = toolClass.getContourSequence(annotation, metadataProvider);\n        const color = [\n            Math.floor(Math.random() * 255),\n            Math.floor(Math.random() * 255),\n            Math.floor(Math.random() * 255),\n        ];\n        return {\n            ReferencedROINumber: index + 1,\n            ROIDisplayColor: color,\n            ContourSequence,\n        };\n    }\n    static register(toolClass) {\n        AnnotationToPointData.TOOL_NAMES[toolClass.toolName] = toolClass;\n    }\n}\nAnnotationToPointData.register(RectangleROIStartEndThreshold);\nexport default AnnotationToPointData;\n","import InterpolationManager from '../../segmentation/InterpolationManager/InterpolationManager';\nexport default function acceptAutogeneratedInterpolations(annotationGroupSelector, selector) {\n    InterpolationManager.acceptAutoGenerated(annotationGroupSelector, selector);\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport * as math from '../math';\nimport { getParentAnnotation, invalidateAnnotation, } from '../../stateManagement/annotation/annotationState';\nexport default function updateContourPolyline(annotation, polylineData, transforms, options) {\n    const { canvasToWorld, worldToCanvas } = transforms;\n    const { data } = annotation;\n    const { targetWindingDirection } = polylineData;\n    let { points: polyline } = polylineData;\n    let windingDirection = math.polyline.getWindingDirection(polyline);\n    if (options?.decimate?.enabled) {\n        polyline = math.polyline.decimate(polylineData.points, options?.decimate?.epsilon);\n    }\n    let { closed } = polylineData;\n    const numPoints = polyline.length;\n    const polylineWorldPoints = new Array(numPoints);\n    const currentPolylineWindingDirection = math.polyline.getWindingDirection(polyline);\n    const parentAnnotation = getParentAnnotation(annotation);\n    if (closed === undefined) {\n        let currentClosedState = false;\n        if (polyline.length > 3) {\n            const lastToFirstDist = math.point.distanceToPointSquared(polyline[0], polyline[numPoints - 1]);\n            currentClosedState = csUtils.isEqual(0, lastToFirstDist);\n        }\n        closed = currentClosedState;\n    }\n    if (options?.updateWindingDirection !== false) {\n        let updatedWindingDirection = parentAnnotation\n            ? parentAnnotation.data.contour.windingDirection * -1\n            : targetWindingDirection;\n        if (updatedWindingDirection === undefined) {\n            updatedWindingDirection = windingDirection;\n        }\n        if (updatedWindingDirection !== windingDirection) {\n            polyline.reverse();\n        }\n        const handlePoints = (data.handles?.points ?? []).map(worldToCanvas);\n        if (handlePoints.length > 2) {\n            const currentHandlesWindingDirection = math.polyline.getWindingDirection(handlePoints);\n            if (currentHandlesWindingDirection !== updatedWindingDirection) {\n                data.handles.points.reverse();\n            }\n        }\n        windingDirection = updatedWindingDirection;\n    }\n    for (let i = 0; i < numPoints; i++) {\n        polylineWorldPoints[i] = canvasToWorld(polyline[i]);\n    }\n    data.contour.polyline = polylineWorldPoints;\n    data.contour.closed = closed;\n    data.contour.windingDirection = windingDirection;\n    invalidateAnnotation(annotation);\n}\n","import { Enums } from '@cornerstonejs/core';\nfunction sumOverDimensionGroups(voxelManager, dimensionGroups) {\n    const arrayLength = voxelManager.getScalarDataLength();\n    const resultArray = new Float32Array(arrayLength);\n    for (const dimensionGroupNumber of dimensionGroups) {\n        const scalarData = voxelManager.getDimensionGroupScalarData(dimensionGroupNumber);\n        for (let i = 0; i < arrayLength; i++) {\n            resultArray[i] += scalarData[i];\n        }\n    }\n    return resultArray;\n}\nfunction averageOverDimensionGroups(voxelManager, dimensionGroups) {\n    const sumArray = sumOverDimensionGroups(voxelManager, dimensionGroups);\n    const numDimensionGroups = dimensionGroups.length;\n    for (let i = 0; i < sumArray.length; i++) {\n        sumArray[i] /= numDimensionGroups;\n    }\n    return sumArray;\n}\nconst operationFunctions = {\n    [Enums.GenerateImageType.SUM]: (voxelManager, dimensionGroups, callback) => {\n        const resultArray = sumOverDimensionGroups(voxelManager, dimensionGroups);\n        for (let i = 0; i < resultArray.length; i++) {\n            callback(i, resultArray[i]);\n        }\n    },\n    [Enums.GenerateImageType.AVERAGE]: (voxelManager, dimensionGroups, callback) => {\n        const resultArray = averageOverDimensionGroups(voxelManager, dimensionGroups);\n        for (let i = 0; i < resultArray.length; i++) {\n            callback(i, resultArray[i]);\n        }\n    },\n    [Enums.GenerateImageType.SUBTRACT]: (voxelManager, dimensionGroups, callback) => {\n        if (dimensionGroups.length !== 2) {\n            throw new Error('Please provide only 2 dimension groups for subtraction.');\n        }\n        const arrayLength = voxelManager.getScalarDataLength();\n        const scalarData1 = voxelManager.getDimensionGroupScalarData(dimensionGroups[0]);\n        const scalarData2 = voxelManager.getDimensionGroupScalarData(dimensionGroups[1]);\n        for (let i = 0; i < arrayLength; i++) {\n            const difference = scalarData1[i] - scalarData2[i];\n            callback(i, difference);\n        }\n    },\n};\nfunction generateImageFromTimeData(dynamicVolume, operation, options) {\n    const { dimensionGroupNumbers, frameNumbers } = options;\n    if (frameNumbers) {\n        console.warn('Warning: frameNumbers parameter is deprecated. Please use dimensionGroupNumbers instead.');\n    }\n    const dimensionGroups = dimensionGroupNumbers ||\n        frameNumbers ||\n        Array.from({ length: dynamicVolume.numDimensionGroups }, (_, i) => i + 1);\n    if (dimensionGroups.length <= 1) {\n        throw new Error('Please provide two or more dimension groups');\n    }\n    const voxelManager = dynamicVolume.voxelManager;\n    const arrayLength = voxelManager.getScalarDataLength();\n    const operationFunction = operationFunctions[operation];\n    if (!operationFunction) {\n        throw new Error(`Unsupported operation: ${operation}`);\n    }\n    const resultArray = new Float32Array(arrayLength);\n    operationFunction(voxelManager, dimensionGroups, (index, value) => {\n        resultArray[index] = value;\n    });\n    return resultArray;\n}\nfunction updateVolumeFromTimeData(dynamicVolume, operation, options) {\n    const { dimensionGroupNumbers, frameNumbers, targetVolume } = options;\n    if (!targetVolume) {\n        throw new Error('A target volume must be provided');\n    }\n    if (frameNumbers) {\n        console.warn('Warning: frameNumbers parameter is deprecated. Please use dimensionGroupNumbers instead.');\n    }\n    const dimensionGroups = dimensionGroupNumbers ||\n        frameNumbers ||\n        Array.from({ length: dynamicVolume.numDimensionGroups }, (_, i) => i + 1);\n    if (dimensionGroups.length <= 1) {\n        throw new Error('Please provide two or more dimension groups');\n    }\n    const voxelManager = dynamicVolume.voxelManager;\n    const targetVoxelManager = targetVolume.voxelManager;\n    const operationFunction = operationFunctions[operation];\n    if (!operationFunction) {\n        throw new Error(`Unsupported operation: ${operation}`);\n    }\n    operationFunction(voxelManager, dimensionGroups, (index, value) => {\n        targetVoxelManager.setAtIndex(index, value);\n    });\n    targetVoxelManager.resetModifiedSlices();\n    for (let k = 0; k < targetVolume.dimensions[2]; k++) {\n        targetVoxelManager.modifiedSlices.add(k);\n    }\n}\nexport { generateImageFromTimeData, updateVolumeFromTimeData };\n","import { utilities, cache } from '@cornerstonejs/core';\nimport { getVoxelOverlap } from '../segmentation/utilities';\nfunction getDataInTime(dynamicVolume, options) {\n    let dataInTime;\n    const dimensionGroups = options.dimensionGroupNumbers ||\n        options.frameNumbers ||\n        Array.from({ length: dynamicVolume.numDimensionGroups }, (_, i) => i + 1);\n    if (options.frameNumbers) {\n        console.warn('Warning: frameNumbers parameter is deprecated. Please use dimensionGroupNumbers instead.');\n    }\n    if (!options.maskVolumeId && !options.worldCoordinate) {\n        throw new Error('You should provide either maskVolumeId or imageCoordinate');\n    }\n    if (options.maskVolumeId && options.worldCoordinate) {\n        throw new Error('You can only use one of maskVolumeId or imageCoordinate');\n    }\n    if (options.maskVolumeId) {\n        const segmentationVolume = cache.getVolume(options.maskVolumeId);\n        if (!segmentationVolume) {\n            throw new Error('Segmentation volume not found');\n        }\n        const [dataInTime, ijkCoords] = _getDimensionGroupDataMask(dimensionGroups, dynamicVolume, segmentationVolume);\n        return [dataInTime, ijkCoords];\n    }\n    if (options.worldCoordinate) {\n        const dataInTime = _getDimensionGroupDataCoordinate(dimensionGroups, options.worldCoordinate, dynamicVolume);\n        return dataInTime;\n    }\n    return dataInTime;\n}\nfunction _getDimensionGroupDataCoordinate(dimensionGroups, coordinate, volume) {\n    const { dimensions, imageData } = volume;\n    const index = imageData.worldToIndex(coordinate);\n    index[0] = Math.floor(index[0]);\n    index[1] = Math.floor(index[1]);\n    index[2] = Math.floor(index[2]);\n    if (!utilities.indexWithinDimensions(index, dimensions)) {\n        throw new Error('outside bounds');\n    }\n    const yMultiple = dimensions[0];\n    const zMultiple = dimensions[0] * dimensions[1];\n    const value = [];\n    dimensionGroups.forEach((dimensionGroupNumber) => {\n        const scalarIndex = index[2] * zMultiple + index[1] * yMultiple + index[0];\n        value.push(volume.voxelManager.getAtIndexAndDimensionGroup(scalarIndex, dimensionGroupNumber));\n    });\n    return value;\n}\nfunction _getDimensionGroupDataMask(dimensionGroups, dynamicVolume, segmentationVolume) {\n    const { imageData: maskImageData } = segmentationVolume;\n    const segVoxelManager = segmentationVolume.voxelManager;\n    const scalarDataLength = segVoxelManager.getScalarDataLength();\n    const nonZeroVoxelIndices = [];\n    nonZeroVoxelIndices.length = scalarDataLength;\n    let actualLen = 0;\n    for (let i = 0, len = scalarDataLength; i < len; i++) {\n        if (segVoxelManager.getAtIndex(i) !== 0) {\n            nonZeroVoxelIndices[actualLen++] = i;\n        }\n    }\n    nonZeroVoxelIndices.length = actualLen;\n    const nonZeroVoxelValuesInTime = [];\n    const isSameVolume = dynamicVolume.voxelManager.getScalarDataLength() === scalarDataLength &&\n        JSON.stringify(dynamicVolume.spacing) ===\n            JSON.stringify(segmentationVolume.spacing);\n    const ijkCoords = [];\n    if (isSameVolume) {\n        for (let i = 0; i < nonZeroVoxelIndices.length; i++) {\n            const valuesInTime = [];\n            const index = nonZeroVoxelIndices[i];\n            for (let j = 0; j < dimensionGroups.length; j++) {\n                valuesInTime.push(dynamicVolume.voxelManager.getAtIndexAndDimensionGroup(index, dimensionGroups[j]));\n            }\n            nonZeroVoxelValuesInTime.push(valuesInTime);\n            ijkCoords.push(segVoxelManager.toIJK(index));\n        }\n        return [nonZeroVoxelValuesInTime, ijkCoords];\n    }\n    const callback = ({ pointLPS: segPointLPS, value: segValue, pointIJK: segPointIJK, }) => {\n        if (segValue === 0) {\n            return;\n        }\n        const overlapIJKMinMax = getVoxelOverlap(dynamicVolume.imageData, dynamicVolume.dimensions, dynamicVolume.spacing, segPointLPS);\n        let count = 0;\n        const perDimensionGroupSum = new Map();\n        dimensionGroups.forEach((dimensionGroupNumber) => perDimensionGroupSum.set(dimensionGroupNumber, 0));\n        const averageCallback = ({ index }) => {\n            for (let i = 0; i < dimensionGroups.length; i++) {\n                const value = dynamicVolume.voxelManager.getAtIndexAndDimensionGroup(index, dimensionGroups[i]);\n                const dimensionGroupNumber = dimensionGroups[i];\n                perDimensionGroupSum.set(dimensionGroupNumber, perDimensionGroupSum.get(dimensionGroupNumber) + value);\n            }\n            count++;\n        };\n        dynamicVolume.voxelManager.forEach(averageCallback, {\n            imageData: dynamicVolume.imageData,\n            boundsIJK: overlapIJKMinMax,\n        });\n        const averageValues = [];\n        perDimensionGroupSum.forEach((sum) => {\n            averageValues.push(sum / count);\n        });\n        ijkCoords.push(segPointIJK);\n        nonZeroVoxelValuesInTime.push(averageValues);\n    };\n    segmentationVolume.voxelManager.forEach(callback, {\n        imageData: maskImageData,\n    });\n    return [nonZeroVoxelValuesInTime, ijkCoords];\n}\nexport default getDataInTime;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { getAnnotations } from '../stateManagement/annotation/annotationState';\nimport * as ToolGroupManager from '../store/ToolGroupManager';\nfunction getAnnotationNearPoint(element, canvasPoint, proximity = 5) {\n    const enabledElement = getEnabledElement(element);\n    if (!enabledElement) {\n        throw new Error('getAnnotationNearPoint: enabledElement not found');\n    }\n    return getAnnotationNearPointOnEnabledElement(enabledElement, canvasPoint, proximity);\n}\nfunction getAnnotationNearPointOnEnabledElement(enabledElement, point, proximity) {\n    const { renderingEngineId, viewportId } = enabledElement;\n    const toolGroup = ToolGroupManager.getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return null;\n    }\n    const { _toolInstances: tools } = toolGroup;\n    for (const name in tools) {\n        const found = findAnnotationNearPointByTool(tools[name], enabledElement, point, proximity);\n        if (found) {\n            return found;\n        }\n    }\n    return null;\n}\nfunction findAnnotationNearPointByTool(tool, enabledElement, point, proximity) {\n    const { viewport } = enabledElement;\n    const annotations = getAnnotations(tool.constructor.toolName, viewport?.element);\n    const currentId = viewport?.getCurrentImageId?.();\n    if (annotations?.length) {\n        const { element } = enabledElement.viewport;\n        for (const annotation of annotations) {\n            const referencedImageId = annotation.metadata?.referencedImageId;\n            if ((currentId && referencedImageId && currentId !== referencedImageId) ||\n                !tool.isPointNearTool) {\n                continue;\n            }\n            if (tool.isPointNearTool(element, annotation, point, proximity, '') ||\n                tool.getHandleNearImagePoint(element, annotation, point, proximity)) {\n                return annotation;\n            }\n        }\n    }\n    return null;\n}\nexport { getAnnotationNearPoint, getAnnotationNearPointOnEnabledElement };\n","import { Enums, utilities } from '@cornerstonejs/core';\nconst { CalibrationTypes } = Enums;\nconst PIXEL_UNITS = 'px';\nconst VOXEL_UNITS = 'voxels';\nconst SUPPORTED_REGION_DATA_TYPES = [\n    1,\n    2,\n    3,\n    4,\n];\nconst SUPPORTED_LENGTH_VARIANT = [\n    '3,3',\n    '4,7',\n];\nconst SUPPORTED_PROBE_VARIANT = [\n    '4,3',\n    '4,7',\n];\nconst UNIT_MAPPING = {\n    0: 'px',\n    1: 'percent',\n    2: 'dB',\n    3: 'cm',\n    4: 'seconds',\n    5: 'hertz',\n    6: 'dB/seconds',\n    7: 'cm/sec',\n    8: 'cm\\xb2',\n    9: 'cm\\xb2/s',\n    0xc: 'degrees',\n};\nconst EPS = 1e-3;\nconst SQUARE = '\\xb2';\nconst getCalibratedLengthUnitsAndScale = (image, handles) => {\n    const { calibration, hasPixelSpacing } = image;\n    let unit = hasPixelSpacing ? 'mm' : PIXEL_UNITS;\n    const volumeUnit = hasPixelSpacing ? 'mm\\xb3' : VOXEL_UNITS;\n    let areaUnit = unit + SQUARE;\n    let scale = 1;\n    let calibrationType = '';\n    if (!calibration ||\n        (!calibration.type && !calibration.sequenceOfUltrasoundRegions)) {\n        return { unit, areaUnit, scale, volumeUnit };\n    }\n    if (calibration.type === CalibrationTypes.UNCALIBRATED) {\n        return {\n            unit: PIXEL_UNITS,\n            areaUnit: PIXEL_UNITS + SQUARE,\n            scale,\n            volumeUnit: VOXEL_UNITS,\n        };\n    }\n    if (calibration.sequenceOfUltrasoundRegions) {\n        let imageIndex1, imageIndex2;\n        if (Array.isArray(handles) && handles.length === 2) {\n            [imageIndex1, imageIndex2] = handles;\n        }\n        else if (typeof handles === 'function') {\n            const points = handles();\n            imageIndex1 = points[0];\n            imageIndex2 = points[1];\n        }\n        let regions = calibration.sequenceOfUltrasoundRegions.filter((region) => imageIndex1[0] >= region.regionLocationMinX0 &&\n            imageIndex1[0] <= region.regionLocationMaxX1 &&\n            imageIndex1[1] >= region.regionLocationMinY0 &&\n            imageIndex1[1] <= region.regionLocationMaxY1 &&\n            imageIndex2[0] >= region.regionLocationMinX0 &&\n            imageIndex2[0] <= region.regionLocationMaxX1 &&\n            imageIndex2[1] >= region.regionLocationMinY0 &&\n            imageIndex2[1] <= region.regionLocationMaxY1);\n        if (!regions?.length) {\n            return { unit, areaUnit, scale, volumeUnit };\n        }\n        regions = regions.filter((region) => SUPPORTED_REGION_DATA_TYPES.includes(region.regionDataType) &&\n            SUPPORTED_LENGTH_VARIANT.includes(`${region.physicalUnitsXDirection},${region.physicalUnitsYDirection}`));\n        if (!regions.length) {\n            return {\n                unit: PIXEL_UNITS,\n                areaUnit: PIXEL_UNITS + SQUARE,\n                scale,\n                volumeUnit: VOXEL_UNITS,\n            };\n        }\n        const region = regions[0];\n        const physicalDeltaX = Math.abs(region.physicalDeltaX);\n        const physicalDeltaY = Math.abs(region.physicalDeltaY);\n        const isSamePhysicalDelta = utilities.isEqual(physicalDeltaX, physicalDeltaY, EPS);\n        if (isSamePhysicalDelta) {\n            scale = 1 / physicalDeltaX;\n            calibrationType = 'US Region';\n            unit = UNIT_MAPPING[region.physicalUnitsXDirection] || 'unknown';\n            areaUnit = unit + SQUARE;\n        }\n        else {\n            return {\n                unit: PIXEL_UNITS,\n                areaUnit: PIXEL_UNITS + SQUARE,\n                scale,\n                volumeUnit: VOXEL_UNITS,\n            };\n        }\n    }\n    else if (calibration.scale) {\n        scale = calibration.scale;\n    }\n    const types = [\n        CalibrationTypes.ERMF,\n        CalibrationTypes.USER,\n        CalibrationTypes.ERROR,\n        CalibrationTypes.PROJECTION,\n    ];\n    if (types.includes(calibration?.type)) {\n        calibrationType = calibration.type;\n    }\n    return {\n        unit: unit + (calibrationType ? ` ${calibrationType}` : ''),\n        areaUnit: areaUnit + (calibrationType ? ` ${calibrationType}` : ''),\n        scale,\n        volumeUnit: volumeUnit + (calibrationType ? ` ${calibrationType}` : ''),\n    };\n};\nconst getCalibratedProbeUnitsAndValue = (image, handles) => {\n    const [imageIndex] = handles;\n    const { calibration } = image;\n    let units = ['raw'];\n    let values = [null];\n    let calibrationType = '';\n    if (!calibration ||\n        (!calibration.type && !calibration.sequenceOfUltrasoundRegions)) {\n        return { units, values };\n    }\n    if (calibration.sequenceOfUltrasoundRegions) {\n        const supportedRegionsMetadata = calibration.sequenceOfUltrasoundRegions.filter((region) => SUPPORTED_REGION_DATA_TYPES.includes(region.regionDataType) &&\n            SUPPORTED_PROBE_VARIANT.includes(`${region.physicalUnitsXDirection},${region.physicalUnitsYDirection}`));\n        if (!supportedRegionsMetadata?.length) {\n            return { units, values };\n        }\n        const region = supportedRegionsMetadata.find((region) => imageIndex[0] >= region.regionLocationMinX0 &&\n            imageIndex[0] <= region.regionLocationMaxX1 &&\n            imageIndex[1] >= region.regionLocationMinY0 &&\n            imageIndex[1] <= region.regionLocationMaxY1);\n        if (!region) {\n            return { units, values };\n        }\n        const { referencePixelX0 = 0, referencePixelY0 = 0 } = region;\n        const { physicalDeltaX, physicalDeltaY } = region;\n        const yValue = (imageIndex[1] - region.regionLocationMinY0 - referencePixelY0) *\n            physicalDeltaY;\n        const xValue = (imageIndex[0] - region.regionLocationMinX0 - referencePixelX0) *\n            physicalDeltaX;\n        calibrationType = 'US Region';\n        values = [xValue, yValue];\n        units = [\n            UNIT_MAPPING[region.physicalUnitsXDirection],\n            UNIT_MAPPING[region.physicalUnitsYDirection],\n        ];\n    }\n    return {\n        units,\n        values,\n        calibrationType,\n    };\n};\nconst getCalibratedAspect = (image) => image.calibration?.aspect || 1;\nexport { getCalibratedLengthUnitsAndScale, getCalibratedAspect, getCalibratedProbeUnitsAndValue, };\n","import { metaData } from '@cornerstonejs/core';\nfunction getPixelValueUnitsImageId(imageId, options) {\n    const generalSeriesModule = metaData.get('generalSeriesModule', imageId);\n    return getPixelValueUnits(generalSeriesModule.modality, imageId, options);\n}\nfunction getPixelValueUnits(modality, imageId, options) {\n    if (modality === 'CT') {\n        return 'HU';\n    }\n    else if (modality === 'PT') {\n        return _handlePTModality(imageId, options);\n    }\n    else {\n        return '';\n    }\n}\nfunction _handlePTModality(imageId, options) {\n    if (!options.isPreScaled) {\n        return 'raw';\n    }\n    if (options.isSuvScaled) {\n        return 'SUV';\n    }\n    const generalSeriesModule = metaData.get('generalSeriesModule', imageId);\n    if (generalSeriesModule?.modality === 'PT') {\n        const petSeriesModule = metaData.get('petSeriesModule', imageId);\n        return petSeriesModule?.units || 'unitless';\n    }\n    return 'unknown';\n}\nexport { getPixelValueUnits, getPixelValueUnitsImageId };\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { getBoundingBoxAroundShapeIJK } from './boundingBox';\nconst { transformWorldToIndex } = csUtils;\nfunction _getSphereBoundsInfo(circlePoints, imageData, directionVectors) {\n    const [bottom, top] = circlePoints;\n    const centerWorld = vec3.fromValues((bottom[0] + top[0]) / 2, (bottom[1] + top[1]) / 2, (bottom[2] + top[2]) / 2);\n    const radiusWorld = vec3.distance(bottom, top) / 2;\n    const { boundsIJK, topLeftWorld, bottomRightWorld } = _computeBoundsIJK(imageData, directionVectors, circlePoints, centerWorld, radiusWorld);\n    return {\n        boundsIJK,\n        centerWorld: centerWorld,\n        radiusWorld,\n        topLeftWorld: topLeftWorld,\n        bottomRightWorld: bottomRightWorld,\n    };\n}\nfunction getSphereBoundsInfo(circlePoints, imageData) {\n    const direction = imageData.getDirection();\n    const rowCosine = vec3.fromValues(direction[0], direction[1], direction[2]);\n    const columnCosine = vec3.fromValues(direction[3], direction[4], direction[5]);\n    const scanAxis = vec3.fromValues(direction[6], direction[7], direction[8]);\n    const viewPlaneNormal = vec3.negate(vec3.create(), scanAxis);\n    const directionVectors = {\n        row: rowCosine,\n        column: columnCosine,\n        normal: viewPlaneNormal,\n    };\n    return _getSphereBoundsInfo(circlePoints, imageData, directionVectors);\n}\nfunction getSphereBoundsInfoFromViewport(circlePoints, imageData, viewport) {\n    if (!viewport) {\n        throw new Error('viewport is required in order to calculate the sphere bounds');\n    }\n    const camera = viewport.getCamera();\n    const viewUp = vec3.fromValues(camera.viewUp[0], camera.viewUp[1], camera.viewUp[2]);\n    const viewPlaneNormal = vec3.fromValues(camera.viewPlaneNormal[0], camera.viewPlaneNormal[1], camera.viewPlaneNormal[2]);\n    const viewRight = vec3.create();\n    vec3.cross(viewRight, viewUp, viewPlaneNormal);\n    const directionVectors = {\n        row: viewRight,\n        normal: viewPlaneNormal,\n        column: vec3.negate(vec3.create(), viewUp),\n    };\n    return _getSphereBoundsInfo(circlePoints, imageData, directionVectors);\n}\nfunction _computeBoundsIJK(imageData, directionVectors, circlePoints, centerWorld, radiusWorld) {\n    const dimensions = imageData.getDimensions();\n    const { row: rowCosine, column: columnCosine, normal: vecNormal, } = directionVectors;\n    const topLeftWorld = vec3.create();\n    const bottomRightWorld = vec3.create();\n    vec3.scaleAndAdd(topLeftWorld, centerWorld, vecNormal, radiusWorld);\n    vec3.scaleAndAdd(bottomRightWorld, centerWorld, vecNormal, -radiusWorld);\n    vec3.scaleAndAdd(topLeftWorld, topLeftWorld, columnCosine, -radiusWorld);\n    vec3.scaleAndAdd(bottomRightWorld, bottomRightWorld, columnCosine, radiusWorld);\n    vec3.scaleAndAdd(topLeftWorld, topLeftWorld, rowCosine, -radiusWorld);\n    vec3.scaleAndAdd(bottomRightWorld, bottomRightWorld, rowCosine, radiusWorld);\n    const topLeftIJK = transformWorldToIndex(imageData, topLeftWorld);\n    const bottomRightIJK = transformWorldToIndex(imageData, bottomRightWorld);\n    const pointsIJK = circlePoints.map((p) => transformWorldToIndex(imageData, p));\n    const boundsIJK = getBoundingBoxAroundShapeIJK([topLeftIJK, bottomRightIJK, ...pointsIJK], dimensions);\n    return { boundsIJK, topLeftWorld, bottomRightWorld };\n}\nexport { getSphereBoundsInfo, getSphereBoundsInfoFromViewport };\n","import { getEnabledElements, utilities as csUtils } from '@cornerstonejs/core';\nconst { isEqual } = csUtils;\nexport default function getViewportsForAnnotation(annotation) {\n    const { metadata } = annotation;\n    return getEnabledElements()\n        .filter((enabledElement) => {\n        if (enabledElement.FrameOfReferenceUID === metadata.FrameOfReferenceUID) {\n            const viewport = enabledElement.viewport;\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            return (isEqual(viewPlaneNormal, metadata.viewPlaneNormal) &&\n                (!metadata.viewUp || isEqual(viewUp, metadata.viewUp)));\n        }\n        return;\n    })\n        .map((enabledElement) => enabledElement.viewport);\n}\n","import { utilities, triggerEvent } from '@cornerstonejs/core';\nimport { getAnnotationNearPoint, getAnnotationNearPointOnEnabledElement, } from './getAnnotationNearPoint';\nimport debounce from './debounce';\nimport throttle from './throttle';\nimport isObject from './isObject';\nimport calibrateImageSpacing from './calibrateImageSpacing';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, } from './getCalibratedUnits';\nimport triggerAnnotationRenderForViewportIds from './triggerAnnotationRenderForViewportIds';\nimport triggerAnnotationRenderForToolGroupIds from './triggerAnnotationRenderForToolGroupIds';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nimport { getSphereBoundsInfo } from './getSphereBoundsInfo';\nimport { pointToString } from './pointToString';\nimport AnnotationMultiSlice from './AnnotationMultiSlice';\nimport getViewportForAnnotation from './getViewportForAnnotation';\nimport { annotationHydration, getClosestImageIdForStackViewport, } from './annotationHydration';\nimport * as contours from './contours';\nimport * as segmentation from './segmentation';\nimport * as drawing from './drawing';\nimport * as math from './math';\nimport * as planar from './planar';\nimport * as viewportFilters from './viewportFilters';\nimport * as orientation from './orientation';\nimport * as cine from './cine';\nimport * as boundingBox from './boundingBox';\nimport * as planarFreehandROITool from './planarFreehandROITool';\nimport * as rectangleROITool from './rectangleROITool';\nimport { stackPrefetch, stackContextPrefetch } from './stackPrefetch';\nimport * as viewport from './viewport';\nimport * as touch from './touch';\nimport * as dynamicVolume from './dynamicVolume';\nimport * as polyDataUtils from './polyData/utils';\nimport * as voi from './voi';\nimport * as contourSegmentation from './contourSegmentation';\nimport { pointInSurroundingSphereCallback } from './pointInSurroundingSphereCallback';\nconst roundNumber = utilities.roundNumber;\nimport normalizeViewportPlane from './normalizeViewportPlane';\nimport IslandRemoval from './segmentation/islandRemoval';\nimport { getPixelValueUnits, getPixelValueUnitsImageId, } from './getPixelValueUnits';\nimport * as geometricSurfaceUtils from './geometricSurfaceUtils';\nimport setAnnotationLabel from './setAnnotationLabel';\nimport { moveAnnotationToViewPlane } from './moveAnnotationToViewPlane';\nexport { math, planar, viewportFilters, drawing, debounce, dynamicVolume, throttle, orientation, isObject, touch, triggerEvent, calibrateImageSpacing, getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, getPixelValueUnits, getPixelValueUnitsImageId, segmentation, contours, triggerAnnotationRenderForViewportIds, triggerAnnotationRenderForToolGroupIds, triggerAnnotationRender, getSphereBoundsInfo, getAnnotationNearPoint, getViewportForAnnotation, getAnnotationNearPointOnEnabledElement, viewport, cine, boundingBox, rectangleROITool, planarFreehandROITool, stackPrefetch, stackContextPrefetch, roundNumber, pointToString, polyDataUtils, voi, AnnotationMultiSlice, contourSegmentation, annotationHydration, getClosestImageIdForStackViewport, pointInSurroundingSphereCallback, normalizeViewportPlane, IslandRemoval, geometricSurfaceUtils, setAnnotationLabel, moveAnnotationToViewPlane, };\n","export default function findClosestPoint(sourcePoints, targetPoint) {\n    let minPoint = [0, 0];\n    let minDistance = Number.MAX_SAFE_INTEGER;\n    sourcePoints.forEach(function (sourcePoint) {\n        const distance = _distanceBetween(targetPoint, sourcePoint);\n        if (distance < minDistance) {\n            minDistance = distance;\n            minPoint = [...sourcePoint];\n        }\n    });\n    return minPoint;\n}\nfunction _distanceBetween(p1, p2) {\n    const [x1, y1] = p1;\n    const [x2, y2] = p2;\n    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n}\n","import { StackViewport } from '@cornerstonejs/core';\nimport * as vec3 from 'gl-matrix/vec3';\nexport function moveAnnotationToViewPlane(annotation, viewport) {\n    const { data } = annotation;\n    const { points } = data.handles;\n    const { focalPoint, viewPlaneNormal } = viewport.getCamera();\n    const projectedDistance = vec3.dot(vec3.sub(vec3.create(), points[0], focalPoint), viewPlaneNormal);\n    points.forEach((point) => {\n        vec3.add(point, point, vec3.scale(vec3.create(), [-viewPlaneNormal[0], -viewPlaneNormal[1], -viewPlaneNormal[2]], projectedDistance));\n    });\n    if (viewport instanceof StackViewport) {\n        annotation.metadata.referencedImageId = viewport.getCurrentImageId();\n    }\n    return annotation;\n}\n","import { BaseVolumeViewport, utilities } from '@cornerstonejs/core';\nconst { isEqual } = utilities;\nconst acquisitionMapping = {\n    toIJK: (ijkPrime) => ijkPrime,\n    fromIJK: (ijk) => ijk,\n    type: 'acquistion',\n};\nconst jkMapping = {\n    toIJK: ([j, k, i]) => [i, j, k],\n    fromIJK: ([i, j, k]) => [j, k, i],\n    type: 'jk',\n};\nconst ikMapping = {\n    toIJK: ([i, k, j]) => [i, j, k],\n    fromIJK: ([i, j, k]) => [i, k, j],\n    type: 'ik',\n};\nexport default function normalizeViewportPlane(viewport, boundsIJK) {\n    if (!(viewport instanceof BaseVolumeViewport)) {\n        return { ...acquisitionMapping, boundsIJKPrime: boundsIJK };\n    }\n    const { viewPlaneNormal } = viewport.getCamera();\n    const mapping = (isEqual(Math.abs(viewPlaneNormal[0]), 1) && jkMapping) ||\n        (isEqual(Math.abs(viewPlaneNormal[1]), 1) && ikMapping) ||\n        (isEqual(Math.abs(viewPlaneNormal[2]), 1) && acquisitionMapping);\n    if (!mapping) {\n        return {\n            toIJK: null,\n            boundsIJKPrime: null,\n            fromIJK: null,\n            error: `Only mappings orthogonal to acquisition plane are permitted, but requested ${viewPlaneNormal}`,\n        };\n    }\n    return { ...mapping, boundsIJKPrime: mapping.fromIJK(boundsIJK) };\n}\n","export default function getOrientationStringLPS(vector) {\n    let orientation = '';\n    const orientationX = vector[0] < 0 ? 'R' : 'L';\n    const orientationY = vector[1] < 0 ? 'A' : 'P';\n    const orientationZ = vector[2] < 0 ? 'F' : 'H';\n    const abs = [Math.abs(vector[0]), Math.abs(vector[1]), Math.abs(vector[2])];\n    const MIN = 0.0001;\n    for (let i = 0; i < 3; i++) {\n        if (abs[0] > MIN && abs[0] > abs[1] && abs[0] > abs[2]) {\n            orientation += orientationX;\n            abs[0] = 0;\n        }\n        else if (abs[1] > MIN && abs[1] > abs[0] && abs[1] > abs[2]) {\n            orientation += orientationY;\n            abs[1] = 0;\n        }\n        else if (abs[2] > MIN && abs[2] > abs[0] && abs[2] > abs[1]) {\n            orientation += orientationZ;\n            abs[2] = 0;\n        }\n        else if (abs[0] > MIN && abs[1] > MIN && abs[0] === abs[1]) {\n            orientation += orientationX + orientationY;\n            abs[0] = 0;\n            abs[1] = 0;\n        }\n        else if (abs[0] > MIN && abs[2] > MIN && abs[0] === abs[2]) {\n            orientation += orientationX + orientationZ;\n            abs[0] = 0;\n            abs[2] = 0;\n        }\n        else if (abs[1] > MIN && abs[2] > MIN && abs[1] === abs[2]) {\n            orientation += orientationY + orientationZ;\n            abs[1] = 0;\n            abs[2] = 0;\n        }\n        else {\n            break;\n        }\n    }\n    return orientation;\n}\n","export default function invertOrientationStringLPS(orientationString) {\n    let inverted = orientationString.replace('H', 'f');\n    inverted = inverted.replace('F', 'h');\n    inverted = inverted.replace('R', 'l');\n    inverted = inverted.replace('L', 'r');\n    inverted = inverted.replace('A', 'p');\n    inverted = inverted.replace('P', 'a');\n    inverted = inverted.toUpperCase();\n    return inverted;\n}\n","import smoothAnnotation from './smoothAnnotation';\nexport default {\n    smoothAnnotation,\n};\nexport { smoothAnnotation };\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { pointInSphere } from './math/sphere';\nimport { getBoundingBoxAroundShape } from './boundingBox';\nconst { transformWorldToIndex } = csUtils;\nexport function pointInSurroundingSphereCallback(imageData, circlePoints, callback, viewport) {\n    const { boundsIJK, centerWorld, radiusWorld } = _getBounds(circlePoints, imageData, viewport);\n    const sphereObj = {\n        center: centerWorld,\n        radius: radiusWorld,\n    };\n    const dimensions = imageData.getDimensions();\n    const voxelManager = csUtils.VoxelManager.createScalarVolumeVoxelManager({\n        dimensions: dimensions,\n        scalarData: imageData.getPointData().getScalars().getData(),\n    });\n    voxelManager.forEach(callback, {\n        boundsIJK,\n        isInObject: (pointLPS) => pointInSphere(sphereObj, pointLPS),\n        imageData,\n    });\n}\nfunction _getBounds(circlePoints, imageData, viewport) {\n    const [bottom, top] = circlePoints;\n    const centerWorld = vec3.fromValues((bottom[0] + top[0]) / 2, (bottom[1] + top[1]) / 2, (bottom[2] + top[2]) / 2);\n    const radiusWorld = vec3.distance(bottom, top) / 2;\n    let boundsIJK;\n    if (!viewport) {\n        const centerIJK = transformWorldToIndex(imageData, centerWorld);\n        const spacings = imageData.getSpacing();\n        const minSpacing = Math.min(...spacings);\n        const maxRadiusIJK = Math.ceil(radiusWorld / minSpacing);\n        boundsIJK = [\n            [centerIJK[0] - maxRadiusIJK, centerIJK[0] + maxRadiusIJK],\n            [centerIJK[1] - maxRadiusIJK, centerIJK[1] + maxRadiusIJK],\n            [centerIJK[2] - maxRadiusIJK, centerIJK[2] + maxRadiusIJK],\n        ];\n        return {\n            boundsIJK,\n            centerWorld: centerWorld,\n            radiusWorld,\n        };\n    }\n    boundsIJK = _computeBoundsIJKWithCamera(imageData, viewport, circlePoints, centerWorld, radiusWorld);\n    return {\n        boundsIJK,\n        centerWorld: centerWorld,\n        radiusWorld,\n    };\n}\nfunction _computeBoundsIJKWithCamera(imageData, viewport, circlePoints, centerWorld, radiusWorld) {\n    const [bottom, top] = circlePoints;\n    const dimensions = imageData.getDimensions();\n    const camera = viewport.getCamera();\n    const viewUp = vec3.fromValues(camera.viewUp[0], camera.viewUp[1], camera.viewUp[2]);\n    const viewPlaneNormal = vec3.fromValues(camera.viewPlaneNormal[0], camera.viewPlaneNormal[1], camera.viewPlaneNormal[2]);\n    const viewRight = vec3.create();\n    vec3.cross(viewRight, viewUp, viewPlaneNormal);\n    const topLeftWorld = vec3.create();\n    const bottomRightWorld = vec3.create();\n    vec3.scaleAndAdd(topLeftWorld, top, viewPlaneNormal, radiusWorld);\n    vec3.scaleAndAdd(bottomRightWorld, bottom, viewPlaneNormal, -radiusWorld);\n    vec3.scaleAndAdd(topLeftWorld, topLeftWorld, viewRight, -radiusWorld);\n    vec3.scaleAndAdd(bottomRightWorld, bottomRightWorld, viewRight, radiusWorld);\n    const sphereCornersIJK = [\n        transformWorldToIndex(imageData, topLeftWorld),\n        (transformWorldToIndex(imageData, bottomRightWorld)),\n    ];\n    const boundsIJK = getBoundingBoxAroundShape(sphereCornersIJK, dimensions);\n    return boundsIJK;\n}\n","export function pointToString(point, decimals = 5) {\n    return (parseFloat(point[0]).toFixed(decimals) +\n        ',' +\n        parseFloat(point[1]).toFixed(decimals) +\n        ',' +\n        parseFloat(point[2]).toFixed(decimals) +\n        ',');\n}\n","import { vec3 } from 'gl-matrix';\nexport function getPoint(points, idx) {\n    const idx3 = idx * 3;\n    if (idx3 < points.length) {\n        return vec3.fromValues(points[idx3], points[idx3 + 1], points[idx3 + 2]);\n    }\n}\nexport function getPolyDataPointIndexes(polyData) {\n    const linesData = polyData.getLines().getData();\n    let idx = 0;\n    const lineSegments = new Map();\n    while (idx < linesData.length) {\n        const segmentSize = linesData[idx++];\n        const segment = [];\n        for (let i = 0; i < segmentSize; i++) {\n            segment.push(linesData[idx + i]);\n        }\n        lineSegments.set(segment[0], segment);\n        idx += segmentSize;\n    }\n    const contours = [];\n    const findStartingPoint = (map) => {\n        for (const [key, value] of map.entries()) {\n            if (value !== undefined) {\n                return key;\n            }\n        }\n        return -1;\n    };\n    let startPoint = findStartingPoint(lineSegments);\n    while (startPoint !== -1) {\n        const contour = [startPoint];\n        while (lineSegments.has(startPoint)) {\n            const nextPoint = lineSegments.get(startPoint)[1];\n            if (lineSegments.has(nextPoint)) {\n                contour.push(nextPoint);\n            }\n            lineSegments.delete(startPoint);\n            startPoint = nextPoint;\n        }\n        contours.push(contour);\n        startPoint = findStartingPoint(lineSegments);\n    }\n    return contours.length ? contours : undefined;\n}\nexport function getPolyDataPoints(polyData) {\n    const contoursIndexes = getPolyDataPointIndexes(polyData);\n    if (!contoursIndexes) {\n        return;\n    }\n    const rawPointsData = polyData.getPoints().getData();\n    return contoursIndexes.map((contourIndexes) => contourIndexes.map((index) => getPoint(rawPointsData, index)));\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { getBoundingBoxAroundShapeIJK } from '../boundingBox/getBoundingBoxAroundShape';\nimport extend2DBoundingBoxInViewAxis from '../boundingBox/extend2DBoundingBoxInViewAxis';\nfunction getBoundsIJKFromRectangleAnnotations(annotations, referenceVolume, options = {}) {\n    const AllBoundsIJK = [];\n    annotations.forEach((annotation) => {\n        const { data } = annotation;\n        const { points } = data.handles;\n        const { imageData, dimensions } = referenceVolume;\n        let pointsToUse = points;\n        if (data.cachedStats?.projectionPoints) {\n            const { projectionPoints } = data.cachedStats;\n            pointsToUse = [].concat(...projectionPoints);\n        }\n        const rectangleCornersIJK = pointsToUse.map((world) => csUtils.transformWorldToIndex(imageData, world));\n        let boundsIJK = getBoundingBoxAroundShapeIJK(rectangleCornersIJK, dimensions);\n        if (options.numSlicesToProject && !data.cachedStats?.projectionPoints) {\n            boundsIJK = extend2DBoundingBoxInViewAxis(boundsIJK, options.numSlicesToProject);\n        }\n        AllBoundsIJK.push(boundsIJK);\n    });\n    if (AllBoundsIJK.length === 1) {\n        return AllBoundsIJK[0];\n    }\n    const boundsIJK = AllBoundsIJK.reduce((accumulator, currentValue) => {\n        return {\n            iMin: Math.min(accumulator.iMin, currentValue.iMin),\n            jMin: Math.min(accumulator.jMin, currentValue.jMin),\n            kMin: Math.min(accumulator.kMin, currentValue.kMin),\n            iMax: Math.max(accumulator.iMax, currentValue.iMax),\n            jMax: Math.max(accumulator.jMax, currentValue.jMax),\n            kMax: Math.max(accumulator.kMax, currentValue.kMax),\n        };\n    }, {\n        iMin: Infinity,\n        jMin: Infinity,\n        kMin: Infinity,\n        iMax: -Infinity,\n        jMax: -Infinity,\n        kMax: -Infinity,\n    });\n    return boundsIJK;\n}\nexport default getBoundsIJKFromRectangleAnnotations;\n","import { getWebWorkerManager } from '@cornerstonejs/core';\nimport { getConfig } from '../config';\nlet registered = false;\nexport function registerComputeWorker() {\n    if (registered) {\n        return;\n    }\n    registered = true;\n    const workerFn = () => {\n        return new Worker(new URL('../workers/computeWorker.js', import.meta.url), {\n            name: 'compute',\n            type: 'module',\n        });\n    };\n    const workerManager = getWebWorkerManager();\n    const config = getConfig();\n    const computeWorkerConfig = config.computeWorker;\n    const options = {\n        maxWorkerInstances: 1,\n        autoTerminateOnIdle: computeWorkerConfig?.autoTerminateOnIdle ?? {\n            enabled: true,\n            idleTimeThreshold: 2000,\n        },\n    };\n    workerManager.registerWorker('compute', workerFn, options);\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { state as annotationState } from '../../../stateManagement/annotation';\nimport getInterpolationDataCollection from '../../contours/interpolation/getInterpolationDataCollection';\nimport interpolate from '../../contours/interpolation/interpolate';\nimport deleteRelatedAnnotations from './deleteRelatedAnnotations';\nimport ChangeTypes from '../../../enums/ChangeTypes';\nimport getViewportForAnnotation from '../../getViewportForAnnotation';\nimport { addContourSegmentationAnnotation } from '../../contourSegmentation/addContourSegmentationAnnotation';\nconst { uuidv4 } = csUtils;\nconst ChangeTypesForInterpolation = [\n    ChangeTypes.HandlesUpdated,\n    ChangeTypes.InterpolationUpdated,\n];\nexport default class InterpolationManager {\n    static { this.toolNames = []; }\n    static addTool(toolName) {\n        if (!this.toolNames.includes(toolName)) {\n            this.toolNames.push(toolName);\n        }\n    }\n    static acceptAutoGenerated(annotationGroupSelector, selector = {}) {\n        const { toolNames, segmentationId, segmentIndex, sliceIndex } = selector;\n        for (const toolName of toolNames || InterpolationManager.toolNames) {\n            const annotations = annotationState.getAnnotations(toolName, annotationGroupSelector);\n            if (!annotations?.length) {\n                continue;\n            }\n            for (const annotation of annotations) {\n                const { interpolationUID, data, autoGenerated, metadata } = annotation;\n                if (interpolationUID) {\n                    annotation.interpolationCompleted = true;\n                }\n                if (!autoGenerated) {\n                    continue;\n                }\n                if (segmentIndex && segmentIndex !== data.segmentation.segmentIndex) {\n                    continue;\n                }\n                if (sliceIndex !== undefined &&\n                    metadata &&\n                    sliceIndex !== metadata.sliceIndex) {\n                    continue;\n                }\n                if (segmentationId &&\n                    segmentationId !== data.segmentation.segmentationId) {\n                    continue;\n                }\n                addContourSegmentationAnnotation(annotation);\n                annotation.autoGenerated = false;\n            }\n        }\n    }\n    static { this.handleAnnotationCompleted = (evt) => {\n        const annotation = evt.detail.annotation;\n        if (!annotation?.metadata) {\n            return;\n        }\n        const { toolName, originalToolName } = annotation.metadata;\n        if (!this.toolNames.includes(toolName) &&\n            !this.toolNames.includes(originalToolName)) {\n            return;\n        }\n        const viewport = getViewportForAnnotation(annotation);\n        if (!viewport) {\n            console.warn('Unable to find viewport for', annotation);\n            return;\n        }\n        const sliceData = getSliceData(viewport);\n        const viewportData = {\n            viewport,\n            sliceData,\n            annotation,\n            interpolationUID: annotation.interpolationUID,\n        };\n        const hasInterpolationUID = !!annotation.interpolationUID;\n        annotation.autoGenerated = false;\n        if (hasInterpolationUID) {\n            deleteRelatedAnnotations(viewportData);\n            interpolate(viewportData);\n            return;\n        }\n        const filterData = [\n            {\n                key: 'segmentIndex',\n                value: annotation.data.segmentation.segmentIndex,\n                parentKey: (annotation) => annotation.data.segmentation,\n            },\n            {\n                key: 'viewPlaneNormal',\n                value: annotation.metadata.viewPlaneNormal,\n                parentKey: (annotation) => annotation.metadata,\n            },\n            {\n                key: 'viewUp',\n                value: annotation.metadata.viewUp,\n                parentKey: (annotation) => annotation.metadata,\n            },\n        ];\n        let interpolationAnnotations = getInterpolationDataCollection(viewportData, filterData);\n        const { sliceIndex } = annotation.metadata;\n        const skipUIDs = new Set();\n        interpolationAnnotations.forEach((interpolationAnnotation) => {\n            if (interpolationAnnotation.interpolationCompleted ||\n                interpolationAnnotation.metadata.sliceIndex === sliceIndex) {\n                const { interpolationUID } = interpolationAnnotation;\n                skipUIDs.add(interpolationUID);\n            }\n        });\n        interpolationAnnotations = interpolationAnnotations.filter((interpolationAnnotation) => !skipUIDs.has(interpolationAnnotation.interpolationUID));\n        annotation.interpolationUID =\n            interpolationAnnotations[0]?.interpolationUID || uuidv4();\n        viewportData.interpolationUID = annotation.interpolationUID;\n        interpolate(viewportData);\n    }; }\n    static { this.handleAnnotationUpdate = (evt) => {\n        const annotation = evt.detail.annotation;\n        const { changeType = ChangeTypes.HandlesUpdated } = evt.detail;\n        if (!annotation?.metadata) {\n            return;\n        }\n        const { toolName, originalToolName } = annotation.metadata;\n        if ((!this.toolNames.includes(toolName) &&\n            !this.toolNames.includes(originalToolName)) ||\n            !ChangeTypesForInterpolation.includes(changeType)) {\n            return;\n        }\n        const viewport = getViewportForAnnotation(annotation);\n        if (!viewport) {\n            console.warn('Unable to find matching viewport for annotation interpolation', annotation);\n            return;\n        }\n        if (annotation.autoGenerated) {\n            addContourSegmentationAnnotation(annotation);\n            annotation.autoGenerated = false;\n        }\n        const sliceData = getSliceData(viewport);\n        const viewportData = {\n            viewport,\n            sliceData,\n            annotation,\n            interpolationUID: annotation.interpolationUID,\n            isInterpolationUpdate: changeType === ChangeTypes.InterpolationUpdated,\n        };\n        interpolate(viewportData);\n    }; }\n    static { this.handleAnnotationDelete = (evt) => {\n        const annotation = evt.detail.annotation;\n        if (!annotation?.metadata) {\n            return;\n        }\n        const { toolName } = annotation.metadata;\n        if (!this.toolNames.includes(toolName) || annotation.autoGenerated) {\n            return;\n        }\n        const viewport = getViewportForAnnotation(annotation);\n        if (!viewport) {\n            console.warn(\"No viewport, can't delete interpolated results\", annotation);\n            return;\n        }\n        const sliceData = getSliceData(viewport);\n        const viewportData = {\n            viewport,\n            sliceData,\n            annotation,\n            interpolationUID: annotation.interpolationUID,\n        };\n        annotation.autoGenerated = false;\n        deleteRelatedAnnotations(viewportData);\n    }; }\n}\nfunction getSliceData(viewport) {\n    const sliceData = {\n        numberOfSlices: viewport.getNumberOfSlices(),\n        imageIndex: viewport.getCurrentImageIdIndex(),\n    };\n    return sliceData;\n}\n","import { InstanceVolumetricCalculator } from './VolumetricCalculator';\nexport default class SegmentStatsCalculator {\n    static { this.calculators = new Map(); }\n    static { this.indices = []; }\n    static { this.mode = 'collective'; }\n    static statsInit(options) {\n        const { storePointData, indices, mode } = options;\n        this.mode = mode;\n        this.indices = indices;\n        this.calculators.clear();\n        if (this.mode === 'individual') {\n            indices.forEach((index) => {\n                this.calculators.set(index, new InstanceVolumetricCalculator({ storePointData }));\n            });\n        }\n        else {\n            this.calculators.set(indices, new InstanceVolumetricCalculator({ storePointData }));\n        }\n    }\n    static statsCallback(data) {\n        const { segmentIndex, ...statsData } = data;\n        if (!segmentIndex) {\n            throw new Error('Segment index is required for stats calculation');\n        }\n        const calculator = this.mode === 'individual'\n            ? this.calculators.get(segmentIndex)\n            : this.calculators.get(this.indices);\n        if (!calculator) {\n            throw new Error(`No calculator found for segment ${segmentIndex}`);\n        }\n        calculator.statsCallback(statsData);\n    }\n    static getStatistics(options) {\n        if (this.mode === 'individual') {\n            const result = {};\n            this.calculators.forEach((calculator, segmentIndex) => {\n                result[segmentIndex] = calculator.getStatistics(options);\n            });\n            return result;\n        }\n        const calculator = this.calculators.get(this.indices);\n        return calculator.getStatistics(options);\n    }\n}\n","import { BasicStatsCalculator, InstanceBasicStatsCalculator, } from '../math/basic/BasicStatsCalculator';\nimport { getCalibratedLengthUnitsAndScale } from '../getCalibratedUnits';\nconst TEST_MAX_LOCATIONS = 10;\nfunction createVolumetricState() {\n    return {\n        maxIJKs: [],\n    };\n}\nfunction volumetricStatsCallback(state, data) {\n    const { value } = data;\n    const { maxIJKs } = state;\n    const length = maxIJKs.length;\n    if (typeof value !== 'number' ||\n        (length >= TEST_MAX_LOCATIONS && value < maxIJKs[0].value)) {\n        return;\n    }\n    const dataCopy = {\n        value: data.value,\n        pointLPS: data.pointLPS\n            ? [data.pointLPS[0], data.pointLPS[1], data.pointLPS[2]]\n            : undefined,\n        pointIJK: data.pointIJK\n            ? [data.pointIJK[0], data.pointIJK[1], data.pointIJK[2]]\n            : undefined,\n    };\n    if (!length || value >= maxIJKs[length - 1].value) {\n        maxIJKs.push(dataCopy);\n    }\n    else {\n        for (let i = 0; i < length; i++) {\n            if (value <= maxIJKs[i].value) {\n                maxIJKs.splice(i, 0, dataCopy);\n                break;\n            }\n        }\n    }\n    if (length >= TEST_MAX_LOCATIONS) {\n        maxIJKs.splice(0, 1);\n    }\n}\nfunction volumetricGetStatistics(state, stats, options) {\n    const { spacing, calibration } = options;\n    const { volumeUnit } = getCalibratedLengthUnitsAndScale({\n        calibration,\n        hasPixelSpacing: true,\n    }, []);\n    const volumeScale = spacing ? spacing[0] * spacing[1] * spacing[2] * 1000 : 1;\n    stats.volume = {\n        value: Array.isArray(stats.count.value)\n            ? stats.count.value.map((v) => v * volumeScale)\n            : stats.count.value * volumeScale,\n        unit: volumeUnit,\n        name: 'volume',\n        label: 'Volume',\n    };\n    stats.maxIJKs = state.maxIJKs.filter((entry) => entry.pointIJK !== undefined);\n    stats.array.push(stats.volume);\n    state.maxIJKs = [];\n    return stats;\n}\nexport class VolumetricCalculator extends BasicStatsCalculator {\n    static { this.volumetricState = createVolumetricState(); }\n    static statsInit(options) {\n        super.statsInit(options);\n        this.volumetricState = createVolumetricState();\n    }\n    static statsCallback(data) {\n        super.statsCallback(data);\n        volumetricStatsCallback(this.volumetricState, data);\n    }\n    static getStatistics(options) {\n        const optionsWithUnit = {\n            ...options,\n            unit: options?.unit || 'none',\n            calibration: options?.calibration,\n            hasPixelSpacing: options?.hasPixelSpacing,\n        };\n        const stats = super.getStatistics(optionsWithUnit);\n        return volumetricGetStatistics(this.volumetricState, stats, optionsWithUnit);\n    }\n}\nexport class InstanceVolumetricCalculator extends InstanceBasicStatsCalculator {\n    constructor(options) {\n        super(options);\n        this.volumetricState = createVolumetricState();\n    }\n    statsInit(options) {\n        super.statsInit(options);\n        this.volumetricState = createVolumetricState();\n    }\n    statsCallback(data) {\n        super.statsCallback(data);\n        volumetricStatsCallback(this.volumetricState, data);\n    }\n    getStatistics(options) {\n        const optionsWithUnit = {\n            ...options,\n            unit: options?.unit || 'none',\n            calibration: options?.calibration,\n            hasPixelSpacing: options?.hasPixelSpacing,\n        };\n        const stats = super.getStatistics(optionsWithUnit);\n        return volumetricGetStatistics(this.volumetricState, stats, optionsWithUnit);\n    }\n}\nexport default VolumetricCalculator;\n","import { getToolGroup } from '../../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../triggerAnnotationRenderForViewportIds';\nimport { getRenderingEngine } from '@cornerstonejs/core';\nimport { getBrushToolInstances } from './getBrushToolInstances';\nexport function setBrushSizeForToolGroup(toolGroupId, brushSize, toolName) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId, toolName);\n    brushBasedToolInstances.forEach((tool) => {\n        tool.configuration.brushSize = brushSize;\n        tool.invalidateBrushCursor();\n    });\n    const viewportsInfo = toolGroup.getViewportsInfo();\n    const viewportsInfoArray = Object.keys(viewportsInfo).map((key) => viewportsInfo[key]);\n    if (!viewportsInfoArray.length) {\n        return;\n    }\n    const { renderingEngineId } = viewportsInfoArray[0];\n    const viewportIds = toolGroup.getViewportIds();\n    const renderingEngine = getRenderingEngine(renderingEngineId);\n    triggerAnnotationRenderForViewportIds(viewportIds);\n}\nexport function getBrushSizeForToolGroup(toolGroupId, toolName) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const toolInstances = toolGroup._toolInstances;\n    if (!Object.keys(toolInstances).length) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId, toolName);\n    const brushToolInstance = brushBasedToolInstances[0];\n    if (!brushToolInstance) {\n        return;\n    }\n    return brushToolInstance.configuration.brushSize;\n}\n","import { getToolGroup } from '../../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../triggerAnnotationRenderForViewportIds';\nimport { getBrushToolInstances } from './getBrushToolInstances';\nexport function setBrushThresholdForToolGroup(toolGroupId, threshold) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId);\n    brushBasedToolInstances.forEach((tool) => {\n        const activeStrategy = tool.configuration.activeStrategy;\n        if (!activeStrategy.toLowerCase().includes('threshold')) {\n            return;\n        }\n        tool.configuration = {\n            ...tool.configuration,\n            threshold: {\n                ...tool.configuration.threshold,\n                ...threshold,\n            },\n        };\n    });\n    const viewportsInfo = toolGroup.getViewportsInfo();\n    if (!viewportsInfo.length) {\n        return;\n    }\n    const viewportIds = toolGroup.getViewportIds();\n    triggerAnnotationRenderForViewportIds(viewportIds);\n}\nexport function getBrushThresholdForToolGroup(toolGroupId) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const toolInstances = toolGroup._toolInstances;\n    if (!Object.keys(toolInstances).length) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId);\n    const brushToolInstance = brushBasedToolInstances[0];\n    if (!brushToolInstance) {\n        return;\n    }\n    return brushToolInstance.configuration.threshold.range;\n}\n","import { utilities, getWebWorkerManager } from '@cornerstonejs/core';\nimport { triggerWorkerProgress } from './utilsForWorker';\nimport { WorkerTypes } from '../../enums';\nimport { registerComputeWorker } from '../registerComputeWorker';\nimport createMergedLabelmapForIndex from './createMergedLabelmapForIndex';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nimport getOrCreateSegmentationVolume from './getOrCreateSegmentationVolume';\nimport { getReferenceVolumeForSegmentation } from './getReferenceVolumeForSegmentation';\nasync function computeMetabolicStats({ segmentationIds, segmentIndex, }) {\n    registerComputeWorker();\n    triggerWorkerProgress(WorkerTypes.COMPUTE_STATISTICS, 0);\n    const segmentation = getSegmentation(segmentationIds[0]);\n    const { imageIds: segImageIds } = segmentation.representationData\n        .Labelmap;\n    const isValidVolume = utilities.isValidVolume(segImageIds);\n    if (!isValidVolume) {\n        throw new Error('Invalid volume - TMTV cannot be calculated');\n    }\n    const stats = await calculateForVolume({\n        segmentationIds,\n        segmentIndex,\n    });\n    return stats;\n}\nasync function calculateForVolume({ segmentationIds, segmentIndex }) {\n    const labelmapVolumes = segmentationIds.map((id) => {\n        return getOrCreateSegmentationVolume(id);\n    });\n    const mergedLabelmap = createMergedLabelmapForIndex(labelmapVolumes, segmentIndex);\n    if (!mergedLabelmap) {\n        throw new Error('Invalid volume - TMTV cannot be calculated');\n    }\n    const { imageData, dimensions, direction, origin, voxelManager } = mergedLabelmap;\n    const spacing = imageData.getSpacing();\n    const segmentationScalarData = voxelManager.getCompleteScalarDataArray();\n    const segmentationInfo = {\n        scalarData: segmentationScalarData,\n        dimensions,\n        spacing,\n        origin,\n        direction,\n    };\n    const referenceVolume = getReferenceVolumeForSegmentation(segmentationIds[0]);\n    const imageInfo = {\n        dimensions: referenceVolume.dimensions,\n        spacing: referenceVolume.spacing,\n        origin: referenceVolume.origin,\n        direction: referenceVolume.direction,\n        scalarData: referenceVolume.voxelManager.getCompleteScalarDataArray(),\n    };\n    const stats = await getWebWorkerManager().executeTask('compute', 'computeMetabolicStats', {\n        segmentationInfo,\n        imageInfo,\n    });\n    triggerWorkerProgress(WorkerTypes.COMPUTE_STATISTICS, 100);\n    return stats;\n}\nexport { computeMetabolicStats };\n","import { cache } from '@cornerstonejs/core';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nimport getOrCreateImageVolume from './getOrCreateImageVolume';\nexport function getReferenceVolumeForSegmentation(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return null;\n    }\n    let referenceImageIds;\n    const labelmap = segmentation.representationData.Labelmap;\n    if ('imageIds' in labelmap) {\n        const { imageIds } = labelmap;\n        const firstImage = cache.getImage(imageIds[0]);\n        const volumeInfo = cache.getVolumeContainingImageId(firstImage.referencedImageId);\n        if (volumeInfo?.volume) {\n            return volumeInfo.volume;\n        }\n        referenceImageIds = imageIds.map((imageId) => cache.getImage(imageId).referencedImageId);\n    }\n    else if ('volumeId' in labelmap) {\n        const { volumeId, referencedVolumeId } = labelmap;\n        if (referencedVolumeId) {\n            const refVolume = cache.getVolume(referencedVolumeId);\n            if (refVolume) {\n                return refVolume;\n            }\n        }\n        const segVolume = cache.getVolume(volumeId);\n        if (segVolume) {\n            referenceImageIds = segVolume.imageIds.map((imageId) => cache.getImage(imageId).referencedImageId);\n        }\n    }\n    return getOrCreateImageVolume(referenceImageIds);\n}\n","import { generateContourSetsFromLabelmap } from '../contours';\nimport findLargestBidirectional from './findLargestBidirectional';\nimport getOrCreateSegmentationVolume from './getOrCreateSegmentationVolume';\nexport default function contourAndFindLargestBidirectional(segmentation) {\n    const contours = generateContourSetsFromLabelmap({\n        segmentations: segmentation,\n    });\n    if (!contours?.length || !contours[0].sliceContours.length) {\n        return;\n    }\n    const { segments = [\n        null,\n        { label: 'Unspecified', color: null, containedSegmentIndices: null },\n    ], } = segmentation;\n    const vol = getOrCreateSegmentationVolume(segmentation.segmentationId);\n    if (!vol) {\n        return;\n    }\n    const segmentIndex = segments.findIndex((it) => !!it);\n    if (segmentIndex === -1) {\n        return;\n    }\n    segments[segmentIndex].segmentIndex = segmentIndex;\n    return findLargestBidirectional(contours[0], vol.volumeId, segments[segmentIndex]);\n}\n","export default function createBidirectionalToolData(bidirectionalData, viewport) {\n    const { majorAxis, minorAxis, label = '', sliceIndex } = bidirectionalData;\n    const [major0, major1] = majorAxis;\n    const [minor0, minor1] = minorAxis;\n    const points = [major0, major1, minor0, minor1];\n    const bidirectionalToolData = {\n        highlighted: true,\n        invalidated: true,\n        metadata: {\n            toolName: 'Bidirectional',\n            ...viewport.getViewReference({ sliceIndex }),\n        },\n        data: {\n            handles: {\n                points,\n                textBox: {\n                    hasMoved: false,\n                    worldPosition: [0, 0, 0],\n                    worldBoundingBox: {\n                        topLeft: [0, 0, 0],\n                        topRight: [0, 0, 0],\n                        bottomLeft: [0, 0, 0],\n                        bottomRight: [0, 0, 0],\n                    },\n                },\n                activeHandleIndex: null,\n            },\n            label,\n            cachedStats: {},\n        },\n        isLocked: false,\n        isVisible: true,\n    };\n    return bidirectionalToolData;\n}\n","import { utilities, eventTarget } from '@cornerstonejs/core';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport Events from '../../enums/Events';\nconst { VoxelManager, RLEVoxelMap } = utilities;\nexport function createLabelmapMemo(segmentationId, segmentationVoxelManager) {\n    return createRleMemo(segmentationId, segmentationVoxelManager);\n}\nexport function restoreMemo(isUndo) {\n    const { segmentationVoxelManager, undoVoxelManager, redoVoxelManager } = this;\n    const useVoxelManager = isUndo === false ? redoVoxelManager : undoVoxelManager;\n    useVoxelManager.forEach(({ value, pointIJK }) => {\n        segmentationVoxelManager.setAtIJKPoint(pointIJK, value);\n    });\n    const slices = useVoxelManager.getArrayOfModifiedSlices();\n    triggerSegmentationDataModified(this.segmentationId, slices);\n}\nexport function createRleMemo(segmentationId, segmentationVoxelManager) {\n    const voxelManager = VoxelManager.createRLEHistoryVoxelManager(segmentationVoxelManager);\n    const state = {\n        segmentationId,\n        restoreMemo,\n        commitMemo,\n        segmentationVoxelManager,\n        voxelManager,\n        id: utilities.uuidv4(),\n        operationType: 'labelmap',\n    };\n    return state;\n}\nfunction commitMemo() {\n    if (this.redoVoxelManager) {\n        return true;\n    }\n    if (!this.voxelManager.modifiedSlices.size) {\n        return false;\n    }\n    const { segmentationVoxelManager } = this;\n    const undoVoxelManager = VoxelManager.createRLEHistoryVoxelManager(segmentationVoxelManager);\n    RLEVoxelMap.copyMap(undoVoxelManager.map, this.voxelManager.map);\n    for (const key of this.voxelManager.modifiedSlices.keys()) {\n        undoVoxelManager.modifiedSlices.add(key);\n    }\n    this.undoVoxelManager = undoVoxelManager;\n    const redoVoxelManager = VoxelManager.createRLEVolumeVoxelManager({\n        dimensions: this.segmentationVoxelManager.dimensions,\n    });\n    this.redoVoxelManager = redoVoxelManager;\n    undoVoxelManager.forEach(({ index, pointIJK, value }) => {\n        const currentValue = segmentationVoxelManager.getAtIJKPoint(pointIJK);\n        if (currentValue === value) {\n            return;\n        }\n        redoVoxelManager.setAtIndex(index, currentValue);\n    });\n    return true;\n}\n","import { getEnabledElementByIds, volumeLoader, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nexport default async function createLabelmapVolumeForViewport(input) {\n    const { viewportId, renderingEngineId, options } = input;\n    let { segmentationId } = input;\n    const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n    if (!enabledElement) {\n        throw new Error('element disabled');\n    }\n    const { viewport } = enabledElement;\n    if (!(viewport instanceof VolumeViewport)) {\n        throw new Error('Segmentation only supports VolumeViewport');\n    }\n    const { uid } = viewport.getDefaultActor();\n    if (segmentationId === undefined) {\n        segmentationId = `${uid}-based-segmentation-${options?.volumeId ?? csUtils.uuidv4().slice(0, 8)}`;\n    }\n    if (options) {\n        const properties = structuredClone(options);\n        await volumeLoader.createLocalVolume(segmentationId, properties);\n    }\n    else {\n        const volumeId = viewport.getVolumeId();\n        volumeLoader.createAndCacheDerivedLabelmapVolume(volumeId, {\n            volumeId: segmentationId,\n        });\n    }\n    return segmentationId;\n}\n","import { volumeLoader, utilities as csUtils, cache } from '@cornerstonejs/core';\nfunction createMergedLabelmapForIndex(labelmaps, segmentIndex = 1, volumeId = 'mergedLabelmap') {\n    labelmaps.forEach(({ direction, dimensions, origin, spacing }) => {\n        if (!csUtils.isEqual(dimensions, labelmaps[0].dimensions) ||\n            !csUtils.isEqual(direction, labelmaps[0].direction) ||\n            !csUtils.isEqual(spacing, labelmaps[0].spacing) ||\n            !csUtils.isEqual(origin, labelmaps[0].origin)) {\n            throw new Error('labelmaps must have the same size and shape');\n        }\n    });\n    const labelmap = labelmaps[0];\n    const arrayType = labelmap.voxelManager.getConstructor();\n    const outputData = new arrayType(labelmap.voxelManager.getScalarDataLength());\n    labelmaps.forEach((labelmap) => {\n        const voxelManager = labelmap.voxelManager;\n        const scalarDataLength = voxelManager.getScalarDataLength();\n        for (let i = 0; i < scalarDataLength; i++) {\n            if (voxelManager.getAtIndex(i) === segmentIndex) {\n                outputData[i] = segmentIndex;\n            }\n        }\n    });\n    const options = {\n        scalarData: outputData,\n        metadata: labelmap.metadata,\n        spacing: labelmap.spacing,\n        origin: labelmap.origin,\n        direction: labelmap.direction,\n        dimensions: labelmap.dimensions,\n    };\n    const cachedVolume = cache.getVolume(volumeId);\n    let mergedVolume;\n    if (cachedVolume) {\n        mergedVolume = cachedVolume;\n        mergedVolume.voxelManager.setCompleteScalarDataArray(outputData);\n    }\n    else {\n        mergedVolume = volumeLoader.createLocalVolume(volumeId, options);\n    }\n    return mergedVolume;\n}\nexport default createMergedLabelmapForIndex;\n","import { vec3 } from 'gl-matrix';\nimport { createIsInSegment, isLineInSegment } from './isLineInSegment';\nconst EPSILON = 1e-2;\nexport default function findLargestBidirectional(contours, segVolumeId, segment) {\n    const { sliceContours } = contours;\n    const { segmentIndex, containedSegmentIndices } = segment;\n    let maxBidirectional;\n    const isInSegment = createIsInSegment(segVolumeId, segmentIndex, containedSegmentIndices);\n    for (const sliceContour of sliceContours) {\n        const bidirectional = createBidirectionalForSlice(sliceContour, isInSegment, maxBidirectional);\n        if (!bidirectional) {\n            continue;\n        }\n        maxBidirectional = bidirectional;\n    }\n    if (maxBidirectional) {\n        Object.assign(maxBidirectional, segment);\n    }\n    return maxBidirectional;\n}\nexport function createBidirectionalForSlice(sliceContour, isInSegment, currentMax = { maxMajor: 0, maxMinor: 0 }) {\n    const { points } = sliceContour.polyData;\n    const { maxMinor: currentMaxMinor, maxMajor: currentMaxMajor } = currentMax;\n    let maxMajor = currentMaxMajor * currentMaxMajor;\n    let maxMinor = currentMaxMinor * currentMaxMinor;\n    let maxMajorPoints;\n    for (let index1 = 0; index1 < points.length; index1++) {\n        for (let index2 = index1 + 1; index2 < points.length; index2++) {\n            const point1 = points[index1];\n            const point2 = points[index2];\n            const distance2 = vec3.sqrDist(point1, point2);\n            if (distance2 < maxMajor) {\n                continue;\n            }\n            if (distance2 - EPSILON < maxMajor + EPSILON && maxMajorPoints) {\n                continue;\n            }\n            if (!isInSegment.testCenter(point1, point2)) {\n                continue;\n            }\n            if (!isLineInSegment(point1, point2, isInSegment)) {\n                continue;\n            }\n            maxMajor = distance2 - EPSILON;\n            maxMajorPoints = [index1, index2];\n            maxMinor = 0;\n        }\n    }\n    if (!maxMajorPoints) {\n        return;\n    }\n    maxMajor = Math.sqrt(maxMajor + EPSILON);\n    const handle0 = points[maxMajorPoints[0]];\n    const handle1 = points[maxMajorPoints[1]];\n    const unitMajor = vec3.sub(vec3.create(), handle0, handle1);\n    vec3.scale(unitMajor, unitMajor, 1 / maxMajor);\n    let maxMinorPoints;\n    for (let index1 = 0; index1 < points.length; index1++) {\n        for (let index2 = index1 + 1; index2 < points.length; index2++) {\n            const point1 = points[index1];\n            const point2 = points[index2];\n            const distance2 = vec3.sqrDist(point1, point2);\n            if (distance2 <= maxMinor) {\n                continue;\n            }\n            const delta = vec3.sub(vec3.create(), point1, point2);\n            const dot = Math.abs(vec3.dot(delta, unitMajor)) / Math.sqrt(distance2);\n            if (dot > EPSILON) {\n                continue;\n            }\n            if (!isInSegment.testCenter(point1, point2)) {\n                continue;\n            }\n            if (!isLineInSegment(point1, point2, isInSegment)) {\n                continue;\n            }\n            maxMinor = distance2;\n            maxMinorPoints = [index1, index2];\n        }\n    }\n    if (!maxMinorPoints) {\n        return;\n    }\n    maxMinor = Math.sqrt(maxMinor);\n    const handle2 = points[maxMinorPoints[0]];\n    const handle3 = points[maxMinorPoints[1]];\n    const bidirectional = {\n        majorAxis: [handle0, handle1],\n        minorAxis: [handle2, handle3],\n        maxMajor,\n        maxMinor,\n        ...sliceContour,\n    };\n    return bidirectional;\n}\n","function floodFill(getter, seed, options = {}) {\n    const onFlood = options.onFlood;\n    const onBoundary = options.onBoundary;\n    const equals = options.equals;\n    const filter = options.filter;\n    const diagonals = options.diagonals || false;\n    const startNode = get(seed);\n    const permutations = prunedPermutations();\n    const stack = [];\n    const flooded = [];\n    const visits = new Set();\n    const bounds = options.bounds;\n    stack.push({ currentArgs: seed });\n    while (stack.length > 0) {\n        flood(stack.pop());\n    }\n    return {\n        flooded,\n    };\n    function flood(job) {\n        const getArgs = job.currentArgs;\n        const prevArgs = job.previousArgs;\n        if (visited(getArgs)) {\n            return;\n        }\n        markAsVisited(getArgs);\n        if (member(getArgs)) {\n            markAsFlooded(getArgs);\n            pushAdjacent(getArgs);\n        }\n        else {\n            markAsBoundary(prevArgs);\n        }\n    }\n    function visited(key) {\n        const [x, y, z = 0] = key;\n        const iKey = x + 32768 + 65536 * (y + 32768 + 65536 * (z + 32768));\n        return visits.has(iKey);\n    }\n    function markAsVisited(key) {\n        const [x, y, z = 0] = key;\n        const iKey = x + 32768 + 65536 * (y + 32768 + 65536 * (z + 32768));\n        visits.add(iKey);\n    }\n    function member(getArgs) {\n        const node = get(getArgs);\n        return equals ? equals(node, startNode) : node === startNode;\n    }\n    function markAsFlooded(getArgs) {\n        flooded.push(getArgs);\n        if (onFlood) {\n            onFlood(...getArgs);\n        }\n    }\n    function markAsBoundary(prevArgs) {\n        const [x, y, z = 0] = prevArgs;\n        const iKey = x + 32768 + 65536 * (y + 32768 + 65536 * (z + 32768));\n        bounds?.set(iKey, prevArgs);\n        if (onBoundary) {\n            onBoundary(...prevArgs);\n        }\n    }\n    function pushAdjacent(getArgs) {\n        for (let i = 0; i < permutations.length; i += 1) {\n            const perm = permutations[i];\n            const nextArgs = getArgs.slice(0);\n            for (let j = 0; j < getArgs.length; j += 1) {\n                nextArgs[j] += perm[j];\n            }\n            if (filter?.(nextArgs) === false) {\n                continue;\n            }\n            if (visited(nextArgs)) {\n                continue;\n            }\n            stack.push({\n                currentArgs: nextArgs,\n                previousArgs: getArgs,\n            });\n        }\n    }\n    function get(getArgs) {\n        return getter(...getArgs);\n    }\n    function prunedPermutations() {\n        const permutations = permute(seed.length);\n        return permutations.filter(function (perm) {\n            const count = countNonZeroes(perm);\n            return count !== 0 && (count === 1 || diagonals);\n        });\n    }\n    function permute(length) {\n        const perms = [];\n        const permutation = function (string) {\n            return string.split('').map(function (c) {\n                return parseInt(c, 10) - 1;\n            });\n        };\n        for (let i = 0; i < Math.pow(3, length); i += 1) {\n            const string = lpad(i.toString(3), '0', length);\n            perms.push(permutation(string));\n        }\n        return perms;\n    }\n}\nfunction countNonZeroes(array) {\n    let count = 0;\n    for (let i = 0; i < array.length; i += 1) {\n        if (array[i] !== 0) {\n            count += 1;\n        }\n    }\n    return count;\n}\nfunction lpad(string, character, length) {\n    const array = new Array(length + 1);\n    const pad = array.join(character);\n    return (pad + string).slice(-length);\n}\nexport default floodFill;\n","import { getToolGroup } from '../../store/ToolGroupManager';\nimport BrushTool from '../../tools/segmentation/BrushTool';\nexport function getBrushToolInstances(toolGroupId, toolName) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const toolInstances = toolGroup._toolInstances;\n    if (!Object.keys(toolInstances).length) {\n        return;\n    }\n    if (toolName && toolInstances[toolName]) {\n        return [toolInstances[toolName]];\n    }\n    const brushBasedToolInstances = Object.values(toolInstances).filter((toolInstance) => toolInstance instanceof BrushTool);\n    return brushBasedToolInstances;\n}\n","import { getAnnotation } from '../../stateManagement';\nimport { getSegmentation } from '../../stateManagement/segmentation/segmentationState';\nexport function getHoveredContourSegmentationAnnotation(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    const { annotationUIDsMap } = segmentation.representationData.Contour;\n    for (const [segmentIndex, annotationUIDs] of annotationUIDsMap.entries()) {\n        const highlightedAnnotationUID = Array.from(annotationUIDs).find((annotationUID) => getAnnotation(annotationUID).highlighted);\n        if (highlightedAnnotationUID) {\n            return segmentIndex;\n        }\n    }\n    return undefined;\n}\n","import { cache, volumeLoader, utilities as csUtils, } from '@cornerstonejs/core';\nfunction getOrCreateImageVolume(referencedImageIds) {\n    if (!referencedImageIds || referencedImageIds.length <= 1) {\n        return;\n    }\n    const isValidVolume = csUtils.isValidVolume(referencedImageIds);\n    if (!isValidVolume) {\n        return;\n    }\n    const volumeId = cache.generateVolumeId(referencedImageIds);\n    let imageVolume = cache.getVolume(volumeId);\n    if (imageVolume) {\n        return imageVolume;\n    }\n    imageVolume = volumeLoader.createAndCacheVolumeFromImagesSync(volumeId, referencedImageIds);\n    return imageVolume;\n}\nexport default getOrCreateImageVolume;\n","import { cache, volumeLoader, utilities, } from '@cornerstonejs/core';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nfunction getOrCreateSegmentationVolume(segmentationId) {\n    const { representationData } = getSegmentation(segmentationId);\n    let { volumeId } = representationData.Labelmap;\n    let segVolume;\n    if (volumeId) {\n        segVolume = cache.getVolume(volumeId);\n        if (segVolume) {\n            return segVolume;\n        }\n    }\n    const { imageIds: labelmapImageIds } = representationData.Labelmap;\n    volumeId = cache.generateVolumeId(labelmapImageIds);\n    if (!labelmapImageIds || labelmapImageIds.length === 1) {\n        return;\n    }\n    const isValidVolume = utilities.isValidVolume(labelmapImageIds);\n    if (!isValidVolume) {\n        return;\n    }\n    segVolume = volumeLoader.createAndCacheVolumeFromImagesSync(volumeId, labelmapImageIds);\n    return segVolume;\n}\nexport default getOrCreateSegmentationVolume;\n","import { cache } from '@cornerstonejs/core';\nexport function getReferenceVolumeForSegmentationVolume(segmentationVolumeId) {\n    const segmentationVolume = cache.getVolume(segmentationVolumeId);\n    if (!segmentationVolume) {\n        return null;\n    }\n    const referencedVolumeId = segmentationVolume.referencedVolumeId;\n    let imageVolume;\n    if (referencedVolumeId) {\n        imageVolume = cache.getVolume(referencedVolumeId);\n    }\n    else {\n        const imageIds = segmentationVolume.imageIds;\n        const image = cache.getImage(imageIds[0]);\n        const referencedImageId = image.referencedImageId;\n        const volumeInfo = cache.getVolumeContainingImageId(referencedImageId);\n        imageVolume = volumeInfo?.volume;\n    }\n    return imageVolume;\n}\n","import { BaseVolumeViewport, cache, utilities } from '@cornerstonejs/core';\nimport { getSegmentation, getCurrentLabelmapImageIdForViewport, } from '../../stateManagement/segmentation/segmentationState';\nimport { getLabelmapActorEntry } from '../../stateManagement/segmentation/helpers';\nexport function getSegmentIndexAtLabelmapBorder(segmentationId, worldPoint, { viewport, searchRadius }) {\n    const segmentation = getSegmentation(segmentationId);\n    const labelmapData = segmentation.representationData.Labelmap;\n    if (viewport instanceof BaseVolumeViewport) {\n        const { volumeId } = labelmapData;\n        const segmentationVolume = cache.getVolume(volumeId);\n        if (!segmentationVolume) {\n            return;\n        }\n        const voxelManager = segmentationVolume.voxelManager;\n        const imageData = segmentationVolume.imageData;\n        const indexIJK = utilities.transformWorldToIndex(imageData, worldPoint);\n        const segmentIndex = voxelManager.getAtIJK(indexIJK[0], indexIJK[1], indexIJK[2]);\n        const canvasPoint = viewport.worldToCanvas(worldPoint);\n        const onEdge = isSegmentOnEdgeCanvas(canvasPoint, segmentIndex, viewport, imageData, searchRadius);\n        return onEdge ? segmentIndex : undefined;\n    }\n    const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n    const image = cache.getImage(segmentationImageId);\n    if (!image) {\n        return;\n    }\n    const segmentationActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    const imageData = segmentationActorEntry?.actor.getMapper().getInputData();\n    const indexIJK = utilities.transformWorldToIndex(imageData, worldPoint);\n    const dimensions = imageData.getDimensions();\n    const voxelManager = (imageData.voxelManager ||\n        utilities.VoxelManager.createScalarVolumeVoxelManager({\n            dimensions,\n            scalarData: imageData.getPointData().getScalars().getData(),\n        }));\n    const segmentIndex = voxelManager.getAtIJKPoint(indexIJK);\n    const onEdge = isSegmentOnEdgeIJK(indexIJK, dimensions, voxelManager, segmentIndex);\n    return onEdge ? segmentIndex : undefined;\n}\nfunction isSegmentOnEdge(getNeighborIndex, segmentIndex, searchRadius = 1) {\n    const neighborRange = Array.from({ length: 2 * searchRadius + 1 }, (_, i) => i - searchRadius);\n    for (const deltaI of neighborRange) {\n        for (const deltaJ of neighborRange) {\n            for (const deltaK of neighborRange) {\n                if (deltaI === 0 && deltaJ === 0 && deltaK === 0) {\n                    continue;\n                }\n                const neighborIndex = getNeighborIndex(deltaI, deltaJ, deltaK);\n                if (neighborIndex !== undefined && segmentIndex !== neighborIndex) {\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\nfunction isSegmentOnEdgeIJK(indexIJK, dimensions, voxelManager, segmentIndex, searchRadius) {\n    const getNeighborIndex = (deltaI, deltaJ, deltaK) => {\n        const neighborIJK = [\n            indexIJK[0] + deltaI,\n            indexIJK[1] + deltaJ,\n            indexIJK[2] + deltaK,\n        ];\n        return voxelManager.getAtIJK(neighborIJK[0], neighborIJK[1], neighborIJK[2]);\n    };\n    return isSegmentOnEdge(getNeighborIndex, segmentIndex, searchRadius);\n}\nfunction isSegmentOnEdgeCanvas(canvasPoint, segmentIndex, viewport, imageData, searchRadius) {\n    const getNeighborIndex = (deltaI, deltaJ) => {\n        const neighborCanvas = [canvasPoint[0] + deltaI, canvasPoint[1] + deltaJ];\n        const worldPoint = viewport.canvasToWorld(neighborCanvas);\n        const voxelManager = imageData.get('voxelManager').voxelManager;\n        const indexIJK = utilities.transformWorldToIndex(imageData, worldPoint);\n        return voxelManager.getAtIJK(indexIJK[0], indexIJK[1], indexIJK[2]);\n    };\n    return isSegmentOnEdge(getNeighborIndex, segmentIndex, searchRadius);\n}\n","import { BaseVolumeViewport, cache, utilities } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getSegmentation, getCurrentLabelmapImageIdsForViewport, } from '../../stateManagement/segmentation/segmentationState';\nimport { getAnnotation } from '../../stateManagement';\nimport { isPointInsidePolyline3D } from '../math/polyline';\nimport { getLabelmapActorEntry } from '../../stateManagement/segmentation/helpers/getSegmentationActor';\nexport function getSegmentIndexAtWorldPoint(segmentationId, worldPoint, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    const representationData = segmentation.representationData;\n    const desiredRepresentation = options?.representationType ?? Object.keys(representationData)[0];\n    if (!desiredRepresentation) {\n        throw new Error(`Segmentation ${segmentationId} does not have any representations`);\n    }\n    switch (desiredRepresentation) {\n        case SegmentationRepresentations.Labelmap:\n            return getSegmentIndexAtWorldForLabelmap(segmentation, worldPoint, options);\n        case SegmentationRepresentations.Contour:\n            return getSegmentIndexAtWorldForContour(segmentation, worldPoint, options);\n        default:\n            return;\n    }\n}\nexport function getSegmentIndexAtWorldForLabelmap(segmentation, worldPoint, { viewport }) {\n    const labelmapData = segmentation.representationData.Labelmap;\n    if (viewport instanceof BaseVolumeViewport) {\n        const { volumeId } = labelmapData;\n        const segmentationVolume = cache.getVolume(volumeId);\n        if (!segmentationVolume) {\n            return;\n        }\n        const segmentIndex = segmentationVolume.imageData.getScalarValueFromWorld(worldPoint);\n        return segmentIndex;\n    }\n    const segmentationImageIds = getCurrentLabelmapImageIdsForViewport(viewport.id, segmentation.segmentationId);\n    if (segmentationImageIds.length > 1) {\n        console.warn('Segment selection for labelmaps with multiple imageIds in stack viewports is not supported yet.');\n        return;\n    }\n    const segmentationImageId = segmentationImageIds[0];\n    const image = cache.getImage(segmentationImageId);\n    if (!image) {\n        return;\n    }\n    const segmentationActorEntry = getLabelmapActorEntry(viewport.id, segmentation.segmentationId);\n    const imageData = segmentationActorEntry?.actor.getMapper().getInputData();\n    const indexIJK = utilities.transformWorldToIndex(imageData, worldPoint);\n    const dimensions = imageData.getDimensions();\n    const voxelManager = (imageData.voxelManager ||\n        utilities.VoxelManager.createScalarVolumeVoxelManager({\n            dimensions,\n            scalarData: imageData.getPointData().getScalars().getData(),\n        }));\n    const segmentIndex = voxelManager.getAtIJKPoint(indexIJK);\n    return segmentIndex;\n}\nexport function getSegmentIndexAtWorldForContour(segmentation, worldPoint, { viewport }) {\n    const contourData = segmentation.representationData.Contour;\n    const segmentIndices = Array.from(contourData.annotationUIDsMap.keys());\n    const { viewPlaneNormal } = viewport.getCamera();\n    for (const segmentIndex of segmentIndices) {\n        const annotationsSet = contourData.annotationUIDsMap.get(segmentIndex);\n        if (!annotationsSet) {\n            continue;\n        }\n        for (const annotationUID of annotationsSet) {\n            const annotation = getAnnotation(annotationUID);\n            if (!annotation) {\n                continue;\n            }\n            const { polyline } = annotation.data.contour;\n            if (!utilities.isEqual(viewPlaneNormal, annotation.metadata.viewPlaneNormal)) {\n                continue;\n            }\n            if (isPointInsidePolyline3D(worldPoint, polyline)) {\n                return Number(segmentIndex);\n            }\n        }\n    }\n}\n","import { getWebWorkerManager } from '@cornerstonejs/core';\nimport { WorkerTypes } from '../../enums';\nimport { registerComputeWorker } from '../registerComputeWorker';\nimport { triggerWorkerProgress, getSegmentationDataForWorker, prepareVolumeStrategyDataForWorker, prepareStackDataForWorker, } from './utilsForWorker';\nexport async function getSegmentLargestBidirectional({ segmentationId, segmentIndices, mode = 'individual', }) {\n    registerComputeWorker();\n    triggerWorkerProgress(WorkerTypes.COMPUTE_LARGEST_BIDIRECTIONAL, 0);\n    const segData = getSegmentationDataForWorker(segmentationId, segmentIndices);\n    if (!segData) {\n        return;\n    }\n    const { operationData, segImageIds, reconstructableVolume, indices } = segData;\n    const bidirectionalData = reconstructableVolume\n        ? await calculateVolumeBidirectional({\n            operationData,\n            indices,\n            mode,\n        })\n        : await calculateStackBidirectional({\n            segImageIds,\n            indices,\n            mode,\n        });\n    triggerWorkerProgress(WorkerTypes.COMPUTE_LARGEST_BIDIRECTIONAL, 100);\n    return bidirectionalData;\n}\nasync function calculateVolumeBidirectional({ operationData, indices, mode }) {\n    const strategyData = prepareVolumeStrategyDataForWorker(operationData);\n    const { segmentationVoxelManager, segmentationImageData } = strategyData;\n    const segmentationScalarData = segmentationVoxelManager.getCompleteScalarDataArray();\n    const segmentationInfo = {\n        scalarData: segmentationScalarData,\n        dimensions: segmentationImageData.getDimensions(),\n        spacing: segmentationImageData.getSpacing(),\n        origin: segmentationImageData.getOrigin(),\n        direction: segmentationImageData.getDirection(),\n    };\n    const bidirectionalData = await getWebWorkerManager().executeTask('compute', 'getSegmentLargestBidirectionalInternal', {\n        segmentationInfo,\n        indices,\n        mode,\n    });\n    return bidirectionalData;\n}\nasync function calculateStackBidirectional({ segImageIds, indices, mode }) {\n    const { segmentationInfo } = prepareStackDataForWorker(segImageIds);\n    const bidirectionalData = await getWebWorkerManager().executeTask('compute', 'getSegmentLargestBidirectionalInternal', {\n        segmentationInfo,\n        indices,\n        mode,\n        isStack: true,\n    });\n    return bidirectionalData;\n}\n","import { utilities, getWebWorkerManager } from '@cornerstonejs/core';\nimport { triggerWorkerProgress, getSegmentationDataForWorker, prepareVolumeStrategyDataForWorker, prepareStackDataForWorker, getImageReferenceInfo, } from './utilsForWorker';\nimport { getPixelValueUnitsImageId } from '../getPixelValueUnits';\nimport VolumetricCalculator from './VolumetricCalculator';\nimport { WorkerTypes } from '../../enums';\nimport { registerComputeWorker } from '../registerComputeWorker';\nconst radiusForVol1 = Math.pow((3 * 1000) / (4 * Math.PI), 1 / 3);\nasync function getStatistics({ segmentationId, segmentIndices, mode = 'collective', }) {\n    registerComputeWorker();\n    triggerWorkerProgress(WorkerTypes.COMPUTE_STATISTICS, 0);\n    const segData = getSegmentationDataForWorker(segmentationId, segmentIndices);\n    if (!segData) {\n        return;\n    }\n    const { operationData, segVolumeId, segImageIds, reconstructableVolume, indices, } = segData;\n    const { refImageId, modalityUnitOptions } = getImageReferenceInfo(segVolumeId, segImageIds);\n    const unit = getPixelValueUnitsImageId(refImageId, modalityUnitOptions);\n    const stats = reconstructableVolume\n        ? await calculateVolumeStatistics({\n            operationData,\n            indices,\n            unit,\n            mode,\n        })\n        : await calculateStackStatistics({\n            segImageIds,\n            indices,\n            unit,\n            mode,\n        });\n    return stats;\n}\nasync function calculateVolumeStatistics({ operationData, indices, unit, mode, }) {\n    const strategyData = prepareVolumeStrategyDataForWorker(operationData);\n    const { segmentationVoxelManager, imageVoxelManager, segmentationImageData, imageData, } = strategyData;\n    if (!segmentationVoxelManager || !segmentationImageData) {\n        return;\n    }\n    const spacing = segmentationImageData.getSpacing();\n    const { boundsIJK: boundsOrig } = segmentationVoxelManager;\n    if (!boundsOrig) {\n        return VolumetricCalculator.getStatistics({ spacing });\n    }\n    const segmentationScalarData = segmentationVoxelManager.getCompleteScalarDataArray();\n    const segmentationInfo = {\n        scalarData: segmentationScalarData,\n        dimensions: segmentationImageData.getDimensions(),\n        spacing: segmentationImageData.getSpacing(),\n        origin: segmentationImageData.getOrigin(),\n        direction: segmentationImageData.getDirection(),\n    };\n    const imageInfo = {\n        scalarData: imageVoxelManager.getCompleteScalarDataArray(),\n        dimensions: imageData.getDimensions(),\n        spacing: imageData.getSpacing(),\n        origin: imageData.getOrigin(),\n        direction: imageData.getDirection(),\n    };\n    const stats = await getWebWorkerManager().executeTask('compute', 'calculateSegmentsStatisticsVolume', {\n        segmentationInfo,\n        imageInfo,\n        indices,\n        mode,\n    });\n    triggerWorkerProgress(WorkerTypes.COMPUTE_STATISTICS, 100);\n    if (mode === 'collective') {\n        return processSegmentationStatistics({\n            stats,\n            unit,\n            spacing,\n            segmentationImageData,\n            imageVoxelManager,\n        });\n    }\n    else {\n        const finalStats = {};\n        Object.entries(stats).forEach(([segmentIndex, stat]) => {\n            finalStats[segmentIndex] = processSegmentationStatistics({\n                stats: stat,\n                unit,\n                spacing,\n                segmentationImageData,\n                imageVoxelManager,\n            });\n        });\n        return finalStats;\n    }\n}\nconst updateStatsArray = (stats, newStat) => {\n    if (!stats.array) {\n        return;\n    }\n    const existingIndex = stats.array.findIndex((stat) => stat.name === newStat.name);\n    if (existingIndex !== -1) {\n        stats.array[existingIndex] = newStat;\n    }\n    else {\n        stats.array.push(newStat);\n    }\n};\nconst processSegmentationStatistics = ({ stats, unit, spacing, segmentationImageData, imageVoxelManager, }) => {\n    stats.mean.unit = unit;\n    stats.max.unit = unit;\n    stats.min.unit = unit;\n    if (unit !== 'SUV') {\n        return stats;\n    }\n    const radiusIJK = spacing.map((s) => Math.max(1, Math.round((1.1 * radiusForVol1) / s)));\n    for (const testMax of stats.maxIJKs) {\n        const testStats = getSphereStats(testMax, radiusIJK, segmentationImageData, imageVoxelManager, spacing);\n        if (!testStats) {\n            continue;\n        }\n        const { mean } = testStats;\n        if (!stats.peakValue || stats.peakValue.value <= mean.value) {\n            stats.peakValue = {\n                name: 'peakValue',\n                label: 'Peak Value',\n                value: mean.value,\n                unit,\n            };\n            stats.peakPoint = {\n                name: 'peakLPS',\n                label: 'Peak SUV Point',\n                value: testMax.pointLPS ? [...testMax.pointLPS] : null,\n                unit: null,\n            };\n            updateStatsArray(stats, stats.peakValue);\n            updateStatsArray(stats, stats.peakPoint);\n        }\n    }\n    if (stats.volume && stats.mean) {\n        const mtv = stats.volume.value;\n        const suvMean = stats.mean.value;\n        stats.lesionGlycolysis = {\n            name: 'lesionGlycolysis',\n            label: 'Lesion Glycolysis',\n            value: mtv * suvMean,\n            unit: `${stats.volume.unit}·${unit}`,\n        };\n        updateStatsArray(stats, stats.lesionGlycolysis);\n    }\n    return stats;\n};\nasync function calculateStackStatistics({ segImageIds, indices, unit, mode }) {\n    triggerWorkerProgress(WorkerTypes.COMPUTE_STATISTICS, 0);\n    const { segmentationInfo, imageInfo } = prepareStackDataForWorker(segImageIds);\n    const stats = await getWebWorkerManager().executeTask('compute', 'calculateSegmentsStatisticsStack', {\n        segmentationInfo,\n        imageInfo,\n        indices,\n        mode,\n    });\n    triggerWorkerProgress(WorkerTypes.COMPUTE_STATISTICS, 100);\n    const spacing = segmentationInfo[0].spacing;\n    const segmentationImageData = segmentationInfo[0];\n    const imageVoxelManager = imageInfo[0].voxelManager;\n    if (mode === 'collective') {\n        return processSegmentationStatistics({\n            stats,\n            unit,\n            spacing,\n            segmentationImageData,\n            imageVoxelManager,\n        });\n    }\n    else {\n        const finalStats = {};\n        Object.entries(stats).forEach(([segmentIndex, stat]) => {\n            finalStats[segmentIndex] = processSegmentationStatistics({\n                stats: stat,\n                unit,\n                spacing,\n                segmentationImageData,\n                imageVoxelManager,\n            });\n        });\n        return finalStats;\n    }\n}\nfunction getSphereStats(testMax, radiusIJK, segData, imageVoxels, spacing) {\n    const { pointIJK: centerIJK, pointLPS: centerLPS } = testMax;\n    if (!centerIJK) {\n        return;\n    }\n    const boundsIJK = centerIJK.map((ijk, idx) => [\n        ijk - radiusIJK[idx],\n        ijk + radiusIJK[idx],\n    ]);\n    const testFunction = (_pointLPS, pointIJK) => {\n        const i = (pointIJK[0] - centerIJK[0]) / radiusIJK[0];\n        const j = (pointIJK[1] - centerIJK[1]) / radiusIJK[1];\n        const k = (pointIJK[2] - centerIJK[2]) / radiusIJK[2];\n        const radius = i * i + j * j + k * k;\n        return radius <= 1;\n    };\n    const statsFunction = ({ pointIJK, pointLPS }) => {\n        const value = imageVoxels.getAtIJKPoint(pointIJK);\n        if (value === undefined) {\n            return;\n        }\n        VolumetricCalculator.statsCallback({ value, pointLPS, pointIJK });\n    };\n    VolumetricCalculator.statsInit({ storePointData: false });\n    utilities.pointInShapeCallback(segData, {\n        pointInShapeFn: testFunction,\n        callback: statsFunction,\n        boundsIJK,\n    });\n    return VolumetricCalculator.getStatistics({ spacing });\n}\nexport default getStatistics;\n","import { cache } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getCachedSegmentIndices, setCachedSegmentIndices } from './utilities';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nfunction getUniqueSegmentIndices(segmentationId) {\n    const cachedResult = getCachedSegmentIndices(segmentationId);\n    if (cachedResult) {\n        return cachedResult;\n    }\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation found for segmentationId ${segmentationId}`);\n    }\n    let indices;\n    if (segmentation.representationData.Labelmap) {\n        indices = handleLabelmapSegmentation(segmentation, segmentationId);\n    }\n    else if (segmentation.representationData.Contour) {\n        indices = handleContourSegmentation(segmentation);\n    }\n    else if (segmentation.representationData.Surface) {\n        indices = handleSurfaceSegmentation(segmentation);\n    }\n    else {\n        throw new Error(`Unsupported segmentation type: ${segmentation.representationData}`);\n    }\n    setCachedSegmentIndices(segmentationId, indices);\n    return indices;\n}\nfunction handleLabelmapSegmentation(segmentation, segmentationId) {\n    const labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    const keySet = new Set();\n    if (labelmapData.imageIds) {\n        addImageSegmentIndices(keySet, labelmapData.imageIds);\n    }\n    else {\n        addVolumeSegmentIndices(keySet, segmentationId);\n    }\n    return Array.from(keySet)\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nfunction addVolumeSegmentIndices(keySet, segmentationId) {\n    const volume = cache.getVolume(segmentationId);\n    volume.voxelManager.forEach(({ value }) => {\n        if (value !== 0) {\n            keySet.add(value);\n        }\n    });\n}\nfunction addImageSegmentIndices(keySet, imageIds) {\n    imageIds.forEach((segmentationImageId) => {\n        const image = cache.getImage(segmentationImageId);\n        const scalarData = image.voxelManager.getScalarData();\n        scalarData.forEach((segmentIndex) => {\n            if (segmentIndex !== 0) {\n                keySet.add(segmentIndex);\n            }\n        });\n    });\n}\nfunction handleContourSegmentation(segmentation) {\n    const { annotationUIDsMap, geometryIds } = segmentation.representationData.Contour || {};\n    if (!geometryIds) {\n        throw new Error(`No geometryIds found for segmentationId ${segmentation.segmentationId}`);\n    }\n    const indices = new Set([...annotationUIDsMap.keys()]);\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        indices.add(geometry.data.segmentIndex);\n    });\n    return Array.from(indices).sort((a, b) => a - b);\n}\nfunction handleSurfaceSegmentation(segmentation) {\n    const geometryIds = segmentation.representationData.Surface?.geometryIds ?? [];\n    return Array.from(geometryIds.keys())\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nexport { getUniqueSegmentIndices };\n","const shader = `\nconst MAX_STRENGTH = 65535f;\n\n// Workgroup size - X*Y*Z must be multiple of 32 for better performance\noverride workGroupSizeX = 1u;\noverride workGroupSizeY = 1u;\noverride workGroupSizeZ = 1u;\n\n// Compare the current voxel to neighbors using a 9x9x9 window\noverride windowSize = 9i;\n\nstruct Params {\n  size: vec3u,\n  iteration: u32,\n}\n\n// New structure to track bounds of modified voxels\nstruct Bounds {\n  minX: atomic<i32>,\n  minY: atomic<i32>,\n  minZ: atomic<i32>,\n  maxX: atomic<i32>,\n  maxY: atomic<i32>,\n  maxZ: atomic<i32>,\n}\n\n@group(0) @binding(0) var<uniform> params: Params;\n@group(0) @binding(1) var<storage> volumePixelData: array<f32>;\n@group(0) @binding(2) var<storage, read_write> labelmap: array<u32>;\n@group(0) @binding(3) var<storage, read_write> strengthData: array<f32>;\n@group(0) @binding(4) var<storage> prevLabelmap: array<u32>;\n@group(0) @binding(5) var<storage> prevStrengthData: array<f32>;\n@group(0) @binding(6) var<storage, read_write> updatedVoxelsCounter: array<atomic<u32>>;\n@group(0) @binding(7) var<storage, read_write> modifiedBounds: Bounds;\n\nfn getPixelIndex(ijkPos: vec3u) -> u32 {\n  let numPixelsPerSlice = params.size.x * params.size.y;\n  return ijkPos.x + ijkPos.y * params.size.x + ijkPos.z * numPixelsPerSlice;\n}\n\nfn updateBounds(position: vec3i) {\n  // Atomically update min bounds (use min operation)\n  let oldMinX = atomicMin(&modifiedBounds.minX, position.x);\n  let oldMinY = atomicMin(&modifiedBounds.minY, position.y);\n  let oldMinZ = atomicMin(&modifiedBounds.minZ, position.z);\n\n  // Atomically update max bounds (use max operation)\n  let oldMaxX = atomicMax(&modifiedBounds.maxX, position.x);\n  let oldMaxY = atomicMax(&modifiedBounds.maxY, position.y);\n  let oldMaxZ = atomicMax(&modifiedBounds.maxZ, position.z);\n}\n\n@compute @workgroup_size(workGroupSizeX, workGroupSizeY, workGroupSizeZ)\nfn main(\n  @builtin(global_invocation_id) globalId: vec3u,\n) {\n  // Make sure it will not get out of bounds for volume with sizes that\n  // are not multiple of workGroupSize\n  if (\n    globalId.x >= params.size.x ||\n    globalId.y >= params.size.y ||\n    globalId.z >= params.size.z\n  ) {\n    return;\n  }\n\n  // Initialize bounds for the first iteration\n  if (params.iteration == 0 && globalId.x == 0 && globalId.y == 0 && globalId.z == 0) {\n    // Initialize to opposite extremes to ensure any update will improve the bounds\n    atomicStore(&modifiedBounds.minX, i32(params.size.x));\n    atomicStore(&modifiedBounds.minY, i32(params.size.y));\n    atomicStore(&modifiedBounds.minZ, i32(params.size.z));\n    atomicStore(&modifiedBounds.maxX, -1);\n    atomicStore(&modifiedBounds.maxY, -1);\n    atomicStore(&modifiedBounds.maxZ, -1);\n  }\n\n  let currentCoord = vec3i(globalId);\n  let currentPixelIndex = getPixelIndex(globalId);\n\n  let numPixels = arrayLength(&volumePixelData);\n  let currentPixelValue = volumePixelData[currentPixelIndex];\n\n  if (params.iteration == 0) {\n    // All non-zero initial labels are given maximum strength\n    strengthData[currentPixelIndex] = select(MAX_STRENGTH, 0., labelmap[currentPixelIndex] == 0);\n\n    // Update bounds for non-zero initial labels\n    if (labelmap[currentPixelIndex] != 0) {\n      updateBounds(currentCoord);\n    }\n    return;\n  }\n\n  // It should at least copy the values from previous state\n  var newLabel = prevLabelmap[currentPixelIndex];\n  var newStrength = prevStrengthData[currentPixelIndex];\n\n  let window = i32(ceil(f32(windowSize - 1) * .5));\n  let minWindow = -1i * window;\n  let maxWindow = 1i * window;\n\n  for (var k = minWindow; k <= maxWindow; k++) {\n    for (var j = minWindow; j <= maxWindow; j++) {\n      for (var i = minWindow; i <= maxWindow; i++) {\n        // Skip current voxel\n        if (i == 0 && j == 0 && k == 0) {\n          continue;\n        }\n\n        let neighborCoord = currentCoord + vec3i(i, j, k);\n\n        //  Boundary conditions. Do not grow outside of the volume\n        if (\n          neighborCoord.x < 0i || neighborCoord.x >= i32(params.size.x) ||\n          neighborCoord.y < 0i || neighborCoord.y >= i32(params.size.y) ||\n          neighborCoord.z < 0i || neighborCoord.z >= i32(params.size.z)\n        ) {\n          continue;\n        }\n\n        let neighborIndex = getPixelIndex(vec3u(neighborCoord));\n        let neighborPixelValue = volumePixelData[neighborIndex];\n        let prevNeighborStrength = prevStrengthData[neighborIndex];\n        let strengthCost = abs(neighborPixelValue - currentPixelValue);\n        let takeoverStrength = prevNeighborStrength - strengthCost;\n\n        if (takeoverStrength > newStrength) {\n          newLabel = prevLabelmap[neighborIndex];\n          newStrength = takeoverStrength;\n        }\n      }\n    }\n  }\n\n  if (labelmap[currentPixelIndex] != newLabel) {\n    atomicAdd(&updatedVoxelsCounter[params.iteration], 1u);\n\n    // Update bounds for modified voxels\n    updateBounds(currentCoord);\n  }\n\n  labelmap[currentPixelIndex] = newLabel;\n  strengthData[currentPixelIndex] = newStrength;\n}\n`;\nexport default shader;\n","import { cache } from '@cornerstonejs/core';\nimport shaderCode from './growCutShader';\nconst GB = 1024 * 1024 * 1024;\nconst WEBGPU_MEMORY_LIMIT = 1.99 * GB;\nconst DEFAULT_GROWCUT_OPTIONS = {\n    windowSize: 3,\n    maxProcessingTime: 30000,\n    inspection: {\n        numCyclesInterval: 5,\n        numCyclesBelowThreshold: 3,\n        threshold: 1e-4,\n    },\n};\nasync function runGrowCut(referenceVolumeId, labelmapVolumeId, options = DEFAULT_GROWCUT_OPTIONS) {\n    const workGroupSize = [8, 8, 4];\n    const { windowSize, maxProcessingTime } = Object.assign({}, DEFAULT_GROWCUT_OPTIONS, options);\n    const inspection = Object.assign({}, DEFAULT_GROWCUT_OPTIONS.inspection, options.inspection);\n    const volume = cache.getVolume(referenceVolumeId);\n    const labelmap = cache.getVolume(labelmapVolumeId);\n    const [columns, rows, numSlices] = volume.dimensions;\n    if (labelmap.dimensions[0] !== columns ||\n        labelmap.dimensions[1] !== rows ||\n        labelmap.dimensions[2] !== numSlices) {\n        throw new Error('Volume and labelmap must have the same size');\n    }\n    let numIterations = Math.floor(Math.sqrt(rows ** 2 + columns ** 2 + numSlices ** 2) / 2);\n    numIterations = Math.min(numIterations, 500);\n    const labelmapData = labelmap.voxelManager.getCompleteScalarDataArray();\n    let volumePixelData = volume.voxelManager.getCompleteScalarDataArray();\n    if (!(volumePixelData instanceof Float32Array)) {\n        volumePixelData = new Float32Array(volumePixelData);\n    }\n    const requiredLimits = {\n        maxStorageBufferBindingSize: WEBGPU_MEMORY_LIMIT,\n        maxBufferSize: WEBGPU_MEMORY_LIMIT,\n    };\n    const adapter = await navigator.gpu?.requestAdapter();\n    const device = await adapter.requestDevice({ requiredLimits });\n    const BUFFER_SIZE = volumePixelData.byteLength;\n    const UPDATED_VOXELS_COUNTER_BUFFER_SIZE = numIterations * Uint32Array.BYTES_PER_ELEMENT;\n    const BOUNDS_BUFFER_SIZE = 6 * Int32Array.BYTES_PER_ELEMENT;\n    const shaderModule = device.createShaderModule({\n        code: shaderCode,\n    });\n    const numIterationIndex = 3;\n    const paramsArrayValues = new Uint32Array([\n        columns,\n        rows,\n        numSlices,\n        0,\n    ]);\n    const gpuParamsBuffer = device.createBuffer({\n        size: paramsArrayValues.byteLength,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n    const gpuVolumePixelDataBuffer = device.createBuffer({\n        size: BUFFER_SIZE,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n    device.queue.writeBuffer(gpuVolumePixelDataBuffer, 0, volumePixelData);\n    const gpuLabelmapBuffers = [0, 1].map(() => device.createBuffer({\n        size: BUFFER_SIZE,\n        usage: GPUBufferUsage.STORAGE |\n            GPUBufferUsage.COPY_SRC |\n            GPUBufferUsage.COPY_DST,\n    }));\n    device.queue.writeBuffer(gpuLabelmapBuffers[0], 0, new Uint32Array(labelmapData));\n    const gpuStrengthBuffers = [0, 1].map(() => {\n        const strengthBuffer = device.createBuffer({\n            size: BUFFER_SIZE,\n            usage: GPUBufferUsage.STORAGE |\n                GPUBufferUsage.COPY_SRC |\n                GPUBufferUsage.COPY_DST,\n        });\n        return strengthBuffer;\n    });\n    const gpuCounterBuffer = device.createBuffer({\n        size: UPDATED_VOXELS_COUNTER_BUFFER_SIZE,\n        usage: GPUBufferUsage.STORAGE |\n            GPUBufferUsage.COPY_SRC |\n            GPUBufferUsage.COPY_DST,\n    });\n    const gpuBoundsBuffer = device.createBuffer({\n        size: BOUNDS_BUFFER_SIZE,\n        usage: GPUBufferUsage.STORAGE |\n            GPUBufferUsage.COPY_SRC |\n            GPUBufferUsage.COPY_DST,\n    });\n    const initialBounds = new Int32Array([\n        columns,\n        rows,\n        numSlices,\n        -1,\n        -1,\n        -1,\n    ]);\n    device.queue.writeBuffer(gpuBoundsBuffer, 0, initialBounds);\n    const bindGroupLayout = device.createBindGroupLayout({\n        entries: [\n            {\n                binding: 0,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'uniform',\n                },\n            },\n            {\n                binding: 1,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'read-only-storage',\n                },\n            },\n            {\n                binding: 2,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'storage',\n                },\n            },\n            {\n                binding: 3,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'storage',\n                },\n            },\n            {\n                binding: 4,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'read-only-storage',\n                },\n            },\n            {\n                binding: 5,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'read-only-storage',\n                },\n            },\n            {\n                binding: 6,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'storage',\n                },\n            },\n            {\n                binding: 7,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: {\n                    type: 'storage',\n                },\n            },\n        ],\n    });\n    const bindGroups = [0, 1].map((i) => {\n        const outputLabelmapBuffer = gpuLabelmapBuffers[i];\n        const outputStrengthBuffer = gpuStrengthBuffers[i];\n        const previouLabelmapBuffer = gpuLabelmapBuffers[(i + 1) % 2];\n        const previousStrengthBuffer = gpuStrengthBuffers[(i + 1) % 2];\n        return device.createBindGroup({\n            layout: bindGroupLayout,\n            entries: [\n                {\n                    binding: 0,\n                    resource: {\n                        buffer: gpuParamsBuffer,\n                    },\n                },\n                {\n                    binding: 1,\n                    resource: {\n                        buffer: gpuVolumePixelDataBuffer,\n                    },\n                },\n                {\n                    binding: 2,\n                    resource: {\n                        buffer: outputLabelmapBuffer,\n                    },\n                },\n                {\n                    binding: 3,\n                    resource: {\n                        buffer: outputStrengthBuffer,\n                    },\n                },\n                {\n                    binding: 4,\n                    resource: {\n                        buffer: previouLabelmapBuffer,\n                    },\n                },\n                {\n                    binding: 5,\n                    resource: {\n                        buffer: previousStrengthBuffer,\n                    },\n                },\n                {\n                    binding: 6,\n                    resource: {\n                        buffer: gpuCounterBuffer,\n                    },\n                },\n                {\n                    binding: 7,\n                    resource: {\n                        buffer: gpuBoundsBuffer,\n                    },\n                },\n            ],\n        });\n    });\n    const pipeline = device.createComputePipeline({\n        layout: device.createPipelineLayout({\n            bindGroupLayouts: [bindGroupLayout],\n        }),\n        compute: {\n            module: shaderModule,\n            entryPoint: 'main',\n            constants: {\n                workGroupSizeX: workGroupSize[0],\n                workGroupSizeY: workGroupSize[1],\n                workGroupSizeZ: workGroupSize[2],\n                windowSize,\n            },\n        },\n    });\n    const numWorkGroups = [\n        Math.ceil(columns / workGroupSize[0]),\n        Math.ceil(rows / workGroupSize[1]),\n        Math.ceil(numSlices / workGroupSize[2]),\n    ];\n    const gpuUpdatedVoxelsCounterStagingBuffer = device.createBuffer({\n        size: UPDATED_VOXELS_COUNTER_BUFFER_SIZE,\n        usage: GPUBufferUsage.MAP_READ | GPUBufferUsage.COPY_DST,\n    });\n    const limitProcessingTime = maxProcessingTime\n        ? performance.now() + maxProcessingTime\n        : 0;\n    let currentInspectionNumCyclesInterval = inspection.numCyclesInterval;\n    let belowThresholdCounter = 0;\n    for (let i = 0; i < numIterations; i++) {\n        paramsArrayValues[numIterationIndex] = i;\n        device.queue.writeBuffer(gpuParamsBuffer, 0, paramsArrayValues);\n        const commandEncoder = device.createCommandEncoder();\n        const passEncoder = commandEncoder.beginComputePass();\n        passEncoder.setPipeline(pipeline);\n        passEncoder.setBindGroup(0, bindGroups[i % 2]);\n        passEncoder.dispatchWorkgroups(numWorkGroups[0], numWorkGroups[1], numWorkGroups[2]);\n        passEncoder.end();\n        commandEncoder.copyBufferToBuffer(gpuCounterBuffer, i * Uint32Array.BYTES_PER_ELEMENT, gpuUpdatedVoxelsCounterStagingBuffer, i * Uint32Array.BYTES_PER_ELEMENT, Uint32Array.BYTES_PER_ELEMENT);\n        device.queue.submit([commandEncoder.finish()]);\n        const inspect = i > 0 && !(i % currentInspectionNumCyclesInterval);\n        if (inspect) {\n            await gpuUpdatedVoxelsCounterStagingBuffer.mapAsync(GPUMapMode.READ, 0, UPDATED_VOXELS_COUNTER_BUFFER_SIZE);\n            const updatedVoxelsCounterResultBuffer = gpuUpdatedVoxelsCounterStagingBuffer.getMappedRange(0, UPDATED_VOXELS_COUNTER_BUFFER_SIZE);\n            const updatedVoxelsCounterBufferData = new Uint32Array(updatedVoxelsCounterResultBuffer.slice(0));\n            const updatedVoxelsRatio = updatedVoxelsCounterBufferData[i] / volumePixelData.length;\n            gpuUpdatedVoxelsCounterStagingBuffer.unmap();\n            if (i >= 1 && updatedVoxelsRatio < inspection.threshold) {\n                currentInspectionNumCyclesInterval = 1;\n                belowThresholdCounter++;\n                if (belowThresholdCounter === inspection.numCyclesBelowThreshold) {\n                    break;\n                }\n            }\n            else {\n                currentInspectionNumCyclesInterval = inspection.numCyclesInterval;\n            }\n        }\n        if (limitProcessingTime && performance.now() > limitProcessingTime) {\n            console.warn(`Exceeded processing time limit (${maxProcessingTime})ms`);\n            break;\n        }\n    }\n    const commandEncoder = device.createCommandEncoder();\n    const outputLabelmapBufferIndex = (numIterations + 1) % 2;\n    const labelmapStagingBuffer = device.createBuffer({\n        size: BUFFER_SIZE,\n        usage: GPUBufferUsage.MAP_READ | GPUBufferUsage.COPY_DST,\n    });\n    const boundsStagingBuffer = device.createBuffer({\n        size: BOUNDS_BUFFER_SIZE,\n        usage: GPUBufferUsage.MAP_READ | GPUBufferUsage.COPY_DST,\n    });\n    commandEncoder.copyBufferToBuffer(gpuLabelmapBuffers[outputLabelmapBufferIndex], 0, labelmapStagingBuffer, 0, BUFFER_SIZE);\n    commandEncoder.copyBufferToBuffer(gpuBoundsBuffer, 0, boundsStagingBuffer, 0, BOUNDS_BUFFER_SIZE);\n    device.queue.submit([commandEncoder.finish()]);\n    await labelmapStagingBuffer.mapAsync(GPUMapMode.READ, 0, BUFFER_SIZE);\n    const labelmapResultBuffer = labelmapStagingBuffer.getMappedRange(0, BUFFER_SIZE);\n    const labelmapResult = new Uint32Array(labelmapResultBuffer);\n    labelmapData.set(labelmapResult);\n    labelmapStagingBuffer.unmap();\n    await boundsStagingBuffer.mapAsync(GPUMapMode.READ, 0, BOUNDS_BUFFER_SIZE);\n    const boundsResultBuffer = boundsStagingBuffer.getMappedRange(0, BOUNDS_BUFFER_SIZE);\n    const boundsResult = new Int32Array(boundsResultBuffer.slice(0));\n    boundsStagingBuffer.unmap();\n    const minX = boundsResult[0];\n    const minY = boundsResult[1];\n    const minZ = boundsResult[2];\n    const maxX = boundsResult[3];\n    const maxY = boundsResult[4];\n    const maxZ = boundsResult[5];\n    labelmap.voxelManager.setCompleteScalarDataArray(labelmapData);\n    labelmap.voxelManager.clearBounds();\n    labelmap.voxelManager.setBounds([\n        [minX, maxX],\n        [minY, maxY],\n        [minZ, maxZ],\n    ]);\n}\nexport { runGrowCut as default, runGrowCut as run };\n","import { volumeLoader, utilities as csUtils } from '@cornerstonejs/core';\nimport { run } from './runGrowCut';\nconst POSITIVE_SEED_VALUE = 254;\nconst NEGATIVE_SEED_VALUE = 255;\nconst NEGATIVE_PIXEL_RANGE = [-Infinity, -995];\nconst POSITIVE_PIXEL_RANGE = [0, 1900];\nfunction _setNegativeSeedValues(subVolume, labelmap, options) {\n    const { negativeSeedValue = NEGATIVE_SEED_VALUE, negativePixelRange = NEGATIVE_PIXEL_RANGE, } = options;\n    const subVolPixelData = subVolume.voxelManager.getCompleteScalarDataArray();\n    const [width, height, numSlices] = labelmap.dimensions;\n    const middleSliceIndex = Math.floor(numSlices / 2);\n    const visited = new Array(width * height).fill(false);\n    const sliceOffset = middleSliceIndex * width * height;\n    const bfs = (startX, startY) => {\n        const queue = [[startX, startY]];\n        while (queue.length) {\n            const [x, y] = queue.shift();\n            const slicePixelIndex = y * width + x;\n            if (x < 0 ||\n                x >= width ||\n                y < 0 ||\n                y >= height ||\n                visited[slicePixelIndex]) {\n                continue;\n            }\n            visited[slicePixelIndex] = true;\n            const volumeVoxelIndex = sliceOffset + slicePixelIndex;\n            const volumeVoxelValue = subVolPixelData[volumeVoxelIndex];\n            if (volumeVoxelValue < negativePixelRange[0] ||\n                volumeVoxelValue > negativePixelRange[1]) {\n                continue;\n            }\n            labelmap.voxelManager.setAtIndex(volumeVoxelIndex, negativeSeedValue);\n            queue.push([x - 1, y]);\n            queue.push([x + 1, y]);\n            queue.push([x, y - 1]);\n            queue.push([x, y + 1]);\n        }\n    };\n    const scanLine = (startX, limitX, incX, y) => {\n        for (let x = startX; x !== limitX; x += incX) {\n            const slicePixelIndex = y * width + x;\n            const volumeVoxelIndex = sliceOffset + slicePixelIndex;\n            const volumeVoxelValue = subVolPixelData[volumeVoxelIndex];\n            if (volumeVoxelValue < negativePixelRange[0] ||\n                volumeVoxelValue > negativePixelRange[1]) {\n                break;\n            }\n            if (!visited[slicePixelIndex]) {\n                bfs(x, y);\n            }\n        }\n    };\n    for (let y = 0; y < height; y++) {\n        scanLine(0, width - 1, 1, y);\n        scanLine(width - 1, 0, -1, y);\n    }\n}\nfunction _setPositiveSeedValues(subVolume, labelmap, options) {\n    const { positiveSeedValue = POSITIVE_SEED_VALUE, positivePixelRange = POSITIVE_PIXEL_RANGE, } = options;\n    const subVolPixelData = subVolume.voxelManager.getCompleteScalarDataArray();\n    const labelmapData = labelmap.voxelManager.getCompleteScalarDataArray();\n    const [width, height, numSlices] = labelmap.dimensions;\n    const middleSliceIndex = Math.floor(numSlices / 2);\n    const startSliceIndex = Math.max(middleSliceIndex - 3, 0);\n    const stopSliceIndex = Math.max(startSliceIndex + 5, numSlices);\n    const pixelsPerSlice = width * height;\n    for (let z = startSliceIndex; z < stopSliceIndex; z++) {\n        const zOffset = z * pixelsPerSlice;\n        for (let y = 0; y < height; y++) {\n            const yOffset = y * width;\n            for (let x = 0; x < width; x++) {\n                const index = zOffset + yOffset + x;\n                const pixelValue = subVolPixelData[index];\n                const isPositiveValue = pixelValue >= positivePixelRange[0] &&\n                    pixelValue <= positivePixelRange[1];\n                if (isPositiveValue) {\n                    labelmap.voxelManager.setAtIndex(index, positiveSeedValue);\n                }\n            }\n        }\n    }\n}\nasync function _createAndCacheSegmentationSubVolumeForBoundingBox(subVolume, options) {\n    const labelmap = volumeLoader.createAndCacheDerivedLabelmapVolume(subVolume.volumeId);\n    _setPositiveSeedValues(subVolume, labelmap, options);\n    _setNegativeSeedValues(subVolume, labelmap, options);\n    return labelmap;\n}\nasync function runGrowCutForBoundingBox(referencedVolumeId, boundingBoxInfo, options) {\n    const { boundingBox } = boundingBoxInfo;\n    const { ijkTopLeft, ijkBottomRight } = boundingBox;\n    const subVolumeBoundsIJK = {\n        minX: ijkTopLeft[0],\n        maxX: ijkBottomRight[0],\n        minY: ijkTopLeft[1],\n        maxY: ijkBottomRight[1],\n        minZ: ijkTopLeft[2],\n        maxZ: ijkBottomRight[2],\n    };\n    const subVolume = csUtils.createSubVolume(referencedVolumeId, subVolumeBoundsIJK, {\n        targetBuffer: {\n            type: 'Float32Array',\n        },\n    });\n    const labelmap = await _createAndCacheSegmentationSubVolumeForBoundingBox(subVolume, options);\n    await run(subVolume.volumeId, labelmap.volumeId);\n    return labelmap;\n}\nexport { runGrowCutForBoundingBox as default, runGrowCutForBoundingBox };\n","import { quat, vec3 } from 'gl-matrix';\nimport { utilities as csUtils, cache, volumeLoader } from '@cornerstonejs/core';\nimport { run } from './runGrowCut';\nimport { getSphereBoundsInfo } from '../../getSphereBoundsInfo';\nconst { transformWorldToIndex } = csUtils;\nconst POSITIVE_SEED_VALUE = 254;\nconst NEGATIVE_SEED_VALUE = 255;\nconst POSITIVE_SEED_VARIANCE = 0.1;\nconst NEGATIVE_SEED_VARIANCE = 0.8;\nfunction _getGrowCutSphereBoundsInfo(referencedVolume, sphereBoundsInfo) {\n    const { topLeftWorld, bottomRightWorld } = sphereBoundsInfo;\n    const topLeftIJK = transformWorldToIndex(referencedVolume.imageData, topLeftWorld);\n    const bottomRightIJK = transformWorldToIndex(referencedVolume.imageData, bottomRightWorld);\n    return {\n        ...sphereBoundsInfo,\n        topLeftIJK,\n        bottomRightIJK,\n    };\n}\nfunction _getSphereBoundsInfo(referencedVolume, sphereInfo) {\n    const direction = referencedVolume.imageData.getDirection();\n    const vecColumn = vec3.fromValues(direction[3], direction[4], direction[5]);\n    const { center: sphereCenterPoint, radius: sphereRadius } = sphereInfo;\n    const refVolImageData = referencedVolume.imageData;\n    const topCirclePoint = vec3.scaleAndAdd(vec3.create(), sphereCenterPoint, vecColumn, -sphereRadius);\n    const bottomCirclePoint = vec3.scaleAndAdd(vec3.create(), sphereCenterPoint, vecColumn, sphereRadius);\n    const sphereBoundsInfo = getSphereBoundsInfo([bottomCirclePoint, topCirclePoint], refVolImageData);\n    return _getGrowCutSphereBoundsInfo(referencedVolume, sphereBoundsInfo);\n}\nfunction _createSubVolumeFromSphere(referencedVolume, sphereInfo, viewport) {\n    const refVolImageData = referencedVolume.imageData;\n    const camera = viewport.getCamera();\n    const { ijkVecRowDir, ijkVecColDir } = csUtils.getVolumeDirectionVectors(refVolImageData, camera);\n    const obliqueView = [ijkVecRowDir, ijkVecColDir].some((vec) => !csUtils.isEqual(Math.abs(vec[0]), 1) &&\n        !csUtils.isEqual(Math.abs(vec[1]), 1) &&\n        !csUtils.isEqual(Math.abs(vec[2]), 1));\n    if (obliqueView) {\n        console.warn('Oblique view is not supported!');\n        return;\n    }\n    const { boundsIJK: sphereBoundsIJK } = _getSphereBoundsInfo(referencedVolume, sphereInfo);\n    const subVolumeBoundsIJK = {\n        minX: sphereBoundsIJK[0][0],\n        maxX: sphereBoundsIJK[0][1] + 1,\n        minY: sphereBoundsIJK[1][0],\n        maxY: sphereBoundsIJK[1][1] + 1,\n        minZ: sphereBoundsIJK[2][0],\n        maxZ: sphereBoundsIJK[2][1] + 1,\n    };\n    return csUtils.createSubVolume(referencedVolume.volumeId, subVolumeBoundsIJK, {\n        targetBuffer: {\n            type: 'Float32Array',\n        },\n    });\n}\nfunction _setPositiveSeedValues(referencedVolume, labelmap, sphereInfo, options) {\n    const refVolumePixelData = referencedVolume.voxelManager.getCompleteScalarDataArray();\n    const worldStartPos = sphereInfo.center;\n    const [width, height, numSlices] = referencedVolume.dimensions;\n    const numPixelsPerSlice = width * height;\n    const ijkStartPosition = transformWorldToIndex(referencedVolume.imageData, worldStartPos);\n    const referencePixelValue = refVolumePixelData[ijkStartPosition[2] * numPixelsPerSlice +\n        ijkStartPosition[1] * width +\n        ijkStartPosition[0]];\n    const positiveSeedValue = options.positiveSeedValue ?? POSITIVE_SEED_VALUE;\n    const positiveSeedVariance = options.positiveSeedVariance ?? POSITIVE_SEED_VARIANCE;\n    const positiveSeedVarianceValue = Math.abs(referencePixelValue * positiveSeedVariance);\n    const minPositivePixelValue = referencePixelValue - positiveSeedVarianceValue;\n    const maxPositivePixelValue = referencePixelValue + positiveSeedVarianceValue;\n    const neighborsCoordDelta = [\n        [-1, 0, 0],\n        [1, 0, 0],\n        [0, -1, 0],\n        [0, 1, 0],\n        [0, 0, -1],\n        [0, 0, 1],\n    ];\n    const startVoxelIndex = ijkStartPosition[2] * numPixelsPerSlice +\n        ijkStartPosition[1] * width +\n        ijkStartPosition[0];\n    labelmap.voxelManager.setAtIndex(startVoxelIndex, positiveSeedValue);\n    const queue = [ijkStartPosition];\n    while (queue.length) {\n        const ijkVoxel = queue.shift();\n        const [x, y, z] = ijkVoxel;\n        for (let i = 0, len = neighborsCoordDelta.length; i < len; i++) {\n            const neighborCoordDelta = neighborsCoordDelta[i];\n            const nx = x + neighborCoordDelta[0];\n            const ny = y + neighborCoordDelta[1];\n            const nz = z + neighborCoordDelta[2];\n            if (nx < 0 ||\n                nx >= width ||\n                ny < 0 ||\n                ny >= height ||\n                nz < 0 ||\n                nz >= numSlices) {\n                continue;\n            }\n            const neighborVoxelIndex = nz * numPixelsPerSlice + ny * width + nx;\n            const neighborPixelValue = refVolumePixelData[neighborVoxelIndex];\n            const neighborLabelmapValue = labelmap.voxelManager.getAtIndex(neighborVoxelIndex);\n            if (neighborLabelmapValue === positiveSeedValue ||\n                neighborPixelValue < minPositivePixelValue ||\n                neighborPixelValue > maxPositivePixelValue) {\n                continue;\n            }\n            labelmap.voxelManager.setAtIndex(neighborVoxelIndex, positiveSeedValue);\n            queue.push([nx, ny, nz]);\n        }\n    }\n}\nfunction _setNegativeSeedValues(subVolume, labelmap, sphereInfo, viewport, options) {\n    const subVolPixelData = subVolume.voxelManager.getCompleteScalarDataArray();\n    const [columns, rows, numSlices] = labelmap.dimensions;\n    const numPixelsPerSlice = columns * rows;\n    const { worldVecRowDir, worldVecSliceDir } = csUtils.getVolumeDirectionVectors(labelmap.imageData, viewport.getCamera());\n    const ijkSphereCenter = transformWorldToIndex(subVolume.imageData, sphereInfo.center);\n    const referencePixelValue = subVolPixelData[ijkSphereCenter[2] * columns * rows +\n        ijkSphereCenter[1] * columns +\n        ijkSphereCenter[0]];\n    const negativeSeedVariance = options.negativeSeedVariance ?? NEGATIVE_SEED_VARIANCE;\n    const negativeSeedValue = options?.negativeSeedValue ?? NEGATIVE_SEED_VALUE;\n    const negativeSeedVarianceValue = Math.abs(referencePixelValue * negativeSeedVariance);\n    const minNegativePixelValue = referencePixelValue - negativeSeedVarianceValue;\n    const maxNegativePixelValue = referencePixelValue + negativeSeedVarianceValue;\n    const numCirclePoints = 360;\n    const rotationAngle = (2 * Math.PI) / numCirclePoints;\n    const worldQuat = quat.setAxisAngle(quat.create(), worldVecSliceDir, rotationAngle);\n    const vecRotation = vec3.clone(worldVecRowDir);\n    for (let i = 0; i < numCirclePoints; i++) {\n        const worldCircleBorderPoint = vec3.scaleAndAdd(vec3.create(), sphereInfo.center, vecRotation, sphereInfo.radius);\n        const ijkCircleBorderPoint = transformWorldToIndex(labelmap.imageData, worldCircleBorderPoint);\n        const [x, y, z] = ijkCircleBorderPoint;\n        vec3.transformQuat(vecRotation, vecRotation, worldQuat);\n        if (x < 0 ||\n            x >= columns ||\n            y < 0 ||\n            y >= rows ||\n            z < 0 ||\n            z >= numSlices) {\n            continue;\n        }\n        const offset = x + y * columns + z * numPixelsPerSlice;\n        const pixelValue = subVolPixelData[offset];\n        if (pixelValue < minNegativePixelValue ||\n            pixelValue > maxNegativePixelValue) {\n            labelmap.voxelManager.setAtIndex(offset, negativeSeedValue);\n        }\n    }\n}\nasync function _createAndCacheSegmentationSubVolumeForSphere(subVolume, sphereInfo, viewport, options) {\n    const labelmap = await volumeLoader.createAndCacheDerivedLabelmapVolume(subVolume.volumeId);\n    _setPositiveSeedValues(subVolume, labelmap, sphereInfo, options);\n    _setNegativeSeedValues(subVolume, labelmap, sphereInfo, viewport, options);\n    return labelmap;\n}\nasync function runGrowCutForSphere(referencedVolumeId, sphereInfo, viewport, options) {\n    const referencedVolume = cache.getVolume(referencedVolumeId);\n    const subVolume = _createSubVolumeFromSphere(referencedVolume, sphereInfo, viewport);\n    const labelmap = await _createAndCacheSegmentationSubVolumeForSphere(subVolume, sphereInfo, viewport, options);\n    await run(subVolume.volumeId, labelmap.volumeId);\n    return labelmap;\n}\nexport { runGrowCutForSphere as default, runGrowCutForSphere };\n","import { utilities as csUtils, cache, volumeLoader } from '@cornerstonejs/core';\nimport { run } from './runGrowCut';\nimport { POSITIVE_SEED_LABEL, NEGATIVE_SEED_LABEL, DEFAULT_NEIGHBORHOOD_RADIUS, DEFAULT_POSITIVE_STD_DEV_MULTIPLIER, DEFAULT_NEGATIVE_STD_DEV_MULTIPLIER, DEFAULT_NEGATIVE_SEED_MARGIN, DEFAULT_NEGATIVE_SEEDS_COUNT, MAX_NEGATIVE_SEED_ATTEMPTS_MULTIPLIER, } from './constants';\nconst { transformWorldToIndex } = csUtils;\nconst MAX_POSITIVE_SEEDS = 100000;\nfunction calculateGrowCutSeeds(referencedVolume, worldPosition, options) {\n    const { dimensions, imageData: refImageData } = referencedVolume;\n    const [width, height, numSlices] = dimensions;\n    const referenceVolumeVoxelManager = referencedVolume.voxelManager;\n    const scalarData = referenceVolumeVoxelManager.getCompleteScalarDataArray();\n    const numPixelsPerSlice = width * height;\n    const neighborhoodRadius = options?.initialNeighborhoodRadius ?? DEFAULT_NEIGHBORHOOD_RADIUS;\n    const positiveK = options?.positiveStdDevMultiplier ?? DEFAULT_POSITIVE_STD_DEV_MULTIPLIER;\n    const negativeK = options?.negativeStdDevMultiplier ?? DEFAULT_NEGATIVE_STD_DEV_MULTIPLIER;\n    const negativeSeedMargin = options?.negativeSeedMargin ?? DEFAULT_NEGATIVE_SEED_MARGIN;\n    const negativeSeedsTargetPatches = options?.negativeSeedsTargetPatches ?? DEFAULT_NEGATIVE_SEEDS_COUNT;\n    const ijkStart = transformWorldToIndex(refImageData, worldPosition).map(Math.round);\n    const startIndex = referenceVolumeVoxelManager.toIndex(ijkStart);\n    if (ijkStart[0] < 0 ||\n        ijkStart[0] >= width ||\n        ijkStart[1] < 0 ||\n        ijkStart[1] >= height ||\n        ijkStart[2] < 0 ||\n        ijkStart[2] >= numSlices) {\n        console.warn('Click position is outside volume bounds.');\n        return null;\n    }\n    const initialStats = csUtils.calculateNeighborhoodStats(scalarData, dimensions, ijkStart, neighborhoodRadius);\n    if (initialStats.count === 0) {\n        initialStats.mean = scalarData[startIndex];\n        initialStats.stdDev = 0;\n    }\n    const positiveIntensityMin = initialStats.mean - positiveK * initialStats.stdDev;\n    const positiveIntensityMax = initialStats.mean + positiveK * initialStats.stdDev;\n    const neighborsCoordDelta = [\n        [-1, 0, 0],\n        [1, 0, 0],\n        [0, -1, 0],\n        [0, 1, 0],\n        [0, 0, -1],\n        [0, 0, 1],\n    ];\n    let minX = Infinity, minY = Infinity, minZ = Infinity;\n    let maxX = -Infinity, maxY = -Infinity, maxZ = -Infinity;\n    const positiveSeedIndices = new Set();\n    const queue = [];\n    const startValue = scalarData[startIndex];\n    if (startValue >= positiveIntensityMin &&\n        startValue <= positiveIntensityMax) {\n        positiveSeedIndices.add(startIndex);\n        queue.push(ijkStart);\n        minX = maxX = ijkStart[0];\n        minY = maxY = ijkStart[1];\n        minZ = maxZ = ijkStart[2];\n    }\n    else {\n        console.warn('Clicked voxel intensity is outside the calculated positive range. No positive seeds generated.');\n        return { positiveSeedIndices: new Set(), negativeSeedIndices: new Set() };\n    }\n    let currentQueueIndex = 0;\n    while (currentQueueIndex < queue.length &&\n        positiveSeedIndices.size < MAX_POSITIVE_SEEDS) {\n        const [x, y, z] = queue[currentQueueIndex++];\n        minX = Math.min(x, minX);\n        minY = Math.min(y, minY);\n        minZ = Math.min(z, minZ);\n        maxX = Math.max(x, maxX);\n        maxY = Math.max(y, maxY);\n        maxZ = Math.max(z, maxZ);\n        for (let i = 0; i < neighborsCoordDelta.length; i++) {\n            const [dx, dy, dz] = neighborsCoordDelta[i];\n            const nx = x + dx;\n            const ny = y + dy;\n            const nz = z + dz;\n            if (nx < 0 ||\n                nx >= width ||\n                ny < 0 ||\n                ny >= height ||\n                nz < 0 ||\n                nz >= numSlices) {\n                continue;\n            }\n            const neighborIndex = nz * numPixelsPerSlice + ny * width + nx;\n            if (positiveSeedIndices.has(neighborIndex)) {\n                continue;\n            }\n            const neighborValue = scalarData[neighborIndex];\n            if (neighborValue >= positiveIntensityMin &&\n                neighborValue <= positiveIntensityMax) {\n                positiveSeedIndices.add(neighborIndex);\n                if (positiveSeedIndices.size < MAX_POSITIVE_SEEDS) {\n                    queue.push([nx, ny, nz]);\n                }\n            }\n        }\n    }\n    if (positiveSeedIndices.size >= MAX_POSITIVE_SEEDS) {\n        console.debug(`Reached maximum number of positive seeds (${MAX_POSITIVE_SEEDS}). Stopping BFS.`);\n    }\n    if (positiveSeedIndices.size === 0) {\n        console.warn('No positive seeds found after BFS.');\n        return { positiveSeedIndices: new Set(), negativeSeedIndices: new Set() };\n    }\n    let positiveSum = 0;\n    let positiveSumSq = 0;\n    positiveSeedIndices.forEach((index) => {\n        const value = scalarData[index];\n        positiveSum += value;\n        positiveSumSq += value * value;\n    });\n    const positiveCount = positiveSeedIndices.size;\n    const positiveMean = positiveSum / positiveCount;\n    const positiveVariance = positiveSumSq / positiveCount - positiveMean * positiveMean;\n    const positiveStdDev = Math.sqrt(Math.max(0, positiveVariance));\n    const negativeDiffThreshold = negativeK * positiveStdDev;\n    const minXm = Math.max(0, minX - negativeSeedMargin);\n    const minYm = Math.max(0, minY - negativeSeedMargin);\n    const minZm = Math.max(0, minZ - negativeSeedMargin);\n    const maxXm = Math.min(width - 1, maxX + negativeSeedMargin);\n    const maxYm = Math.min(height - 1, maxY + negativeSeedMargin);\n    const maxZm = Math.min(numSlices - 1, maxZ + negativeSeedMargin);\n    const negativeSeedIndices = new Set();\n    let attempts = 0;\n    let patchesAdded = 0;\n    const maxAttempts = negativeSeedsTargetPatches * MAX_NEGATIVE_SEED_ATTEMPTS_MULTIPLIER;\n    while (patchesAdded < negativeSeedsTargetPatches && attempts < maxAttempts) {\n        attempts++;\n        const rx = Math.floor(Math.random() * (maxXm - minXm + 1) + minXm);\n        const ry = Math.floor(Math.random() * (maxYm - minYm + 1) + minYm);\n        const rz = Math.floor(Math.random() * (maxZm - minZm + 1) + minZm);\n        const centerIndex = rz * numPixelsPerSlice + ry * width + rx;\n        if (positiveSeedIndices.has(centerIndex) ||\n            negativeSeedIndices.has(centerIndex)) {\n            continue;\n        }\n        const centerValue = scalarData[centerIndex];\n        if (Math.abs(centerValue - positiveMean) > negativeDiffThreshold) {\n            let patchContributed = false;\n            for (let dy = -1; dy <= 1; dy++) {\n                const ny = ry + dy;\n                if (ny < 0 || ny >= height) {\n                    continue;\n                }\n                for (let dx = -1; dx <= 1; dx++) {\n                    const nx = rx + dx;\n                    if (nx < 0 || nx >= width) {\n                        continue;\n                    }\n                    const neighborIndex = rz * numPixelsPerSlice + ny * width + nx;\n                    if (positiveSeedIndices.has(neighborIndex) ||\n                        negativeSeedIndices.has(neighborIndex)) {\n                        continue;\n                    }\n                    negativeSeedIndices.add(neighborIndex);\n                    patchContributed = true;\n                }\n            }\n            if (patchContributed) {\n                patchesAdded++;\n            }\n        }\n    }\n    if (negativeSeedIndices.size === 0) {\n        console.warn('Could not find any negative seeds. GrowCut might fail or produce poor results.');\n    }\n    console.debug('positiveSeedIndices', positiveSeedIndices.size);\n    console.debug('negativeSeedIndices', negativeSeedIndices.size);\n    return { positiveSeedIndices, negativeSeedIndices };\n}\nasync function runOneClickGrowCut({ referencedVolumeId, worldPosition, options, }) {\n    const referencedVolume = cache.getVolume(referencedVolumeId);\n    const labelmap = volumeLoader.createAndCacheDerivedLabelmapVolume(referencedVolumeId);\n    labelmap.voxelManager.forEach(({ index, value }) => {\n        if (value !== 0) {\n            labelmap.voxelManager.setAtIndex(index, 0);\n        }\n    });\n    const seeds = options.seeds ??\n        calculateGrowCutSeeds(referencedVolume, worldPosition, options);\n    const positiveSeedLabel = options?.positiveSeedValue ?? POSITIVE_SEED_LABEL;\n    const negativeSeedLabel = options?.negativeSeedValue ?? NEGATIVE_SEED_LABEL;\n    if (!seeds) {\n        return null;\n    }\n    const { positiveSeedIndices, negativeSeedIndices } = seeds;\n    if (positiveSeedIndices.size < 10 ||\n        positiveSeedIndices.size > MAX_POSITIVE_SEEDS ||\n        negativeSeedIndices.size < 10) {\n        console.warn('Not enough seeds found. GrowCut might fail or produce poor results.');\n        return labelmap;\n    }\n    positiveSeedIndices.forEach((index) => {\n        labelmap.voxelManager.setAtIndex(index, positiveSeedLabel);\n    });\n    negativeSeedIndices.forEach((index) => {\n        labelmap.voxelManager.setAtIndex(index, negativeSeedLabel);\n    });\n    await run(referencedVolumeId, labelmap.volumeId, options);\n    return labelmap;\n}\nexport { runOneClickGrowCut as default, runOneClickGrowCut, calculateGrowCutSeeds, };\n","import { getToolGroup } from '../../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../triggerAnnotationRenderForViewportIds';\nimport { getBrushToolInstances } from './getBrushToolInstances';\nexport function invalidateBrushCursor(toolGroupId) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId);\n    brushBasedToolInstances.forEach((tool) => {\n        tool.invalidateBrushCursor();\n    });\n    const viewportsInfo = toolGroup.getViewportsInfo();\n    const viewportsInfoArray = Object.keys(viewportsInfo).map((key) => viewportsInfo[key]);\n    if (!viewportsInfoArray.length) {\n        return;\n    }\n    const viewportIds = toolGroup.getViewportIds();\n    triggerAnnotationRenderForViewportIds(viewportIds);\n}\n","import { cache } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nexport default function isLineInSegment(point1, point2, isInSegment) {\n    const ijk1 = isInSegment.toIJK(point1);\n    const ijk2 = isInSegment.toIJK(point2);\n    const testPoint = vec3.create();\n    const { testIJK } = isInSegment;\n    const delta = vec3.sub(vec3.create(), ijk1, ijk2);\n    const testSize = Math.round(Math.max(...delta.map(Math.abs)));\n    if (testSize < 2) {\n        return true;\n    }\n    const unitDelta = vec3.scale(vec3.create(), delta, 1 / testSize);\n    for (let i = 1; i < testSize; i++) {\n        vec3.scaleAndAdd(testPoint, ijk2, unitDelta, i);\n        if (!testIJK(testPoint)) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction createIsInSegmentMetadata({ dimensions, imageData, voxelManager, segmentIndex, containedSegmentIndices, }) {\n    const width = dimensions[0];\n    const pixelsPerSlice = width * dimensions[1];\n    return {\n        testCenter: (point1, point2) => {\n            const point = vec3.add(vec3.create(), point1, point2).map((it) => it / 2);\n            const ijk = imageData.worldToIndex(point).map(Math.round);\n            const [i, j, k] = ijk;\n            const index = i + j * width + k * pixelsPerSlice;\n            const value = voxelManager.getAtIndex(index);\n            return value === segmentIndex || containedSegmentIndices?.has(value);\n        },\n        toIJK: (point) => imageData.worldToIndex(point),\n        testIJK: (ijk) => {\n            const [i, j, k] = ijk;\n            const index = Math.round(i) + Math.round(j) * width + Math.round(k) * pixelsPerSlice;\n            const value = voxelManager.getAtIndex(index);\n            return value === segmentIndex || containedSegmentIndices?.has(value);\n        },\n    };\n}\nfunction createIsInSegment(segVolumeId, segmentIndex, containedSegmentIndices) {\n    const vol = cache.getVolume(segVolumeId);\n    if (!vol) {\n        console.warn(`No volume found for ${segVolumeId}`);\n        return;\n    }\n    return createIsInSegmentMetadata({\n        dimensions: vol.dimensions,\n        imageData: vol.imageData,\n        voxelManager: vol.voxelManager,\n        segmentIndex,\n        containedSegmentIndices,\n    });\n}\nexport { createIsInSegment, createIsInSegmentMetadata, isLineInSegment };\n","import { utilities } from '@cornerstonejs/core';\nimport normalizeViewportPlane from '../normalizeViewportPlane';\nconst { RLEVoxelMap, VoxelManager } = utilities;\nconst MAX_IMAGE_SIZE = 65535;\nexport var SegmentationEnum;\n(function (SegmentationEnum) {\n    SegmentationEnum[SegmentationEnum[\"SEGMENT\"] = -1] = \"SEGMENT\";\n    SegmentationEnum[SegmentationEnum[\"ISLAND\"] = -2] = \"ISLAND\";\n    SegmentationEnum[SegmentationEnum[\"INTERIOR\"] = -3] = \"INTERIOR\";\n    SegmentationEnum[SegmentationEnum[\"EXTERIOR\"] = -4] = \"EXTERIOR\";\n    SegmentationEnum[SegmentationEnum[\"INTERIOR_SMALL\"] = -5] = \"INTERIOR_SMALL\";\n    SegmentationEnum[SegmentationEnum[\"INTERIOR_TEST\"] = -6] = \"INTERIOR_TEST\";\n})(SegmentationEnum || (SegmentationEnum = {}));\nexport default class IslandRemoval {\n    constructor(options) {\n        this.fillInternalEdge = false;\n        this.maxInternalRemove = 128;\n        this.maxInternalRemove =\n            options?.maxInternalRemove ?? this.maxInternalRemove;\n        this.fillInternalEdge = options?.fillInternalEdge ?? this.fillInternalEdge;\n    }\n    initialize(viewport, segmentationVoxels, options) {\n        const hasSource = !!segmentationVoxels.sourceVoxelManager;\n        const segmentationVoxelManager = hasSource\n            ? segmentationVoxels.sourceVoxelManager\n            : segmentationVoxels;\n        const previewVoxelManager = hasSource\n            ? segmentationVoxels\n            : VoxelManager.createRLEHistoryVoxelManager(segmentationVoxelManager);\n        const { segmentIndex = 1, previewSegmentIndex = 1 } = options;\n        const clickedPoints = options.points || segmentationVoxelManager.getPoints();\n        if (!clickedPoints?.length) {\n            return;\n        }\n        const boundsIJK = segmentationVoxelManager\n            .getBoundsIJK()\n            .map((bound, i) => [\n            Math.min(bound[0], ...clickedPoints.map((point) => point[i])),\n            Math.max(bound[1], ...clickedPoints.map((point) => point[i])),\n        ]);\n        if (boundsIJK.find((it) => it[0] < 0 || it[1] > MAX_IMAGE_SIZE)) {\n            return;\n        }\n        const { toIJK, fromIJK, boundsIJKPrime, error } = normalizeViewportPlane(viewport, boundsIJK);\n        if (error) {\n            console.warn('Not performing island removal for planes not orthogonal to acquisition plane', error);\n            return;\n        }\n        const [width, height, depth] = fromIJK(segmentationVoxelManager.dimensions);\n        const segmentSet = new RLEVoxelMap(width, height, depth);\n        const getter = (i, j, k) => {\n            const index = segmentationVoxelManager.toIndex(toIJK([i, j, k]));\n            const oldVal = segmentationVoxelManager.getAtIndex(index);\n            if (oldVal === previewSegmentIndex || oldVal === segmentIndex) {\n                return SegmentationEnum.SEGMENT;\n            }\n        };\n        segmentSet.fillFrom(getter, boundsIJKPrime);\n        segmentSet.normalizer = { toIJK, fromIJK, boundsIJKPrime };\n        this.segmentSet = segmentSet;\n        this.previewVoxelManager = previewVoxelManager;\n        this.segmentIndex = segmentIndex;\n        this.previewSegmentIndex = previewSegmentIndex ?? segmentIndex;\n        this.selectedPoints = clickedPoints;\n        return true;\n    }\n    floodFillSegmentIsland() {\n        const { selectedPoints: clickedPoints, segmentSet } = this;\n        let floodedCount = 0;\n        const { fromIJK } = segmentSet.normalizer;\n        clickedPoints.forEach((clickedPoint) => {\n            const ijkPrime = fromIJK(clickedPoint);\n            const index = segmentSet.toIndex(ijkPrime);\n            const [iPrime, jPrime, kPrime] = ijkPrime;\n            if (segmentSet.get(index) === SegmentationEnum.SEGMENT) {\n                floodedCount += segmentSet.floodFill(iPrime, jPrime, kPrime, SegmentationEnum.ISLAND);\n            }\n        });\n        return floodedCount;\n    }\n    removeExternalIslands() {\n        const { previewVoxelManager, segmentSet } = this;\n        const { toIJK } = segmentSet.normalizer;\n        const callback = (index, rle) => {\n            const [, jPrime, kPrime] = segmentSet.toIJK(index);\n            if (rle.value !== SegmentationEnum.ISLAND) {\n                for (let iPrime = rle.start; iPrime < rle.end; iPrime++) {\n                    const clearPoint = toIJK([iPrime, jPrime, kPrime]);\n                    const v = previewVoxelManager.getAtIJKPoint(clearPoint);\n                    previewVoxelManager.setAtIJKPoint(clearPoint, v === undefined ? 0 : null);\n                }\n            }\n        };\n        segmentSet.forEach(callback, { rowModified: true });\n    }\n    removeInternalIslands() {\n        const { segmentSet, previewVoxelManager, previewSegmentIndex } = this;\n        const { height, normalizer, width } = segmentSet;\n        const { toIJK } = normalizer;\n        segmentSet.forEachRow((baseIndex, row) => {\n            let lastRle;\n            for (const rle of [...row]) {\n                if (rle.value !== SegmentationEnum.ISLAND) {\n                    continue;\n                }\n                if (!lastRle) {\n                    if (this.fillInternalEdge && rle.start > 0) {\n                        for (let iPrime = 0; iPrime < rle.start; iPrime++) {\n                            segmentSet.set(baseIndex + iPrime, SegmentationEnum.INTERIOR);\n                        }\n                    }\n                    lastRle = rle;\n                    continue;\n                }\n                for (let iPrime = lastRle.end; iPrime < rle.start; iPrime++) {\n                    segmentSet.set(baseIndex + iPrime, SegmentationEnum.INTERIOR);\n                }\n                lastRle = rle;\n            }\n            if (this.fillInternalEdge && lastRle?.end < width) {\n                for (let iPrime = lastRle.end; iPrime < width; iPrime++) {\n                    segmentSet.set(baseIndex + iPrime, SegmentationEnum.INTERIOR);\n                }\n            }\n        });\n        segmentSet.forEach((baseIndex, rle) => {\n            if (rle.value !== SegmentationEnum.INTERIOR) {\n                return;\n            }\n            const [, jPrime, kPrime] = segmentSet.toIJK(baseIndex);\n            const rowPrev = jPrime > 0 ? segmentSet.getRun(jPrime - 1, kPrime) : null;\n            const rowNext = jPrime + 1 < height ? segmentSet.getRun(jPrime + 1, kPrime) : null;\n            const isLast = jPrime === height - 1;\n            const isFirst = jPrime === 0;\n            const prevCovers = IslandRemoval.covers(rle, rowPrev) ||\n                (isFirst && this.fillInternalEdge);\n            const nextCovers = IslandRemoval.covers(rle, rowNext) || (isLast && this.fillInternalEdge);\n            if (rle.end - rle.start > 2 && (!prevCovers || !nextCovers)) {\n                segmentSet.floodFill(rle.start, jPrime, kPrime, SegmentationEnum.EXTERIOR, { singlePlane: true });\n            }\n        });\n        segmentSet.forEach((baseIndex, rle) => {\n            if (rle.value !== SegmentationEnum.INTERIOR) {\n                return;\n            }\n            const [, jPrime, kPrime] = segmentSet.toIJK(baseIndex);\n            const size = segmentSet.floodFill(rle.start, jPrime, kPrime, SegmentationEnum.INTERIOR_TEST);\n            const isBig = size > this.maxInternalRemove;\n            const newType = isBig\n                ? SegmentationEnum.EXTERIOR\n                : SegmentationEnum.INTERIOR_SMALL;\n            segmentSet.floodFill(rle.start, jPrime, kPrime, newType);\n        });\n        segmentSet.forEach((baseIndex, rle) => {\n            if (rle.value !== SegmentationEnum.INTERIOR_SMALL) {\n                return;\n            }\n            for (let iPrime = rle.start; iPrime < rle.end; iPrime++) {\n                const clearPoint = toIJK(segmentSet.toIJK(baseIndex + iPrime));\n                previewVoxelManager.setAtIJKPoint(clearPoint, previewSegmentIndex);\n            }\n        });\n        return previewVoxelManager.getArrayOfModifiedSlices();\n    }\n    static covers(rle, row) {\n        if (!row) {\n            return false;\n        }\n        let { start } = rle;\n        const { end } = rle;\n        for (const rowRle of row) {\n            if (start >= rowRle.start && start < rowRle.end) {\n                start = rowRle.end;\n                if (start >= end) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n","import { state } from '../../stateManagement/annotation';\nimport RectangleROIStartEndThresholdTool from '../../tools/segmentation/RectangleROIStartEndThresholdTool';\nimport RectangleROIThresholdTool from '../../tools/segmentation/RectangleROIThresholdTool';\nimport thresholdVolumeByRange from './thresholdVolumeByRange';\nimport getBoundsIJKFromRectangleAnnotations from '../rectangleROITool/getBoundsIJKFromRectangleAnnotations';\nfunction rectangleROIThresholdVolumeByRange(annotationUIDs, segmentationVolume, thresholdVolumeInformation, options) {\n    const annotations = annotationUIDs.map((annotationUID) => {\n        return state.getAnnotation(annotationUID);\n    });\n    _validateAnnotations(annotations);\n    let boundsIJK;\n    for (let i = 0; i < thresholdVolumeInformation.length; i++) {\n        const volumeSize = thresholdVolumeInformation[i].volume.voxelManager.getScalarDataLength();\n        if (volumeSize === segmentationVolume.voxelManager.getScalarDataLength() ||\n            i === 0) {\n            boundsIJK = getBoundsIJKFromRectangleAnnotations(annotations, thresholdVolumeInformation[i].volume, options);\n        }\n    }\n    const outputSegmentationVolume = thresholdVolumeByRange(segmentationVolume, thresholdVolumeInformation, { ...options, boundsIJK, segmentationId: options.segmentationId });\n    outputSegmentationVolume.modified();\n    return outputSegmentationVolume;\n}\nfunction _validateAnnotations(annotations) {\n    const validToolNames = [\n        RectangleROIThresholdTool.toolName,\n        RectangleROIStartEndThresholdTool.toolName,\n    ];\n    for (const annotation of annotations) {\n        const name = annotation.metadata.toolName;\n        if (!validToolNames.includes(name)) {\n            throw new Error('rectangleROIThresholdVolumeByRange only supports RectangleROIThreshold and RectangleROIStartEndThreshold annotations');\n        }\n    }\n}\nexport default rectangleROIThresholdVolumeByRange;\n","import { getEnabledElement, utilities } from '@cornerstonejs/core';\nimport { state as annotationState, config as annotationConfig, } from '../../stateManagement/annotation';\nimport contourAndFindLargestBidirectional from './contourAndFindLargestBidirectional';\nimport createBidirectionalToolData from './createBidirectionalToolData';\nimport BidirectionalTool from '../../tools/annotation/BidirectionalTool';\nimport { getSegmentations } from '../../stateManagement/segmentation/getSegmentations';\nimport { getActiveSegmentIndex } from '../../stateManagement/segmentation/getActiveSegmentIndex';\nexport default function segmentContourAction(element, configuration) {\n    console.warn('Deprecation Alert: There is a new getSegmentLargestBidirectional function that handles volume, stack and individual segment cases properly. This function is deprecated and will be removed in a future version.');\n    const { data: configurationData } = configuration;\n    const enabledElement = getEnabledElement(element);\n    const segment = (configurationData.getSegment || defaultGetSegment)(enabledElement, configurationData);\n    if (!segment) {\n        return;\n    }\n    const FrameOfReferenceUID = enabledElement.viewport.getFrameOfReferenceUID();\n    const segmentationsList = getSegmentations();\n    const { segmentIndex, segmentationId } = segment;\n    const bidirectionals = annotationState.getAnnotations(this.toolName || BidirectionalTool.toolName, FrameOfReferenceUID);\n    let hasExistingActiveSegment = false;\n    const existingLargestBidirectionals = bidirectionals.filter((existingBidirectionalItem) => {\n        const segment = existingBidirectionalItem.data.segment;\n        if (!segment) {\n            return false;\n        }\n        if (segment.segmentationId === segmentationId &&\n            segment.segmentIndex === segmentIndex) {\n            hasExistingActiveSegment = true;\n            existingBidirectionalItem.data.segment = segment;\n        }\n        return true;\n    });\n    if (!hasExistingActiveSegment) {\n        existingLargestBidirectionals.push({\n            data: { segment },\n        });\n    }\n    let newBidirectional;\n    existingLargestBidirectionals.forEach((existingLargestBidirectional) => {\n        const segments = [];\n        const updateSegment = existingLargestBidirectional.data.segment;\n        const { segmentIndex, segmentationId } = updateSegment;\n        segments[segmentIndex] = updateSegment;\n        annotationState.removeAnnotation(existingLargestBidirectional.annotationUID);\n        const bidirectionalData = contourAndFindLargestBidirectional({\n            ...segmentationsList.find((segmentation) => segmentation.segmentationId === segmentationId),\n            segments,\n        });\n        if (!bidirectionalData) {\n            return;\n        }\n        const bidirectionalToolData = createBidirectionalToolData(bidirectionalData, enabledElement.viewport);\n        bidirectionalToolData.annotationUID =\n            existingLargestBidirectional.annotationUID;\n        bidirectionalToolData.data.segment = updateSegment;\n        const annotationUID = annotationState.addAnnotation(bidirectionalToolData, FrameOfReferenceUID);\n        if (updateSegment.segmentIndex === segment.segmentIndex &&\n            updateSegment.segmentationId === segment.segmentationId) {\n            newBidirectional = bidirectionalData;\n            const { style } = segment;\n            if (style) {\n                annotationConfig.style.setAnnotationStyles(annotationUID, style);\n            }\n        }\n    });\n    if (newBidirectional) {\n        const { sliceIndex } = newBidirectional;\n        const imageIds = enabledElement.viewport.getImageIds();\n        utilities.jumpToSlice(element, {\n            imageIndex: imageIds.length - 1 - sliceIndex,\n        });\n        enabledElement.viewport.render();\n    }\n    else {\n        console.warn('No bidirectional found');\n    }\n    return newBidirectional;\n}\nexport function defaultGetSegment(enabledElement, configuration) {\n    const segmentationsList = getSegmentations();\n    if (!segmentationsList.length) {\n        return;\n    }\n    const segmentationId = configuration.segmentationId || segmentationsList[0].segmentationId;\n    const segmentIndex = configuration.segmentIndex ?? getActiveSegmentIndex(segmentationId);\n    if (!segmentIndex) {\n        return;\n    }\n    const segmentData = configuration.segmentData?.get(segmentIndex);\n    return {\n        label: `Segment ${segmentIndex}`,\n        segmentIndex,\n        segmentationId,\n        ...segmentData,\n    };\n}\n","import { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { getVoxelOverlap, processVolumes } from './utilities';\nfunction thresholdSegmentationByRange(segmentationVolume, segmentationIndex, thresholdVolumeInformation, overlapType, segmentationId) {\n    if (!segmentationId) {\n        throw new Error('Segmentation ID is required to be passed inside thresholdSegmentationByRange');\n    }\n    const { baseVolumeIdx, volumeInfoList } = processVolumes(segmentationVolume, thresholdVolumeInformation);\n    const { voxelManager } = volumeInfoList[baseVolumeIdx];\n    const refVoxelManager = voxelManager;\n    const scalarDataLength = segmentationVolume.voxelManager.getScalarDataLength();\n    const segVoxelManager = segmentationVolume.voxelManager;\n    volumeInfoList.forEach((volumeInfo) => {\n        const { volumeSize } = volumeInfo;\n        if (volumeSize === scalarDataLength) {\n            _handleSameSizeVolume(segVoxelManager, refVoxelManager, segmentationIndex, volumeInfo);\n        }\n        else {\n            _handleDifferentSizeVolume(segVoxelManager, refVoxelManager, segmentationIndex, volumeInfo, volumeInfoList, baseVolumeIdx, overlapType);\n        }\n    });\n    triggerSegmentationDataModified(segmentationId);\n    return segmentationVolume;\n}\nfunction _handleDifferentSizeVolume(segVoxelManager, refVoxelManager, segmentationIndex, volumeInfo, volumeInfoList, baseVolumeIdx, overlapType) {\n    const { imageData, lower, upper, dimensions } = volumeInfo;\n    let total, overlaps, range;\n    const segScalarDataLength = segVoxelManager.getScalarDataLength();\n    for (let i = 0; i < segScalarDataLength; i++) {\n        if (segScalarDataLength.getAtIndex(i) === segmentationIndex) {\n            const overlapBounds = getVoxelOverlap(imageData, dimensions, volumeInfoList[baseVolumeIdx].spacing, volumeInfoList[baseVolumeIdx].imageData.getPoint(i));\n            const callbackOverlap = ({ value }) => {\n                total = total + 1;\n                if (value >= range.lower && value <= range.upper) {\n                    overlaps = overlaps + 1;\n                }\n            };\n            total = 0;\n            overlaps = 0;\n            range = { lower, upper };\n            let overlapTest = false;\n            segVoxelManager.forEach(callbackOverlap, {\n                imageData,\n                boundsIJK: overlapBounds,\n            });\n            overlapTest = overlapType === 0 ? overlaps > 0 : overlaps === total;\n            segVoxelManager.setAtIndex(i, overlapTest ? segmentationIndex : 0);\n        }\n    }\n    return { total, range, overlaps };\n}\nfunction _handleSameSizeVolume(segVoxelManager, refVoxelManager, segmentationIndex, volumeInfo) {\n    const { lower, upper } = volumeInfo;\n    const scalarDataLength = segVoxelManager.getScalarDataLength();\n    for (let i = 0; i < scalarDataLength; i++) {\n        if (segVoxelManager.getAtIndex[i] === segmentationIndex) {\n            const value = refVoxelManager.getAtIndex(i);\n            segVoxelManager.setAtIndex(i, value >= lower && value <= upper ? segmentationIndex : 0);\n        }\n    }\n}\nexport default thresholdSegmentationByRange;\n","import { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { getVoxelOverlap, processVolumes } from './utilities';\nfunction thresholdVolumeByRange(segmentationVolume, thresholdVolumeInformation, options) {\n    const { imageData: segmentationImageData } = segmentationVolume;\n    const { overwrite, boundsIJK, segmentationId } = options;\n    if (!segmentationId) {\n        throw new Error('Segmentation ID is required to be passed inside thresholdVolumeByRange as options');\n    }\n    const overlapType = options?.overlapType || 0;\n    const segVoxelManager = segmentationVolume.voxelManager;\n    const scalarDataLength = segmentationVolume.voxelManager.getScalarDataLength();\n    if (overwrite) {\n        for (let i = 0; i < scalarDataLength; i++) {\n            segVoxelManager.setAtIndex(i, 0);\n        }\n    }\n    const { baseVolumeIdx, volumeInfoList } = processVolumes(segmentationVolume, thresholdVolumeInformation);\n    let overlaps, total, range;\n    const testOverlapRange = (volumeInfo, voxelSpacing, voxelCenter) => {\n        const callbackOverlap = ({ value }) => {\n            total = total + 1;\n            if (value >= range.lower && value <= range.upper) {\n                overlaps = overlaps + 1;\n            }\n        };\n        const { imageData, dimensions, lower, upper } = volumeInfo;\n        const overlapBounds = getVoxelOverlap(imageData, dimensions, voxelSpacing, voxelCenter);\n        total = 0;\n        overlaps = 0;\n        range = { lower, upper };\n        let overlapTest = false;\n        const { voxelManager } = imageData.get('voxelManager');\n        voxelManager.forEach(callbackOverlap, {\n            imageData,\n            boundsIJK: overlapBounds,\n        });\n        if (overlapType === 0) {\n            overlapTest = overlaps > 0;\n        }\n        else if (overlapType == 1) {\n            overlapTest = overlaps === total;\n        }\n        return overlapTest;\n    };\n    const testRange = (volumeInfo, pointIJK) => {\n        const { imageData, lower, upper } = volumeInfo;\n        const voxelManager = imageData.get('voxelManager').voxelManager;\n        const offset = voxelManager.toIndex(pointIJK);\n        const value = voxelManager.getAtIndex(offset);\n        if (value <= lower || value >= upper) {\n            return false;\n        }\n        else {\n            return true;\n        }\n    };\n    const callback = ({ index, pointIJK, pointLPS }) => {\n        let insert = volumeInfoList.length > 0;\n        for (let i = 0; i < volumeInfoList.length; i++) {\n            if (volumeInfoList[i].volumeSize === scalarDataLength) {\n                insert = testRange(volumeInfoList[i], pointIJK);\n            }\n            else {\n                insert = testOverlapRange(volumeInfoList[i], volumeInfoList[baseVolumeIdx].spacing, pointLPS);\n            }\n            if (!insert) {\n                break;\n            }\n        }\n        if (insert) {\n            segVoxelManager.setAtIndex(index, options.segmentIndex || 1);\n        }\n    };\n    const voxelManager = segmentationVolume.voxelManager;\n    voxelManager.forEach(callback, {\n        imageData: segmentationImageData,\n        boundsIJK,\n    });\n    triggerSegmentationDataModified(options.segmentationId);\n    return segmentationVolume;\n}\nexport default thresholdVolumeByRange;\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { getBoundingBoxAroundShapeIJK } from '../boundingBox/getBoundingBoxAroundShape';\nconst equalsCheck = (a, b) => {\n    return JSON.stringify(a) === JSON.stringify(b);\n};\nexport function getVoxelOverlap(imageData, dimensions, voxelSpacing, voxelCenter) {\n    const halfSpacingX = voxelSpacing[0] / 2;\n    const halfSpacingY = voxelSpacing[1] / 2;\n    const halfSpacingZ = voxelSpacing[2] / 2;\n    const voxelCornersIJK = new Array(8);\n    voxelCornersIJK[0] = csUtils.transformWorldToIndex(imageData, [\n        voxelCenter[0] - halfSpacingX,\n        voxelCenter[1] - halfSpacingY,\n        voxelCenter[2] - halfSpacingZ,\n    ]);\n    const offsets = [\n        [1, -1, -1],\n        [-1, 1, -1],\n        [1, 1, -1],\n        [-1, -1, 1],\n        [1, -1, 1],\n        [-1, 1, 1],\n        [1, 1, 1],\n    ];\n    for (let i = 0; i < 7; i++) {\n        const [xOff, yOff, zOff] = offsets[i];\n        voxelCornersIJK[i + 1] = csUtils.transformWorldToIndex(imageData, [\n            voxelCenter[0] + xOff * halfSpacingX,\n            voxelCenter[1] + yOff * halfSpacingY,\n            voxelCenter[2] + zOff * halfSpacingZ,\n        ]);\n    }\n    return getBoundingBoxAroundShapeIJK(voxelCornersIJK, dimensions);\n}\nexport function processVolumes(segmentationVolume, thresholdVolumeInformation) {\n    const { spacing: segmentationSpacing } = segmentationVolume;\n    const scalarDataLength = segmentationVolume.voxelManager.getScalarDataLength();\n    const volumeInfoList = [];\n    let baseVolumeIdx = 0;\n    for (let i = 0; i < thresholdVolumeInformation.length; i++) {\n        const { imageData, spacing, dimensions, voxelManager } = thresholdVolumeInformation[i].volume;\n        const volumeSize = thresholdVolumeInformation[i].volume.voxelManager.getScalarDataLength();\n        if (volumeSize === scalarDataLength &&\n            equalsCheck(spacing, segmentationSpacing)) {\n            baseVolumeIdx = i;\n        }\n        const lower = thresholdVolumeInformation[i].lower;\n        const upper = thresholdVolumeInformation[i].upper;\n        volumeInfoList.push({\n            imageData,\n            lower,\n            upper,\n            spacing,\n            dimensions,\n            volumeSize,\n            voxelManager,\n        });\n    }\n    return {\n        volumeInfoList,\n        baseVolumeIdx,\n    };\n}\nconst segmentIndicesCache = new Map();\nexport const setSegmentationDirty = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = true;\n    }\n};\nexport const setSegmentationClean = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = false;\n    }\n};\nexport const getCachedSegmentIndices = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached && !cached.isDirty) {\n        return cached.indices;\n    }\n    return null;\n};\nexport const setCachedSegmentIndices = (segmentationId, indices) => {\n    segmentIndicesCache.set(segmentationId, { indices, isDirty: false });\n};\n","import { cache, utilities, eventTarget, Enums, triggerEvent, metaData, } from '@cornerstonejs/core';\nimport { getActiveSegmentIndex } from '../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nimport { getStrategyData } from '../../tools/segmentation/strategies/utils/getStrategyData';\nimport ensureSegmentationVolume from '../../tools/segmentation/strategies/compositions/ensureSegmentationVolume';\nimport ensureImageVolume from '../../tools/segmentation/strategies/compositions/ensureImageVolume';\nexport const triggerWorkerProgress = (workerType, progress) => {\n    triggerEvent(eventTarget, Enums.Events.WEB_WORKER_PROGRESS, {\n        progress,\n        type: workerType,\n    });\n};\nexport const getSegmentationDataForWorker = (segmentationId, segmentIndices) => {\n    const segmentation = getSegmentation(segmentationId);\n    const { representationData } = segmentation;\n    const { Labelmap } = representationData;\n    if (!Labelmap) {\n        console.debug('No labelmap found for segmentation', segmentationId);\n        return null;\n    }\n    const segVolumeId = Labelmap.volumeId;\n    const segImageIds = Labelmap.imageIds;\n    const operationData = {\n        segmentationId,\n        volumeId: segVolumeId,\n        imageIds: segImageIds,\n    };\n    let reconstructableVolume = false;\n    if (segImageIds) {\n        const refImageIds = segImageIds.map((imageId) => {\n            const image = cache.getImage(imageId);\n            return image.referencedImageId;\n        });\n        reconstructableVolume = utilities.isValidVolume(refImageIds);\n    }\n    let indices = segmentIndices;\n    if (!indices) {\n        indices = [getActiveSegmentIndex(segmentationId)];\n    }\n    else if (!Array.isArray(indices)) {\n        indices = [indices, 255];\n    }\n    return {\n        operationData,\n        segVolumeId,\n        segImageIds,\n        reconstructableVolume,\n        indices,\n    };\n};\nexport const prepareVolumeStrategyDataForWorker = (operationData) => {\n    return getStrategyData({\n        operationData,\n        strategy: {\n            ensureSegmentationVolumeFor3DManipulation: ensureSegmentationVolume.ensureSegmentationVolumeFor3DManipulation,\n            ensureImageVolumeFor3DManipulation: ensureImageVolume.ensureImageVolumeFor3DManipulation,\n        },\n    });\n};\nexport const prepareImageInfo = (imageVoxelManager, imageData) => {\n    const imageScalarData = imageVoxelManager.getCompleteScalarDataArray();\n    return {\n        scalarData: imageScalarData,\n        dimensions: imageData.getDimensions(),\n        spacing: imageData.getSpacing(),\n        origin: imageData.getOrigin(),\n        direction: imageData.getDirection(),\n    };\n};\nexport const prepareStackDataForWorker = (segImageIds) => {\n    const segmentationInfo = [];\n    const imageInfo = [];\n    for (const segImageId of segImageIds) {\n        const segImage = cache.getImage(segImageId);\n        const segPixelData = segImage.getPixelData();\n        const { origin, direction, spacing, dimensions } = utilities.getImageDataMetadata(segImage);\n        segmentationInfo.push({\n            scalarData: segPixelData,\n            dimensions,\n            spacing,\n            origin,\n            direction,\n        });\n        const refImageId = segImage.referencedImageId;\n        if (refImageId) {\n            const refImage = cache.getImage(refImageId);\n            const refPixelData = refImage.getPixelData();\n            const refVoxelManager = refImage.voxelManager;\n            const refSpacing = [\n                refImage.rowPixelSpacing,\n                refImage.columnPixelSpacing,\n            ];\n            imageInfo.push({\n                scalarData: refPixelData,\n                dimensions: refVoxelManager\n                    ? refVoxelManager.dimensions\n                    : [refImage.columns, refImage.rows, 1],\n                spacing: refSpacing,\n            });\n        }\n    }\n    return { segmentationInfo, imageInfo };\n};\nexport const getImageReferenceInfo = (segVolumeId, segImageIds) => {\n    let refImageId;\n    if (segVolumeId) {\n        const segmentationVolume = cache.getVolume(segVolumeId);\n        const imageIds = segmentationVolume.imageIds;\n        const cachedImage = cache.getImage(imageIds[0]);\n        if (cachedImage) {\n            refImageId = cachedImage.referencedImageId;\n        }\n    }\n    else if (segImageIds?.length) {\n        const segImage = cache.getImage(segImageIds[0]);\n        refImageId = segImage.referencedImageId;\n    }\n    const refImage = cache.getImage(refImageId);\n    const scalingModule = metaData.get('scalingModule', refImageId);\n    const modalityUnitOptions = {\n        isPreScaled: Boolean(refImage.preScale?.scaled),\n        isSuvScaled: typeof scalingModule?.suvbw === 'number',\n    };\n    return { refImageId, modalityUnitOptions };\n};\n","import { cache } from '@cornerstonejs/core';\nfunction validateRepresentationData(segmentationRepresentationData) {\n    if ('volumeId' in segmentationRepresentationData) {\n        segmentationRepresentationData =\n            segmentationRepresentationData;\n        const cachedVolume = cache.getVolume(segmentationRepresentationData.volumeId);\n        if (!cachedVolume) {\n            throw new Error(`volumeId of ${segmentationRepresentationData.volumeId} not found in cache, you should load and cache volume before adding segmentation`);\n        }\n    }\n    else if ('imageIds' in segmentationRepresentationData) {\n        segmentationRepresentationData =\n            segmentationRepresentationData;\n        if (!segmentationRepresentationData.imageIds) {\n            throw new Error('The segmentationInput.representationData.imageIds is undefined, please provide a valid representationData.imageIds for stack data');\n        }\n    }\n    else {\n        throw new Error('The segmentationInput.representationData is undefined, please provide a valid representationData');\n    }\n}\nexport function validatePublic(segmentationInput) {\n    if (!segmentationInput.representation.data) {\n        throw new Error('The segmentationInput.representationData.data is undefined, please provide a valid representationData.data');\n    }\n    const representationData = segmentationInput.representation\n        .data;\n    validateRepresentationData(representationData);\n}\nexport function validate(segmentationRepresentationData) {\n    validateRepresentationData(segmentationRepresentationData);\n}\n","import { triggerAnnotationModified } from '../stateManagement/annotation/helpers/state';\nimport { ChangeTypes } from '../enums';\nexport default function setAnnotationLabel(annotation, element, updatedLabel) {\n    annotation.data.label = updatedLabel;\n    triggerAnnotationModified(annotation, element, ChangeTypes.LabelChange);\n}\n","import { imageLoader, Enums, eventTarget, imageLoadPoolManager, cache, } from '@cornerstonejs/core';\nimport { addToolState, getToolState } from './state';\nimport { getStackData, requestType, priority, clearFromImageIds, getPromiseRemovedHandler, } from './stackPrefetchUtils';\nlet configuration = {\n    maxImagesToPrefetch: Infinity,\n    minBefore: 2,\n    maxAfter: 2,\n    directionExtraImages: 10,\n    preserveExistingPool: false,\n};\nlet resetPrefetchTimeout;\nconst resetPrefetchDelay = 5;\nconst enable = (element) => {\n    const stack = getStackData(element);\n    if (!stack) {\n        return;\n    }\n    if (!stack.imageIds?.length) {\n        console.warn('CornerstoneTools.stackPrefetch: No images in stack.');\n        return;\n    }\n    updateToolState(element);\n    prefetch(element);\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, onImageUpdated);\n    element.addEventListener(Enums.Events.STACK_NEW_IMAGE, onImageUpdated);\n    const promiseRemovedHandler = getPromiseRemovedHandler(element);\n    eventTarget.removeEventListener(Enums.Events.IMAGE_CACHE_IMAGE_REMOVED, promiseRemovedHandler);\n    eventTarget.addEventListener(Enums.Events.IMAGE_CACHE_IMAGE_REMOVED, promiseRemovedHandler);\n};\nfunction prefetch(element) {\n    const stack = getStackData(element);\n    if (!stack) {\n        return;\n    }\n    if (!stack?.imageIds?.length) {\n        console.warn('CornerstoneTools.stackPrefetch: No images in stack.');\n        return;\n    }\n    const stackPrefetchData = getToolState(element);\n    if (!stackPrefetchData) {\n        return;\n    }\n    const stackPrefetch = (stackPrefetchData || {});\n    stackPrefetch.enabled =\n        stackPrefetch.enabled && (stackPrefetch.indicesToRequest?.length ?? 0) > 0;\n    if (stackPrefetch.enabled === false) {\n        return;\n    }\n    function removeFromList(imageIdIndex) {\n        const index = stackPrefetch.indicesToRequest.indexOf(imageIdIndex);\n        if (index > -1) {\n            stackPrefetch.indicesToRequest.splice(index, 1);\n        }\n    }\n    const indicesToRequestCopy = stackPrefetch.indicesToRequest.slice();\n    const { currentImageIdIndex } = stack;\n    indicesToRequestCopy.forEach((imageIdIndex) => {\n        const imageId = stack.imageIds[imageIdIndex];\n        if (!imageId) {\n            return;\n        }\n        const distance = Math.abs(currentImageIdIndex - imageIdIndex);\n        const imageCached = distance < 6\n            ? cache.getImageLoadObject(imageId)\n            : cache.isLoaded(imageId);\n        if (imageCached) {\n            removeFromList(imageIdIndex);\n        }\n    });\n    if (!stackPrefetch.indicesToRequest.length) {\n        return;\n    }\n    if (!configuration.preserveExistingPool) {\n        imageLoadPoolManager.filterRequests(clearFromImageIds(stack));\n    }\n    function doneCallback(imageId) {\n        const imageIdIndex = stack.imageIds.indexOf(imageId);\n        removeFromList(imageIdIndex);\n        const image = cache.getCachedImageBasedOnImageURI(imageId);\n        const { stats } = stackPrefetch;\n        const decodeTimeInMS = image?.image?.decodeTimeInMS || 0;\n        if (decodeTimeInMS) {\n            stats.imageIds.set(imageId, decodeTimeInMS);\n            stats.decodeTimeInMS += decodeTimeInMS;\n            const loadTimeInMS = image?.image?.loadTimeInMS || 0;\n            stats.loadTimeInMS += loadTimeInMS;\n        }\n        if (!stackPrefetch.indicesToRequest.length) {\n            if (image?.sizeInBytes) {\n                const { sizeInBytes } = image;\n                const usage = cache.getMaxCacheSize() / 4 / sizeInBytes;\n                if (!stackPrefetch.cacheFill) {\n                    stats.initialTime = Date.now() - stats.start;\n                    stats.initialSize = stats.imageIds.size;\n                    updateToolState(element, usage);\n                    prefetch(element);\n                }\n                else if (stats.imageIds.size) {\n                    stats.fillTime = Date.now() - stats.start;\n                    const { size } = stats.imageIds;\n                    stats.fillSize = size;\n                }\n            }\n        }\n    }\n    const requestFn = (imageId, options) => imageLoader\n        .loadAndCacheImage(imageId, options)\n        .then(() => doneCallback(imageId));\n    stackPrefetch.indicesToRequest.forEach((imageIdIndex) => {\n        const imageId = stack.imageIds[imageIdIndex];\n        const options = {\n            requestType,\n        };\n        imageLoadPoolManager.addRequest(requestFn.bind(null, imageId, options), requestType, {\n            imageId,\n        }, priority);\n    });\n}\nfunction onImageUpdated(e) {\n    clearTimeout(resetPrefetchTimeout);\n    resetPrefetchTimeout = setTimeout(function () {\n        const element = e.target;\n        try {\n            updateToolState(element);\n            prefetch(element);\n        }\n        catch (error) {\n            return;\n        }\n    }, resetPrefetchDelay);\n}\nconst signum = (x) => (x < 0 ? -1 : 1);\nconst updateToolState = (element, usage) => {\n    const stack = getStackData(element);\n    if (!stack) {\n        return;\n    }\n    if (!stack.imageIds?.length) {\n        console.warn('CornerstoneTools.stackPrefetch: No images in stack.');\n        return;\n    }\n    const { currentImageIdIndex } = stack;\n    let { maxAfter = 2, minBefore = 2 } = configuration;\n    const { directionExtraImages = 10 } = configuration;\n    const stackPrefetchData = getToolState(element) ||\n        {\n            indicesToRequest: [],\n            currentImageIdIndex,\n            stackCount: 0,\n            enabled: true,\n            direction: 1,\n            stats: {\n                start: Date.now(),\n                imageIds: new Map(),\n                decodeTimeInMS: 0,\n                loadTimeInMS: 0,\n                totalBytes: 0,\n            },\n        };\n    const delta = currentImageIdIndex - stackPrefetchData.currentImageIdIndex;\n    stackPrefetchData.direction = signum(delta);\n    stackPrefetchData.currentImageIdIndex = currentImageIdIndex;\n    stackPrefetchData.enabled = true;\n    if (stackPrefetchData.stackCount < 100) {\n        stackPrefetchData.stackCount += directionExtraImages;\n    }\n    if (Math.abs(delta) > maxAfter || !delta) {\n        stackPrefetchData.stackCount = 0;\n        if (usage) {\n            const positionFraction = currentImageIdIndex / stack.imageIds.length;\n            minBefore = Math.ceil(usage * positionFraction);\n            maxAfter = Math.ceil(usage * (1 - positionFraction));\n            stackPrefetchData.cacheFill = true;\n        }\n        else {\n            stackPrefetchData.cacheFill = false;\n        }\n    }\n    else if (delta < 0) {\n        minBefore += stackPrefetchData.stackCount;\n        maxAfter = 0;\n    }\n    else {\n        maxAfter += stackPrefetchData.stackCount;\n        minBefore = 0;\n    }\n    const minIndex = Math.max(0, currentImageIdIndex - minBefore);\n    const maxIndex = Math.min(stack.imageIds.length - 1, currentImageIdIndex + maxAfter);\n    const indicesToRequest = [];\n    for (let i = currentImageIdIndex + 1; i <= maxIndex; i++) {\n        indicesToRequest.push(i);\n    }\n    for (let i = currentImageIdIndex - 1; i >= minIndex; i--) {\n        indicesToRequest.push(i);\n    }\n    stackPrefetchData.indicesToRequest = indicesToRequest;\n    addToolState(element, stackPrefetchData);\n};\nfunction disable(element) {\n    clearTimeout(resetPrefetchTimeout);\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, onImageUpdated);\n    const promiseRemovedHandler = getPromiseRemovedHandler(element);\n    eventTarget.removeEventListener(Enums.Events.IMAGE_CACHE_IMAGE_REMOVED, promiseRemovedHandler);\n    const stackPrefetchData = getToolState(element);\n    if (stackPrefetchData) {\n        stackPrefetchData.enabled = false;\n    }\n}\nfunction getConfiguration() {\n    return configuration;\n}\nfunction setConfiguration(config) {\n    configuration = config;\n}\nconst stackContextPrefetch = {\n    enable,\n    disable,\n    getConfiguration,\n    setConfiguration,\n};\nexport default stackContextPrefetch;\n","import { imageLoader, Enums, eventTarget, imageLoadPoolManager, cache, getConfiguration as getCoreConfiguration, } from '@cornerstonejs/core';\nimport { addToolState, getToolState } from './state';\nimport { getStackData, requestType, priority, getPromiseRemovedHandler, nearestIndex, range, } from './stackPrefetchUtils';\nlet configuration = {\n    maxImagesToPrefetch: Infinity,\n    preserveExistingPool: true,\n};\nlet resetPrefetchTimeout;\nconst resetPrefetchDelay = 10;\nfunction prefetch(element) {\n    const stackPrefetchData = getToolState(element);\n    if (!stackPrefetchData) {\n        return;\n    }\n    const stackPrefetch = (stackPrefetchData || {});\n    const stack = getStackData(element);\n    if (!stack?.imageIds?.length) {\n        console.warn('CornerstoneTools.stackPrefetch: No images in stack.');\n        return;\n    }\n    const { currentImageIdIndex } = stack;\n    stackPrefetch.enabled =\n        stackPrefetch.enabled && (stackPrefetch.indicesToRequest?.length ?? 0) > 0;\n    if (stackPrefetch.enabled === false) {\n        return;\n    }\n    function removeFromList(imageIdIndex) {\n        const index = stackPrefetch.indicesToRequest.indexOf(imageIdIndex);\n        if (index > -1) {\n            stackPrefetch.indicesToRequest.splice(index, 1);\n        }\n    }\n    stackPrefetchData.indicesToRequest.sort((a, b) => a - b);\n    const indicesToRequestCopy = stackPrefetch.indicesToRequest.slice();\n    indicesToRequestCopy.forEach(function (imageIdIndex) {\n        const imageId = stack.imageIds[imageIdIndex];\n        if (!imageId) {\n            return;\n        }\n        const distance = Math.abs(currentImageIdIndex - imageIdIndex);\n        const imageCached = distance < 6\n            ? cache.getImageLoadObject(imageId)\n            : cache.isLoaded(imageId);\n        if (imageCached) {\n            removeFromList(imageIdIndex);\n        }\n    });\n    if (!stackPrefetch.indicesToRequest.length) {\n        return;\n    }\n    if (!configuration.preserveExistingPool) {\n        imageLoadPoolManager.clearRequestStack(requestType);\n    }\n    const nearest = nearestIndex(stackPrefetch.indicesToRequest, stack.currentImageIdIndex);\n    let imageId;\n    let nextImageIdIndex;\n    const preventCache = false;\n    function doneCallback(image) {\n        console.log('prefetch done: %s', image.imageId);\n        const imageIdIndex = stack.imageIds.indexOf(image.imageId);\n        removeFromList(imageIdIndex);\n    }\n    let lowerIndex = nearest.low;\n    let higherIndex = nearest.high;\n    const imageIdsToPrefetch = [];\n    while (lowerIndex >= 0 ||\n        higherIndex < stackPrefetch.indicesToRequest.length) {\n        const currentIndex = stack.currentImageIdIndex;\n        const shouldSkipLower = currentIndex - stackPrefetch.indicesToRequest[lowerIndex] >\n            configuration.maxImagesToPrefetch;\n        const shouldSkipHigher = stackPrefetch.indicesToRequest[higherIndex] - currentIndex >\n            configuration.maxImagesToPrefetch;\n        const shouldLoadLower = !shouldSkipLower && lowerIndex >= 0;\n        const shouldLoadHigher = !shouldSkipHigher && higherIndex < stackPrefetch.indicesToRequest.length;\n        if (!shouldLoadHigher && !shouldLoadLower) {\n            break;\n        }\n        if (shouldLoadLower) {\n            nextImageIdIndex = stackPrefetch.indicesToRequest[lowerIndex--];\n            imageId = stack.imageIds[nextImageIdIndex];\n            imageIdsToPrefetch.push(imageId);\n        }\n        if (shouldLoadHigher) {\n            nextImageIdIndex = stackPrefetch.indicesToRequest[higherIndex++];\n            imageId = stack.imageIds[nextImageIdIndex];\n            imageIdsToPrefetch.push(imageId);\n        }\n    }\n    const requestFn = (imageId, options) => imageLoader.loadAndCacheImage(imageId, options);\n    imageIdsToPrefetch.forEach((imageId) => {\n        const options = {\n            requestType,\n        };\n        imageLoadPoolManager.addRequest(requestFn.bind(null, imageId, options), requestType, {\n            imageId,\n        }, priority);\n    });\n}\nfunction onImageUpdated(e) {\n    clearTimeout(resetPrefetchTimeout);\n    resetPrefetchTimeout = setTimeout(function () {\n        const element = e.target;\n        try {\n            prefetch(element);\n        }\n        catch (error) {\n            return;\n        }\n    }, resetPrefetchDelay);\n}\nfunction enable(element) {\n    const stack = getStackData(element);\n    if (!stack || !stack.imageIds || stack.imageIds.length === 0) {\n        console.warn('CornerstoneTools.stackPrefetch: No images in stack.');\n        return;\n    }\n    const stackPrefetchData = {\n        indicesToRequest: range(0, stack.imageIds.length - 1),\n        enabled: true,\n        direction: 1,\n    };\n    const indexOfCurrentImage = stackPrefetchData.indicesToRequest.indexOf(stack.currentImageIdIndex);\n    stackPrefetchData.indicesToRequest.splice(indexOfCurrentImage, 1);\n    addToolState(element, stackPrefetchData);\n    prefetch(element);\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, onImageUpdated);\n    element.addEventListener(Enums.Events.STACK_NEW_IMAGE, onImageUpdated);\n    const promiseRemovedHandler = getPromiseRemovedHandler(element);\n    eventTarget.removeEventListener(Enums.Events.IMAGE_CACHE_IMAGE_REMOVED, promiseRemovedHandler);\n    eventTarget.addEventListener(Enums.Events.IMAGE_CACHE_IMAGE_REMOVED, promiseRemovedHandler);\n}\nfunction disable(element) {\n    clearTimeout(resetPrefetchTimeout);\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, onImageUpdated);\n    const promiseRemovedHandler = getPromiseRemovedHandler(element);\n    eventTarget.removeEventListener(Enums.Events.IMAGE_CACHE_IMAGE_REMOVED, promiseRemovedHandler);\n    const stackPrefetchData = getToolState(element);\n    if (stackPrefetchData && stackPrefetchData.indicesToRequest.length) {\n        stackPrefetchData.enabled = false;\n        imageLoadPoolManager.clearRequestStack(requestType);\n    }\n}\nfunction getConfiguration() {\n    return configuration;\n}\nfunction setConfiguration(config) {\n    configuration = config;\n}\nconst stackPrefetch = { enable, disable, getConfiguration, setConfiguration };\nexport default stackPrefetch;\n","function getDeltaPoints(currentPoints, lastPoints) {\n    const curr = getMeanPoints(currentPoints);\n    const last = getMeanPoints(lastPoints);\n    return {\n        page: _subtractPoints2D(curr.page, last.page),\n        client: _subtractPoints2D(curr.client, last.client),\n        canvas: _subtractPoints2D(curr.canvas, last.canvas),\n        world: _subtractPoints3D(curr.world, last.world),\n    };\n}\nfunction getDeltaDistance(currentPoints, lastPoints) {\n    const curr = getMeanPoints(currentPoints);\n    const last = getMeanPoints(lastPoints);\n    return {\n        page: _getDistance2D(curr.page, last.page),\n        client: _getDistance2D(curr.client, last.client),\n        canvas: _getDistance2D(curr.canvas, last.canvas),\n        world: _getDistance3D(curr.world, last.world),\n    };\n}\nfunction getDeltaRotation(currentPoints, lastPoints) {\n}\nfunction getDeltaDistanceBetweenIPoints(currentPoints, lastPoints) {\n    const currentDistance = _getMeanDistanceBetweenAllIPoints(currentPoints);\n    const lastDistance = _getMeanDistanceBetweenAllIPoints(lastPoints);\n    const deltaDistance = {\n        page: currentDistance.page - lastDistance.page,\n        client: currentDistance.client - lastDistance.client,\n        canvas: currentDistance.canvas - lastDistance.canvas,\n        world: currentDistance.world - lastDistance.world,\n    };\n    return deltaDistance;\n}\nfunction copyPointsList(points) {\n    return JSON.parse(JSON.stringify(points));\n}\nfunction copyPoints(points) {\n    return JSON.parse(JSON.stringify(points));\n}\nfunction getMeanPoints(points) {\n    return points.reduce((prev, curr) => {\n        return {\n            page: [\n                prev.page[0] + curr.page[0] / points.length,\n                prev.page[1] + curr.page[1] / points.length,\n            ],\n            client: [\n                prev.client[0] + curr.client[0] / points.length,\n                prev.client[1] + curr.client[1] / points.length,\n            ],\n            canvas: [\n                prev.canvas[0] + curr.canvas[0] / points.length,\n                prev.canvas[1] + curr.canvas[1] / points.length,\n            ],\n            world: [\n                prev.world[0] + curr.world[0] / points.length,\n                prev.world[1] + curr.world[1] / points.length,\n                prev.world[2] + curr.world[2] / points.length,\n            ],\n        };\n    }, {\n        page: [0, 0],\n        client: [0, 0],\n        canvas: [0, 0],\n        world: [0, 0, 0],\n    });\n}\nfunction getMeanTouchPoints(points) {\n    return points.reduce((prev, curr) => {\n        return {\n            page: [\n                prev.page[0] + curr.page[0] / points.length,\n                prev.page[1] + curr.page[1] / points.length,\n            ],\n            client: [\n                prev.client[0] + curr.client[0] / points.length,\n                prev.client[1] + curr.client[1] / points.length,\n            ],\n            canvas: [\n                prev.canvas[0] + curr.canvas[0] / points.length,\n                prev.canvas[1] + curr.canvas[1] / points.length,\n            ],\n            world: [\n                prev.world[0] + curr.world[0] / points.length,\n                prev.world[1] + curr.world[1] / points.length,\n                prev.world[2] + curr.world[2] / points.length,\n            ],\n            touch: {\n                identifier: null,\n                radiusX: prev.touch.radiusX + curr.touch.radiusX / points.length,\n                radiusY: prev.touch.radiusY + curr.touch.radiusY / points.length,\n                force: prev.touch.force + curr.touch.force / points.length,\n                rotationAngle: prev.touch.rotationAngle + curr.touch.rotationAngle / points.length,\n            },\n        };\n    }, {\n        page: [0, 0],\n        client: [0, 0],\n        canvas: [0, 0],\n        world: [0, 0, 0],\n        touch: {\n            identifier: null,\n            radiusX: 0,\n            radiusY: 0,\n            force: 0,\n            rotationAngle: 0,\n        },\n    });\n}\nfunction _subtractPoints2D(point0, point1) {\n    return [point0[0] - point1[0], point0[1] - point1[1]];\n}\nfunction _subtractPoints3D(point0, point1) {\n    return [point0[0] - point1[0], point0[1] - point1[1], point0[2] - point1[2]];\n}\nfunction _getMeanDistanceBetweenAllIPoints(points) {\n    const pairedDistance = [];\n    for (let i = 0; i < points.length; i++) {\n        for (let j = 0; j < points.length; j++) {\n            if (i < j) {\n                pairedDistance.push({\n                    page: _getDistance2D(points[i].page, points[j].page),\n                    client: _getDistance2D(points[i].client, points[j].client),\n                    canvas: _getDistance2D(points[i].canvas, points[j].canvas),\n                    world: _getDistance3D(points[i].world, points[j].world),\n                });\n            }\n        }\n    }\n    return pairedDistance.reduce((prev, curr) => {\n        return {\n            page: prev.page + curr.page / pairedDistance.length,\n            client: prev.client + curr.client / pairedDistance.length,\n            canvas: prev.canvas + curr.canvas / pairedDistance.length,\n            world: prev.world + curr.world / pairedDistance.length,\n        };\n    }, {\n        page: 0,\n        client: 0,\n        canvas: 0,\n        world: 0,\n    });\n}\nfunction _getDistance2D(point0, point1) {\n    return Math.sqrt(Math.pow(point0[0] - point1[0], 2) + Math.pow(point0[1] - point1[1], 2));\n}\nfunction _getDistance3D(point0, point1) {\n    return Math.sqrt(Math.pow(point0[0] - point1[0], 2) +\n        Math.pow(point0[1] - point1[1], 2) +\n        Math.pow(point0[2] - point1[2], 2));\n}\nexport { getMeanPoints, getMeanTouchPoints, copyPoints, copyPointsList, getDeltaDistanceBetweenIPoints, getDeltaPoints, getDeltaDistance, getDeltaRotation, };\n","import { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nfunction triggerAnnotationRender(element) {\n    annotationRenderingEngine.renderViewport(element);\n}\nexport default triggerAnnotationRender;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nimport { getToolGroup } from '../store/ToolGroupManager';\nexport function triggerAnnotationRenderForToolGroupIds(toolGroupIds) {\n    toolGroupIds.forEach((toolGroupId) => {\n        const toolGroup = getToolGroup(toolGroupId);\n        if (!toolGroup) {\n            console.warn(`ToolGroup not available for ${toolGroupId}`);\n            return;\n        }\n        const viewportsInfo = toolGroup.getViewportsInfo();\n        viewportsInfo.forEach((viewportInfo) => {\n            const { renderingEngineId, viewportId } = viewportInfo;\n            const renderingEngine = getRenderingEngine(renderingEngineId);\n            if (!renderingEngine) {\n                console.warn(`RenderingEngine not available for ${renderingEngineId}`);\n                return;\n            }\n            const viewport = renderingEngine.getViewport(viewportId);\n            triggerAnnotationRender(viewport.element);\n        });\n    });\n}\nexport default triggerAnnotationRenderForToolGroupIds;\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nexport function triggerAnnotationRenderForViewportIds(viewportIdsToRender) {\n    if (!viewportIdsToRender.length) {\n        return;\n    }\n    viewportIdsToRender.forEach((viewportId) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const { viewport } = enabledElement;\n        if (!viewport) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const element = viewport.element;\n        triggerAnnotationRender(element);\n    });\n}\nexport default triggerAnnotationRenderForViewportIds;\n","export default function filterViewportsWithFrameOfReferenceUID(viewports, FrameOfReferenceUID) {\n    const numViewports = viewports.length;\n    const viewportsWithFrameOfReferenceUID = [];\n    for (let vp = 0; vp < numViewports; vp++) {\n        const viewport = viewports[vp];\n        if (viewport.getFrameOfReferenceUID() === FrameOfReferenceUID) {\n            viewportsWithFrameOfReferenceUID.push(viewport);\n        }\n    }\n    return viewportsWithFrameOfReferenceUID;\n}\n","import { vec3 } from 'gl-matrix';\nexport function filterViewportsWithParallelNormals(viewports, camera, EPS = 0.999) {\n    return viewports.filter((viewport) => {\n        const vpCamera = viewport.getCamera();\n        const isParallel = Math.abs(vec3.dot(vpCamera.viewPlaneNormal, camera.viewPlaneNormal)) >\n            EPS;\n        return isParallel;\n    });\n}\nexport default filterViewportsWithParallelNormals;\n","import { ToolModes } from '../../enums';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst { Active, Passive, Enabled } = ToolModes;\nexport default function filterViewportsWithToolEnabled(viewports, toolName) {\n    const numViewports = viewports.length;\n    const viewportsWithToolEnabled = [];\n    for (let vp = 0; vp < numViewports; vp++) {\n        const viewport = viewports[vp];\n        const toolGroup = getToolGroupForViewport(viewport.id, viewport.renderingEngineId);\n        if (!toolGroup) {\n            continue;\n        }\n        const hasTool = _toolGroupHasActiveEnabledOrPassiveTool(toolGroup, toolName);\n        if (hasTool) {\n            viewportsWithToolEnabled.push(viewport);\n        }\n    }\n    return viewportsWithToolEnabled;\n}\nfunction _toolGroupHasActiveEnabledOrPassiveTool(toolGroup, toolName) {\n    const { toolOptions } = toolGroup;\n    const tool = toolOptions[toolName];\n    if (!tool) {\n        return false;\n    }\n    const toolMode = tool.mode;\n    return toolMode === Active || toolMode === Passive || toolMode === Enabled;\n}\n","import { vec2 } from 'gl-matrix';\nimport { utilities as csUtils } from '@cornerstonejs/core';\nimport { isRangeValid, areColorbarRangesEqual } from './common';\nimport { ColorbarRangeTextPosition } from './enums/ColorbarRangeTextPosition';\nimport { ColorbarCanvas } from './ColorbarCanvas';\nimport { ColorbarTicks } from './ColorbarTicks';\nimport isRangeTextPositionValid from './common/isRangeTextPositionValid';\nimport Widget from '../../../widgets/Widget';\nconst DEFAULTS = {\n    MULTIPLIER: 1,\n    RANGE_TEXT_POSITION: ColorbarRangeTextPosition.Right,\n    TICKS_BAR_SIZE: 50,\n};\nclass Colorbar extends Widget {\n    constructor(props) {\n        super(props);\n        this._isMouseOver = false;\n        this._isInteracting = false;\n        this._mouseOverCallback = (evt) => {\n            this._isMouseOver = true;\n            this.showTicks();\n            evt.stopPropagation();\n        };\n        this._mouseOutCallback = (evt) => {\n            this._isMouseOver = false;\n            this.hideTicks();\n            evt.stopPropagation();\n        };\n        this._mouseDownCallback = (evt) => {\n            this._isInteracting = true;\n            this.showTicks();\n            this._addVOIEventListeners(evt);\n            evt.stopPropagation();\n        };\n        this._mouseDragCallback = (evt, initialState) => {\n            const multipliers = this.getVOIMultipliers();\n            const currentPoints = this._getPointsFromMouseEvent(evt);\n            const { points: startPoints, voiRange: startVOIRange } = initialState;\n            const canvasDelta = vec2.sub(vec2.create(), currentPoints.local, startPoints.local);\n            const wwDelta = canvasDelta[0] * multipliers[0];\n            const wcDelta = canvasDelta[1] * multipliers[1];\n            if (!wwDelta && !wcDelta) {\n                return;\n            }\n            const { lower: voiLower, upper: voiUpper } = startVOIRange;\n            let { windowWidth, windowCenter } = csUtils.windowLevel.toWindowLevel(voiLower, voiUpper);\n            windowWidth = Math.max(windowWidth + wwDelta, 1);\n            windowCenter += wcDelta;\n            const newVoiRange = csUtils.windowLevel.toLowHighRange(windowWidth, windowCenter);\n            this.voiRange = newVoiRange;\n            evt.stopPropagation();\n            evt.preventDefault();\n        };\n        this._mouseUpCallback = (evt) => {\n            this._isInteracting = false;\n            this.hideTicks();\n            this._removeVOIEventListeners();\n            evt.stopPropagation();\n        };\n        this._eventListenersManager =\n            new csUtils.eventListener.MultiTargetEventListenerManager();\n        this._colormaps = Colorbar.getColormapsMap(props);\n        this._activeColormapName = Colorbar.getInitialColormapName(props);\n        this._canvas = this._createCanvas(props);\n        this._ticksBar = this._createTicksBar(props);\n        this._rangeTextPosition =\n            props.ticks?.position ?? DEFAULTS.RANGE_TEXT_POSITION;\n        this._canvas.appendTo(this.rootElement);\n        this._ticksBar.appendTo(this.rootElement);\n        this._addRootElementEventListeners();\n    }\n    get activeColormapName() {\n        return this._activeColormapName;\n    }\n    set activeColormapName(colormapName) {\n        if (colormapName === this._activeColormapName) {\n            return;\n        }\n        const colormap = this._colormaps.get(colormapName);\n        if (!colormap) {\n            console.warn(`Invalid colormap name (${colormapName})`);\n            return;\n        }\n        this._activeColormapName = colormapName;\n        this._canvas.colormap = colormap;\n    }\n    get imageRange() {\n        return this._canvas.imageRange;\n    }\n    set imageRange(imageRange) {\n        this._canvas.imageRange = imageRange;\n        this._ticksBar.imageRange = imageRange;\n    }\n    get voiRange() {\n        return this._canvas.voiRange;\n    }\n    set voiRange(voiRange) {\n        const { voiRange: currentVoiRange } = this._canvas;\n        if (!isRangeValid(voiRange) ||\n            areColorbarRangesEqual(voiRange, currentVoiRange)) {\n            return;\n        }\n        this._canvas.voiRange = voiRange;\n        this._ticksBar.voiRange = voiRange;\n        this.onVoiChange(voiRange);\n    }\n    get showFullImageRange() {\n        return this._canvas.showFullImageRange;\n    }\n    set showFullImageRange(value) {\n        this._canvas.showFullImageRange = value;\n        this._ticksBar.showFullPixelValueRange = value;\n    }\n    destroy() {\n        super.destroy();\n        this._eventListenersManager.reset();\n    }\n    createRootElement() {\n        const rootElement = document.createElement('div');\n        Object.assign(rootElement.style, {\n            position: 'relative',\n            fontSize: '0',\n            width: '100%',\n            height: '100%',\n        });\n        return rootElement;\n    }\n    onContainerResize() {\n        super.onContainerResize();\n        this.updateTicksBar();\n        this._canvas.size = this.containerSize;\n    }\n    getVOIMultipliers() {\n        return [DEFAULTS.MULTIPLIER, DEFAULTS.MULTIPLIER];\n    }\n    onVoiChange(voiRange) {\n    }\n    showTicks() {\n        this.updateTicksBar();\n        this._ticksBar.visible = true;\n    }\n    hideTicks() {\n        if (this._isInteracting || this._isMouseOver) {\n            return;\n        }\n        this._ticksBar.visible = false;\n    }\n    static getColormapsMap(props) {\n        const { colormaps } = props;\n        return colormaps.reduce((items, item) => items.set(item.Name, item), new Map());\n    }\n    static getInitialColormapName(props) {\n        const { activeColormapName, colormaps } = props;\n        const colormapExists = !!activeColormapName &&\n            colormaps.some((cm) => cm.Name === activeColormapName);\n        return colormapExists ? activeColormapName : colormaps[0].Name;\n    }\n    _createCanvas(props) {\n        const { imageRange, voiRange, showFullPixelValueRange } = props;\n        const colormap = this._colormaps.get(this._activeColormapName);\n        return new ColorbarCanvas({\n            colormap,\n            imageRange,\n            voiRange: voiRange,\n            showFullPixelValueRange,\n        });\n    }\n    _createTicksBar(props) {\n        const ticksProps = props.ticks;\n        return new ColorbarTicks({\n            imageRange: props.imageRange,\n            voiRange: props.voiRange,\n            ticks: ticksProps,\n            showFullPixelValueRange: props.showFullPixelValueRange,\n        });\n    }\n    _getPointsFromMouseEvent(evt) {\n        const { rootElement: element } = this;\n        const clientPoint = [evt.clientX, evt.clientY];\n        const pagePoint = [evt.pageX, evt.pageY];\n        const rect = element.getBoundingClientRect();\n        const localPoints = [\n            pagePoint[0] - rect.left - window.pageXOffset,\n            pagePoint[1] - rect.top - window.pageYOffset,\n        ];\n        return { client: clientPoint, page: pagePoint, local: localPoints };\n    }\n    updateTicksBar() {\n        const { width: containerWidth, height: containerHeight } = this.containerSize;\n        if (containerWidth === 0 && containerHeight === 0) {\n            return;\n        }\n        const { _ticksBar: ticksBar, _rangeTextPosition: rangeTextPosition } = this;\n        const isHorizontal = containerWidth >= containerHeight;\n        const width = isHorizontal ? containerWidth : DEFAULTS.TICKS_BAR_SIZE;\n        const height = isHorizontal ? DEFAULTS.TICKS_BAR_SIZE : containerHeight;\n        if (!isRangeTextPositionValid(containerWidth, containerHeight, rangeTextPosition)) {\n            throw new Error('Invalid rangeTextPosition value for the current colobar orientation');\n        }\n        let ticksBarTop;\n        let ticksBarLeft;\n        ticksBar.size = { width, height };\n        if (isHorizontal) {\n            ticksBarLeft = 0;\n            ticksBarTop =\n                rangeTextPosition === ColorbarRangeTextPosition.Top\n                    ? -height\n                    : containerHeight;\n        }\n        else {\n            ticksBarTop = 0;\n            ticksBarLeft =\n                rangeTextPosition === ColorbarRangeTextPosition.Left\n                    ? -width\n                    : containerWidth;\n        }\n        ticksBar.top = ticksBarTop;\n        ticksBar.left = ticksBarLeft;\n    }\n    _addRootElementEventListeners() {\n        const { _eventListenersManager: manager } = this;\n        const { rootElement: element } = this;\n        manager.addEventListener(element, 'mouseover', this._mouseOverCallback);\n        manager.addEventListener(element, 'mouseout', this._mouseOutCallback);\n        manager.addEventListener(element, 'mousedown', this._mouseDownCallback);\n    }\n    _addVOIEventListeners(evt) {\n        const { _eventListenersManager: manager } = this;\n        const points = this._getPointsFromMouseEvent(evt);\n        const voiRange = { ...this._canvas.voiRange };\n        const initialDragState = { points, voiRange };\n        this._removeVOIEventListeners();\n        manager.addEventListener(document, 'voi.mouseup', this._mouseUpCallback);\n        manager.addEventListener(document, 'voi.mousemove', (evt) => this._mouseDragCallback(evt, initialDragState));\n    }\n    _removeVOIEventListeners() {\n        const { _eventListenersManager: manager } = this;\n        manager.removeEventListener(document, 'voi.mouseup');\n        manager.removeEventListener(document, 'voi.mousemove');\n    }\n}\nexport { Colorbar as default, Colorbar };\n","import { eventTarget, VolumeViewport, StackViewport, Enums, utilities, getEnabledElement, cache, } from '@cornerstonejs/core';\nimport { Colorbar } from './Colorbar';\nimport { getVOIMultipliers } from '../../getVOIMultipliers';\nconst { Events } = Enums;\nconst defaultImageRange = { lower: -1000, upper: 1000 };\nclass ViewportColorbar extends Colorbar {\n    constructor(props) {\n        const { element, volumeId } = props;\n        const imageRange = ViewportColorbar._getImageRange(element, volumeId);\n        const voiRange = ViewportColorbar._getVOIRange(element, volumeId);\n        super({ ...props, imageRange, voiRange });\n        this.autoHideTicks = () => {\n            if (this._hideTicksTimeoutId) {\n                return;\n            }\n            const timeLeft = this._hideTicksTime - Date.now();\n            if (timeLeft <= 0) {\n                this.hideTicks();\n            }\n            else {\n                this._hideTicksTimeoutId = window.setTimeout(() => {\n                    this._hideTicksTimeoutId = 0;\n                    this.autoHideTicks();\n                }, timeLeft);\n            }\n        };\n        this._stackNewImageCallback = () => {\n            this.imageRange = ViewportColorbar._getImageRange(this._element);\n        };\n        this._imageVolumeModifiedCallback = (evt) => {\n            const { volumeId } = evt.detail;\n            if (volumeId !== this._volumeId) {\n                return;\n            }\n            const { _element: element } = this;\n            this.imageRange = ViewportColorbar._getImageRange(element, volumeId);\n        };\n        this._viewportVOIModifiedCallback = (evt) => {\n            const { viewportId, volumeId, range: voiRange, colormap } = evt.detail;\n            const { viewport } = this.enabledElement;\n            if (viewportId !== viewport.id || volumeId !== this._volumeId) {\n                return;\n            }\n            this.voiRange = voiRange;\n            if (colormap) {\n                this.activeColormapName = colormap.name;\n            }\n            this.showAndAutoHideTicks();\n        };\n        this._viewportColormapModifiedCallback = (evt) => {\n            const { viewportId, colormap, volumeId } = evt.detail;\n            const { viewport } = this.enabledElement;\n            if (viewportId !== viewport.id || volumeId !== this._volumeId) {\n                return;\n            }\n            this.activeColormapName = colormap.name;\n        };\n        this._element = element;\n        this._volumeId = volumeId;\n        this._addCornerstoneEventListener();\n    }\n    get element() {\n        return this._element;\n    }\n    get enabledElement() {\n        return getEnabledElement(this._element);\n    }\n    getVOIMultipliers() {\n        const { viewport } = this.enabledElement;\n        return getVOIMultipliers(viewport, this._volumeId);\n    }\n    onVoiChange(voiRange) {\n        super.onVoiChange(voiRange);\n        const { viewport } = this.enabledElement;\n        if (viewport instanceof StackViewport) {\n            viewport.setProperties({\n                voiRange: voiRange,\n            });\n            viewport.render();\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const { _volumeId: volumeId } = this;\n            const viewportsContainingVolumeUID = utilities.getViewportsWithVolumeId(volumeId);\n            viewport.setProperties({ voiRange }, volumeId);\n            viewportsContainingVolumeUID.forEach((vp) => vp.render());\n        }\n    }\n    static _getImageRange(element, volumeId) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const actor = viewport.getImageActor(volumeId);\n        if (!actor) {\n            return defaultImageRange;\n        }\n        const imageData = actor.getMapper().getInputData();\n        const scalarData = imageData.getPointData().getScalars();\n        let imageRange;\n        if (!scalarData) {\n            if (!volumeId) {\n                throw new Error('volumeId is required when scalarData is not available');\n            }\n            const volume = cache.getVolume(volumeId);\n            const [minValue, maxValue] = volume.voxelManager.getRange();\n            imageRange = [minValue, maxValue];\n        }\n        else {\n            imageRange = scalarData.getRange();\n        }\n        return imageRange[0] === 0 && imageRange[1] === 0\n            ? defaultImageRange\n            : { lower: imageRange[0], upper: imageRange[1] };\n    }\n    static _getVOIRange(element, volumeId) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const actor = viewport.getImageActor(volumeId);\n        if (!actor) {\n            return defaultImageRange;\n        }\n        const voiRange = actor.getProperty().getRGBTransferFunction(0).getRange();\n        return voiRange[0] === 0 && voiRange[1] === 0\n            ? defaultImageRange\n            : { lower: voiRange[0], upper: voiRange[1] };\n    }\n    showAndAutoHideTicks(interval = 1000) {\n        this._hideTicksTime = Date.now() + interval;\n        this.showTicks();\n        this.autoHideTicks();\n    }\n    _addCornerstoneEventListener() {\n        const { _element: element } = this;\n        eventTarget.addEventListener(Events.IMAGE_VOLUME_MODIFIED, this._imageVolumeModifiedCallback);\n        element.addEventListener(Events.STACK_NEW_IMAGE, this._stackNewImageCallback);\n        element.addEventListener(Events.VOI_MODIFIED, this._viewportVOIModifiedCallback);\n        element.addEventListener(Events.COLORMAP_MODIFIED, this._viewportColormapModifiedCallback);\n    }\n    destroy() {\n        super.destroy();\n        const { _element: element } = this;\n        eventTarget.removeEventListener(Events.IMAGE_VOLUME_MODIFIED, this._imageVolumeModifiedCallback);\n        element.removeEventListener(Events.STACK_NEW_IMAGE, this._stackNewImageCallback);\n        element.removeEventListener(Events.VOI_MODIFIED, this._viewportVOIModifiedCallback);\n        element.removeEventListener(Events.COLORMAP_MODIFIED, this._viewportColormapModifiedCallback);\n    }\n}\nexport { ViewportColorbar as default, ViewportColorbar };\n","export var ColorbarRangeTextPosition;\n(function (ColorbarRangeTextPosition) {\n    ColorbarRangeTextPosition[\"Top\"] = \"top\";\n    ColorbarRangeTextPosition[\"Left\"] = \"left\";\n    ColorbarRangeTextPosition[\"Bottom\"] = \"bottom\";\n    ColorbarRangeTextPosition[\"Right\"] = \"right\";\n})(ColorbarRangeTextPosition || (ColorbarRangeTextPosition = {}));\n","function calculateMinMaxMean(pixelLuminance, globalMin, globalMax) {\n    const numPixels = pixelLuminance.length;\n    let min = globalMax;\n    let max = globalMin;\n    let sum = 0;\n    if (numPixels < 2) {\n        return {\n            min,\n            max,\n            mean: (globalMin + globalMax) / 2,\n        };\n    }\n    for (let index = 0; index < numPixels; index++) {\n        const spv = pixelLuminance[index];\n        min = Math.min(min, spv);\n        max = Math.max(max, spv);\n        sum += spv;\n    }\n    return {\n        min,\n        max,\n        mean: sum / numPixels,\n    };\n}\nexport { calculateMinMaxMean };\n","import { utilities as csUtils, StackViewport, VolumeViewport, } from '@cornerstonejs/core';\nfunction extractWindowLevelRegionToolData(viewport) {\n    if (viewport instanceof VolumeViewport) {\n        return extractImageDataVolume(viewport);\n    }\n    if (viewport instanceof StackViewport) {\n        return extractImageDataStack(viewport);\n    }\n    throw new Error('Viewport not supported');\n}\nfunction extractImageDataVolume(viewport) {\n    const { scalarData, width, height } = csUtils.getCurrentVolumeViewportSlice(viewport);\n    const { min: minPixelValue, max: maxPixelValue } = csUtils.getMinMax(scalarData);\n    return {\n        scalarData,\n        minPixelValue,\n        maxPixelValue,\n        width,\n        height,\n        rows: width,\n        columns: height,\n    };\n}\nfunction extractImageDataStack(viewport) {\n    const imageData = viewport.getImageData();\n    const { scalarData } = imageData;\n    const { min: minPixelValue, max: maxPixelValue } = csUtils.getMinMax(scalarData);\n    const width = imageData.dimensions[0];\n    const height = imageData.dimensions[1];\n    const { rows, columns, color } = viewport.getCornerstoneImage();\n    return {\n        scalarData,\n        width,\n        height,\n        minPixelValue,\n        maxPixelValue,\n        rows,\n        columns,\n        color,\n    };\n}\nexport { extractWindowLevelRegionToolData };\n","function getLuminanceFromRegion(imageData, x, y, width, height) {\n    const luminance = [];\n    let index = 0;\n    const pixelData = imageData.scalarData;\n    let spIndex, row, column;\n    if (imageData.color) {\n        for (row = 0; row < height; row++) {\n            for (column = 0; column < width; column++) {\n                spIndex = ((row + y) * imageData.columns + (column + x)) * 4;\n                const red = pixelData[spIndex];\n                const green = pixelData[spIndex + 1];\n                const blue = pixelData[spIndex + 2];\n                luminance[index++] = 0.2126 * red + 0.7152 * green + 0.0722 * blue;\n            }\n        }\n    }\n    else {\n        for (row = 0; row < height; row++) {\n            for (column = 0; column < width; column++) {\n                spIndex = (row + y) * imageData.columns + (column + x);\n                luminance[index++] = pixelData[spIndex];\n            }\n        }\n    }\n    return luminance;\n}\nexport { getLuminanceFromRegion };\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z' })\n  );\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z' })\n  );\n};","import { m as macro } from '../../macros2.js';\nimport vtkPolyData from '../../Common/DataModel/PolyData.js';\nimport vtkEdgeLocator from '../../Common/DataModel/EdgeLocator.js';\nimport vtkCaseTable from './ImageMarchingSquares/caseTable.js';\n\nconst {\n  vtkErrorMacro,\n  vtkDebugMacro\n} = macro;\n\n// ----------------------------------------------------------------------------\n// vtkImageMarchingSquares methods\n// ----------------------------------------------------------------------------\n\nfunction vtkImageMarchingSquares(publicAPI, model) {\n  /**\n   * Get the X,Y kernels based on the set slicing mode.\n   * @returns {[number, number]}\n   */\n  function getKernels() {\n    let kernelX = 0; // default K slicing mode\n    let kernelY = 1;\n    if (model.slicingMode === 1) {\n      kernelX = 0;\n      kernelY = 2;\n    } else if (model.slicingMode === 0) {\n      kernelX = 1;\n      kernelY = 2;\n    }\n    return [kernelX, kernelY];\n  }\n\n  // Set our className\n  model.classHierarchy.push('vtkImageMarchingSquares');\n\n  /**\n   * Get the list of contour values.\n   * @returns {number[]}\n   */\n  publicAPI.getContourValues = () => model.contourValues;\n\n  /**\n   * Set the list contour values.\n   * @param {number[]} cValues\n   */\n  publicAPI.setContourValues = cValues => {\n    model.contourValues = cValues;\n    publicAPI.modified();\n  };\n  const ids = [];\n  const pixelScalars = [];\n  const pixelPts = [];\n  const edgeLocator = vtkEdgeLocator.newInstance();\n\n  /**\n   * Retrieve scalars and pixel coordinates.\n   * @param {Vector3} ijk origin of the pixel\n   * @param {Vector3} dims dimensions of the image\n   * @param {TypedArray} scalars list of scalar values\n   * @param {Vector3} increments IJK slice increments\n   * @param {number} kernelX index of the X element\n   * @param {number} kernelY index of the Y element\n   */\n  publicAPI.getPixelScalars = (ijk, dims, scalars, increments, kernelX, kernelY) => {\n    const [i, j, k] = ijk;\n\n    // First get the indices for the pixel\n    ids[0] = k * dims[1] * dims[0] + j * dims[0] + i; // i, j, k\n    ids[1] = ids[0] + increments[kernelX]; // i+1, j, k\n    ids[2] = ids[0] + increments[kernelY]; // i, j+1, k\n    ids[3] = ids[2] + increments[kernelX]; // i+1, j+1, k\n\n    // Now retrieve the scalars\n    for (let ii = 0; ii < 4; ++ii) {\n      pixelScalars[ii] = scalars[ids[ii]];\n    }\n  };\n\n  /**\n   * Retrieve pixel coordinates.\n   * @param {Vector3} ijk origin of the pixel\n   * @param {Vector3} origin origin of the image\n   * @param {Vector3} spacing spacing of the image\n   * @param {number} kernelX index of the X element\n   * @param {number} kernelY index of the Y element\n   */\n  publicAPI.getPixelPoints = (ijk, origin, spacing, kernelX, kernelY) => {\n    const i = ijk[kernelX];\n    const j = ijk[kernelY];\n\n    // (i,i+1),(j,j+1),(k,k+1) - i varies fastest; then j; then k\n    pixelPts[0] = origin[kernelX] + i * spacing[kernelX]; // 0\n    pixelPts[1] = origin[kernelY] + j * spacing[kernelY];\n    pixelPts[2] = pixelPts[0] + spacing[kernelX]; // 1\n    pixelPts[3] = pixelPts[1];\n    pixelPts[4] = pixelPts[0]; // 2\n    pixelPts[5] = pixelPts[1] + spacing[kernelY];\n    pixelPts[6] = pixelPts[2]; // 3\n    pixelPts[7] = pixelPts[5];\n  };\n\n  /**\n   * Produce points and lines for the polydata.\n   * @param {number[]} cVal list of contour values\n   * @param {Vector3} ijk origin of the pixel\n   * @param {Vector3} dims dimensions of the image\n   * @param {Vector3} origin origin of the image\n   * @param {Vector3} spacing sapcing of the image\n   * @param {TypedArray} scalars list of scalar values\n   * @param {number[]} points list of points\n   * @param {number[]} lines list of lines\n   * @param {Vector3} increments IJK slice increments\n   * @param {number} kernelX index of the X element\n   * @param {number} kernelY index of the Y element\n   */\n  publicAPI.produceLines = (cVal, ijk, dims, origin, spacing, scalars, points, lines, increments, kernelX, kernelY) => {\n    const k = ijk[model.slicingMode];\n    const CASE_MASK = [1, 2, 8, 4]; // case table is actually for quad\n    const xyz = [];\n    let pId;\n    publicAPI.getPixelScalars(ijk, dims, scalars, increments, kernelX, kernelY);\n    let index = 0;\n    for (let idx = 0; idx < 4; idx++) {\n      if (pixelScalars[idx] >= cVal) {\n        index |= CASE_MASK[idx]; // eslint-disable-line no-bitwise\n      }\n    }\n\n    const pixelLines = vtkCaseTable.getCase(index);\n    if (pixelLines[0] < 0) {\n      return; // don't get the pixel coordinates, nothing to do\n    }\n\n    publicAPI.getPixelPoints(ijk, origin, spacing, kernelX, kernelY);\n    const z = origin[model.slicingMode] + k * spacing[model.slicingMode];\n    for (let idx = 0; pixelLines[idx] >= 0; idx += 2) {\n      lines.push(2);\n      for (let eid = 0; eid < 2; eid++) {\n        const edgeVerts = vtkCaseTable.getEdge(pixelLines[idx + eid]);\n        pId = undefined;\n        if (model.mergePoints) {\n          pId = edgeLocator.isInsertedEdge(ids[edgeVerts[0]], ids[edgeVerts[1]])?.value;\n        }\n        if (pId === undefined) {\n          const t = (cVal - pixelScalars[edgeVerts[0]]) / (pixelScalars[edgeVerts[1]] - pixelScalars[edgeVerts[0]]);\n          const x0 = pixelPts.slice(edgeVerts[0] * 2, (edgeVerts[0] + 1) * 2);\n          const x1 = pixelPts.slice(edgeVerts[1] * 2, (edgeVerts[1] + 1) * 2);\n          xyz[kernelX] = x0[0] + t * (x1[0] - x0[0]);\n          xyz[kernelY] = x0[1] + t * (x1[1] - x0[1]);\n          xyz[model.slicingMode] = z;\n          pId = points.length / 3;\n          points.push(xyz[0], xyz[1], xyz[2]);\n          if (model.mergePoints) {\n            edgeLocator.insertEdge(ids[edgeVerts[0]], ids[edgeVerts[1]], pId);\n          }\n        }\n        lines.push(pId);\n      }\n    }\n  };\n  publicAPI.requestData = (inData, outData) => {\n    // implement requestData\n    const input = inData[0];\n    if (!input) {\n      vtkErrorMacro('Invalid or missing input');\n      return;\n    }\n    if (model.slicingMode == null || model.slicingMode < 0 || model.slicingMode > 2) {\n      vtkErrorMacro('Invalid or missing slicing mode');\n      return;\n    }\n    console.time('msquares');\n\n    // Retrieve output and volume data\n    const origin = input.getOrigin();\n    const spacing = input.getSpacing();\n    const dims = input.getDimensions();\n    const extent = input.getExtent();\n    const increments = input.computeIncrements(extent);\n    const scalars = input.getPointData().getScalars().getData();\n    const [kernelX, kernelY] = getKernels();\n\n    // Points - dynamic array\n    const points = [];\n\n    // Cells - dynamic array\n    const lines = [];\n\n    // Ensure slice is valid\n    let k = Math.round(model.slice);\n    if (k >= dims[model.slicingMode]) {\n      k = 0;\n    }\n\n    // Loop over all contour values, and then pixels, determine case and process\n    const ijk = [0, 0, 0];\n    ijk[model.slicingMode] = k;\n    for (let cv = 0; cv < model.contourValues.length; ++cv) {\n      for (let j = 0; j < dims[kernelY] - 1; ++j) {\n        ijk[kernelY] = j;\n        for (let i = 0; i < dims[kernelX] - 1; ++i) {\n          ijk[kernelX] = i;\n          publicAPI.produceLines(model.contourValues[cv], ijk, dims, origin, spacing, scalars, points, lines, increments, kernelX, kernelY);\n        }\n      }\n      edgeLocator.initialize();\n    }\n\n    // Update output\n    const polydata = vtkPolyData.newInstance();\n    polydata.getPoints().setData(new Float32Array(points), 3);\n    polydata.getLines().setData(new Uint32Array(lines));\n    outData[0] = polydata;\n    vtkDebugMacro('Produced output');\n    console.timeEnd('msquares');\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  contourValues: [],\n  slicingMode: 2,\n  slice: 0,\n  mergePoints: false\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Make this a VTK object\n  macro.obj(publicAPI, model);\n\n  // Also make it an algorithm with one input and one output\n  macro.algo(publicAPI, model, 1, 1);\n  macro.setGet(publicAPI, model, ['slicingMode', 'slice', 'mergePoints']);\n\n  // Object specific methods\n  macro.algo(publicAPI, model, 1, 1);\n  vtkImageMarchingSquares(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkImageMarchingSquares');\n\n// ----------------------------------------------------------------------------\n\nvar vtkImageMarchingSquares$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkImageMarchingSquares$1 as default, extend, newInstance };\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\n/**\n * Converts a Uint8Array to a String.\n * @param {Uint8Array} array that should be converted\n * @param {Number} offset array offset in case only subset of array items should\n                   be extracted (default: 0)\n * @param {Number} limit maximum number of array items that should be extracted\n                   (defaults to length of array)\n * @returns {String}\n */\nfunction uint8ArrayToString(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var limit = arguments.length > 2 ? arguments[2] : undefined;\n  var itemLimit = limit || arr.length - offset;\n  var str = '';\n  for (var i = offset; i < offset + itemLimit; i++) {\n    str += String.fromCharCode(arr[i]);\n  }\n  return str;\n}\n\n/**\n * Converts a String to a Uint8Array.\n * @param {String} str string that should be converted\n * @returns {Uint8Array}\n */\nfunction stringToUint8Array(str) {\n  var arr = new Uint8Array(str.length);\n  for (var i = 0, j = str.length; i < j; i++) {\n    arr[i] = str.charCodeAt(i);\n  }\n  return arr;\n}\n\n/**\n * Identifies the boundary in a multipart/related message header.\n * @param {String} header message header\n * @returns {String} boundary\n */\nfunction identifyBoundary(header) {\n  var parts = header.split('\\r\\n');\n  for (var i = 0; i < parts.length; i++) {\n    if (parts[i].substr(0, 2) === '--') {\n      return parts[i];\n    }\n  }\n  return null;\n}\n\n/**\n * Checks whether a given token is contained by a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be present\n * @param {Number} offset offset in message content from where search should start\n * @returns {Boolean} whether message contains token at offset\n */\nfunction containsToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  if (offset + token.length > message.length) {\n    return false;\n  }\n  var index = offset;\n  for (var i = 0; i < token.length; i++) {\n    if (token[i] !== message[index]) {\n      return false;\n    }\n    index += 1;\n  }\n  return true;\n}\n\n/**\n * Finds a given token in a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be found\n * @param {String} offset message body offset from where search should start\n * @returns {Boolean} whether message has a part at given offset or not\n */\nfunction findToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var maxSearchLength = arguments.length > 3 ? arguments[3] : undefined;\n  var searchLength = message.length;\n  if (maxSearchLength) {\n    searchLength = Math.min(offset + maxSearchLength, message.length);\n  }\n  for (var i = offset; i < searchLength; i++) {\n    // If the first value of the message matches\n    // the first value of the token, check if\n    // this is the full token.\n    if (message[i] === token[0]) {\n      if (containsToken(message, token, i)) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * Create a random GUID\n *\n * @return {string}\n */\nfunction guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n  return \"\".concat(s4() + s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4()).concat(s4()).concat(s4());\n}\n\n/**\n * @typedef {Object} MultipartEncodedData\n * @property {ArrayBuffer} data The encoded Multipart Data\n * @property {String} boundary The boundary used to divide pieces of the encoded data\n */\n\n/**\n * Encode one or more DICOM datasets into a single body so it can be\n * sent using the Multipart Content-Type.\n *\n * @param {ArrayBuffer[]} datasets Array containing each file to be encoded in the\n                          multipart body, passed as ArrayBuffers.\n * @param {String} [boundary] Optional string to define a boundary between each part\n                              of the multipart body. If this is not specified, a random\n                              GUID will be generated.\n * @return {MultipartEncodedData} The Multipart encoded data returned as an Object. This\n                                  contains both the data itself, and the boundary string\n                                  used to divide it.\n */\nfunction multipartEncode(datasets) {\n  var boundary = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : guid();\n  var contentType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'application/dicom';\n  var contentTypeString = \"Content-Type: \".concat(contentType);\n  var header = \"\\r\\n--\".concat(boundary, \"\\r\\n\").concat(contentTypeString, \"\\r\\n\\r\\n\");\n  var footer = \"\\r\\n--\".concat(boundary, \"--\");\n  var headerArray = stringToUint8Array(header);\n  var footerArray = stringToUint8Array(footer);\n  var headerLength = headerArray.length;\n  var footerLength = footerArray.length;\n  var length = 0;\n\n  // Calculate the total length for the final array\n  var contentArrays = datasets.map(function (datasetBuffer) {\n    var contentArray = new Uint8Array(datasetBuffer);\n    var contentLength = contentArray.length;\n    length += headerLength + contentLength + footerLength;\n    return contentArray;\n  });\n\n  // Allocate the array\n  var multipartArray = new Uint8Array(length);\n\n  // Set the initial header\n  multipartArray.set(headerArray, 0);\n\n  // Write each dataset into the multipart array\n  var position = 0;\n  contentArrays.forEach(function (contentArray) {\n    multipartArray.set(headerArray, position);\n    multipartArray.set(contentArray, position + headerLength);\n    position += headerLength + contentArray.length;\n  });\n  multipartArray.set(footerArray, position);\n  return {\n    data: multipartArray.buffer,\n    boundary: boundary\n  };\n}\n\n/**\n * Decode a Multipart encoded ArrayBuffer and return the components as an Array.\n *\n * @param {ArrayBuffer} response Data encoded as a 'multipart/related' message\n * @returns {Array} The content\n */\nfunction multipartDecode(response) {\n  // Use the raw data if it is provided in an appropriate format\n  var message = ArrayBuffer.isView(response) ? response : new Uint8Array(response);\n\n  /* Set a maximum length to search for the header boundaries, otherwise\n       findToken can run for a long time\n    */\n  var maxSearchLength = 1000;\n\n  // First look for the multipart mime header\n  var separator = stringToUint8Array('\\r\\n\\r\\n');\n  var headerIndex = findToken(message, separator, 0, maxSearchLength);\n  if (headerIndex === -1) {\n    throw new Error('Response message has no multipart mime header');\n  }\n  var header = uint8ArrayToString(message, 0, headerIndex);\n  var boundaryString = identifyBoundary(header);\n  if (!boundaryString) {\n    throw new Error('Header of response message does not specify boundary');\n  }\n  var boundary = stringToUint8Array(boundaryString);\n  var boundaryLength = boundary.length;\n  var components = [];\n  var offset = boundaryLength;\n\n  // Loop until we cannot find any more boundaries\n  var boundaryIndex;\n  while (boundaryIndex !== -1) {\n    // Search for the next boundary in the message, starting\n    // from the current offset position\n    boundaryIndex = findToken(message, boundary, offset);\n\n    // If no further boundaries are found, stop here.\n    if (boundaryIndex === -1) {\n      break;\n    }\n    var headerTokenIndex = findToken(message, separator, offset, maxSearchLength);\n    if (headerTokenIndex === -1) {\n      throw new Error('Response message part has no mime header');\n    }\n    offset = headerTokenIndex + separator.length;\n\n    // Extract data from response message, excluding \"\\r\\n\"\n    var spacingLength = 2;\n    var data = response.slice(offset, boundaryIndex - spacingLength);\n\n    // Add the data to the array of results\n    components.push(data);\n\n    // Move the offset to the end of the current section,\n    // plus the identified boundary\n    offset = boundaryIndex + boundaryLength;\n  }\n  return components;\n}\n\nfunction isObject(obj) {\n  return _typeof(obj) === 'object' && obj !== null;\n}\nfunction isEmptyObject(obj) {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\nfunction areValidRequestHooks(requestHooks) {\n  var isValid = Array.isArray(requestHooks) && requestHooks.every(function (requestHook) {\n    return typeof requestHook === 'function' && requestHook.length === 2;\n  });\n  if (!isValid) {\n    console.warn('Request hooks should have the following signature: ' + 'function requestHook(request, metadata) { return request; }');\n  }\n  return isValid;\n}\nvar getFirstResult = function getFirstResult(result) {\n  return result[0];\n};\nvar MEDIATYPES = {\n  DICOM: 'application/dicom',\n  DICOM_JSON: 'application/dicom+json',\n  OCTET_STREAM: 'application/octet-stream',\n  PDF: 'application/pdf',\n  JPEG: 'image/jpeg',\n  PNG: 'image/png'\n};\n\n/**\n * debugLog is a function that can be called with console.log arguments, and will\n * be conditionally displayed, only when debug logging is enabled.\n */\nvar debugLog = function debugLog() {};\n\n/**\n * @typedef { import(\"../types/types\").InstanceMetadata } InstanceMetadata\n */\n\n/**\n * A callback with the request instance and metadata information\n * of the currently request being executed that should necessarily\n * return the given request optionally modified.\n * @typedef {function} RequestHook\n * @param {XMLHttpRequest} request - The original XMLHttpRequest instance.\n * @param {object} metadata - The metadata used by the request.\n */\n\n/**\n * Class for interacting with DICOMweb RESTful services.\n */\nvar DICOMwebClient = /*#__PURE__*/function () {\n  /**\n   * @constructor\n   * @param {Object} options\n   * @param {String} options.url - URL of the DICOMweb RESTful Service endpoint\n   * @param {String=} options.qidoURLPrefix - URL path prefix for QIDO-RS\n   * @param {String=} options.wadoURLPrefix - URL path prefix for WADO-RS\n   * @param {String=} options.stowURLPrefix - URL path prefix for STOW-RS\n   * @param {String=} options.username - Username\n   * @param {String=} options.password - Password\n   * @param {Object=} options.headers - HTTP headers\n   * @param {Array.<RequestHook>=} options.requestHooks - Request hooks.\n   * @param {Object=} options.verbose - print to console request warnings and errors, default true\n   * @param {Object=} options.debug - print to the console debug level information/status updates.\n   * @param {boolean|String} options.singlepart - retrieve singlepart for the named types.\n   * The available types are:  bulkdata, video, image.  true means all.\n   */\n  function DICOMwebClient(options) {\n    _classCallCheck(this, DICOMwebClient);\n    this.baseURL = options.url;\n    if (!this.baseURL) {\n      console.error('no DICOMweb base url provided - calls that require a URL will fail');\n    }\n    if ('username' in options) {\n      this.username = options.username;\n      if (!('password' in options)) {\n        console.error('no password provided to authenticate with DICOMweb service');\n      }\n      this.password = options.password;\n    }\n    if ('qidoURLPrefix' in options) {\n      debugLog(\"use URL prefix for QIDO-RS: \".concat(options.qidoURLPrefix));\n      this.qidoURL = \"\".concat(this.baseURL, \"/\").concat(options.qidoURLPrefix);\n    } else {\n      this.qidoURL = this.baseURL;\n    }\n    if ('wadoURLPrefix' in options) {\n      debugLog(\"use URL prefix for WADO-RS: \".concat(options.wadoURLPrefix));\n      this.wadoURL = \"\".concat(this.baseURL, \"/\").concat(options.wadoURLPrefix);\n    } else {\n      this.wadoURL = this.baseURL;\n    }\n    if ('stowURLPrefix' in options) {\n      debugLog(\"use URL prefix for STOW-RS: \".concat(options.stowURLPrefix));\n      this.stowURL = \"\".concat(this.baseURL, \"/\").concat(options.stowURLPrefix);\n    } else {\n      this.stowURL = this.baseURL;\n    }\n    if (options.singlepart) {\n      debugLog('use singlepart', options.singlepart);\n      this.singlepart = options.singlepart === true ? 'bulkdata,video,image' : options.singlepart;\n    } else {\n      this.singlepart = '';\n    }\n    if ('requestHooks' in options) {\n      this.requestHooks = options.requestHooks;\n    }\n\n    // Headers to pass to requests.\n    this.headers = options.headers || {};\n\n    // Optional error interceptor callback to handle any failed request.\n    this.errorInterceptor = options.errorInterceptor || function () {\n      return undefined;\n    };\n\n    // Verbose - print to console request warnings and errors, default true\n    this.verbose = options.verbose !== false;\n    this.setDebug(options.debug);\n  }\n\n  /**\n   * Allows setting the debug log information. \n   * Note this is different from verbose in that verbose is whether to include warning/error information, defaulting to true\n   * \n   * @param {boolean} debugLevel \n   * @param {function} debugLogFunction to call with the debug output arguments. \n   */\n  _createClass(DICOMwebClient, [{\n    key: \"setDebug\",\n    value: function setDebug() {\n      var debugLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var debugLogFunction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      this.debugLevel = !!debugLevel;\n      debugLog = debugLogFunction || debugLevel ? console.log : function () {};\n    }\n    /**\n     * Gets debug flag\n     * \n     * @returns true if debug logging is enabled\n     */\n  }, {\n    key: \"getDebug\",\n    value: function getDebug() {\n      return this.debugLevel;\n    }\n    /**\n     * Sets verbose flag.\n     *\n     * @param {Boolean} verbose\n     */\n  }, {\n    key: \"setVerbose\",\n    value: function setVerbose(verbose) {\n      this.verbose = verbose;\n    }\n    /**\n     * Gets verbose flag.\n     *\n     * @return {Boolean} verbose\n     */\n  }, {\n    key: \"getVerbose\",\n    value: function getVerbose() {\n      return this.verbose;\n    }\n  }, {\n    key: \"_httpRequest\",\n    /**\n     * Performs an HTTP request.\n     *\n     * @param {String} url\n     * @param {String} method\n     * @param {Object} headers\n     * @param {Object} options\n     * @param {Array.<RequestHook>} options.requestHooks - Request hooks.\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @return {*}\n     * @private\n     */\n    value: function _httpRequest(url, method) {\n      var _this = this;\n      var headers = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var errorInterceptor = this.errorInterceptor,\n        requestHooks = this.requestHooks;\n      return new Promise(function (resolve, reject) {\n        var request = options.request ? options.request : new XMLHttpRequest();\n        request.open(method, url, true);\n        if ('responseType' in options) {\n          request.responseType = options.responseType;\n        }\n        if (_typeof(headers) === 'object') {\n          Object.keys(headers).forEach(function (key) {\n            request.setRequestHeader(key, headers[key]);\n          });\n        }\n\n        // now add custom headers from the user\n        // (e.g. access tokens)\n        var userHeaders = _this.headers;\n        Object.keys(userHeaders).forEach(function (key) {\n          request.setRequestHeader(key, userHeaders[key]);\n        });\n\n        // Event triggered when upload starts\n        request.onloadstart = function onloadstart() {\n          debugLog('upload started: ', url);\n        };\n\n        // Event triggered when upload ends\n        request.onloadend = function onloadend() {\n          debugLog('upload finished');\n        };\n\n        // Handle response message\n        request.onreadystatechange = function () {\n          if (request.readyState === 4) {\n            if (request.status === 200) {\n              var contentType = request.getResponseHeader('Content-Type');\n              // Automatically distinguishes between multipart and singlepart in an array buffer, and\n              // converts them into a consistent type.\n              if (contentType && contentType.indexOf('multipart') !== -1) {\n                resolve(multipartDecode(request.response));\n              } else if (request.responseType === 'arraybuffer') {\n                resolve([request.response]);\n              } else {\n                resolve(request.response);\n              }\n            } else if (request.status === 202) {\n              if (_this.verbose) {\n                console.warn('some resources already existed: ', request);\n              }\n              resolve(request.response);\n            } else if (request.status === 204) {\n              if (_this.verbose) {\n                console.warn('empty response for request: ', request);\n              }\n              resolve([]);\n            } else {\n              var error = new Error('request failed');\n              error.request = request;\n              error.response = request.response;\n              error.status = request.status;\n              if (_this.verbose) {\n                console.error('request failed: ', request);\n                console.error(error);\n                console.error(error.response);\n              }\n              errorInterceptor(error);\n              reject(error);\n            }\n          }\n        };\n\n        // Event triggered while download progresses\n        if ('progressCallback' in options) {\n          if (typeof options.progressCallback === 'function') {\n            request.onprogress = options.progressCallback;\n          }\n        }\n        if (requestHooks && areValidRequestHooks(requestHooks)) {\n          var combinedHeaders = Object.assign({}, headers, _this.headers);\n          var metadata = {\n            method: method,\n            url: url,\n            headers: combinedHeaders\n          };\n          var pipeRequestHooks = function pipeRequestHooks(functions) {\n            return function (args) {\n              return functions.reduce(function (props, fn) {\n                return fn(props, metadata);\n              }, args);\n            };\n          };\n          var pipedRequest = pipeRequestHooks(requestHooks);\n          request = pipedRequest(request);\n        }\n\n        // Add withCredentials to request if needed\n        if ('withCredentials' in options) {\n          if (options.withCredentials) {\n            request.withCredentials = true;\n          }\n        }\n        if ('data' in options) {\n          request.send(options.data);\n        } else {\n          request.send();\n        }\n      });\n    }\n    /**\n     * Performs an HTTP GET request.\n     *\n     * @param {String} url\n     * @param {Object} headers\n     * @param {Object} responseType\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGet\",\n    value: function _httpGet(url, headers, responseType, progressCallback, withCredentials) {\n      return this._httpRequest(url, 'get', headers, {\n        responseType: responseType,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials\n      });\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/json\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationJson\",\n    value: function _httpGetApplicationJson(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.DICOM_JSON\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/pdf\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationPdf\",\n    value: function _httpGetApplicationPdf(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.PDF\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with an image\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetImage\",\n    value: function _httpGetImage(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['image/', 'image/*', 'image/jpeg', 'image/jp2', 'image/gif', 'image/png'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a text\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetText\",\n    value: function _httpGetText(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['text/', 'text/*', 'text/html', 'text/plain', 'text/rtf', 'text/xml'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a video\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetVideo\",\n    value: function _httpGetVideo(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['video/', 'video/*', 'video/mpeg', 'video/mp4', 'video/H265'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Asserts that a given media type is valid.\n     *\n     * @params {String} mediaType media type\n     */\n  }, {\n    key: \"_httpGetMultipartImage\",\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with an image media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n    value: function _httpGetMultipartImage(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['image/jpeg', 'image/gif', 'image/png', 'image/jp2'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with a video media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartVideo\",\n    value: function _httpGetMultipartVideo(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['video/', 'video/*', 'video/mpeg2', 'video/mp4', 'video/H265'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.4.100': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.101': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.102': ['video/mp4'],\n          '1.2.840.10008.1.2.4.103': ['video/mp4'],\n          '1.2.840.10008.1.2.4.104': ['video/mp4'],\n          '1.2.840.10008.1.2.4.105': ['video/mp4'],\n          '1.2.840.10008.1.2.4.106': ['video/mp4']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/dicom media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationDicom\",\n    value: function _httpGetMultipartApplicationDicom(url, mediaTypes, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/dicom';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': [defaultMediaType],\n        '1.2.840.10008.1.2.5': [defaultMediaType],\n        '1.2.840.10008.1.2.4.50': [defaultMediaType],\n        '1.2.840.10008.1.2.4.51': [defaultMediaType],\n        '1.2.840.10008.1.2.4.57': [defaultMediaType],\n        '1.2.840.10008.1.2.4.70': [defaultMediaType],\n        '1.2.840.10008.1.2.4.80': [defaultMediaType],\n        '1.2.840.10008.1.2.4.81': [defaultMediaType],\n        '1.2.840.10008.1.2.4.90': [defaultMediaType],\n        '1.2.840.10008.1.2.4.91': [defaultMediaType],\n        '1.2.840.10008.1.2.4.92': [defaultMediaType],\n        '1.2.840.10008.1.2.4.93': [defaultMediaType],\n        '1.2.840.10008.1.2.4.100': [defaultMediaType],\n        '1.2.840.10008.1.2.4.101': [defaultMediaType],\n        '1.2.840.10008.1.2.4.102': [defaultMediaType],\n        '1.2.840.10008.1.2.4.103': [defaultMediaType],\n        '1.2.840.10008.1.2.4.104': [defaultMediaType],\n        '1.2.840.10008.1.2.4.105': [defaultMediaType],\n        '1.2.840.10008.1.2.4.106': [defaultMediaType]\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/octet-stream, OR any of the equivalencies for that (eg\n     * application/pdf etc)\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationOctetStream\",\n    value: function _httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/octet-stream';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': _toConsumableArray(Object.values(MEDIATYPES))\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      if (byteRange) {\n        headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP POST request.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @param {Function} progressCallback\n     * @param {XMLHttpRequest} request - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPost\",\n    value: function _httpPost(url, headers, data, progressCallback, withCredentials, request) {\n      return this._httpRequest(url, 'post', headers, {\n        data: data,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials,\n        request: request\n      });\n    }\n    /**\n     * Performs an HTTP POST request with content-type application/dicom+json.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPostApplicationJson\",\n    value: function _httpPostApplicationJson(url, data, progressCallback, withCredentials) {\n      var headers = {\n        'Content-Type': MEDIATYPES.DICOM_JSON\n      };\n      return this._httpPost(url, headers, data, progressCallback, withCredentials);\n    }\n    /**\n     * Parses media type and extracts its type and subtype.\n     *\n     * @param {String} mediaType - HTTP media type (e.g. image/jpeg)\n     * @private\n     * @returns {String[]} Media type and subtype\n     */\n  }, {\n    key: \"searchForStudies\",\n    /**\n     * Searches for DICOM studies.\n     *\n     * @param {Object} options\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @return {Object[]} Study representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2)\n     */\n    value: function searchForStudies() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      debugLog('search for studies');\n      var withCredentials = false;\n      var url = \"\".concat(this.qidoURL, \"/studies\");\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the study\n     */\n  }, {\n    key: \"retrieveStudyMetadata\",\n    value: function retrieveStudyMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of study metadata');\n      }\n      debugLog(\"retrieve metadata of study \".concat(options.studyInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM series.\n     *\n     * @param {Object} options\n     * @param {Object} [options.studyInstanceUID] - Study Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Series representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2a)\n     */\n  }, {\n    key: \"searchForSeries\",\n    value: function searchForSeries() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      if ('studyInstanceUID' in options) {\n        debugLog(\"search series of study \".concat(options.studyInstanceUID));\n        url += \"/studies/\".concat(options.studyInstanceUID);\n      }\n      url += '/series';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the series\n     */\n  }, {\n    key: \"retrieveSeriesMetadata\",\n    value: function retrieveSeriesMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of series metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of series metadata');\n      }\n      debugLog(\"retrieve metadata of series \".concat(options.seriesInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {String} [options.seriesInstanceUID] - Series Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Instance representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2b)\n     */\n  }, {\n    key: \"searchForInstances\",\n    value: function searchForInstances() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      var withCredentials = false;\n      if ('studyInstanceUID' in options) {\n        url += \"/studies/\".concat(options.studyInstanceUID);\n        if ('seriesInstanceUID' in options) {\n          debugLog(\"search for instances of series \".concat(options.seriesInstanceUID));\n          url += \"/series/\".concat(options.seriesInstanceUID);\n        } else {\n          debugLog(\"search for instances of study \".concat(options.studyInstanceUID));\n        }\n      } else {\n        debugLog('search for instances');\n      }\n      url += '/instances';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /** Returns a WADO-URI URL for an instance\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {String} WADO-URI URL\n     */\n  }, {\n    key: \"buildInstanceWadoURIUrl\",\n    value: function buildInstanceWadoURIUrl(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required.');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required.');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required.');\n      }\n      var contentType = options.contentType || MEDIATYPES.DICOM;\n      var transferSyntax = options.transferSyntax || '*';\n      var params = [];\n      params.push('requestType=WADO');\n      params.push(\"studyUID=\".concat(options.studyInstanceUID));\n      params.push(\"seriesUID=\".concat(options.seriesInstanceUID));\n      params.push(\"objectUID=\".concat(options.sopInstanceUID));\n      params.push(\"contentType=\".concat(contentType));\n      params.push(\"transferSyntax=\".concat(transferSyntax));\n      var paramString = params.join('&');\n      return \"\".concat(this.wadoURL, \"?\").concat(paramString);\n    }\n    /**\n     * Retrieves metadata for a DICOM Instance.\n     *\n     * @param {Object} options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<InstanceMetadata>} metadata elements in DICOM JSON format\n     */\n  }, {\n    key: \"retrieveInstanceMetadata\",\n    value: function retrieveInstanceMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance metadata');\n      }\n      debugLog(\"retrieve metadata of instance \".concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves frames for a DICOM Instance.\n     * @param {Object} options options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @returns {Array} frame items as byte arrays of the pixel data element\n     */\n  }, {\n    key: \"retrieveInstanceFrames\",\n    value: function retrieveInstanceFrames(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of instance frames');\n      }\n      debugLog(\"retrieve frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString());\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationOctetStream(url, false, false, false, progressCallback, withCredentials);\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length > 1) {\n        /**\n         * Enable request of frames that are stored either compressed\n         * (image/* media type) or uncompressed (application/octet-stream\n         * media type).\n         */\n        var supportedMediaTypes = {\n          '1.2.840.10008.1.2.1': ['application/octet-stream'],\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx'],\n          '1.2.840.10008.1.2.4.201': ['image/jhc'],\n          '1.2.840.10008.1.2.4.202': ['image/jhc']\n        };\n        var headers = {\n          Accept: DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes)\n        };\n        return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('application')) {\n        return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetMultipartImage(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetMultipartVideo(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of frames.\"));\n    }\n    /**\n    * Element in mediaTypes parameter\n    * @typedef {Object} MediaType\n    * @param {String} [MediaType.mediaType] - ie 'image/jpeg', 'image/png'...\n    */\n    /**\n     * Retrieves an individual, server-side rendered DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Promise<ArrayBuffer>} Rendered DICOM Instance\n     */\n  }, {\n    key: \"retrieveInstanceRendered\",\n    value: function retrieveInstanceRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('text')) {\n        return this._httpGetText(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType === MEDIATYPES.PDF) {\n        return this._httpGetApplicationPdf(url, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves a thumbnail of an DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer} Thumbnail\n     */\n  }, {\n    key: \"retrieveInstanceThumbnail\",\n    value: function retrieveInstanceThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves rendered frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesRendered\",\n    value: function retrieveInstanceFramesRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      debugLog(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, false, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves thumbnail of frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesThumbnail\",\n    value: function retrieveInstanceFramesThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      console.debug(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<ArrayBuffer>} DICOM Part 10 file as Arraybuffer\n     */\n  }, {\n    key: \"retrieveInstance\",\n    value: function retrieveInstance(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti = options.withCredentials,\n        withCredentials = _options$withCredenti === void 0 ? false : _options$withCredenti;\n      var _options$progressCall = options.progressCallback,\n        progressCallback = _options$progressCall === void 0 ? false : _options$progressCall;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of instance.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {Function} options.progressCallback\n     * @returns {Promise<ArrayBuffer[]>} DICOM Instances\n     */\n  }, {\n    key: \"retrieveSeries\",\n    value: function retrieveSeries(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of series.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {ArrayBuffer[]} DICOM Instances\n     */\n  }, {\n    key: \"retrieveStudy\",\n    value: function retrieveStudy(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti2 = options.withCredentials,\n        withCredentials = _options$withCredenti2 === void 0 ? false : _options$withCredenti2;\n      var _options$progressCall2 = options.progressCallback,\n        progressCallback = _options$progressCall2 === void 0 ? false : _options$progressCall2;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of study.\"));\n    }\n    /**\n     * Retrieves and parses BulkData from a BulkDataURI location.\n     * Decodes the multipart encoded data and returns the resulting data\n     * as an ArrayBuffer.\n     *\n     * See http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.5.5.html\n     *\n     * @param {Object} options\n     * @param {string} options.BulkDataURI to retrieve\n     * @param {Array}  options.mediaTypes to use to fetch the URI\n     * @param {string} options.byteRange to request a sub-range (only valid on single part)\n     * @returns {Promise<Array>} Bulkdata parts\n     */\n  }, {\n    key: \"retrieveBulkData\",\n    value: function retrieveBulkData(options) {\n      if (!('BulkDataURI' in options)) {\n        throw new Error('BulkDataURI is required.');\n      }\n      var url = options.BulkDataURI;\n      var mediaTypes = options.mediaTypes,\n        byteRange = options.byteRange;\n      var _options$withCredenti3 = options.withCredentials,\n        withCredentials = _options$withCredenti3 === void 0 ? false : _options$withCredenti3;\n      var _options$progressCall3 = options.progressCallback,\n        progressCallback = _options$progressCall3 === void 0 ? false : _options$progressCall3;\n      if (this.singlepart.indexOf('bulkdata') !== -1) {\n        return this._httpGet(url, options.headers, 'arraybuffer', null, withCredentials);\n      }\n      if (mediaTypes) {\n        try {\n          var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n          if (commonMediaType === 'image/') {\n            return this._httpGetMultipartImage(url, mediaTypes, byteRange, false, false, progressCallback, withCredentials);\n          }\n        } catch (e) {\n          // No-op - this happens sometimes if trying to fetch the specific desired type but want to fallback to octet-stream\n        }\n      }\n\n      // Just use the media types provided\n      return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, false, progressCallback, withCredentials);\n    }\n    /**\n     * Stores DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {ArrayBuffer[]} options.datasets - DICOM Instances in PS3.10 format\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @returns {Promise} Response message\n     */\n  }, {\n    key: \"storeInstances\",\n    value: function storeInstances(options) {\n      if (!('datasets' in options)) {\n        throw new Error('datasets are required for storing');\n      }\n      var url = \"\".concat(this.stowURL, \"/studies\");\n      if ('studyInstanceUID' in options) {\n        url += \"/\".concat(options.studyInstanceUID);\n      }\n      var _multipartEncode = multipartEncode(options.datasets),\n        data = _multipartEncode.data,\n        boundary = _multipartEncode.boundary;\n      var headers = {\n        'Content-Type': \"multipart/related; type=\\\"application/dicom\\\"; boundary=\\\"\".concat(boundary, \"\\\"\")\n      };\n      var _options$withCredenti4 = options.withCredentials,\n        withCredentials = _options$withCredenti4 === void 0 ? false : _options$withCredenti4;\n      return this._httpPost(url, headers, data, options.progressCallback, withCredentials, options.request);\n    }\n  }], [{\n    key: \"_parseQueryParameters\",\n    value: function _parseQueryParameters() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var queryString = '?';\n      Object.keys(params).forEach(function (key, index) {\n        if (index !== 0) {\n          queryString += '&';\n        }\n        queryString += \"\".concat(key, \"=\").concat(encodeURIComponent(params[key]));\n      });\n      return queryString;\n    }\n  }, {\n    key: \"_assertMediaTypeIsValid\",\n    value: function _assertMediaTypeIsValid(mediaType) {\n      if (!mediaType) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var sepIndex = mediaType.indexOf('/');\n      if (sepIndex === -1) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var mediaTypeType = mediaType.slice(0, sepIndex);\n      var types = ['application', 'image', 'text', 'video'];\n      if (!types.includes(mediaTypeType)) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      if (mediaType.slice(sepIndex + 1).includes('/')) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n    }\n  }, {\n    key: \"_parseMediaType\",\n    value: function _parseMediaType(mediaType) {\n      DICOMwebClient._assertMediaTypeIsValid(mediaType);\n      return mediaType.split('/');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET request messages.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_buildAcceptHeaderFieldValue\",\n    value: function _buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      var fieldValueParts = mediaTypes.map(function (item) {\n        var mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        if (!supportedMediaTypes.includes(mediaType)) {\n          throw new Error(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n        }\n        return mediaType;\n      });\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET multipart request\n     * messages.  Will throw an exception if no media types are found which are acceptable,\n     * but will only log a verbose level message when types are specified which are\n     * not acceptable.  This allows requesting several types with having to know\n     * whether they are all acceptable or not.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @private\n     */\n  }, {\n    key: \"_buildMultipartAcceptHeaderFieldValue\",\n    value: function _buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      var _this2 = this;\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      if (!Array.isArray(supportedMediaTypes) && !isObject(supportedMediaTypes)) {\n        throw new Error('Supported media types must be provided as an Array or an Object');\n      }\n      var fieldValueParts = [];\n      mediaTypes.forEach(function (item) {\n        var transferSyntaxUID = item.transferSyntaxUID,\n          mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        var fieldValue = \"multipart/related; type=\\\"\".concat(mediaType, \"\\\"\");\n        if (isObject(supportedMediaTypes)) {\n          // SupportedMediaTypes is a lookup table that maps Transfer Syntax UID\n          // to one or more Media Types\n          if (!Object.values(supportedMediaTypes).flat(1).includes(mediaType)) {\n            if (!mediaType.endsWith('/*') || !mediaType.endsWith('/')) {\n              debugLog(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n              return;\n            }\n          }\n          if (transferSyntaxUID) {\n            if (transferSyntaxUID !== '*') {\n              if (!Object.keys(supportedMediaTypes).includes(transferSyntaxUID)) {\n                throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n              }\n              var expectedMediaTypes = supportedMediaTypes[transferSyntaxUID];\n              if (!expectedMediaTypes.includes(mediaType)) {\n                var actualType = DICOMwebClient._parseMediaType(mediaType)[0];\n                expectedMediaTypes.map(function (expectedMediaType) {\n                  var expectedType = DICOMwebClient._parseMediaType(expectedMediaType)[0];\n                  var haveSameType = actualType === expectedType;\n                  if (haveSameType && (mediaType.endsWith('/*') || mediaType.endsWith('/'))) {\n                    return;\n                  }\n                  throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n                });\n              }\n            }\n            fieldValue += \"; transfer-syntax=\".concat(transferSyntaxUID);\n          }\n        } else if (Array.isArray(supportedMediaTypes) && !supportedMediaTypes.includes(mediaType)) {\n          if (_this2.verbose) {\n            console.warn(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n          }\n          return;\n        }\n        fieldValueParts.push(fieldValue);\n      });\n      if (!fieldValueParts.length) {\n        throw new Error(\"No acceptable media types found among \".concat(JSON.stringify(mediaTypes)));\n      }\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds a range header field value for HTTP GET request messages.\n     *\n     * @param {Array} byteRange - Start and end of byte range\n     * @returns {String} Range header field value\n     * @private\n     */\n  }, {\n    key: \"_buildRangeHeaderFieldValue\",\n    value: function _buildRangeHeaderFieldValue() {\n      var byteRange = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      if (byteRange.length === 1) {\n        return \"bytes=\".concat(byteRange[0], \"-\");\n      }\n      if (byteRange.length === 2) {\n        return \"bytes=\".concat(byteRange[0], \"-\").concat(byteRange[1]);\n      }\n      return 'bytes=0-';\n    }\n    /**\n     * Gets types that are shared among acceptable media types.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Types that are shared among acceptable media types\n     */\n  }, {\n    key: \"_getSharedMediaTypes\",\n    value: function _getSharedMediaTypes(mediaTypes) {\n      var types = new Set();\n      if (!mediaTypes || !mediaTypes.length) {\n        return types;\n      }\n      mediaTypes.forEach(function (item) {\n        var mediaType = item.mediaType;\n        var type = DICOMwebClient._parseMediaType(mediaType)[0];\n        types.add(\"\".concat(type, \"/\"));\n      });\n      return Array.from(types);\n    }\n    /**\n     * Gets common base type of acceptable media types and asserts that only\n     one type is specified. For example, ``(\"image/jpeg\", \"image/jp2\")``\n     will pass, but ``(\"image/jpeg\", \"video/mpeg2\")`` will raise an\n     exception.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Common media type, eg `image/` for the above example.\n     */\n  }, {\n    key: \"_getCommonMediaType\",\n    value: function _getCommonMediaType(mediaTypes) {\n      if (!mediaTypes || !mediaTypes.length) {\n        throw new Error('No acceptable media types provided');\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length === 0) {\n        throw new Error('No common acceptable media type could be identified.');\n      } else if (sharedMediaTypes.length > 1) {\n        throw new Error('Acceptable media types must have the same type.');\n      }\n      return sharedMediaTypes[0];\n    }\n  }]);\n  return DICOMwebClient;\n}();\n\nfunction findSubstring(str, before, after) {\n  var beforeIndex = str.lastIndexOf(before) + before.length;\n  if (beforeIndex < before.length) {\n    return null;\n  }\n  if (after !== undefined) {\n    var afterIndex = str.lastIndexOf(after);\n    if (afterIndex < 0) {\n      return null;\n    }\n    return str.substring(beforeIndex, afterIndex);\n  }\n  return str.substring(beforeIndex);\n}\nfunction getStudyInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'studies/', '/series');\n  if (!uid) {\n    uid = findSubstring(uri, 'studies/');\n  }\n  if (!uid) {\n    console.debug(\"Study Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSeriesInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'series/', '/instances');\n  if (!uid) {\n    uid = findSubstring(uri, 'series/');\n  }\n  if (!uid) {\n    console.debug(\"Series Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSOPInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, '/instances/', '/frames');\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/', '/metadata');\n  }\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/');\n  }\n  if (!uid) {\n    console.debug(\"SOP Instance UID could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getFrameNumbersFromUri(uri) {\n  var numbers = findSubstring(uri, '/frames/', '/rendered');\n  if (!numbers) {\n    numbers = findSubstring(uri, '/frames/');\n  }\n  if (numbers === undefined) {\n    console.debug(\"Frame Numbers could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return numbers.split(',');\n}\n\nvar version = '0.5.2';\n\nvar api = {\n  DICOMwebClient: DICOMwebClient\n};\nvar utils = {\n  getStudyInstanceUIDFromUri: getStudyInstanceUIDFromUri,\n  getSeriesInstanceUIDFromUri: getSeriesInstanceUIDFromUri,\n  getSOPInstanceUIDFromUri: getSOPInstanceUIDFromUri,\n  getFrameNumbersFromUri: getFrameNumbersFromUri\n};\n\nexport { api, utils, version };\n//# sourceMappingURL=dicomweb-client.es.js.map\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    splice = arrayProto.splice;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used to compose bitmasks for comparison styles. */\nvar UNORDERED_COMPARE_FLAG = 1,\n    PARTIAL_COMPARE_FLAG = 2;\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array ? array.length : 0;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  if (value !== value) {\n    return baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\n/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a cache value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    Uint8Array = root.Uint8Array,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView'),\n    Map = getNative(root, 'Map'),\n    Promise = getNative(root, 'Promise'),\n    Set = getNative(root, 'Set'),\n    WeakMap = getNative(root, 'WeakMap'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values ? values.length : 0;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  this.__data__ = new ListCache(entries);\n}\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n}\n\n/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  return this.__data__['delete'](key);\n}\n\n/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\n/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var cache = this.__data__;\n  if (cache instanceof ListCache) {\n    var pairs = cache.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      return this;\n    }\n    cache = this.__data__ = new MapCache(pairs);\n  }\n  cache.set(key, value);\n  return this;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  // Safari 9 makes `arguments.length` enumerable in strict mode.\n  var result = (isArray(value) || isArguments(value))\n    ? baseTimes(value.length, String)\n    : [];\n\n  var length = result.length,\n      skipIndexes = !!length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `getTag`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  return objectToString.call(value);\n}\n\n/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {boolean} [bitmask] The bitmask of comparison flags.\n *  The bitmask may be composed of the following flags:\n *     1 - Unordered comparison\n *     2 - Partial comparison\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, customizer, bitmask, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObject(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, baseIsEqual, customizer, bitmask, stack);\n}\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {number} [bitmask] The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, equalFunc, customizer, bitmask, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = arrayTag,\n      othTag = arrayTag;\n\n  if (!objIsArr) {\n    objTag = getTag(object);\n    objTag = objTag == argsTag ? objectTag : objTag;\n  }\n  if (!othIsArr) {\n    othTag = getTag(other);\n    othTag = othTag == argsTag ? objectTag : othTag;\n  }\n  var objIsObj = objTag == objectTag && !isHostObject(object),\n      othIsObj = othTag == objectTag && !isHostObject(other),\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, equalFunc, customizer, bitmask, stack)\n      : equalByTag(object, other, objTag, equalFunc, customizer, bitmask, stack);\n  }\n  if (!(bitmask & PARTIAL_COMPARE_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, customizer, bitmask, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, equalFunc, customizer, bitmask, stack);\n}\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, customizer, UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[objectToString.call(value)];\n}\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, undefined, UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG);\n  };\n}\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} customizer The function to customize comparisons.\n * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, equalFunc, customizer, bitmask, stack) {\n  var isPartial = bitmask & PARTIAL_COMPARE_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & UNORDERED_COMPARE_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!seen.has(othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, customizer, bitmask, stack))) {\n              return seen.add(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, customizer, bitmask, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} customizer The function to customize comparisons.\n * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, equalFunc, customizer, bitmask, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & PARTIAL_COMPARE_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= UNORDERED_COMPARE_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), equalFunc, customizer, bitmask, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} customizer The function to customize comparisons.\n * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, equalFunc, customizer, bitmask, stack) {\n  var isPartial = bitmask & PARTIAL_COMPARE_FLAG,\n      objProps = keys(object),\n      objLength = objProps.length,\n      othProps = keys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, customizer, bitmask, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11,\n// for data views in Edge < 14, and promises in Node.js.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = objectToString.call(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : undefined;\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var result,\n      index = -1,\n      length = path.length;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result) {\n    return result;\n  }\n  var length = object ? object.length : 0;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\n/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * This method is like `_.uniq` except that it accepts `iteratee` which is\n * invoked for each element in `array` to generate the criterion by which\n * uniqueness is computed. The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee=_.identity]\n *  The iteratee invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n * // => [2.1, 1.2]\n *\n * // The `_.property` iteratee shorthand.\n * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n * // => [{ 'x': 1 }, { 'x': 2 }]\n */\nfunction uniqBy(array, iteratee) {\n  return (array && array.length)\n    ? baseUniq(array, baseIteratee(iteratee, 2))\n    : [];\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\n/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = uniqBy;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","var copyObject = require('./_copyObject'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nmodule.exports = baseAssign;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nmodule.exports = baseAssignIn;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var Stack = require('./_Stack'),\n    arrayEach = require('./_arrayEach'),\n    assignValue = require('./_assignValue'),\n    baseAssign = require('./_baseAssign'),\n    baseAssignIn = require('./_baseAssignIn'),\n    cloneBuffer = require('./_cloneBuffer'),\n    copyArray = require('./_copyArray'),\n    copySymbols = require('./_copySymbols'),\n    copySymbolsIn = require('./_copySymbolsIn'),\n    getAllKeys = require('./_getAllKeys'),\n    getAllKeysIn = require('./_getAllKeysIn'),\n    getTag = require('./_getTag'),\n    initCloneArray = require('./_initCloneArray'),\n    initCloneByTag = require('./_initCloneByTag'),\n    initCloneObject = require('./_initCloneObject'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isMap = require('./isMap'),\n    isObject = require('./isObject'),\n    isSet = require('./isSet'),\n    keys = require('./keys'),\n    keysIn = require('./keysIn');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nmodule.exports = baseClone;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nmodule.exports = baseIsMap;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nmodule.exports = baseIsSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n","var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nmodule.exports = cloneDataView;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nmodule.exports = cloneRegExp;\n","var Symbol = require('./_Symbol');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nmodule.exports = cloneSymbol;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","var copyObject = require('./_copyObject'),\n    getSymbols = require('./_getSymbols');\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nmodule.exports = copySymbols;\n","var copyObject = require('./_copyObject'),\n    getSymbolsIn = require('./_getSymbolsIn');\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nmodule.exports = copySymbolsIn;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbolsIn = require('./_getSymbolsIn'),\n    keysIn = require('./keysIn');\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nmodule.exports = getAllKeysIn;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var arrayPush = require('./_arrayPush'),\n    getPrototype = require('./_getPrototype'),\n    getSymbols = require('./_getSymbols'),\n    stubArray = require('./stubArray');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nmodule.exports = getSymbolsIn;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nmodule.exports = initCloneArray;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer'),\n    cloneDataView = require('./_cloneDataView'),\n    cloneRegExp = require('./_cloneRegExp'),\n    cloneSymbol = require('./_cloneSymbol'),\n    cloneTypedArray = require('./_cloneTypedArray');\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nmodule.exports = initCloneByTag;\n","var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var baseClone = require('./_baseClone');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * This method is like `_.clone` except that it recursively clones `value`.\n *\n * @static\n * @memberOf _\n * @since 1.0.0\n * @category Lang\n * @param {*} value The value to recursively clone.\n * @returns {*} Returns the deep cloned value.\n * @see _.clone\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var deep = _.cloneDeep(objects);\n * console.log(deep[0] === objects[0]);\n * // => false\n */\nfunction cloneDeep(value) {\n  return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nmodule.exports = cloneDeep;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseForOwn = require('./_baseForOwn'),\n    castFunction = require('./_castFunction');\n\n/**\n * Iterates over own enumerable string keyed properties of an object and\n * invokes `iteratee` for each property. The iteratee is invoked with three\n * arguments: (value, key, object). Iteratee functions may exit iteration\n * early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 0.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Object} Returns `object`.\n * @see _.forOwnRight\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.forOwn(new Foo, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forOwn(object, iteratee) {\n  return object && baseForOwn(object, castFunction(iteratee));\n}\n\nmodule.exports = forOwn;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var baseIsMap = require('./_baseIsMap'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nmodule.exports = isMap;\n","var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n","var baseIsSet = require('./_baseIsSet'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nmodule.exports = isSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nmodule.exports = isString;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var checkboardCache = {};\n\nexport var render = function render(c1, c2, size, serverCanvas) {\n  if (typeof document === 'undefined' && !serverCanvas) {\n    return null;\n  }\n  var canvas = serverCanvas ? new serverCanvas() : document.createElement('canvas');\n  canvas.width = size * 2;\n  canvas.height = size * 2;\n  var ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return null;\n  } // If no context can be found, return early.\n  ctx.fillStyle = c1;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = c2;\n  ctx.fillRect(0, 0, size, size);\n  ctx.translate(size, size);\n  ctx.fillRect(0, 0, size, size);\n  return canvas.toDataURL();\n};\n\nexport var get = function get(c1, c2, size, serverCanvas) {\n  var key = c1 + '-' + c2 + '-' + size + (serverCanvas ? '-server' : '');\n\n  if (checkboardCache[key]) {\n    return checkboardCache[key];\n  }\n\n  var checkboard = render(c1, c2, size, serverCanvas);\n  checkboardCache[key] = checkboard;\n  return checkboard;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React, { isValidElement } from 'react';\nimport reactCSS from 'reactcss';\nimport * as checkboard from '../../helpers/checkboard';\n\nexport var Checkboard = function Checkboard(_ref) {\n  var white = _ref.white,\n      grey = _ref.grey,\n      size = _ref.size,\n      renderers = _ref.renderers,\n      borderRadius = _ref.borderRadius,\n      boxShadow = _ref.boxShadow,\n      children = _ref.children;\n\n  var styles = reactCSS({\n    'default': {\n      grid: {\n        borderRadius: borderRadius,\n        boxShadow: boxShadow,\n        absolute: '0px 0px 0px 0px',\n        background: 'url(' + checkboard.get(white, grey, size, renderers.canvas) + ') center left'\n      }\n    }\n  });\n  return isValidElement(children) ? React.cloneElement(children, _extends({}, children.props, { style: _extends({}, children.props.style, styles.grid) })) : React.createElement('div', { style: styles.grid });\n};\n\nCheckboard.defaultProps = {\n  size: 8,\n  white: 'transparent',\n  grey: 'rgba(0,0,0,.08)',\n  renderers: {}\n};\n\nexport default Checkboard;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as alpha from '../../helpers/alpha';\n\nimport Checkboard from './Checkboard';\n\nexport var Alpha = function (_ref) {\n  _inherits(Alpha, _ref);\n\n  function Alpha() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Alpha);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Alpha.__proto__ || Object.getPrototypeOf(Alpha)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = alpha.calculateChange(e, _this.props.hsl, _this.props.direction, _this.props.a, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleChange);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Alpha, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var rgb = this.props.rgb;\n      var styles = reactCSS({\n        'default': {\n          alpha: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          checkboard: {\n            absolute: '0px 0px 0px 0px',\n            overflow: 'hidden',\n            borderRadius: this.props.radius\n          },\n          gradient: {\n            absolute: '0px 0px 0px 0px',\n            background: 'linear-gradient(to right, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          container: {\n            position: 'relative',\n            height: '100%',\n            margin: '0 3px'\n          },\n          pointer: {\n            position: 'absolute',\n            left: rgb.a * 100 + '%'\n          },\n          slider: {\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            marginTop: '1px',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          gradient: {\n            background: 'linear-gradient(to bottom, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)'\n          },\n          pointer: {\n            left: 0,\n            top: rgb.a * 100 + '%'\n          }\n        },\n        'overwrite': _extends({}, this.props.style)\n      }, {\n        vertical: this.props.direction === 'vertical',\n        overwrite: true\n      });\n\n      return React.createElement(\n        'div',\n        { style: styles.alpha },\n        React.createElement(\n          'div',\n          { style: styles.checkboard },\n          React.createElement(Checkboard, { renderers: this.props.renderers })\n        ),\n        React.createElement('div', { style: styles.gradient }),\n        React.createElement(\n          'div',\n          {\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Alpha;\n}(PureComponent || Component);\n\nexport default Alpha;","export var calculateChange = function calculateChange(e, hsl, direction, initialA, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var a = void 0;\n    if (top < 0) {\n      a = 0;\n    } else if (top > containerHeight) {\n      a = 1;\n    } else {\n      a = Math.round(top * 100 / containerHeight) / 100;\n    }\n\n    if (hsl.a !== a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: a,\n        source: 'rgb'\n      };\n    }\n  } else {\n    var _a = void 0;\n    if (left < 0) {\n      _a = 0;\n    } else if (left > containerWidth) {\n      _a = 1;\n    } else {\n      _a = Math.round(left * 100 / containerWidth) / 100;\n    }\n\n    if (initialA !== _a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: _a,\n        source: 'rgb'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\n\nvar DEFAULT_ARROW_OFFSET = 1;\n\nvar UP_KEY_CODE = 38;\nvar DOWN_KEY_CODE = 40;\nvar VALID_KEY_CODES = [UP_KEY_CODE, DOWN_KEY_CODE];\nvar isValidKeyCode = function isValidKeyCode(keyCode) {\n  return VALID_KEY_CODES.indexOf(keyCode) > -1;\n};\nvar getNumberValue = function getNumberValue(value) {\n  return Number(String(value).replace(/%/g, ''));\n};\n\nvar idCounter = 1;\n\nexport var EditableInput = function (_ref) {\n  _inherits(EditableInput, _ref);\n\n  function EditableInput(props) {\n    _classCallCheck(this, EditableInput);\n\n    var _this = _possibleConstructorReturn(this, (EditableInput.__proto__ || Object.getPrototypeOf(EditableInput)).call(this));\n\n    _this.handleBlur = function () {\n      if (_this.state.blurValue) {\n        _this.setState({ value: _this.state.blurValue, blurValue: null });\n      }\n    };\n\n    _this.handleChange = function (e) {\n      _this.setUpdatedValue(e.target.value, e);\n    };\n\n    _this.handleKeyDown = function (e) {\n      // In case `e.target.value` is a percentage remove the `%` character\n      // and update accordingly with a percentage\n      // https://github.com/casesandberg/react-color/issues/383\n      var value = getNumberValue(e.target.value);\n      if (!isNaN(value) && isValidKeyCode(e.keyCode)) {\n        var offset = _this.getArrowOffset();\n        var updatedValue = e.keyCode === UP_KEY_CODE ? value + offset : value - offset;\n\n        _this.setUpdatedValue(updatedValue, e);\n      }\n    };\n\n    _this.handleDrag = function (e) {\n      if (_this.props.dragLabel) {\n        var newValue = Math.round(_this.props.value + e.movementX);\n        if (newValue >= 0 && newValue <= _this.props.dragMax) {\n          _this.props.onChange && _this.props.onChange(_this.getValueObjectWithLabel(newValue), e);\n        }\n      }\n    };\n\n    _this.handleMouseDown = function (e) {\n      if (_this.props.dragLabel) {\n        e.preventDefault();\n        _this.handleDrag(e);\n        window.addEventListener('mousemove', _this.handleDrag);\n        window.addEventListener('mouseup', _this.handleMouseUp);\n      }\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleDrag);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.state = {\n      value: String(props.value).toUpperCase(),\n      blurValue: String(props.value).toUpperCase()\n    };\n\n    _this.inputId = 'rc-editable-input-' + idCounter++;\n    return _this;\n  }\n\n  _createClass(EditableInput, [{\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.value !== this.state.value && (prevProps.value !== this.props.value || prevState.value !== this.state.value)) {\n        if (this.input === document.activeElement) {\n          this.setState({ blurValue: String(this.props.value).toUpperCase() });\n        } else {\n          this.setState({ value: String(this.props.value).toUpperCase(), blurValue: !this.state.blurValue && String(this.props.value).toUpperCase() });\n        }\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getValueObjectWithLabel',\n    value: function getValueObjectWithLabel(value) {\n      return _defineProperty({}, this.props.label, value);\n    }\n  }, {\n    key: 'getArrowOffset',\n    value: function getArrowOffset() {\n      return this.props.arrowOffset || DEFAULT_ARROW_OFFSET;\n    }\n  }, {\n    key: 'setUpdatedValue',\n    value: function setUpdatedValue(value, e) {\n      var onChangeValue = this.props.label ? this.getValueObjectWithLabel(value) : value;\n      this.props.onChange && this.props.onChange(onChangeValue, e);\n\n      this.setState({ value: value });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            position: 'relative'\n          }\n        },\n        'user-override': {\n          wrap: this.props.style && this.props.style.wrap ? this.props.style.wrap : {},\n          input: this.props.style && this.props.style.input ? this.props.style.input : {},\n          label: this.props.style && this.props.style.label ? this.props.style.label : {}\n        },\n        'dragLabel-true': {\n          label: {\n            cursor: 'ew-resize'\n          }\n        }\n      }, {\n        'user-override': true\n      }, this.props);\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap },\n        React.createElement('input', {\n          id: this.inputId,\n          style: styles.input,\n          ref: function ref(input) {\n            return _this2.input = input;\n          },\n          value: this.state.value,\n          onKeyDown: this.handleKeyDown,\n          onChange: this.handleChange,\n          onBlur: this.handleBlur,\n          placeholder: this.props.placeholder,\n          spellCheck: 'false'\n        }),\n        this.props.label && !this.props.hideLabel ? React.createElement(\n          'label',\n          {\n            htmlFor: this.inputId,\n            style: styles.label,\n            onMouseDown: this.handleMouseDown\n          },\n          this.props.label\n        ) : null\n      );\n    }\n  }]);\n\n  return EditableInput;\n}(PureComponent || Component);\n\nexport default EditableInput;","export var calculateChange = function calculateChange(e, direction, hsl, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var h = void 0;\n    if (top < 0) {\n      h = 359;\n    } else if (top > containerHeight) {\n      h = 0;\n    } else {\n      var percent = -(top * 100 / containerHeight) + 100;\n      h = 360 * percent / 100;\n    }\n\n    if (hsl.h !== h) {\n      return {\n        h: h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  } else {\n    var _h = void 0;\n    if (left < 0) {\n      _h = 0;\n    } else if (left > containerWidth) {\n      _h = 359;\n    } else {\n      var _percent = left * 100 / containerWidth;\n      _h = 360 * _percent / 100;\n    }\n\n    if (hsl.h !== _h) {\n      return {\n        h: _h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as hue from '../../helpers/hue';\n\nexport var Hue = function (_ref) {\n  _inherits(Hue, _ref);\n\n  function Hue() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Hue);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Hue.__proto__ || Object.getPrototypeOf(Hue)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = hue.calculateChange(e, _this.props.direction, _this.props.hsl, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Hue, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      window.removeEventListener('mousemove', this.handleChange);\n      window.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props$direction = this.props.direction,\n          direction = _props$direction === undefined ? 'horizontal' : _props$direction;\n\n\n      var styles = reactCSS({\n        'default': {\n          hue: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius,\n            boxShadow: this.props.shadow\n          },\n          container: {\n            padding: '0 2px',\n            position: 'relative',\n            height: '100%',\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            left: this.props.hsl.h * 100 / 360 + '%'\n          },\n          slider: {\n            marginTop: '1px',\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          pointer: {\n            left: '0px',\n            top: -(this.props.hsl.h * 100 / 360) + 100 + '%'\n          }\n        }\n      }, { vertical: direction === 'vertical' });\n\n      return React.createElement(\n        'div',\n        { style: styles.hue },\n        React.createElement(\n          'div',\n          {\n            className: 'hue-' + direction,\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'style',\n            null,\n            '\\n            .hue-horizontal {\\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n\\n            .hue-vertical {\\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n          '\n          ),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Hue;\n}(PureComponent || Component);\n\nexport default Hue;","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import defineProperty from './_defineProperty.js';\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nexport default baseAssignValue;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignMergeValue;\n","import createBaseFor from './_createBaseFor.js';\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nexport default baseFor;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nexport default createBaseFor;\n","import root from './_root.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nexport default cloneBuffer;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","import Uint8Array from './_Uint8Array.js';\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nexport default cloneArrayBuffer;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nexport default cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nexport default copyArray;\n","import isObject from './isObject.js';\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nexport default baseCreate;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","import baseCreate from './_baseCreate.js';\nimport getPrototype from './_getPrototype.js';\nimport isPrototype from './_isPrototype.js';\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nexport default initCloneObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","/**\n * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key === 'constructor' && typeof object[key] === 'function') {\n    return;\n  }\n\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nexport default safeGet;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignValue;\n","import assignValue from './_assignValue.js';\nimport baseAssignValue from './_baseAssignValue.js';\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nexport default copyObject;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default nativeKeysIn;\n","import isObject from './isObject.js';\nimport isPrototype from './_isPrototype.js';\nimport nativeKeysIn from './_nativeKeysIn.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeysIn;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeysIn from './_baseKeysIn.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nexport default keysIn;\n","import copyObject from './_copyObject.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nexport default toPlainObject;\n","import assignMergeValue from './_assignMergeValue.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\nimport copyArray from './_copyArray.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\nimport isBuffer from './isBuffer.js';\nimport isFunction from './isFunction.js';\nimport isObject from './isObject.js';\nimport isPlainObject from './isPlainObject.js';\nimport isTypedArray from './isTypedArray.js';\nimport safeGet from './_safeGet.js';\nimport toPlainObject from './toPlainObject.js';\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nexport default baseMergeDeep;\n","import Stack from './_Stack.js';\nimport assignMergeValue from './_assignMergeValue.js';\nimport baseFor from './_baseFor.js';\nimport baseMergeDeep from './_baseMergeDeep.js';\nimport isObject from './isObject.js';\nimport keysIn from './keysIn.js';\nimport safeGet from './_safeGet.js';\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    stack || (stack = new Stack);\n    if (isObject(srcValue)) {\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nexport default baseMerge;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","import eq from './eq.js';\nimport isArrayLike from './isArrayLike.js';\nimport isIndex from './_isIndex.js';\nimport isObject from './isObject.js';\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nexport default isIterateeCall;\n","import baseMerge from './_baseMerge.js';\nimport createAssigner from './_createAssigner.js';\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nexport default merge;\n","import baseRest from './_baseRest.js';\nimport isIterateeCall from './_isIterateeCall.js';\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nexport default createAssigner;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nexport var Raised = function Raised(_ref) {\n  var zDepth = _ref.zDepth,\n      radius = _ref.radius,\n      background = _ref.background,\n      children = _ref.children,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles;\n\n  var styles = reactCSS(merge({\n    'default': {\n      wrap: {\n        position: 'relative',\n        display: 'inline-block'\n      },\n      content: {\n        position: 'relative'\n      },\n      bg: {\n        absolute: '0px 0px 0px 0px',\n        boxShadow: '0 ' + zDepth + 'px ' + zDepth * 4 + 'px rgba(0,0,0,.24)',\n        borderRadius: radius,\n        background: background\n      }\n    },\n    'zDepth-0': {\n      bg: {\n        boxShadow: 'none'\n      }\n    },\n\n    'zDepth-1': {\n      bg: {\n        boxShadow: '0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)'\n      }\n    },\n    'zDepth-2': {\n      bg: {\n        boxShadow: '0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)'\n      }\n    },\n    'zDepth-3': {\n      bg: {\n        boxShadow: '0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)'\n      }\n    },\n    'zDepth-4': {\n      bg: {\n        boxShadow: '0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)'\n      }\n    },\n    'zDepth-5': {\n      bg: {\n        boxShadow: '0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)'\n      }\n    },\n    'square': {\n      bg: {\n        borderRadius: '0'\n      }\n    },\n    'circle': {\n      bg: {\n        borderRadius: '50%'\n      }\n    }\n  }, passedStyles), { 'zDepth-1': zDepth === 1 });\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap },\n    React.createElement('div', { style: styles.bg }),\n    React.createElement(\n      'div',\n      { style: styles.content },\n      children\n    )\n  );\n};\n\nRaised.propTypes = {\n  background: PropTypes.string,\n  zDepth: PropTypes.oneOf([0, 1, 2, 3, 4, 5]),\n  radius: PropTypes.number,\n  styles: PropTypes.object\n};\n\nRaised.defaultProps = {\n  background: '#fff',\n  zDepth: 1,\n  radius: 2,\n  styles: {}\n};\n\nexport default Raised;","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import debounce from './debounce.js';\nimport isObject from './isObject.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nexport default throttle;\n","export var calculateChange = function calculateChange(e, hsl, container) {\n  var _container$getBoundin = container.getBoundingClientRect(),\n      containerWidth = _container$getBoundin.width,\n      containerHeight = _container$getBoundin.height;\n\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (left < 0) {\n    left = 0;\n  } else if (left > containerWidth) {\n    left = containerWidth;\n  }\n\n  if (top < 0) {\n    top = 0;\n  } else if (top > containerHeight) {\n    top = containerHeight;\n  }\n\n  var saturation = left / containerWidth;\n  var bright = 1 - top / containerHeight;\n\n  return {\n    h: hsl.h,\n    s: saturation,\n    v: bright,\n    a: hsl.a,\n    source: 'hsv'\n  };\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport throttle from 'lodash-es/throttle';\nimport * as saturation from '../../helpers/saturation';\n\nexport var Saturation = function (_ref) {\n  _inherits(Saturation, _ref);\n\n  function Saturation(props) {\n    _classCallCheck(this, Saturation);\n\n    var _this = _possibleConstructorReturn(this, (Saturation.__proto__ || Object.getPrototypeOf(Saturation)).call(this, props));\n\n    _this.handleChange = function (e) {\n      typeof _this.props.onChange === 'function' && _this.throttle(_this.props.onChange, saturation.calculateChange(e, _this.props.hsl, _this.container), e);\n    };\n\n    _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      var renderWindow = _this.getContainerRenderWindow();\n      renderWindow.addEventListener('mousemove', _this.handleChange);\n      renderWindow.addEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.throttle = throttle(function (fn, data, e) {\n      fn(data, e);\n    }, 50);\n    return _this;\n  }\n\n  _createClass(Saturation, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.throttle.cancel();\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getContainerRenderWindow',\n    value: function getContainerRenderWindow() {\n      var container = this.container;\n\n      var renderWindow = window;\n      while (!renderWindow.document.contains(container) && renderWindow.parent !== renderWindow) {\n        renderWindow = renderWindow.parent;\n      }\n      return renderWindow;\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      var renderWindow = this.getContainerRenderWindow();\n      renderWindow.removeEventListener('mousemove', this.handleChange);\n      renderWindow.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _ref2 = this.props.style || {},\n          color = _ref2.color,\n          white = _ref2.white,\n          black = _ref2.black,\n          pointer = _ref2.pointer,\n          circle = _ref2.circle;\n\n      var styles = reactCSS({\n        'default': {\n          color: {\n            absolute: '0px 0px 0px 0px',\n            background: 'hsl(' + this.props.hsl.h + ',100%, 50%)',\n            borderRadius: this.props.radius\n          },\n          white: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          black: {\n            absolute: '0px 0px 0px 0px',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            top: -(this.props.hsv.v * 100) + 100 + '%',\n            left: this.props.hsv.s * 100 + '%',\n            cursor: 'default'\n          },\n          circle: {\n            width: '4px',\n            height: '4px',\n            boxShadow: '0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\\n            0 0 1px 2px rgba(0,0,0,.4)',\n            borderRadius: '50%',\n            cursor: 'hand',\n            transform: 'translate(-2px, -2px)'\n          }\n        },\n        'custom': {\n          color: color,\n          white: white,\n          black: black,\n          pointer: pointer,\n          circle: circle\n        }\n      }, { 'custom': !!this.props.style });\n\n      return React.createElement(\n        'div',\n        {\n          style: styles.color,\n          ref: function ref(container) {\n            return _this2.container = container;\n          },\n          onMouseDown: this.handleMouseDown,\n          onTouchMove: this.handleChange,\n          onTouchStart: this.handleChange\n        },\n        React.createElement(\n          'style',\n          null,\n          '\\n          .saturation-white {\\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\\n          }\\n          .saturation-black {\\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\\n          }\\n        '\n        ),\n        React.createElement(\n          'div',\n          { style: styles.white, className: 'saturation-white' },\n          React.createElement('div', { style: styles.black, className: 'saturation-black' }),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.circle })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Saturation;\n}(PureComponent || Component);\n\nexport default Saturation;","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nexport default arrayEach;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import baseForOwn from './_baseForOwn.js';\nimport createBaseEach from './_createBaseEach.js';\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nexport default baseEach;\n","import isArrayLike from './isArrayLike.js';\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nexport default createBaseEach;\n","import baseFor from './_baseFor.js';\nimport keys from './keys.js';\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nexport default baseForOwn;\n","import identity from './identity.js';\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nexport default castFunction;\n","import arrayEach from './_arrayEach.js';\nimport baseEach from './_baseEach.js';\nimport castFunction from './_castFunction.js';\nimport isArray from './isArray.js';\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nexport default forEach;\n","// This file is autogenerated. It's used to publish ESM to npm.\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\n// https://github.com/bgrins/TinyColor\n// Brian Grinstead, MIT License\n\nvar trimLeft = /^\\s+/;\nvar trimRight = /\\s+$/;\nfunction tinycolor(color, opts) {\n  color = color ? color : \"\";\n  opts = opts || {};\n\n  // If input is already a tinycolor, return itself\n  if (color instanceof tinycolor) {\n    return color;\n  }\n  // If we are called as a function, call using new instead\n  if (!(this instanceof tinycolor)) {\n    return new tinycolor(color, opts);\n  }\n  var rgb = inputToRGB(color);\n  this._originalInput = color, this._r = rgb.r, this._g = rgb.g, this._b = rgb.b, this._a = rgb.a, this._roundA = Math.round(100 * this._a) / 100, this._format = opts.format || rgb.format;\n  this._gradientType = opts.gradientType;\n\n  // Don't let the range of [0,255] come back in [0,1].\n  // Potentially lose a little bit of precision here, but will fix issues where\n  // .5 gets interpreted as half of the total, instead of half of 1\n  // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n  if (this._r < 1) this._r = Math.round(this._r);\n  if (this._g < 1) this._g = Math.round(this._g);\n  if (this._b < 1) this._b = Math.round(this._b);\n  this._ok = rgb.ok;\n}\ntinycolor.prototype = {\n  isDark: function isDark() {\n    return this.getBrightness() < 128;\n  },\n  isLight: function isLight() {\n    return !this.isDark();\n  },\n  isValid: function isValid() {\n    return this._ok;\n  },\n  getOriginalInput: function getOriginalInput() {\n    return this._originalInput;\n  },\n  getFormat: function getFormat() {\n    return this._format;\n  },\n  getAlpha: function getAlpha() {\n    return this._a;\n  },\n  getBrightness: function getBrightness() {\n    //http://www.w3.org/TR/AERT#color-contrast\n    var rgb = this.toRgb();\n    return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n  },\n  getLuminance: function getLuminance() {\n    //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n    var rgb = this.toRgb();\n    var RsRGB, GsRGB, BsRGB, R, G, B;\n    RsRGB = rgb.r / 255;\n    GsRGB = rgb.g / 255;\n    BsRGB = rgb.b / 255;\n    if (RsRGB <= 0.03928) R = RsRGB / 12.92;else R = Math.pow((RsRGB + 0.055) / 1.055, 2.4);\n    if (GsRGB <= 0.03928) G = GsRGB / 12.92;else G = Math.pow((GsRGB + 0.055) / 1.055, 2.4);\n    if (BsRGB <= 0.03928) B = BsRGB / 12.92;else B = Math.pow((BsRGB + 0.055) / 1.055, 2.4);\n    return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n  },\n  setAlpha: function setAlpha(value) {\n    this._a = boundAlpha(value);\n    this._roundA = Math.round(100 * this._a) / 100;\n    return this;\n  },\n  toHsv: function toHsv() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    return {\n      h: hsv.h * 360,\n      s: hsv.s,\n      v: hsv.v,\n      a: this._a\n    };\n  },\n  toHsvString: function toHsvString() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    var h = Math.round(hsv.h * 360),\n      s = Math.round(hsv.s * 100),\n      v = Math.round(hsv.v * 100);\n    return this._a == 1 ? \"hsv(\" + h + \", \" + s + \"%, \" + v + \"%)\" : \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \" + this._roundA + \")\";\n  },\n  toHsl: function toHsl() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    return {\n      h: hsl.h * 360,\n      s: hsl.s,\n      l: hsl.l,\n      a: this._a\n    };\n  },\n  toHslString: function toHslString() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    var h = Math.round(hsl.h * 360),\n      s = Math.round(hsl.s * 100),\n      l = Math.round(hsl.l * 100);\n    return this._a == 1 ? \"hsl(\" + h + \", \" + s + \"%, \" + l + \"%)\" : \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \" + this._roundA + \")\";\n  },\n  toHex: function toHex(allow3Char) {\n    return rgbToHex(this._r, this._g, this._b, allow3Char);\n  },\n  toHexString: function toHexString(allow3Char) {\n    return \"#\" + this.toHex(allow3Char);\n  },\n  toHex8: function toHex8(allow4Char) {\n    return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\n  },\n  toHex8String: function toHex8String(allow4Char) {\n    return \"#\" + this.toHex8(allow4Char);\n  },\n  toRgb: function toRgb() {\n    return {\n      r: Math.round(this._r),\n      g: Math.round(this._g),\n      b: Math.round(this._b),\n      a: this._a\n    };\n  },\n  toRgbString: function toRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \")\" : \"rgba(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \", \" + this._roundA + \")\";\n  },\n  toPercentageRgb: function toPercentageRgb() {\n    return {\n      r: Math.round(bound01(this._r, 255) * 100) + \"%\",\n      g: Math.round(bound01(this._g, 255) * 100) + \"%\",\n      b: Math.round(bound01(this._b, 255) * 100) + \"%\",\n      a: this._a\n    };\n  },\n  toPercentageRgbString: function toPercentageRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%)\" : \"rgba(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\n  },\n  toName: function toName() {\n    if (this._a === 0) {\n      return \"transparent\";\n    }\n    if (this._a < 1) {\n      return false;\n    }\n    return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n  },\n  toFilter: function toFilter(secondColor) {\n    var hex8String = \"#\" + rgbaToArgbHex(this._r, this._g, this._b, this._a);\n    var secondHex8String = hex8String;\n    var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\n    if (secondColor) {\n      var s = tinycolor(secondColor);\n      secondHex8String = \"#\" + rgbaToArgbHex(s._r, s._g, s._b, s._a);\n    }\n    return \"progid:DXImageTransform.Microsoft.gradient(\" + gradientType + \"startColorstr=\" + hex8String + \",endColorstr=\" + secondHex8String + \")\";\n  },\n  toString: function toString(format) {\n    var formatSet = !!format;\n    format = format || this._format;\n    var formattedString = false;\n    var hasAlpha = this._a < 1 && this._a >= 0;\n    var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\n    if (needsAlphaFormat) {\n      // Special case for \"transparent\", all other non-alpha formats\n      // will return rgba when there is transparency.\n      if (format === \"name\" && this._a === 0) {\n        return this.toName();\n      }\n      return this.toRgbString();\n    }\n    if (format === \"rgb\") {\n      formattedString = this.toRgbString();\n    }\n    if (format === \"prgb\") {\n      formattedString = this.toPercentageRgbString();\n    }\n    if (format === \"hex\" || format === \"hex6\") {\n      formattedString = this.toHexString();\n    }\n    if (format === \"hex3\") {\n      formattedString = this.toHexString(true);\n    }\n    if (format === \"hex4\") {\n      formattedString = this.toHex8String(true);\n    }\n    if (format === \"hex8\") {\n      formattedString = this.toHex8String();\n    }\n    if (format === \"name\") {\n      formattedString = this.toName();\n    }\n    if (format === \"hsl\") {\n      formattedString = this.toHslString();\n    }\n    if (format === \"hsv\") {\n      formattedString = this.toHsvString();\n    }\n    return formattedString || this.toHexString();\n  },\n  clone: function clone() {\n    return tinycolor(this.toString());\n  },\n  _applyModification: function _applyModification(fn, args) {\n    var color = fn.apply(null, [this].concat([].slice.call(args)));\n    this._r = color._r;\n    this._g = color._g;\n    this._b = color._b;\n    this.setAlpha(color._a);\n    return this;\n  },\n  lighten: function lighten() {\n    return this._applyModification(_lighten, arguments);\n  },\n  brighten: function brighten() {\n    return this._applyModification(_brighten, arguments);\n  },\n  darken: function darken() {\n    return this._applyModification(_darken, arguments);\n  },\n  desaturate: function desaturate() {\n    return this._applyModification(_desaturate, arguments);\n  },\n  saturate: function saturate() {\n    return this._applyModification(_saturate, arguments);\n  },\n  greyscale: function greyscale() {\n    return this._applyModification(_greyscale, arguments);\n  },\n  spin: function spin() {\n    return this._applyModification(_spin, arguments);\n  },\n  _applyCombination: function _applyCombination(fn, args) {\n    return fn.apply(null, [this].concat([].slice.call(args)));\n  },\n  analogous: function analogous() {\n    return this._applyCombination(_analogous, arguments);\n  },\n  complement: function complement() {\n    return this._applyCombination(_complement, arguments);\n  },\n  monochromatic: function monochromatic() {\n    return this._applyCombination(_monochromatic, arguments);\n  },\n  splitcomplement: function splitcomplement() {\n    return this._applyCombination(_splitcomplement, arguments);\n  },\n  // Disabled until https://github.com/bgrins/TinyColor/issues/254\n  // polyad: function (number) {\n  //   return this._applyCombination(polyad, [number]);\n  // },\n  triad: function triad() {\n    return this._applyCombination(polyad, [3]);\n  },\n  tetrad: function tetrad() {\n    return this._applyCombination(polyad, [4]);\n  }\n};\n\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\n// String input requires \"1.0\" as input, so 1 will be treated as 1\ntinycolor.fromRatio = function (color, opts) {\n  if (_typeof(color) == \"object\") {\n    var newColor = {};\n    for (var i in color) {\n      if (color.hasOwnProperty(i)) {\n        if (i === \"a\") {\n          newColor[i] = color[i];\n        } else {\n          newColor[i] = convertToPercentage(color[i]);\n        }\n      }\n    }\n    color = newColor;\n  }\n  return tinycolor(color, opts);\n};\n\n// Given a string or object, convert that input to RGB\n// Possible string inputs:\n//\n//     \"red\"\n//     \"#f00\" or \"f00\"\n//     \"#ff0000\" or \"ff0000\"\n//     \"#ff000000\" or \"ff000000\"\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n//\nfunction inputToRGB(color) {\n  var rgb = {\n    r: 0,\n    g: 0,\n    b: 0\n  };\n  var a = 1;\n  var s = null;\n  var v = null;\n  var l = null;\n  var ok = false;\n  var format = false;\n  if (typeof color == \"string\") {\n    color = stringInputToObject(color);\n  }\n  if (_typeof(color) == \"object\") {\n    if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n      rgb = rgbToRgb(color.r, color.g, color.b);\n      ok = true;\n      format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n      s = convertToPercentage(color.s);\n      v = convertToPercentage(color.v);\n      rgb = hsvToRgb(color.h, s, v);\n      ok = true;\n      format = \"hsv\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n      s = convertToPercentage(color.s);\n      l = convertToPercentage(color.l);\n      rgb = hslToRgb(color.h, s, l);\n      ok = true;\n      format = \"hsl\";\n    }\n    if (color.hasOwnProperty(\"a\")) {\n      a = color.a;\n    }\n  }\n  a = boundAlpha(a);\n  return {\n    ok: ok,\n    format: color.format || format,\n    r: Math.min(255, Math.max(rgb.r, 0)),\n    g: Math.min(255, Math.max(rgb.g, 0)),\n    b: Math.min(255, Math.max(rgb.b, 0)),\n    a: a\n  };\n}\n\n// Conversion Functions\n// --------------------\n\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n// `rgbToRgb`\n// Handle bounds / percentage checking to conform to CSS color spec\n// <http://www.w3.org/TR/css3-color/>\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\n// *Returns:* { r, g, b } in [0, 255]\nfunction rgbToRgb(r, g, b) {\n  return {\n    r: bound01(r, 255) * 255,\n    g: bound01(g, 255) * 255,\n    b: bound01(b, 255) * 255\n  };\n}\n\n// `rgbToHsl`\n// Converts an RGB color value to HSL.\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n// *Returns:* { h, s, l } in [0,1]\nfunction rgbToHsl(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    l = (max + min) / 2;\n  if (max == min) {\n    h = s = 0; // achromatic\n  } else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    l: l\n  };\n}\n\n// `hslToRgb`\n// Converts an HSL color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hslToRgb(h, s, l) {\n  var r, g, b;\n  h = bound01(h, 360);\n  s = bound01(s, 100);\n  l = bound01(l, 100);\n  function hue2rgb(p, q, t) {\n    if (t < 0) t += 1;\n    if (t > 1) t -= 1;\n    if (t < 1 / 6) return p + (q - p) * 6 * t;\n    if (t < 1 / 2) return q;\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n    return p;\n  }\n  if (s === 0) {\n    r = g = b = l; // achromatic\n  } else {\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHsv`\n// Converts an RGB color value to HSV\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n// *Returns:* { h, s, v } in [0,1]\nfunction rgbToHsv(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    v = max;\n  var d = max - min;\n  s = max === 0 ? 0 : d / max;\n  if (max == min) {\n    h = 0; // achromatic\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    v: v\n  };\n}\n\n// `hsvToRgb`\n// Converts an HSV color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hsvToRgb(h, s, v) {\n  h = bound01(h, 360) * 6;\n  s = bound01(s, 100);\n  v = bound01(v, 100);\n  var i = Math.floor(h),\n    f = h - i,\n    p = v * (1 - s),\n    q = v * (1 - f * s),\n    t = v * (1 - (1 - f) * s),\n    mod = i % 6,\n    r = [v, q, p, p, t, v][mod],\n    g = [t, v, v, q, p, p][mod],\n    b = [p, p, t, v, v, q][mod];\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHex`\n// Converts an RGB color to hex\n// Assumes r, g, and b are contained in the set [0, 255]\n// Returns a 3 or 6 character hex\nfunction rgbToHex(r, g, b, allow3Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n\n  // Return a 3 character hex if possible\n  if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToHex`\n// Converts an RGBA color plus alpha transparency to hex\n// Assumes r, g, b are contained in the set [0, 255] and\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\nfunction rgbaToHex(r, g, b, a, allow4Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16)), pad2(convertDecimalToHex(a))];\n\n  // Return a 4 character hex if possible\n  if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToArgbHex`\n// Converts an RGBA color to an ARGB Hex8 string\n// Rarely used, but required for \"toFilter()\"\nfunction rgbaToArgbHex(r, g, b, a) {\n  var hex = [pad2(convertDecimalToHex(a)), pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n  return hex.join(\"\");\n}\n\n// `equals`\n// Can be called with any tinycolor input\ntinycolor.equals = function (color1, color2) {\n  if (!color1 || !color2) return false;\n  return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n};\ntinycolor.random = function () {\n  return tinycolor.fromRatio({\n    r: Math.random(),\n    g: Math.random(),\n    b: Math.random()\n  });\n};\n\n// Modification Functions\n// ----------------------\n// Thanks to less.js for some of the basics here\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\nfunction _desaturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s -= amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _saturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s += amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _greyscale(color) {\n  return tinycolor(color).desaturate(100);\n}\nfunction _lighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l += amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\nfunction _brighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var rgb = tinycolor(color).toRgb();\n  rgb.r = Math.max(0, Math.min(255, rgb.r - Math.round(255 * -(amount / 100))));\n  rgb.g = Math.max(0, Math.min(255, rgb.g - Math.round(255 * -(amount / 100))));\n  rgb.b = Math.max(0, Math.min(255, rgb.b - Math.round(255 * -(amount / 100))));\n  return tinycolor(rgb);\n}\nfunction _darken(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l -= amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\n\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n// Values outside of this range will be wrapped into this range.\nfunction _spin(color, amount) {\n  var hsl = tinycolor(color).toHsl();\n  var hue = (hsl.h + amount) % 360;\n  hsl.h = hue < 0 ? 360 + hue : hue;\n  return tinycolor(hsl);\n}\n\n// Combination Functions\n// ---------------------\n// Thanks to jQuery xColor for some of the ideas behind these\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\nfunction _complement(color) {\n  var hsl = tinycolor(color).toHsl();\n  hsl.h = (hsl.h + 180) % 360;\n  return tinycolor(hsl);\n}\nfunction polyad(color, number) {\n  if (isNaN(number) || number <= 0) {\n    throw new Error(\"Argument to polyad must be a positive number\");\n  }\n  var hsl = tinycolor(color).toHsl();\n  var result = [tinycolor(color)];\n  var step = 360 / number;\n  for (var i = 1; i < number; i++) {\n    result.push(tinycolor({\n      h: (hsl.h + i * step) % 360,\n      s: hsl.s,\n      l: hsl.l\n    }));\n  }\n  return result;\n}\nfunction _splitcomplement(color) {\n  var hsl = tinycolor(color).toHsl();\n  var h = hsl.h;\n  return [tinycolor(color), tinycolor({\n    h: (h + 72) % 360,\n    s: hsl.s,\n    l: hsl.l\n  }), tinycolor({\n    h: (h + 216) % 360,\n    s: hsl.s,\n    l: hsl.l\n  })];\n}\nfunction _analogous(color, results, slices) {\n  results = results || 6;\n  slices = slices || 30;\n  var hsl = tinycolor(color).toHsl();\n  var part = 360 / slices;\n  var ret = [tinycolor(color)];\n  for (hsl.h = (hsl.h - (part * results >> 1) + 720) % 360; --results;) {\n    hsl.h = (hsl.h + part) % 360;\n    ret.push(tinycolor(hsl));\n  }\n  return ret;\n}\nfunction _monochromatic(color, results) {\n  results = results || 6;\n  var hsv = tinycolor(color).toHsv();\n  var h = hsv.h,\n    s = hsv.s,\n    v = hsv.v;\n  var ret = [];\n  var modification = 1 / results;\n  while (results--) {\n    ret.push(tinycolor({\n      h: h,\n      s: s,\n      v: v\n    }));\n    v = (v + modification) % 1;\n  }\n  return ret;\n}\n\n// Utility Functions\n// ---------------------\n\ntinycolor.mix = function (color1, color2, amount) {\n  amount = amount === 0 ? 0 : amount || 50;\n  var rgb1 = tinycolor(color1).toRgb();\n  var rgb2 = tinycolor(color2).toRgb();\n  var p = amount / 100;\n  var rgba = {\n    r: (rgb2.r - rgb1.r) * p + rgb1.r,\n    g: (rgb2.g - rgb1.g) * p + rgb1.g,\n    b: (rgb2.b - rgb1.b) * p + rgb1.b,\n    a: (rgb2.a - rgb1.a) * p + rgb1.a\n  };\n  return tinycolor(rgba);\n};\n\n// Readability Functions\n// ---------------------\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\n\n// `contrast`\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\ntinycolor.readability = function (color1, color2) {\n  var c1 = tinycolor(color1);\n  var c2 = tinycolor(color2);\n  return (Math.max(c1.getLuminance(), c2.getLuminance()) + 0.05) / (Math.min(c1.getLuminance(), c2.getLuminance()) + 0.05);\n};\n\n// `isReadable`\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\n// The third argument is an optional Object.\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\n\n// *Example*\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\ntinycolor.isReadable = function (color1, color2, wcag2) {\n  var readability = tinycolor.readability(color1, color2);\n  var wcag2Parms, out;\n  out = false;\n  wcag2Parms = validateWCAG2Parms(wcag2);\n  switch (wcag2Parms.level + wcag2Parms.size) {\n    case \"AAsmall\":\n    case \"AAAlarge\":\n      out = readability >= 4.5;\n      break;\n    case \"AAlarge\":\n      out = readability >= 3;\n      break;\n    case \"AAAsmall\":\n      out = readability >= 7;\n      break;\n  }\n  return out;\n};\n\n// `mostReadable`\n// Given a base color and a list of possible foreground or background\n// colors for that base, returns the most readable color.\n// Optionally returns Black or White if the most readable color is unreadable.\n// *Example*\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\ntinycolor.mostReadable = function (baseColor, colorList, args) {\n  var bestColor = null;\n  var bestScore = 0;\n  var readability;\n  var includeFallbackColors, level, size;\n  args = args || {};\n  includeFallbackColors = args.includeFallbackColors;\n  level = args.level;\n  size = args.size;\n  for (var i = 0; i < colorList.length; i++) {\n    readability = tinycolor.readability(baseColor, colorList[i]);\n    if (readability > bestScore) {\n      bestScore = readability;\n      bestColor = tinycolor(colorList[i]);\n    }\n  }\n  if (tinycolor.isReadable(baseColor, bestColor, {\n    level: level,\n    size: size\n  }) || !includeFallbackColors) {\n    return bestColor;\n  } else {\n    args.includeFallbackColors = false;\n    return tinycolor.mostReadable(baseColor, [\"#fff\", \"#000\"], args);\n  }\n};\n\n// Big List of Colors\n// ------------------\n// <https://www.w3.org/TR/css-color-4/#named-colors>\nvar names = tinycolor.names = {\n  aliceblue: \"f0f8ff\",\n  antiquewhite: \"faebd7\",\n  aqua: \"0ff\",\n  aquamarine: \"7fffd4\",\n  azure: \"f0ffff\",\n  beige: \"f5f5dc\",\n  bisque: \"ffe4c4\",\n  black: \"000\",\n  blanchedalmond: \"ffebcd\",\n  blue: \"00f\",\n  blueviolet: \"8a2be2\",\n  brown: \"a52a2a\",\n  burlywood: \"deb887\",\n  burntsienna: \"ea7e5d\",\n  cadetblue: \"5f9ea0\",\n  chartreuse: \"7fff00\",\n  chocolate: \"d2691e\",\n  coral: \"ff7f50\",\n  cornflowerblue: \"6495ed\",\n  cornsilk: \"fff8dc\",\n  crimson: \"dc143c\",\n  cyan: \"0ff\",\n  darkblue: \"00008b\",\n  darkcyan: \"008b8b\",\n  darkgoldenrod: \"b8860b\",\n  darkgray: \"a9a9a9\",\n  darkgreen: \"006400\",\n  darkgrey: \"a9a9a9\",\n  darkkhaki: \"bdb76b\",\n  darkmagenta: \"8b008b\",\n  darkolivegreen: \"556b2f\",\n  darkorange: \"ff8c00\",\n  darkorchid: \"9932cc\",\n  darkred: \"8b0000\",\n  darksalmon: \"e9967a\",\n  darkseagreen: \"8fbc8f\",\n  darkslateblue: \"483d8b\",\n  darkslategray: \"2f4f4f\",\n  darkslategrey: \"2f4f4f\",\n  darkturquoise: \"00ced1\",\n  darkviolet: \"9400d3\",\n  deeppink: \"ff1493\",\n  deepskyblue: \"00bfff\",\n  dimgray: \"696969\",\n  dimgrey: \"696969\",\n  dodgerblue: \"1e90ff\",\n  firebrick: \"b22222\",\n  floralwhite: \"fffaf0\",\n  forestgreen: \"228b22\",\n  fuchsia: \"f0f\",\n  gainsboro: \"dcdcdc\",\n  ghostwhite: \"f8f8ff\",\n  gold: \"ffd700\",\n  goldenrod: \"daa520\",\n  gray: \"808080\",\n  green: \"008000\",\n  greenyellow: \"adff2f\",\n  grey: \"808080\",\n  honeydew: \"f0fff0\",\n  hotpink: \"ff69b4\",\n  indianred: \"cd5c5c\",\n  indigo: \"4b0082\",\n  ivory: \"fffff0\",\n  khaki: \"f0e68c\",\n  lavender: \"e6e6fa\",\n  lavenderblush: \"fff0f5\",\n  lawngreen: \"7cfc00\",\n  lemonchiffon: \"fffacd\",\n  lightblue: \"add8e6\",\n  lightcoral: \"f08080\",\n  lightcyan: \"e0ffff\",\n  lightgoldenrodyellow: \"fafad2\",\n  lightgray: \"d3d3d3\",\n  lightgreen: \"90ee90\",\n  lightgrey: \"d3d3d3\",\n  lightpink: \"ffb6c1\",\n  lightsalmon: \"ffa07a\",\n  lightseagreen: \"20b2aa\",\n  lightskyblue: \"87cefa\",\n  lightslategray: \"789\",\n  lightslategrey: \"789\",\n  lightsteelblue: \"b0c4de\",\n  lightyellow: \"ffffe0\",\n  lime: \"0f0\",\n  limegreen: \"32cd32\",\n  linen: \"faf0e6\",\n  magenta: \"f0f\",\n  maroon: \"800000\",\n  mediumaquamarine: \"66cdaa\",\n  mediumblue: \"0000cd\",\n  mediumorchid: \"ba55d3\",\n  mediumpurple: \"9370db\",\n  mediumseagreen: \"3cb371\",\n  mediumslateblue: \"7b68ee\",\n  mediumspringgreen: \"00fa9a\",\n  mediumturquoise: \"48d1cc\",\n  mediumvioletred: \"c71585\",\n  midnightblue: \"191970\",\n  mintcream: \"f5fffa\",\n  mistyrose: \"ffe4e1\",\n  moccasin: \"ffe4b5\",\n  navajowhite: \"ffdead\",\n  navy: \"000080\",\n  oldlace: \"fdf5e6\",\n  olive: \"808000\",\n  olivedrab: \"6b8e23\",\n  orange: \"ffa500\",\n  orangered: \"ff4500\",\n  orchid: \"da70d6\",\n  palegoldenrod: \"eee8aa\",\n  palegreen: \"98fb98\",\n  paleturquoise: \"afeeee\",\n  palevioletred: \"db7093\",\n  papayawhip: \"ffefd5\",\n  peachpuff: \"ffdab9\",\n  peru: \"cd853f\",\n  pink: \"ffc0cb\",\n  plum: \"dda0dd\",\n  powderblue: \"b0e0e6\",\n  purple: \"800080\",\n  rebeccapurple: \"663399\",\n  red: \"f00\",\n  rosybrown: \"bc8f8f\",\n  royalblue: \"4169e1\",\n  saddlebrown: \"8b4513\",\n  salmon: \"fa8072\",\n  sandybrown: \"f4a460\",\n  seagreen: \"2e8b57\",\n  seashell: \"fff5ee\",\n  sienna: \"a0522d\",\n  silver: \"c0c0c0\",\n  skyblue: \"87ceeb\",\n  slateblue: \"6a5acd\",\n  slategray: \"708090\",\n  slategrey: \"708090\",\n  snow: \"fffafa\",\n  springgreen: \"00ff7f\",\n  steelblue: \"4682b4\",\n  tan: \"d2b48c\",\n  teal: \"008080\",\n  thistle: \"d8bfd8\",\n  tomato: \"ff6347\",\n  turquoise: \"40e0d0\",\n  violet: \"ee82ee\",\n  wheat: \"f5deb3\",\n  white: \"fff\",\n  whitesmoke: \"f5f5f5\",\n  yellow: \"ff0\",\n  yellowgreen: \"9acd32\"\n};\n\n// Make it easy to access colors via `hexNames[hex]`\nvar hexNames = tinycolor.hexNames = flip(names);\n\n// Utilities\n// ---------\n\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\nfunction flip(o) {\n  var flipped = {};\n  for (var i in o) {\n    if (o.hasOwnProperty(i)) {\n      flipped[o[i]] = i;\n    }\n  }\n  return flipped;\n}\n\n// Return a valid alpha value [0,1] with all invalid values being set to 1\nfunction boundAlpha(a) {\n  a = parseFloat(a);\n  if (isNaN(a) || a < 0 || a > 1) {\n    a = 1;\n  }\n  return a;\n}\n\n// Take input from [0, n] and return it as [0, 1]\nfunction bound01(n, max) {\n  if (isOnePointZero(n)) n = \"100%\";\n  var processPercent = isPercentage(n);\n  n = Math.min(max, Math.max(0, parseFloat(n)));\n\n  // Automatically convert percentage into number\n  if (processPercent) {\n    n = parseInt(n * max, 10) / 100;\n  }\n\n  // Handle floating point rounding errors\n  if (Math.abs(n - max) < 0.000001) {\n    return 1;\n  }\n\n  // Convert into [0, 1] range if it isn't already\n  return n % max / parseFloat(max);\n}\n\n// Force a number between 0 and 1\nfunction clamp01(val) {\n  return Math.min(1, Math.max(0, val));\n}\n\n// Parse a base-16 hex value into a base-10 integer\nfunction parseIntFromHex(val) {\n  return parseInt(val, 16);\n}\n\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\nfunction isOnePointZero(n) {\n  return typeof n == \"string\" && n.indexOf(\".\") != -1 && parseFloat(n) === 1;\n}\n\n// Check to see if string passed in is a percentage\nfunction isPercentage(n) {\n  return typeof n === \"string\" && n.indexOf(\"%\") != -1;\n}\n\n// Force a hex value to have 2 characters\nfunction pad2(c) {\n  return c.length == 1 ? \"0\" + c : \"\" + c;\n}\n\n// Replace a decimal with it's percentage value\nfunction convertToPercentage(n) {\n  if (n <= 1) {\n    n = n * 100 + \"%\";\n  }\n  return n;\n}\n\n// Converts a decimal to a hex value\nfunction convertDecimalToHex(d) {\n  return Math.round(parseFloat(d) * 255).toString(16);\n}\n// Converts a hex value to a decimal\nfunction convertHexToDecimal(h) {\n  return parseIntFromHex(h) / 255;\n}\nvar matchers = function () {\n  // <http://www.w3.org/TR/css3-values/#integers>\n  var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\n\n  // <http://www.w3.org/TR/css3-values/#number-value>\n  var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\n\n  // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\n  var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\n\n  // Actual matching.\n  // Parentheses and commas are optional, but not required.\n  // Whitespace can take the place of commas or opening paren\n  var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  return {\n    CSS_UNIT: new RegExp(CSS_UNIT),\n    rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\n    rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\n    hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\n    hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\n    hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\n    hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\n    hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n    hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n  };\n}();\n\n// `isValidCSSUnit`\n// Take in a single string / number and check to see if it looks like a CSS unit\n// (see `matchers` above for definition).\nfunction isValidCSSUnit(color) {\n  return !!matchers.CSS_UNIT.exec(color);\n}\n\n// `stringInputToObject`\n// Permissive string parsing.  Take in a number of formats, and output an object\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\nfunction stringInputToObject(color) {\n  color = color.replace(trimLeft, \"\").replace(trimRight, \"\").toLowerCase();\n  var named = false;\n  if (names[color]) {\n    color = names[color];\n    named = true;\n  } else if (color == \"transparent\") {\n    return {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0,\n      format: \"name\"\n    };\n  }\n\n  // Try to match string input using regular expressions.\n  // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n  // Just return an object and let the conversion functions handle that.\n  // This way the result will be the same whether the tinycolor is initialized with string or object.\n  var match;\n  if (match = matchers.rgb.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3]\n    };\n  }\n  if (match = matchers.rgba.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsl.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3]\n    };\n  }\n  if (match = matchers.hsla.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsv.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3]\n    };\n  }\n  if (match = matchers.hsva.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hex8.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      a: convertHexToDecimal(match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex6.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  if (match = matchers.hex4.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      a: convertHexToDecimal(match[4] + \"\" + match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex3.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  return false;\n}\nfunction validateWCAG2Parms(parms) {\n  // return valid WCAG2 parms for isReadable.\n  // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\n  var level, size;\n  parms = parms || {\n    level: \"AA\",\n    size: \"small\"\n  };\n  level = (parms.level || \"AA\").toUpperCase();\n  size = (parms.size || \"small\").toLowerCase();\n  if (level !== \"AA\" && level !== \"AAA\") {\n    level = \"AA\";\n  }\n  if (size !== \"small\" && size !== \"large\") {\n    size = \"small\";\n  }\n  return {\n    level: level,\n    size: size\n  };\n}\n\nexport { tinycolor as default };\n","import each from 'lodash-es/each';\nimport tinycolor from 'tinycolor2';\n\nexport var simpleCheckForValidColor = function simpleCheckForValidColor(data) {\n  var keysToCheck = ['r', 'g', 'b', 'a', 'h', 's', 'l', 'v'];\n  var checked = 0;\n  var passed = 0;\n  each(keysToCheck, function (letter) {\n    if (data[letter]) {\n      checked += 1;\n      if (!isNaN(data[letter])) {\n        passed += 1;\n      }\n      if (letter === 's' || letter === 'l') {\n        var percentPatt = /^\\d+%$/;\n        if (percentPatt.test(data[letter])) {\n          passed += 1;\n        }\n      }\n    }\n  });\n  return checked === passed ? data : false;\n};\n\nexport var toState = function toState(data, oldHue) {\n  var color = data.hex ? tinycolor(data.hex) : tinycolor(data);\n  var hsl = color.toHsl();\n  var hsv = color.toHsv();\n  var rgb = color.toRgb();\n  var hex = color.toHex();\n  if (hsl.s === 0) {\n    hsl.h = oldHue || 0;\n    hsv.h = oldHue || 0;\n  }\n  var transparent = hex === '000000' && rgb.a === 0;\n\n  return {\n    hsl: hsl,\n    hex: transparent ? 'transparent' : '#' + hex,\n    rgb: rgb,\n    hsv: hsv,\n    oldHue: data.h || oldHue || hsl.h,\n    source: data.source\n  };\n};\n\nexport var isValidHex = function isValidHex(hex) {\n  if (hex === 'transparent') {\n    return true;\n  }\n  // disable hex4 and hex8\n  var lh = String(hex).charAt(0) === '#' ? 1 : 0;\n  return hex.length !== 4 + lh && hex.length < 7 + lh && tinycolor(hex).isValid();\n};\n\nexport var getContrastingColor = function getContrastingColor(data) {\n  if (!data) {\n    return '#fff';\n  }\n  var col = toState(data);\n  if (col.hex === 'transparent') {\n    return 'rgba(0,0,0,0.4)';\n  }\n  var yiq = (col.rgb.r * 299 + col.rgb.g * 587 + col.rgb.b * 114) / 1000;\n  return yiq >= 128 ? '#000' : '#fff';\n};\n\nexport var red = {\n  hsl: { a: 1, h: 0, l: 0.5, s: 1 },\n  hex: '#ff0000',\n  rgb: { r: 255, g: 0, b: 0, a: 1 },\n  hsv: { h: 0, s: 1, v: 1, a: 1 }\n};\n\nexport var isvalidColorString = function isvalidColorString(string, type) {\n  var stringWithoutDegree = string.replace('°', '');\n  return tinycolor(type + ' (' + stringWithoutDegree + ')')._ok;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport debounce from 'lodash-es/debounce';\nimport * as color from '../../helpers/color';\n\nexport var ColorWrap = function ColorWrap(Picker) {\n  var ColorPicker = function (_ref) {\n    _inherits(ColorPicker, _ref);\n\n    function ColorPicker(props) {\n      _classCallCheck(this, ColorPicker);\n\n      var _this = _possibleConstructorReturn(this, (ColorPicker.__proto__ || Object.getPrototypeOf(ColorPicker)).call(this));\n\n      _this.handleChange = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.setState(colors);\n          _this.props.onChangeComplete && _this.debounce(_this.props.onChangeComplete, colors, event);\n          _this.props.onChange && _this.props.onChange(colors, event);\n        }\n      };\n\n      _this.handleSwatchHover = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.props.onSwatchHover && _this.props.onSwatchHover(colors, event);\n        }\n      };\n\n      _this.state = _extends({}, color.toState(props.color, 0));\n\n      _this.debounce = debounce(function (fn, data, event) {\n        fn(data, event);\n      }, 100);\n      return _this;\n    }\n\n    _createClass(ColorPicker, [{\n      key: 'render',\n      value: function render() {\n        var optionalEvents = {};\n        if (this.props.onSwatchHover) {\n          optionalEvents.onSwatchHover = this.handleSwatchHover;\n        }\n\n        return React.createElement(Picker, _extends({}, this.props, this.state, {\n          onChange: this.handleChange\n        }, optionalEvents));\n      }\n    }], [{\n      key: 'getDerivedStateFromProps',\n      value: function getDerivedStateFromProps(nextProps, state) {\n        return _extends({}, color.toState(nextProps.color, state.oldHue));\n      }\n    }]);\n\n    return ColorPicker;\n  }(PureComponent || Component);\n\n  ColorPicker.propTypes = _extends({}, Picker.propTypes);\n\n  ColorPicker.defaultProps = _extends({}, Picker.defaultProps, {\n    color: {\n      h: 250,\n      s: 0.50,\n      l: 0.20,\n      a: 1\n    }\n  });\n\n  return ColorPicker;\n};\n\nexport default ColorWrap;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable no-invalid-this */\nimport React from 'react';\n\nexport var handleFocus = function handleFocus(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n  return function (_React$Component) {\n    _inherits(Focus, _React$Component);\n\n    function Focus() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Focus);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Focus.__proto__ || Object.getPrototypeOf(Focus)).call.apply(_ref, [this].concat(args))), _this), _this.state = { focus: false }, _this.handleFocus = function () {\n        return _this.setState({ focus: true });\n      }, _this.handleBlur = function () {\n        return _this.setState({ focus: false });\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    _createClass(Focus, [{\n      key: 'render',\n      value: function render() {\n        return React.createElement(\n          Span,\n          { onFocus: this.handleFocus, onBlur: this.handleBlur },\n          React.createElement(Component, _extends({}, this.props, this.state))\n        );\n      }\n    }]);\n\n    return Focus;\n  }(React.Component);\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport { handleFocus } from '../../helpers/interaction';\n\nimport Checkboard from './Checkboard';\n\nvar ENTER = 13;\n\nexport var Swatch = function Swatch(_ref) {\n  var color = _ref.color,\n      style = _ref.style,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onHover = _ref.onHover,\n      _ref$title = _ref.title,\n      title = _ref$title === undefined ? color : _ref$title,\n      children = _ref.children,\n      focus = _ref.focus,\n      _ref$focusStyle = _ref.focusStyle,\n      focusStyle = _ref$focusStyle === undefined ? {} : _ref$focusStyle;\n\n  var transparent = color === 'transparent';\n  var styles = reactCSS({\n    default: {\n      swatch: _extends({\n        background: color,\n        height: '100%',\n        width: '100%',\n        cursor: 'pointer',\n        position: 'relative',\n        outline: 'none'\n      }, style, focus ? focusStyle : {})\n    }\n  });\n\n  var handleClick = function handleClick(e) {\n    return onClick(color, e);\n  };\n  var handleKeyDown = function handleKeyDown(e) {\n    return e.keyCode === ENTER && onClick(color, e);\n  };\n  var handleHover = function handleHover(e) {\n    return onHover(color, e);\n  };\n\n  var optionalEvents = {};\n  if (onHover) {\n    optionalEvents.onMouseOver = handleHover;\n  }\n\n  return React.createElement(\n    'div',\n    _extends({\n      style: styles.swatch,\n      onClick: handleClick,\n      title: title,\n      tabIndex: 0,\n      onKeyDown: handleKeyDown\n    }, optionalEvents),\n    children,\n    transparent && React.createElement(Checkboard, {\n      borderRadius: styles.swatch.borderRadius,\n      boxShadow: 'inset 0 0 0 1px rgba(0,0,0,0.1)'\n    })\n  );\n};\n\nexport default handleFocus(Swatch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var AlphaPointer = function AlphaPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default AlphaPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { ColorWrap, Alpha } from '../common';\nimport AlphaPointer from './AlphaPointer';\n\nexport var AlphaPicker = function AlphaPicker(_ref) {\n  var rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      direction = _ref.direction,\n      style = _ref.style,\n      renderers = _ref.renderers,\n      pointer = _ref.pointer,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      alpha: {\n        radius: '2px',\n        style: style\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'alpha-picker ' + className },\n    React.createElement(Alpha, _extends({}, styles.alpha, {\n      rgb: rgb,\n      hsl: hsl,\n      pointer: pointer,\n      renderers: renderers,\n      onChange: onChange,\n      direction: direction\n    }))\n  );\n};\n\nAlphaPicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: AlphaPointer\n};\n\nexport default ColorWrap(AlphaPicker);","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import MapCache from './_MapCache.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nexport default memoize;\n","import memoizeCapped from './_memoizeCapped.js';\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nexport default stringToPath;\n","import memoize from './memoize.js';\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nexport default memoizeCapped;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default toKey;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","import baseEach from './_baseEach.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nexport default baseMap;\n","import arrayMap from './_arrayMap.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseMap from './_baseMap.js';\nimport isArray from './isArray.js';\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nexport default map;\n","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport { Swatch } from '../common';\n\nexport var BlockSwatches = function BlockSwatches(_ref) {\n  var colors = _ref.colors,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginRight: '-10px'\n      },\n      swatch: {\n        width: '22px',\n        height: '22px',\n        float: 'left',\n        marginRight: '10px',\n        marginBottom: '10px',\n        borderRadius: '4px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    map(colors, function (c) {\n      return React.createElement(Swatch, {\n        key: c,\n        color: c,\n        style: styles.swatch,\n        onClick: onClick,\n        onHover: onSwatchHover,\n        focusStyle: {\n          boxShadow: '0 0 4px ' + c\n        }\n      });\n    }),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default BlockSwatches;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Checkboard } from '../common';\nimport BlockSwatches from './BlockSwatches';\n\nexport var Block = function Block(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var transparent = hex === 'transparent';\n  var handleChange = function handleChange(hexCode, e) {\n    color.isValidHex(hexCode) && onChange({\n      hex: hexCode,\n      source: 'hex'\n    }, e);\n  };\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        boxShadow: '0 1px rgba(0,0,0,.1)',\n        borderRadius: '6px',\n        position: 'relative'\n      },\n      head: {\n        height: '110px',\n        background: hex,\n        borderRadius: '6px 6px 0 0',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        position: 'relative'\n      },\n      body: {\n        padding: '10px'\n      },\n      label: {\n        fontSize: '18px',\n        color: color.getContrastingColor(hex),\n        position: 'relative'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 10px 10px 10px',\n        borderColor: 'transparent transparent ' + hex + ' transparent',\n        position: 'absolute',\n        top: '-10px',\n        left: '50%',\n        marginLeft: '-10px'\n      },\n      input: {\n        width: '100%',\n        fontSize: '12px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '22px',\n        boxShadow: 'inset 0 0 0 1px #ddd',\n        borderRadius: '4px',\n        padding: '0 7px',\n        boxSizing: 'border-box'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { 'hide-triangle': triangle === 'hide' });\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'block-picker ' + className },\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.head },\n      transparent && React.createElement(Checkboard, { borderRadius: '6px 6px 0 0' }),\n      React.createElement(\n        'div',\n        { style: styles.label },\n        hex\n      )\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(BlockSwatches, { colors: colors, onClick: handleChange, onSwatchHover: onSwatchHover }),\n      React.createElement(EditableInput, {\n        style: { input: styles.input },\n        value: hex,\n        onChange: handleChange\n      })\n    )\n  );\n};\n\nBlock.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['top', 'hide']),\n  styles: PropTypes.object\n};\n\nBlock.defaultProps = {\n  width: 170,\n  colors: ['#D9E3F0', '#F47373', '#697689', '#37D67A', '#2CCCE4', '#555555', '#dce775', '#ff8a65', '#ba68c8'],\n  triangle: 'top',\n  styles: {}\n};\n\nexport default ColorWrap(Block);","export var red = {\"50\":\"#ffebee\",\"100\":\"#ffcdd2\",\"200\":\"#ef9a9a\",\"300\":\"#e57373\",\"400\":\"#ef5350\",\"500\":\"#f44336\",\"600\":\"#e53935\",\"700\":\"#d32f2f\",\"800\":\"#c62828\",\"900\":\"#b71c1c\",\"a100\":\"#ff8a80\",\"a200\":\"#ff5252\",\"a400\":\"#ff1744\",\"a700\":\"#d50000\"};\nexport var pink = {\"50\":\"#fce4ec\",\"100\":\"#f8bbd0\",\"200\":\"#f48fb1\",\"300\":\"#f06292\",\"400\":\"#ec407a\",\"500\":\"#e91e63\",\"600\":\"#d81b60\",\"700\":\"#c2185b\",\"800\":\"#ad1457\",\"900\":\"#880e4f\",\"a100\":\"#ff80ab\",\"a200\":\"#ff4081\",\"a400\":\"#f50057\",\"a700\":\"#c51162\"};\nexport var purple = {\"50\":\"#f3e5f5\",\"100\":\"#e1bee7\",\"200\":\"#ce93d8\",\"300\":\"#ba68c8\",\"400\":\"#ab47bc\",\"500\":\"#9c27b0\",\"600\":\"#8e24aa\",\"700\":\"#7b1fa2\",\"800\":\"#6a1b9a\",\"900\":\"#4a148c\",\"a100\":\"#ea80fc\",\"a200\":\"#e040fb\",\"a400\":\"#d500f9\",\"a700\":\"#aa00ff\"};\nexport var deepPurple = {\"50\":\"#ede7f6\",\"100\":\"#d1c4e9\",\"200\":\"#b39ddb\",\"300\":\"#9575cd\",\"400\":\"#7e57c2\",\"500\":\"#673ab7\",\"600\":\"#5e35b1\",\"700\":\"#512da8\",\"800\":\"#4527a0\",\"900\":\"#311b92\",\"a100\":\"#b388ff\",\"a200\":\"#7c4dff\",\"a400\":\"#651fff\",\"a700\":\"#6200ea\"};\nexport var indigo = {\"50\":\"#e8eaf6\",\"100\":\"#c5cae9\",\"200\":\"#9fa8da\",\"300\":\"#7986cb\",\"400\":\"#5c6bc0\",\"500\":\"#3f51b5\",\"600\":\"#3949ab\",\"700\":\"#303f9f\",\"800\":\"#283593\",\"900\":\"#1a237e\",\"a100\":\"#8c9eff\",\"a200\":\"#536dfe\",\"a400\":\"#3d5afe\",\"a700\":\"#304ffe\"};\nexport var blue = {\"50\":\"#e3f2fd\",\"100\":\"#bbdefb\",\"200\":\"#90caf9\",\"300\":\"#64b5f6\",\"400\":\"#42a5f5\",\"500\":\"#2196f3\",\"600\":\"#1e88e5\",\"700\":\"#1976d2\",\"800\":\"#1565c0\",\"900\":\"#0d47a1\",\"a100\":\"#82b1ff\",\"a200\":\"#448aff\",\"a400\":\"#2979ff\",\"a700\":\"#2962ff\"};\nexport var lightBlue = {\"50\":\"#e1f5fe\",\"100\":\"#b3e5fc\",\"200\":\"#81d4fa\",\"300\":\"#4fc3f7\",\"400\":\"#29b6f6\",\"500\":\"#03a9f4\",\"600\":\"#039be5\",\"700\":\"#0288d1\",\"800\":\"#0277bd\",\"900\":\"#01579b\",\"a100\":\"#80d8ff\",\"a200\":\"#40c4ff\",\"a400\":\"#00b0ff\",\"a700\":\"#0091ea\"};\nexport var cyan = {\"50\":\"#e0f7fa\",\"100\":\"#b2ebf2\",\"200\":\"#80deea\",\"300\":\"#4dd0e1\",\"400\":\"#26c6da\",\"500\":\"#00bcd4\",\"600\":\"#00acc1\",\"700\":\"#0097a7\",\"800\":\"#00838f\",\"900\":\"#006064\",\"a100\":\"#84ffff\",\"a200\":\"#18ffff\",\"a400\":\"#00e5ff\",\"a700\":\"#00b8d4\"};\nexport var teal = {\"50\":\"#e0f2f1\",\"100\":\"#b2dfdb\",\"200\":\"#80cbc4\",\"300\":\"#4db6ac\",\"400\":\"#26a69a\",\"500\":\"#009688\",\"600\":\"#00897b\",\"700\":\"#00796b\",\"800\":\"#00695c\",\"900\":\"#004d40\",\"a100\":\"#a7ffeb\",\"a200\":\"#64ffda\",\"a400\":\"#1de9b6\",\"a700\":\"#00bfa5\"};\nexport var green = {\"50\":\"#e8f5e9\",\"100\":\"#c8e6c9\",\"200\":\"#a5d6a7\",\"300\":\"#81c784\",\"400\":\"#66bb6a\",\"500\":\"#4caf50\",\"600\":\"#43a047\",\"700\":\"#388e3c\",\"800\":\"#2e7d32\",\"900\":\"#1b5e20\",\"a100\":\"#b9f6ca\",\"a200\":\"#69f0ae\",\"a400\":\"#00e676\",\"a700\":\"#00c853\"};\nexport var lightGreen = {\"50\":\"#f1f8e9\",\"100\":\"#dcedc8\",\"200\":\"#c5e1a5\",\"300\":\"#aed581\",\"400\":\"#9ccc65\",\"500\":\"#8bc34a\",\"600\":\"#7cb342\",\"700\":\"#689f38\",\"800\":\"#558b2f\",\"900\":\"#33691e\",\"a100\":\"#ccff90\",\"a200\":\"#b2ff59\",\"a400\":\"#76ff03\",\"a700\":\"#64dd17\"};\nexport var lime = {\"50\":\"#f9fbe7\",\"100\":\"#f0f4c3\",\"200\":\"#e6ee9c\",\"300\":\"#dce775\",\"400\":\"#d4e157\",\"500\":\"#cddc39\",\"600\":\"#c0ca33\",\"700\":\"#afb42b\",\"800\":\"#9e9d24\",\"900\":\"#827717\",\"a100\":\"#f4ff81\",\"a200\":\"#eeff41\",\"a400\":\"#c6ff00\",\"a700\":\"#aeea00\"};\nexport var yellow = {\"50\":\"#fffde7\",\"100\":\"#fff9c4\",\"200\":\"#fff59d\",\"300\":\"#fff176\",\"400\":\"#ffee58\",\"500\":\"#ffeb3b\",\"600\":\"#fdd835\",\"700\":\"#fbc02d\",\"800\":\"#f9a825\",\"900\":\"#f57f17\",\"a100\":\"#ffff8d\",\"a200\":\"#ffff00\",\"a400\":\"#ffea00\",\"a700\":\"#ffd600\"};\nexport var amber = {\"50\":\"#fff8e1\",\"100\":\"#ffecb3\",\"200\":\"#ffe082\",\"300\":\"#ffd54f\",\"400\":\"#ffca28\",\"500\":\"#ffc107\",\"600\":\"#ffb300\",\"700\":\"#ffa000\",\"800\":\"#ff8f00\",\"900\":\"#ff6f00\",\"a100\":\"#ffe57f\",\"a200\":\"#ffd740\",\"a400\":\"#ffc400\",\"a700\":\"#ffab00\"};\nexport var orange = {\"50\":\"#fff3e0\",\"100\":\"#ffe0b2\",\"200\":\"#ffcc80\",\"300\":\"#ffb74d\",\"400\":\"#ffa726\",\"500\":\"#ff9800\",\"600\":\"#fb8c00\",\"700\":\"#f57c00\",\"800\":\"#ef6c00\",\"900\":\"#e65100\",\"a100\":\"#ffd180\",\"a200\":\"#ffab40\",\"a400\":\"#ff9100\",\"a700\":\"#ff6d00\"};\nexport var deepOrange = {\"50\":\"#fbe9e7\",\"100\":\"#ffccbc\",\"200\":\"#ffab91\",\"300\":\"#ff8a65\",\"400\":\"#ff7043\",\"500\":\"#ff5722\",\"600\":\"#f4511e\",\"700\":\"#e64a19\",\"800\":\"#d84315\",\"900\":\"#bf360c\",\"a100\":\"#ff9e80\",\"a200\":\"#ff6e40\",\"a400\":\"#ff3d00\",\"a700\":\"#dd2c00\"};\nexport var brown = {\"50\":\"#efebe9\",\"100\":\"#d7ccc8\",\"200\":\"#bcaaa4\",\"300\":\"#a1887f\",\"400\":\"#8d6e63\",\"500\":\"#795548\",\"600\":\"#6d4c41\",\"700\":\"#5d4037\",\"800\":\"#4e342e\",\"900\":\"#3e2723\"};\nexport var grey = {\"50\":\"#fafafa\",\"100\":\"#f5f5f5\",\"200\":\"#eeeeee\",\"300\":\"#e0e0e0\",\"400\":\"#bdbdbd\",\"500\":\"#9e9e9e\",\"600\":\"#757575\",\"700\":\"#616161\",\"800\":\"#424242\",\"900\":\"#212121\"};\nexport var blueGrey = {\"50\":\"#eceff1\",\"100\":\"#cfd8dc\",\"200\":\"#b0bec5\",\"300\":\"#90a4ae\",\"400\":\"#78909c\",\"500\":\"#607d8b\",\"600\":\"#546e7a\",\"700\":\"#455a64\",\"800\":\"#37474f\",\"900\":\"#263238\"};\nexport var darkText = {\"primary\":\"rgba(0, 0, 0, 0.87)\",\"secondary\":\"rgba(0, 0, 0, 0.54)\",\"disabled\":\"rgba(0, 0, 0, 0.38)\",\"dividers\":\"rgba(0, 0, 0, 0.12)\"};\nexport var lightText = {\"primary\":\"rgba(255, 255, 255, 1)\",\"secondary\":\"rgba(255, 255, 255, 0.7)\",\"disabled\":\"rgba(255, 255, 255, 0.5)\",\"dividers\":\"rgba(255, 255, 255, 0.12)\"};\nexport var darkIcons = {\"active\":\"rgba(0, 0, 0, 0.54)\",\"inactive\":\"rgba(0, 0, 0, 0.38)\"};\nexport var lightIcons = {\"active\":\"rgba(255, 255, 255, 1)\",\"inactive\":\"rgba(255, 255, 255, 0.5)\"};\nexport var white = \"#ffffff\";\nexport var black = \"#000000\";\n\nexport default {\n  red: red,\n  pink: pink,\n  purple: purple,\n  deepPurple: deepPurple,\n  indigo: indigo,\n  blue: blue,\n  lightBlue: lightBlue,\n  cyan: cyan,\n  teal: teal,\n  green: green,\n  lightGreen: lightGreen,\n  lime: lime,\n  yellow: yellow,\n  amber: amber,\n  orange: orange,\n  deepOrange: deepOrange,\n  brown: brown,\n  grey: grey,\n  blueGrey: blueGrey,\n  darkText: darkText,\n  lightText: lightText,\n  darkIcons: darkIcons,\n  lightIcons: lightIcons,\n  white: white,\n  black: black\n};\n","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var CircleSwatch = function CircleSwatch(_ref) {\n  var color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      hover = _ref.hover,\n      active = _ref.active,\n      circleSize = _ref.circleSize,\n      circleSpacing = _ref.circleSpacing;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: circleSize,\n        height: circleSize,\n        marginRight: circleSpacing,\n        marginBottom: circleSpacing,\n        transform: 'scale(1)',\n        transition: '100ms transform ease'\n      },\n      Swatch: {\n        borderRadius: '50%',\n        background: 'transparent',\n        boxShadow: 'inset 0 0 0 ' + (circleSize / 2 + 1) + 'px ' + color,\n        transition: '100ms box-shadow ease'\n      }\n    },\n    'hover': {\n      swatch: {\n        transform: 'scale(1.2)'\n      }\n    },\n    'active': {\n      Swatch: {\n        boxShadow: 'inset 0 0 0 3px ' + color\n      }\n    }\n  }, { hover: hover, active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      style: styles.Swatch,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: styles.Swatch.boxShadow + ', 0 0 5px ' + color }\n    })\n  );\n};\n\nCircleSwatch.defaultProps = {\n  circleSize: 28,\n  circleSpacing: 14\n};\n\nexport default handleHover(CircleSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap } from '../common';\nimport CircleSwatch from './CircleSwatch';\n\nexport var Circle = function Circle(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      circleSize = _ref.circleSize,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      circleSpacing = _ref.circleSpacing,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        display: 'flex',\n        flexWrap: 'wrap',\n        marginRight: -circleSpacing,\n        marginBottom: -circleSpacing\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(hexCode, e) {\n    return onChange({ hex: hexCode, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'circle-picker ' + className },\n    map(colors, function (c) {\n      return React.createElement(CircleSwatch, {\n        key: c,\n        color: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover,\n        active: hex === c.toLowerCase(),\n        circleSize: circleSize,\n        circleSpacing: circleSpacing\n      });\n    })\n  );\n};\n\nCircle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  circleSize: PropTypes.number,\n  circleSpacing: PropTypes.number,\n  styles: PropTypes.object\n};\n\nCircle.defaultProps = {\n  width: 252,\n  circleSize: 28,\n  circleSpacing: 14,\n  colors: [material.red['500'], material.pink['500'], material.purple['500'], material.deepPurple['500'], material.indigo['500'], material.blue['500'], material.lightBlue['500'], material.cyan['500'], material.teal['500'], material.green['500'], material.lightGreen['500'], material.lime['500'], material.yellow['500'], material.amber['500'], material.orange['500'], material.deepOrange['500'], material.brown['500'], material.blueGrey['500']],\n  styles: {}\n};\n\nexport default ColorWrap(Circle);","/**\n * Checks if `value` is `undefined`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n * @example\n *\n * _.isUndefined(void 0);\n * // => true\n *\n * _.isUndefined(null);\n * // => false\n */\nfunction isUndefined(value) {\n  return value === undefined;\n}\n\nexport default isUndefined;\n","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable react/no-did-mount-set-state, no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport isUndefined from 'lodash-es/isUndefined';\n\nimport { EditableInput } from '../common';\nimport UnfoldMoreHorizontalIcon from '@icons/material/UnfoldMoreHorizontalIcon';\n\nexport var ChromeFields = function (_React$Component) {\n  _inherits(ChromeFields, _React$Component);\n\n  function ChromeFields(props) {\n    _classCallCheck(this, ChromeFields);\n\n    var _this = _possibleConstructorReturn(this, (ChromeFields.__proto__ || Object.getPrototypeOf(ChromeFields)).call(this));\n\n    _this.toggleViews = function () {\n      if (_this.state.view === 'hex') {\n        _this.setState({ view: 'rgb' });\n      } else if (_this.state.view === 'rgb') {\n        _this.setState({ view: 'hsl' });\n      } else if (_this.state.view === 'hsl') {\n        if (_this.props.hsl.a === 1) {\n          _this.setState({ view: 'hex' });\n        } else {\n          _this.setState({ view: 'rgb' });\n        }\n      }\n    };\n\n    _this.handleChange = function (data, e) {\n      if (data.hex) {\n        color.isValidHex(data.hex) && _this.props.onChange({\n          hex: data.hex,\n          source: 'hex'\n        }, e);\n      } else if (data.r || data.g || data.b) {\n        _this.props.onChange({\n          r: data.r || _this.props.rgb.r,\n          g: data.g || _this.props.rgb.g,\n          b: data.b || _this.props.rgb.b,\n          source: 'rgb'\n        }, e);\n      } else if (data.a) {\n        if (data.a < 0) {\n          data.a = 0;\n        } else if (data.a > 1) {\n          data.a = 1;\n        }\n\n        _this.props.onChange({\n          h: _this.props.hsl.h,\n          s: _this.props.hsl.s,\n          l: _this.props.hsl.l,\n          a: Math.round(data.a * 100) / 100,\n          source: 'rgb'\n        }, e);\n      } else if (data.h || data.s || data.l) {\n        // Remove any occurances of '%'.\n        if (typeof data.s === 'string' && data.s.includes('%')) {\n          data.s = data.s.replace('%', '');\n        }\n        if (typeof data.l === 'string' && data.l.includes('%')) {\n          data.l = data.l.replace('%', '');\n        }\n\n        // We store HSL as a unit interval so we need to override the 1 input to 0.01\n        if (data.s == 1) {\n          data.s = 0.01;\n        } else if (data.l == 1) {\n          data.l = 0.01;\n        }\n\n        _this.props.onChange({\n          h: data.h || _this.props.hsl.h,\n          s: Number(!isUndefined(data.s) ? data.s : _this.props.hsl.s),\n          l: Number(!isUndefined(data.l) ? data.l : _this.props.hsl.l),\n          source: 'hsl'\n        }, e);\n      }\n    };\n\n    _this.showHighlight = function (e) {\n      e.currentTarget.style.background = '#eee';\n    };\n\n    _this.hideHighlight = function (e) {\n      e.currentTarget.style.background = 'transparent';\n    };\n\n    if (props.hsl.a !== 1 && props.view === \"hex\") {\n      _this.state = {\n        view: \"rgb\"\n      };\n    } else {\n      _this.state = {\n        view: props.view\n      };\n    }\n    return _this;\n  }\n\n  _createClass(ChromeFields, [{\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            paddingTop: '16px',\n            display: 'flex'\n          },\n          fields: {\n            flex: '1',\n            display: 'flex',\n            marginLeft: '-6px'\n          },\n          field: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          alpha: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          toggle: {\n            width: '32px',\n            textAlign: 'right',\n            position: 'relative'\n          },\n          icon: {\n            marginRight: '-4px',\n            marginTop: '12px',\n            cursor: 'pointer',\n            position: 'relative'\n          },\n          iconHighlight: {\n            position: 'absolute',\n            width: '24px',\n            height: '28px',\n            background: '#eee',\n            borderRadius: '4px',\n            top: '10px',\n            left: '12px',\n            display: 'none'\n          },\n          input: {\n            fontSize: '11px',\n            color: '#333',\n            width: '100%',\n            borderRadius: '2px',\n            border: 'none',\n            boxShadow: 'inset 0 0 0 1px #dadada',\n            height: '21px',\n            textAlign: 'center'\n          },\n          label: {\n            textTransform: 'uppercase',\n            fontSize: '11px',\n            lineHeight: '11px',\n            color: '#969696',\n            textAlign: 'center',\n            display: 'block',\n            marginTop: '12px'\n          },\n          svg: {\n            fill: '#333',\n            width: '24px',\n            height: '24px',\n            border: '1px transparent solid',\n            borderRadius: '5px'\n          }\n        },\n        'disableAlpha': {\n          alpha: {\n            display: 'none'\n          }\n        }\n      }, this.props, this.state);\n\n      var fields = void 0;\n      if (this.state.view === 'hex') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'hex', value: this.props.hex,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'rgb') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'r',\n              value: this.props.rgb.r,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'g',\n              value: this.props.rgb.g,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'b',\n              value: this.props.rgb.b,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.rgb.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'hsl') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'h',\n              value: Math.round(this.props.hsl.h),\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 's',\n              value: Math.round(this.props.hsl.s * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'l',\n              value: Math.round(this.props.hsl.l * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.hsl.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      }\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap, className: 'flexbox-fix' },\n        fields,\n        React.createElement(\n          'div',\n          { style: styles.toggle },\n          React.createElement(\n            'div',\n            { style: styles.icon, onClick: this.toggleViews, ref: function ref(icon) {\n                return _this2.icon = icon;\n              } },\n            React.createElement(UnfoldMoreHorizontalIcon, {\n              style: styles.svg,\n              onMouseOver: this.showHighlight,\n              onMouseEnter: this.showHighlight,\n              onMouseOut: this.hideHighlight\n            })\n          )\n        )\n      );\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, state) {\n      if (nextProps.hsl.a !== 1 && state.view === 'hex') {\n        return { view: 'rgb' };\n      }\n      return null;\n    }\n  }]);\n\n  return ChromeFields;\n}(React.Component);\n\nChromeFields.defaultProps = {\n  view: \"hex\"\n};\n\nexport default ChromeFields;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointer = function ChromePointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        transform: 'translate(-6px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointerCircle = function ChromePointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointerCircle;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport ChromeFields from './ChromeFields';\nimport ChromePointer from './ChromePointer';\nimport ChromePointerCircle from './ChromePointerCircle';\n\nexport var Chrome = function Chrome(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      disableAlpha = _ref.disableAlpha,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className,\n      defaultView = _ref.defaultView;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        borderRadius: '2px',\n        boxShadow: '0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)',\n        boxSizing: 'initial',\n        fontFamily: 'Menlo'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '55%',\n        position: 'relative',\n        borderRadius: '2px 2px 0 0',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '2px 2px 0 0'\n      },\n      body: {\n        padding: '16px 16px 12px'\n      },\n      controls: {\n        display: 'flex'\n      },\n      color: {\n        width: '32px'\n      },\n      swatch: {\n        marginTop: '6px',\n        width: '16px',\n        height: '16px',\n        borderRadius: '8px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      active: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '8px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.1)',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + rgb.a + ')',\n        zIndex: '2'\n      },\n      toggles: {\n        flex: '1'\n      },\n      hue: {\n        height: '10px',\n        position: 'relative',\n        marginBottom: '8px'\n      },\n      Hue: {\n        radius: '2px'\n      },\n      alpha: {\n        height: '10px',\n        position: 'relative'\n      },\n      Alpha: {\n        radius: '2px'\n      }\n    },\n    'disableAlpha': {\n      color: {\n        width: '22px'\n      },\n      alpha: {\n        display: 'none'\n      },\n      hue: {\n        marginBottom: '0px'\n      },\n      swatch: {\n        width: '10px',\n        height: '10px',\n        marginTop: '0px'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'chrome-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        pointer: ChromePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.color },\n          React.createElement(\n            'div',\n            { style: styles.swatch },\n            React.createElement('div', { style: styles.active }),\n            React.createElement(Checkboard, { renderers: renderers })\n          )\n        ),\n        React.createElement(\n          'div',\n          { style: styles.toggles },\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              style: styles.Hue,\n              hsl: hsl,\n              pointer: ChromePointer,\n              onChange: onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(Alpha, {\n              style: styles.Alpha,\n              rgb: rgb,\n              hsl: hsl,\n              pointer: ChromePointer,\n              renderers: renderers,\n              onChange: onChange\n            })\n          )\n        )\n      ),\n      React.createElement(ChromeFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        view: defaultView,\n        onChange: onChange,\n        disableAlpha: disableAlpha\n      })\n    )\n  );\n};\n\nChrome.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  disableAlpha: PropTypes.bool,\n  styles: PropTypes.object,\n  defaultView: PropTypes.oneOf([\"hex\", \"rgb\", \"hsl\"])\n};\n\nChrome.defaultProps = {\n  width: 225,\n  disableAlpha: false,\n  styles: {}\n};\n\nexport default ColorWrap(Chrome);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\n\nexport var CompactColor = function CompactColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        background: color,\n        width: '15px',\n        height: '15px',\n        float: 'left',\n        marginRight: '5px',\n        marginBottom: '5px',\n        position: 'relative',\n        cursor: 'pointer'\n      },\n      dot: {\n        absolute: '5px 5px 5px 5px',\n        background: colorUtils.getContrastingColor(color),\n        borderRadius: '50%',\n        opacity: '0'\n      }\n    },\n    'active': {\n      dot: {\n        opacity: '1'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      dot: {\n        background: '#000'\n      }\n    },\n    'transparent': {\n      dot: {\n        background: '#000'\n      }\n    }\n  }, { active: active, 'color-#FFFFFF': color === '#FFFFFF', 'transparent': color === 'transparent' });\n\n  return React.createElement(\n    Swatch,\n    {\n      style: styles.color,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement('div', { style: styles.dot })\n  );\n};\n\nexport default CompactColor;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { EditableInput } from '../common';\n\nexport var CompactFields = function CompactFields(_ref) {\n  var hex = _ref.hex,\n      rgb = _ref.rgb,\n      onChange = _ref.onChange;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingBottom: '6px',\n        paddingRight: '5px',\n        position: 'relative'\n      },\n      active: {\n        position: 'absolute',\n        top: '6px',\n        left: '5px',\n        height: '9px',\n        width: '9px',\n        background: hex\n      },\n      HEXwrap: {\n        flex: '6',\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '80%',\n        padding: '0px',\n        paddingLeft: '20%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      HEXlabel: {\n        display: 'none'\n      },\n      RGBwrap: {\n        flex: '3',\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '70%',\n        padding: '0px',\n        paddingLeft: '30%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '3px',\n        left: '0px',\n        lineHeight: '16px',\n        textTransform: 'uppercase',\n        fontSize: '12px',\n        color: '#999'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else {\n      onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement('div', { style: styles.active }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: 'hex',\n      value: hex,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    })\n  );\n};\n\nexport default CompactFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, Raised } from '../common';\nimport CompactColor from './CompactColor';\nimport CompactFields from './CompactFields';\n\nexport var Compact = function Compact(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      Compact: {\n        background: '#f6f6f6',\n        radius: '4px'\n      },\n      compact: {\n        paddingTop: '5px',\n        paddingLeft: '5px',\n        boxSizing: 'initial',\n        width: '240px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else {\n      onChange(data, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { style: styles.Compact, styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.compact, className: 'compact-picker ' + className },\n      React.createElement(\n        'div',\n        null,\n        map(colors, function (c) {\n          return React.createElement(CompactColor, {\n            key: c,\n            color: c,\n            active: c.toLowerCase() === hex,\n            onClick: handleChange,\n            onSwatchHover: onSwatchHover\n          });\n        }),\n        React.createElement('div', { style: styles.clear })\n      ),\n      React.createElement(CompactFields, { hex: hex, rgb: rgb, onChange: handleChange })\n    )\n  );\n};\n\nCompact.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nCompact.defaultProps = {\n  colors: ['#4D4D4D', '#999999', '#FFFFFF', '#F44E3B', '#FE9200', '#FCDC00', '#DBDF00', '#A4DD00', '#68CCCA', '#73D8FF', '#AEA1FF', '#FDA1FF', '#333333', '#808080', '#cccccc', '#D33115', '#E27300', '#FCC400', '#B0BC00', '#68BC00', '#16A5A5', '#009CE0', '#7B64FF', '#FA28FF', '#000000', '#666666', '#B3B3B3', '#9F0500', '#C45100', '#FB9E00', '#808900', '#194D33', '#0C797D', '#0062B1', '#653294', '#AB149E'],\n  styles: {}\n};\n\nexport default ColorWrap(Compact);","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var GithubSwatch = function GithubSwatch(_ref) {\n  var hover = _ref.hover,\n      color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var hoverSwatch = {\n    position: 'relative',\n    zIndex: '2',\n    outline: '2px solid #fff',\n    boxShadow: '0 0 5px 2px rgba(0,0,0,0.25)'\n  };\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: '25px',\n        height: '25px',\n        fontSize: '0'\n      }\n    },\n    'hover': {\n      swatch: hoverSwatch\n    }\n  }, { hover: hover });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: hoverSwatch\n    })\n  );\n};\n\nexport default handleHover(GithubSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap } from '../common';\nimport GithubSwatch from './GithubSwatch';\n\nexport var Github = function Github(_ref) {\n  var width = _ref.width,\n      colors = _ref.colors,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '1px solid rgba(0,0,0,0.2)',\n        boxShadow: '0 3px 12px rgba(0,0,0,0.15)',\n        borderRadius: '4px',\n        position: 'relative',\n        padding: '5px',\n        display: 'flex',\n        flexWrap: 'wrap'\n      },\n      triangle: {\n        position: 'absolute',\n        border: '7px solid transparent',\n        borderBottomColor: '#fff'\n      },\n      triangleShadow: {\n        position: 'absolute',\n        border: '8px solid transparent',\n        borderBottomColor: 'rgba(0,0,0,0.15)'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-14px',\n        left: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        left: '9px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-14px',\n        right: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        right: '9px'\n      }\n    },\n    'bottom-left-triangle': {\n      triangle: {\n        top: '35px',\n        left: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        left: '9px',\n        transform: 'rotate(180deg)'\n      }\n    },\n    'bottom-right-triangle': {\n      triangle: {\n        top: '35px',\n        right: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        right: '9px',\n        transform: 'rotate(180deg)'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right',\n    'bottom-left-triangle': triangle === 'bottom-left',\n    'bottom-right-triangle': triangle === 'bottom-right'\n  });\n\n  var handleChange = function handleChange(hex, e) {\n    return onChange({ hex: hex, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'github-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    map(colors, function (c) {\n      return React.createElement(GithubSwatch, {\n        color: c,\n        key: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nGithub.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right', 'bottom-left', 'bottom-right']),\n  styles: PropTypes.object\n};\n\nGithub.defaultProps = {\n  width: 200,\n  colors: ['#B80000', '#DB3E00', '#FCCB00', '#008B02', '#006B76', '#1273DE', '#004DCF', '#5300EB', '#EB9694', '#FAD0C3', '#FEF3BD', '#C1E1C5', '#BEDADC', '#C4DEF6', '#BED3F3', '#D4C4FB'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Github);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport HuePointer from './HuePointer';\n\nexport var HuePicker = function HuePicker(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      hsl = _ref.hsl,\n      direction = _ref.direction,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  // Overwrite to provide pure hue color\n  var handleChange = function handleChange(data) {\n    return onChange({ a: 1, h: data.h, l: 0.5, s: 1 });\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'hue-picker ' + className },\n    React.createElement(Hue, _extends({}, styles.hue, {\n      hsl: hsl,\n      pointer: pointer,\n      onChange: handleChange,\n      direction: direction\n    }))\n  );\n};\n\nHuePicker.propTypes = {\n  styles: PropTypes.object\n};\nHuePicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: HuePointer,\n  styles: {}\n};\n\nexport default ColorWrap(HuePicker);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Raised } from '../common';\n\nexport var Material = function Material(_ref) {\n  var onChange = _ref.onChange,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      material: {\n        width: '98px',\n        height: '98px',\n        padding: '16px',\n        fontFamily: 'Roboto'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '2px solid ' + hex,\n        outline: 'none',\n        height: '30px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      Hex: {\n        style: {}\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '1px solid #eee',\n        outline: 'none',\n        height: '30px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      split: {\n        display: 'flex',\n        marginRight: '-10px',\n        paddingTop: '11px'\n      },\n      third: {\n        flex: '1',\n        paddingRight: '10px'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.material, className: 'material-picker ' + className },\n      React.createElement(EditableInput, {\n        style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n        label: 'hex',\n        value: hex,\n        onChange: handleChange\n      }),\n      React.createElement(\n        'div',\n        { style: styles.split, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'r', value: rgb.r,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'g',\n            value: rgb.g,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'b',\n            value: rgb.b,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default ColorWrap(Material);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var PhotoshopPicker = function PhotoshopPicker(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsv = _ref.hsv,\n      hex = _ref.hex;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        paddingTop: '5px',\n        paddingBottom: '9px',\n        width: '80px',\n        position: 'relative'\n      },\n      divider: {\n        height: '5px'\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        marginLeft: '40%',\n        width: '40%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '5px',\n        fontSize: '13px',\n        paddingLeft: '3px',\n        marginRight: '10px'\n      },\n      RGBlabel: {\n        left: '0px',\n        top: '0px',\n        width: '34px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px',\n        position: 'absolute'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        marginLeft: '20%',\n        width: '80%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '6px',\n        fontSize: '13px',\n        paddingLeft: '3px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        width: '14px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px'\n      },\n      fieldSymbols: {\n        position: 'absolute',\n        top: '5px',\n        right: '-7px',\n        fontSize: '13px'\n      },\n      symbol: {\n        height: '20px',\n        lineHeight: '22px',\n        paddingBottom: '7px'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data['#']) {\n      color.isValidHex(data['#']) && onChange({\n        hex: data['#'],\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else if (data.h || data.s || data.v) {\n      onChange({\n        h: data.h || hsv.h,\n        s: data.s || hsv.s,\n        v: data.v || hsv.v,\n        source: 'hsv'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields },\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'h',\n      value: Math.round(hsv.h),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 's',\n      value: Math.round(hsv.s * 100),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'v',\n      value: Math.round(hsv.v * 100),\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: '#',\n      value: hex.replace('#', ''),\n      onChange: handleChange\n    }),\n    React.createElement(\n      'div',\n      { style: styles.fieldSymbols },\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '\\xB0'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      )\n    )\n  );\n};\n\nexport default PhotoshopPicker;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle(_ref) {\n  var hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    },\n    'black-outline': {\n      picker: {\n        boxShadow: 'inset 0 0 0 1px #000'\n      }\n    }\n  }, { 'black-outline': hsl.l > 0.5 });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      triangle: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '4px 0 4px 6px',\n        borderColor: 'transparent transparent transparent #fff',\n        position: 'absolute',\n        top: '1px',\n        left: '1px'\n      },\n      triangleBorder: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '5px 0 5px 8px',\n        borderColor: 'transparent transparent transparent #555'\n      },\n\n      left: {\n        Extend: 'triangleBorder',\n        transform: 'translate(-13px, -4px)'\n      },\n      leftInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      },\n\n      right: {\n        Extend: 'triangleBorder',\n        transform: 'translate(20px, -14px) rotate(180deg)'\n      },\n      rightInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.pointer },\n    React.createElement(\n      'div',\n      { style: styles.left },\n      React.createElement('div', { style: styles.leftInside })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.right },\n      React.createElement('div', { style: styles.rightInside })\n    )\n  );\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopButton = function PhotoshopButton(_ref) {\n  var onClick = _ref.onClick,\n      label = _ref.label,\n      children = _ref.children,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      button: {\n        backgroundImage: 'linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)',\n        border: '1px solid #878787',\n        borderRadius: '2px',\n        height: '20px',\n        boxShadow: '0 1px 0 0 #EAEAEA',\n        fontSize: '14px',\n        color: '#000',\n        lineHeight: '20px',\n        textAlign: 'center',\n        marginBottom: '10px',\n        cursor: 'pointer'\n      }\n    },\n    'active': {\n      button: {\n        boxShadow: '0 0 0 1px #878787'\n      }\n    }\n  }, { active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.button, onClick: onClick },\n    label || children\n  );\n};\n\nexport default PhotoshopButton;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPreviews = function PhotoshopPreviews(_ref) {\n  var rgb = _ref.rgb,\n      currentColor = _ref.currentColor;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        border: '1px solid #B3B3B3',\n        borderBottom: '1px solid #F0F0F0',\n        marginBottom: '2px',\n        marginTop: '1px'\n      },\n      new: {\n        height: '34px',\n        background: 'rgb(' + rgb.r + ',' + rgb.g + ', ' + rgb.b + ')',\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000'\n      },\n      current: {\n        height: '34px',\n        background: currentColor,\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000'\n      },\n      label: {\n        fontSize: '14px',\n        color: '#000',\n        textAlign: 'center'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    null,\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'new'\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement('div', { style: styles.new }),\n      React.createElement('div', { style: styles.current })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'current'\n    )\n  );\n};\n\nexport default PhotoshopPreviews;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport PhotoshopFields from './PhotoshopFields';\nimport PhotoshopPointerCircle from './PhotoshopPointerCircle';\nimport PhotoshopPointer from './PhotoshopPointer';\nimport PhotoshopButton from './PhotoshopButton';\nimport PhotoshopPreviews from './PhotoshopPreviews';\n\nexport var Photoshop = function (_React$Component) {\n  _inherits(Photoshop, _React$Component);\n\n  function Photoshop(props) {\n    _classCallCheck(this, Photoshop);\n\n    var _this = _possibleConstructorReturn(this, (Photoshop.__proto__ || Object.getPrototypeOf(Photoshop)).call(this));\n\n    _this.state = {\n      currentColor: props.hex\n    };\n    return _this;\n  }\n\n  _createClass(Photoshop, [{\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          _props$styles = _props.styles,\n          passedStyles = _props$styles === undefined ? {} : _props$styles,\n          _props$className = _props.className,\n          className = _props$className === undefined ? '' : _props$className;\n\n      var styles = reactCSS(merge({\n        'default': {\n          picker: {\n            background: '#DCDCDC',\n            borderRadius: '4px',\n            boxShadow: '0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)',\n            boxSizing: 'initial',\n            width: '513px'\n          },\n          head: {\n            backgroundImage: 'linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)',\n            borderBottom: '1px solid #B1B1B1',\n            boxShadow: 'inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)',\n            height: '23px',\n            lineHeight: '24px',\n            borderRadius: '4px 4px 0 0',\n            fontSize: '13px',\n            color: '#4D4D4D',\n            textAlign: 'center'\n          },\n          body: {\n            padding: '15px 15px 0',\n            display: 'flex'\n          },\n          saturation: {\n            width: '256px',\n            height: '256px',\n            position: 'relative',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0',\n            overflow: 'hidden'\n          },\n          hue: {\n            position: 'relative',\n            height: '256px',\n            width: '19px',\n            marginLeft: '10px',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0'\n          },\n          controls: {\n            width: '180px',\n            marginLeft: '10px'\n          },\n          top: {\n            display: 'flex'\n          },\n          previews: {\n            width: '60px'\n          },\n          actions: {\n            flex: '1',\n            marginLeft: '20px'\n          }\n        }\n      }, passedStyles));\n\n      return React.createElement(\n        'div',\n        { style: styles.picker, className: 'photoshop-picker ' + className },\n        React.createElement(\n          'div',\n          { style: styles.head },\n          this.props.header\n        ),\n        React.createElement(\n          'div',\n          { style: styles.body, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.saturation },\n            React.createElement(Saturation, {\n              hsl: this.props.hsl,\n              hsv: this.props.hsv,\n              pointer: PhotoshopPointerCircle,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              direction: 'vertical',\n              hsl: this.props.hsl,\n              pointer: PhotoshopPointer,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.controls },\n            React.createElement(\n              'div',\n              { style: styles.top, className: 'flexbox-fix' },\n              React.createElement(\n                'div',\n                { style: styles.previews },\n                React.createElement(PhotoshopPreviews, {\n                  rgb: this.props.rgb,\n                  currentColor: this.state.currentColor\n                })\n              ),\n              React.createElement(\n                'div',\n                { style: styles.actions },\n                React.createElement(PhotoshopButton, { label: 'OK', onClick: this.props.onAccept, active: true }),\n                React.createElement(PhotoshopButton, { label: 'Cancel', onClick: this.props.onCancel }),\n                React.createElement(PhotoshopFields, {\n                  onChange: this.props.onChange,\n                  rgb: this.props.rgb,\n                  hsv: this.props.hsv,\n                  hex: this.props.hex\n                })\n              )\n            )\n          )\n        )\n      );\n    }\n  }]);\n\n  return Photoshop;\n}(React.Component);\n\nPhotoshop.propTypes = {\n  header: PropTypes.string,\n  styles: PropTypes.object\n};\n\nPhotoshop.defaultProps = {\n  header: 'Color Picker',\n  styles: {}\n};\n\nexport default ColorWrap(Photoshop);","/* eslint-disable no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var SketchFields = function SketchFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      disableAlpha = _ref.disableAlpha;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingTop: '4px'\n      },\n      single: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      alpha: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      double: {\n        flex: '2'\n      },\n      input: {\n        width: '80%',\n        padding: '4px 10% 3px',\n        border: 'none',\n        boxShadow: 'inset 0 0 0 1px #ccc',\n        fontSize: '11px'\n      },\n      label: {\n        display: 'block',\n        textAlign: 'center',\n        fontSize: '11px',\n        color: '#222',\n        paddingTop: '3px',\n        paddingBottom: '4px',\n        textTransform: 'capitalize'\n      }\n    },\n    'disableAlpha': {\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, { disableAlpha: disableAlpha });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        a: rgb.a,\n        source: 'rgb'\n      }, e);\n    } else if (data.a) {\n      if (data.a < 0) {\n        data.a = 0;\n      } else if (data.a > 100) {\n        data.a = 100;\n      }\n\n      data.a /= 100;\n      onChange({\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: data.a,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.double },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'hex',\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'r',\n        value: rgb.r,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'g',\n        value: rgb.g,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'b',\n        value: rgb.b,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.alpha },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'a',\n        value: Math.round(rgb.a * 100),\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '100'\n      })\n    )\n  );\n};\n\nexport default SketchFields;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var SketchPresetColors = function SketchPresetColors(_ref) {\n  var colors = _ref.colors,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      colors: {\n        margin: '0 -10px',\n        padding: '10px 0 0 10px',\n        borderTop: '1px solid #eee',\n        display: 'flex',\n        flexWrap: 'wrap',\n        position: 'relative'\n      },\n      swatchWrap: {\n        width: '16px',\n        height: '16px',\n        margin: '0 10px 10px 0'\n      },\n      swatch: {\n        borderRadius: '3px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15)'\n      }\n    },\n    'no-presets': {\n      colors: {\n        display: 'none'\n      }\n    }\n  }, {\n    'no-presets': !colors || !colors.length\n  });\n\n  var handleClick = function handleClick(hex, e) {\n    onClick({\n      hex: hex,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.colors, className: 'flexbox-fix' },\n    colors.map(function (colorObjOrString) {\n      var c = typeof colorObjOrString === 'string' ? { color: colorObjOrString } : colorObjOrString;\n      var key = '' + c.color + (c.title || '');\n      return React.createElement(\n        'div',\n        { key: key, style: styles.swatchWrap },\n        React.createElement(Swatch, _extends({}, c, {\n          style: styles.swatch,\n          onClick: handleClick,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px ' + c.color\n          }\n        }))\n      );\n    })\n  );\n};\n\nSketchPresetColors.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.shape({\n    color: PropTypes.string,\n    title: PropTypes.string\n  })])).isRequired\n};\n\nexport default SketchPresetColors;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport SketchFields from './SketchFields';\nimport SketchPresetColors from './SketchPresetColors';\n\nexport var Sketch = function Sketch(_ref) {\n  var width = _ref.width,\n      rgb = _ref.rgb,\n      hex = _ref.hex,\n      hsv = _ref.hsv,\n      hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      disableAlpha = _ref.disableAlpha,\n      presetColors = _ref.presetColors,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': _extends({\n      picker: {\n        width: width,\n        padding: '10px 10px 0',\n        boxSizing: 'initial',\n        background: '#fff',\n        borderRadius: '4px',\n        boxShadow: '0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '75%',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '3px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      controls: {\n        display: 'flex'\n      },\n      sliders: {\n        padding: '4px 0',\n        flex: '1'\n      },\n      color: {\n        width: '24px',\n        height: '24px',\n        position: 'relative',\n        marginTop: '4px',\n        marginLeft: '4px',\n        borderRadius: '3px'\n      },\n      activeColor: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '2px',\n        background: 'rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ',' + rgb.a + ')',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      hue: {\n        position: 'relative',\n        height: '10px',\n        overflow: 'hidden'\n      },\n      Hue: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n\n      alpha: {\n        position: 'relative',\n        height: '10px',\n        marginTop: '4px',\n        overflow: 'hidden'\n      },\n      Alpha: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      }\n    }, passedStyles),\n    'disableAlpha': {\n      color: {\n        height: '10px'\n      },\n      hue: {\n        height: '10px'\n      },\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'sketch-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.controls, className: 'flexbox-fix' },\n      React.createElement(\n        'div',\n        { style: styles.sliders },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            onChange: onChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.alpha },\n          React.createElement(Alpha, {\n            style: styles.Alpha,\n            rgb: rgb,\n            hsl: hsl,\n            renderers: renderers,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(\n        'div',\n        { style: styles.color },\n        React.createElement(Checkboard, null),\n        React.createElement('div', { style: styles.activeColor })\n      )\n    ),\n    React.createElement(SketchFields, {\n      rgb: rgb,\n      hsl: hsl,\n      hex: hex,\n      onChange: onChange,\n      disableAlpha: disableAlpha\n    }),\n    React.createElement(SketchPresetColors, {\n      colors: presetColors,\n      onClick: onChange,\n      onSwatchHover: onSwatchHover\n    })\n  );\n};\n\nSketch.propTypes = {\n  disableAlpha: PropTypes.bool,\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object\n};\n\nSketch.defaultProps = {\n  disableAlpha: false,\n  width: 200,\n  styles: {},\n  presetColors: ['#D0021B', '#F5A623', '#F8E71C', '#8B572A', '#7ED321', '#417505', '#BD10E0', '#9013FE', '#4A90E2', '#50E3C2', '#B8E986', '#000000', '#4A4A4A', '#9B9B9B', '#FFFFFF']\n};\n\nexport default ColorWrap(Sketch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderSwatch = function SliderSwatch(_ref) {\n  var hsl = _ref.hsl,\n      offset = _ref.offset,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      active = _ref.active,\n      first = _ref.first,\n      last = _ref.last;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        height: '12px',\n        background: 'hsl(' + hsl.h + ', 50%, ' + offset * 100 + '%)',\n        cursor: 'pointer'\n      }\n    },\n    'first': {\n      swatch: {\n        borderRadius: '2px 0 0 2px'\n      }\n    },\n    'last': {\n      swatch: {\n        borderRadius: '0 2px 2px 0'\n      }\n    },\n    'active': {\n      swatch: {\n        transform: 'scaleY(1.8)',\n        borderRadius: '3.6px/2px'\n      }\n    }\n  }, { active: active, first: first, last: last });\n\n  var handleClick = function handleClick(e) {\n    return onClick({\n      h: hsl.h,\n      s: 0.5,\n      l: offset,\n      source: 'hsl'\n    }, e);\n  };\n\n  return React.createElement('div', { style: styles.swatch, onClick: handleClick });\n};\n\nexport default SliderSwatch;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport SliderSwatch from './SliderSwatch';\n\nexport var SliderSwatches = function SliderSwatches(_ref) {\n  var onClick = _ref.onClick,\n      hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginTop: '20px'\n      },\n      swatch: {\n        boxSizing: 'border-box',\n        width: '20%',\n        paddingRight: '1px',\n        float: 'left'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  // Acceptible difference in floating point equality\n  var epsilon = 0.1;\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.80',\n        active: Math.abs(hsl.l - 0.80) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        first: true\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.65',\n        active: Math.abs(hsl.l - 0.65) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.50',\n        active: Math.abs(hsl.l - 0.50) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.35',\n        active: Math.abs(hsl.l - 0.35) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.20',\n        active: Math.abs(hsl.l - 0.20) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        last: true\n      })\n    ),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default SliderSwatches;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '14px',\n        height: '14px',\n        borderRadius: '6px',\n        transform: 'translate(-7px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport SliderSwatches from './SliderSwatches';\nimport SliderPointer from './SliderPointer';\n\nexport var Slider = function Slider(_ref) {\n  var hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      hue: {\n        height: '12px',\n        position: 'relative'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap || {}, className: 'slider-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.hue },\n      React.createElement(Hue, {\n        style: styles.Hue,\n        hsl: hsl,\n        pointer: pointer,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement(SliderSwatches, { hsl: hsl, onClick: onChange })\n    )\n  );\n};\n\nSlider.propTypes = {\n  styles: PropTypes.object\n};\nSlider.defaultProps = {\n  pointer: SliderPointer,\n  styles: {}\n};\n\nexport default ColorWrap(Slider);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\nimport CheckIcon from '@icons/material/CheckIcon';\n\nexport var SwatchesColor = function SwatchesColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      first = _ref.first,\n      last = _ref.last,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        width: '40px',\n        height: '24px',\n        cursor: 'pointer',\n        background: color,\n        marginBottom: '1px'\n      },\n      check: {\n        color: colorUtils.getContrastingColor(color),\n        marginLeft: '8px',\n        display: 'none'\n      }\n    },\n    'first': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '2px 2px 0 0'\n      }\n    },\n    'last': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '0 0 2px 2px'\n      }\n    },\n    'active': {\n      check: {\n        display: 'block'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      check: {\n        color: '#333'\n      }\n    },\n    'transparent': {\n      check: {\n        color: '#333'\n      }\n    }\n  }, {\n    first: first,\n    last: last,\n    active: active,\n    'color-#FFFFFF': color === '#FFFFFF',\n    'transparent': color === 'transparent'\n  });\n\n  return React.createElement(\n    Swatch,\n    {\n      color: color,\n      style: styles.color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement(\n      'div',\n      { style: styles.check },\n      React.createElement(CheckIcon, null)\n    )\n  );\n};\n\nexport default SwatchesColor;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport SwatchesColor from './SwatchesColor';\n\nexport var SwatchesGroup = function SwatchesGroup(_ref) {\n  var onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      group = _ref.group,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      group: {\n        paddingBottom: '10px',\n        width: '40px',\n        float: 'left',\n        marginRight: '10px'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.group },\n    map(group, function (color, i) {\n      return React.createElement(SwatchesColor, {\n        key: color,\n        color: color,\n        active: color.toLowerCase() === active,\n        first: i === 0,\n        last: i === group.length - 1,\n        onClick: onClick,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nexport default SwatchesGroup;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap, Raised } from '../common';\nimport SwatchesGroup from './SwatchesGroup';\n\nexport var Swatches = function Swatches(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        height: height\n      },\n      overflow: {\n        height: height,\n        overflowY: 'scroll'\n      },\n      body: {\n        padding: '16px 0 6px 16px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    return onChange({ hex: data, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'swatches-picker ' + className },\n    React.createElement(\n      Raised,\n      null,\n      React.createElement(\n        'div',\n        { style: styles.overflow },\n        React.createElement(\n          'div',\n          { style: styles.body },\n          map(colors, function (group) {\n            return React.createElement(SwatchesGroup, {\n              key: group.toString(),\n              group: group,\n              active: hex,\n              onClick: handleChange,\n              onSwatchHover: onSwatchHover\n            });\n          }),\n          React.createElement('div', { style: styles.clear })\n        )\n      )\n    )\n  );\n};\n\nSwatches.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  styles: PropTypes.object\n\n  /* eslint-disable max-len */\n};Swatches.defaultProps = {\n  width: 320,\n  height: 240,\n  colors: [[material.red['900'], material.red['700'], material.red['500'], material.red['300'], material.red['100']], [material.pink['900'], material.pink['700'], material.pink['500'], material.pink['300'], material.pink['100']], [material.purple['900'], material.purple['700'], material.purple['500'], material.purple['300'], material.purple['100']], [material.deepPurple['900'], material.deepPurple['700'], material.deepPurple['500'], material.deepPurple['300'], material.deepPurple['100']], [material.indigo['900'], material.indigo['700'], material.indigo['500'], material.indigo['300'], material.indigo['100']], [material.blue['900'], material.blue['700'], material.blue['500'], material.blue['300'], material.blue['100']], [material.lightBlue['900'], material.lightBlue['700'], material.lightBlue['500'], material.lightBlue['300'], material.lightBlue['100']], [material.cyan['900'], material.cyan['700'], material.cyan['500'], material.cyan['300'], material.cyan['100']], [material.teal['900'], material.teal['700'], material.teal['500'], material.teal['300'], material.teal['100']], ['#194D33', material.green['700'], material.green['500'], material.green['300'], material.green['100']], [material.lightGreen['900'], material.lightGreen['700'], material.lightGreen['500'], material.lightGreen['300'], material.lightGreen['100']], [material.lime['900'], material.lime['700'], material.lime['500'], material.lime['300'], material.lime['100']], [material.yellow['900'], material.yellow['700'], material.yellow['500'], material.yellow['300'], material.yellow['100']], [material.amber['900'], material.amber['700'], material.amber['500'], material.amber['300'], material.amber['100']], [material.orange['900'], material.orange['700'], material.orange['500'], material.orange['300'], material.orange['100']], [material.deepOrange['900'], material.deepOrange['700'], material.deepOrange['500'], material.deepOrange['300'], material.deepOrange['100']], [material.brown['900'], material.brown['700'], material.brown['500'], material.brown['300'], material.brown['100']], [material.blueGrey['900'], material.blueGrey['700'], material.blueGrey['500'], material.blueGrey['300'], material.blueGrey['100']], ['#000000', '#525252', '#969696', '#D9D9D9', '#FFFFFF']],\n  styles: {}\n};\n\nexport default ColorWrap(Swatches);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Swatch } from '../common';\n\nexport var Twitter = function Twitter(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '0 solid rgba(0,0,0,0.25)',\n        boxShadow: '0 1px 4px rgba(0,0,0,0.25)',\n        borderRadius: '4px',\n        position: 'relative'\n      },\n      body: {\n        padding: '15px 9px 9px 15px'\n      },\n      label: {\n        fontSize: '18px',\n        color: '#fff'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent #fff transparent',\n        position: 'absolute'\n      },\n      triangleShadow: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent rgba(0,0,0,.1) transparent',\n        position: 'absolute'\n      },\n      hash: {\n        background: '#F0F0F0',\n        height: '30px',\n        width: '30px',\n        borderRadius: '4px 0 0 4px',\n        float: 'left',\n        color: '#98A1A4',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      input: {\n        width: '100px',\n        fontSize: '14px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '28px',\n        boxShadow: 'inset 0 0 0 1px #F0F0F0',\n        boxSizing: 'content-box',\n        borderRadius: '0 4px 4px 0',\n        float: 'left',\n        paddingLeft: '8px'\n      },\n      swatch: {\n        width: '30px',\n        height: '30px',\n        float: 'left',\n        borderRadius: '4px',\n        margin: '0 6px 6px 0'\n      },\n      clear: {\n        clear: 'both'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-10px',\n        left: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        left: '12px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-10px',\n        right: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        right: '12px'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right'\n  });\n\n  var handleChange = function handleChange(hexcode, e) {\n    color.isValidHex(hexcode) && onChange({\n      hex: hexcode,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'twitter-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      map(colors, function (c, i) {\n        return React.createElement(Swatch, {\n          key: i,\n          color: c,\n          hex: c,\n          style: styles.swatch,\n          onClick: handleChange,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: '0 0 4px ' + c\n          }\n        });\n      }),\n      React.createElement(\n        'div',\n        { style: styles.hash },\n        '#'\n      ),\n      React.createElement(EditableInput, {\n        label: null,\n        style: { input: styles.input },\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      }),\n      React.createElement('div', { style: styles.clear })\n    )\n  );\n};\n\nTwitter.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right']),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nTwitter.defaultProps = {\n  width: 276,\n  colors: ['#FF6900', '#FCB900', '#7BDCB5', '#00D084', '#8ED1FC', '#0693E3', '#ABB8C3', '#EB144C', '#F78DA7', '#9900EF'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Twitter);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointerCircle = function GooglePointerCircle(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        border: '2px #fff solid',\n        transform: 'translate(-12px, -13px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', ' + Math.round(props.hsl.s * 100) + '%, ' + Math.round(props.hsl.l * 100) + '%)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointerCircle.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointerCircle.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointer = function GooglePointer(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        transform: 'translate(-10px, -7px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', 100%, 50%)',\n        border: '2px white solid'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointer.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointer.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport { EditableInput } from '../common';\n\nexport var GoogleFields = function GoogleFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      hsv = _ref.hsv;\n\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.rgb) {\n      var values = data.rgb.split(',');\n      color.isvalidColorString(data.rgb, 'rgb') && onChange({\n        r: values[0],\n        g: values[1],\n        b: values[2],\n        a: 1,\n        source: 'rgb'\n      }, e);\n    } else if (data.hsv) {\n      var _values = data.hsv.split(',');\n      if (color.isvalidColorString(data.hsv, 'hsv')) {\n        _values[2] = _values[2].replace('%', '');\n        _values[1] = _values[1].replace('%', '');\n        _values[0] = _values[0].replace('°', '');\n        if (_values[1] == 1) {\n          _values[1] = 0.01;\n        } else if (_values[2] == 1) {\n          _values[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values[0]),\n          s: Number(_values[1]),\n          v: Number(_values[2]),\n          source: 'hsv'\n        }, e);\n      }\n    } else if (data.hsl) {\n      var _values2 = data.hsl.split(',');\n      if (color.isvalidColorString(data.hsl, 'hsl')) {\n        _values2[2] = _values2[2].replace('%', '');\n        _values2[1] = _values2[1].replace('%', '');\n        _values2[0] = _values2[0].replace('°', '');\n        if (hsvValue[1] == 1) {\n          hsvValue[1] = 0.01;\n        } else if (hsvValue[2] == 1) {\n          hsvValue[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values2[0]),\n          s: Number(_values2[1]),\n          v: Number(_values2[2]),\n          source: 'hsl'\n        }, e);\n      }\n    }\n  };\n\n  var styles = reactCSS({\n    'default': {\n      wrap: {\n        display: 'flex',\n        height: '100px',\n        marginTop: '4px'\n      },\n      fields: {\n        width: '100%'\n      },\n      column: {\n        paddingTop: '10px',\n        display: 'flex',\n        justifyContent: 'space-between'\n      },\n      double: {\n        padding: '0px 4.4px',\n        boxSizing: 'border-box'\n      },\n      input: {\n        width: '100%',\n        height: '38px',\n        boxSizing: 'border-box',\n        padding: '4px 10% 3px',\n        textAlign: 'center',\n        border: '1px solid #dadce0',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      input2: {\n        height: '38px',\n        width: '100%',\n        border: '1px solid #dadce0',\n        boxSizing: 'border-box',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        paddingLeft: '10px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label: {\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '35px',\n        top: '-6px',\n        left: '0',\n        right: '0',\n        marginLeft: 'auto',\n        marginRight: 'auto',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label2: {\n        left: '10px',\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '32px',\n        top: '-6px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      single: {\n        flexGrow: '1',\n        margin: '0px 4.4px'\n      }\n    }\n  });\n\n  var rgbValue = rgb.r + ', ' + rgb.g + ', ' + rgb.b;\n  var hslValue = Math.round(hsl.h) + '\\xB0, ' + Math.round(hsl.s * 100) + '%, ' + Math.round(hsl.l * 100) + '%';\n  var hsvValue = Math.round(hsv.h) + '\\xB0, ' + Math.round(hsv.s * 100) + '%, ' + Math.round(hsv.v * 100) + '%';\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.fields },\n      React.createElement(\n        'div',\n        { style: styles.double },\n        React.createElement(EditableInput, {\n          style: { input: styles.input, label: styles.label },\n          label: 'hex',\n          value: hex,\n          onChange: handleChange\n        })\n      ),\n      React.createElement(\n        'div',\n        { style: styles.column },\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'rgb',\n            value: rgbValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsv',\n            value: hsvValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsl',\n            value: hslValue,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default GoogleFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport GooglePointerCircle from './GooglePointerCircle';\nimport GooglePointer from './GooglePointer';\nimport GoogleFields from './GoogleFields';\n\nexport var Google = function Google(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      header = _ref.header,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        border: '1px solid #dfe1e5',\n        boxSizing: 'initial',\n        display: 'flex',\n        flexWrap: 'wrap',\n        borderRadius: '8px 8px 0px 0px'\n      },\n      head: {\n        height: '57px',\n        width: '100%',\n        paddingTop: '16px',\n        paddingBottom: '16px',\n        paddingLeft: '16px',\n        fontSize: '20px',\n        boxSizing: 'border-box',\n        fontFamily: 'Roboto-Regular,HelveticaNeue,Arial,sans-serif'\n      },\n      saturation: {\n        width: '70%',\n        padding: '0px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      swatch: {\n        width: '30%',\n        height: '228px',\n        padding: '0px',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', 1)',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      body: {\n        margin: 'auto',\n        width: '95%'\n      },\n      controls: {\n        display: 'flex',\n        boxSizing: 'border-box',\n        height: '52px',\n        paddingTop: '22px'\n      },\n      color: {\n        width: '32px'\n      },\n      hue: {\n        height: '8px',\n        position: 'relative',\n        margin: '0px 16px 0px 16px',\n        width: '100%'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'google-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.head },\n      header\n    ),\n    React.createElement('div', { style: styles.swatch }),\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        hsl: hsl,\n        hsv: hsv,\n        pointer: GooglePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            radius: '4px',\n            pointer: GooglePointer,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(GoogleFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        hsv: hsv,\n        onChange: onChange\n      })\n    )\n  );\n};\n\nGoogle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object,\n  header: PropTypes.string\n\n};\n\nGoogle.defaultProps = {\n  width: 652,\n  styles: {},\n  header: 'Color picker'\n};\n\nexport default ColorWrap(Google);","import _extends from '@babel/runtime/helpers/esm/extends';\nimport _assertThisInitialized from '@babel/runtime/helpers/esm/assertThisInitialized';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport memoizeOne from 'memoize-one';\nimport { createElement, PureComponent } from 'react';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\n\n// Animation frame based implementation of setTimeout.\n// Inspired by Joe Lambert, https://gist.github.com/joelambert/1002116#file-requesttimeout-js\nvar hasNativePerformanceNow = typeof performance === 'object' && typeof performance.now === 'function';\nvar now = hasNativePerformanceNow ? function () {\n  return performance.now();\n} : function () {\n  return Date.now();\n};\nfunction cancelTimeout(timeoutID) {\n  cancelAnimationFrame(timeoutID.id);\n}\nfunction requestTimeout(callback, delay) {\n  var start = now();\n\n  function tick() {\n    if (now() - start >= delay) {\n      callback.call(null);\n    } else {\n      timeoutID.id = requestAnimationFrame(tick);\n    }\n  }\n\n  var timeoutID = {\n    id: requestAnimationFrame(tick)\n  };\n  return timeoutID;\n}\n\nvar size = -1; // This utility copied from \"dom-helpers\" package.\n\nfunction getScrollbarSize(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (size === -1 || recalculate) {\n    var div = document.createElement('div');\n    var style = div.style;\n    style.width = '50px';\n    style.height = '50px';\n    style.overflow = 'scroll';\n    document.body.appendChild(div);\n    size = div.offsetWidth - div.clientWidth;\n    document.body.removeChild(div);\n  }\n\n  return size;\n}\nvar cachedRTLResult = null; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n// Chrome does not seem to adhere; its scrollLeft values are positive (measured relative to the left).\n// Safari's elastic bounce makes detecting this even more complicated wrt potential false positives.\n// The safest way to check this is to intentionally set a negative offset,\n// and then verify that the subsequent \"scroll\" event matches the negative offset.\n// If it does not match, then we can assume a non-standard RTL scroll implementation.\n\nfunction getRTLOffsetType(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (cachedRTLResult === null || recalculate) {\n    var outerDiv = document.createElement('div');\n    var outerStyle = outerDiv.style;\n    outerStyle.width = '50px';\n    outerStyle.height = '50px';\n    outerStyle.overflow = 'scroll';\n    outerStyle.direction = 'rtl';\n    var innerDiv = document.createElement('div');\n    var innerStyle = innerDiv.style;\n    innerStyle.width = '100px';\n    innerStyle.height = '100px';\n    outerDiv.appendChild(innerDiv);\n    document.body.appendChild(outerDiv);\n\n    if (outerDiv.scrollLeft > 0) {\n      cachedRTLResult = 'positive-descending';\n    } else {\n      outerDiv.scrollLeft = 1;\n\n      if (outerDiv.scrollLeft === 0) {\n        cachedRTLResult = 'negative';\n      } else {\n        cachedRTLResult = 'positive-ascending';\n      }\n    }\n\n    document.body.removeChild(outerDiv);\n    return cachedRTLResult;\n  }\n\n  return cachedRTLResult;\n}\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL = 150;\n\nvar defaultItemKey = function defaultItemKey(_ref) {\n  var columnIndex = _ref.columnIndex,\n      data = _ref.data,\n      rowIndex = _ref.rowIndex;\n  return rowIndex + \":\" + columnIndex;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsOverscanCount = null;\nvar devWarningsOverscanRowsColumnsCount = null;\nvar devWarningsTagName = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsOverscanCount = /*#__PURE__*/new WeakSet();\n    devWarningsOverscanRowsColumnsCount = /*#__PURE__*/new WeakSet();\n    devWarningsTagName = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createGridComponent(_ref2) {\n  var _class;\n\n  var getColumnOffset = _ref2.getColumnOffset,\n      getColumnStartIndexForOffset = _ref2.getColumnStartIndexForOffset,\n      getColumnStopIndexForStartIndex = _ref2.getColumnStopIndexForStartIndex,\n      getColumnWidth = _ref2.getColumnWidth,\n      getEstimatedTotalHeight = _ref2.getEstimatedTotalHeight,\n      getEstimatedTotalWidth = _ref2.getEstimatedTotalWidth,\n      getOffsetForColumnAndAlignment = _ref2.getOffsetForColumnAndAlignment,\n      getOffsetForRowAndAlignment = _ref2.getOffsetForRowAndAlignment,\n      getRowHeight = _ref2.getRowHeight,\n      getRowOffset = _ref2.getRowOffset,\n      getRowStartIndexForOffset = _ref2.getRowStartIndexForOffset,\n      getRowStopIndexForStartIndex = _ref2.getRowStopIndexForStartIndex,\n      initInstanceProps = _ref2.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref2.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref2.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(Grid, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function Grid(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._resetIsScrollingTimeoutId = null;\n      _this._outerRef = void 0;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        horizontalScrollDirection: 'forward',\n        scrollLeft: typeof _this.props.initialScrollLeft === 'number' ? _this.props.initialScrollLeft : 0,\n        scrollTop: typeof _this.props.initialScrollTop === 'number' ? _this.props.initialScrollTop : 0,\n        scrollUpdateWasRequested: false,\n        verticalScrollDirection: 'forward'\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanColumnStartIndex, overscanColumnStopIndex, overscanRowStartIndex, overscanRowStopIndex, visibleColumnStartIndex, visibleColumnStopIndex, visibleRowStartIndex, visibleRowStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanColumnStartIndex: overscanColumnStartIndex,\n          overscanColumnStopIndex: overscanColumnStopIndex,\n          overscanRowStartIndex: overscanRowStartIndex,\n          overscanRowStopIndex: overscanRowStopIndex,\n          visibleColumnStartIndex: visibleColumnStartIndex,\n          visibleColumnStopIndex: visibleColumnStopIndex,\n          visibleRowStartIndex: visibleRowStartIndex,\n          visibleRowStopIndex: visibleRowStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollLeft, scrollTop, horizontalScrollDirection, verticalScrollDirection, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          horizontalScrollDirection: horizontalScrollDirection,\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          verticalScrollDirection: verticalScrollDirection,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (rowIndex, columnIndex) {\n        var _this$props = _this.props,\n            columnWidth = _this$props.columnWidth,\n            direction = _this$props.direction,\n            rowHeight = _this$props.rowHeight;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && columnWidth, shouldResetStyleCacheOnItemSizeChange && direction, shouldResetStyleCacheOnItemSizeChange && rowHeight);\n\n        var key = rowIndex + \":\" + columnIndex;\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(key)) {\n          style = itemStyleCache[key];\n        } else {\n          var _offset = getColumnOffset(_this.props, columnIndex, _this._instanceProps);\n\n          var isRtl = direction === 'rtl';\n          itemStyleCache[key] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : _offset,\n            right: isRtl ? _offset : undefined,\n            top: getRowOffset(_this.props, rowIndex, _this._instanceProps),\n            height: getRowHeight(_this.props, rowIndex, _this._instanceProps),\n            width: getColumnWidth(_this.props, columnIndex, _this._instanceProps)\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScroll = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientHeight = _event$currentTarget.clientHeight,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollTop = _event$currentTarget.scrollTop,\n            scrollHeight = _event$currentTarget.scrollHeight,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n          // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n          // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n          // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n\n          var calculatedScrollLeft = scrollLeft;\n\n          if (direction === 'rtl') {\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                calculatedScrollLeft = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                calculatedScrollLeft = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          calculatedScrollLeft = Math.max(0, Math.min(calculatedScrollLeft, scrollWidth - clientWidth));\n          var calculatedScrollTop = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n            scrollLeft: calculatedScrollLeft,\n            scrollTop: calculatedScrollTop,\n            verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward',\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1);\n        });\n      };\n\n      return _this;\n    }\n\n    Grid.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = Grid.prototype;\n\n    _proto.scrollTo = function scrollTo(_ref3) {\n      var scrollLeft = _ref3.scrollLeft,\n          scrollTop = _ref3.scrollTop;\n\n      if (scrollLeft !== undefined) {\n        scrollLeft = Math.max(0, scrollLeft);\n      }\n\n      if (scrollTop !== undefined) {\n        scrollTop = Math.max(0, scrollTop);\n      }\n\n      this.setState(function (prevState) {\n        if (scrollLeft === undefined) {\n          scrollLeft = prevState.scrollLeft;\n        }\n\n        if (scrollTop === undefined) {\n          scrollTop = prevState.scrollTop;\n        }\n\n        if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n          return null;\n        }\n\n        return {\n          horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          scrollUpdateWasRequested: true,\n          verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward'\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(_ref4) {\n      var _ref4$align = _ref4.align,\n          align = _ref4$align === void 0 ? 'auto' : _ref4$align,\n          columnIndex = _ref4.columnIndex,\n          rowIndex = _ref4.rowIndex;\n      var _this$props2 = this.props,\n          columnCount = _this$props2.columnCount,\n          height = _this$props2.height,\n          rowCount = _this$props2.rowCount,\n          width = _this$props2.width;\n      var _this$state = this.state,\n          scrollLeft = _this$state.scrollLeft,\n          scrollTop = _this$state.scrollTop;\n      var scrollbarSize = getScrollbarSize();\n\n      if (columnIndex !== undefined) {\n        columnIndex = Math.max(0, Math.min(columnIndex, columnCount - 1));\n      }\n\n      if (rowIndex !== undefined) {\n        rowIndex = Math.max(0, Math.min(rowIndex, rowCount - 1));\n      }\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps); // The scrollbar size should be considered when scrolling an item into view,\n      // to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n\n      var horizontalScrollbarSize = estimatedTotalWidth > width ? scrollbarSize : 0;\n      var verticalScrollbarSize = estimatedTotalHeight > height ? scrollbarSize : 0;\n      this.scrollTo({\n        scrollLeft: columnIndex !== undefined ? getOffsetForColumnAndAlignment(this.props, columnIndex, align, scrollLeft, this._instanceProps, verticalScrollbarSize) : scrollLeft,\n        scrollTop: rowIndex !== undefined ? getOffsetForRowAndAlignment(this.props, rowIndex, align, scrollTop, this._instanceProps, horizontalScrollbarSize) : scrollTop\n      });\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          initialScrollLeft = _this$props3.initialScrollLeft,\n          initialScrollTop = _this$props3.initialScrollTop;\n\n      if (this._outerRef != null) {\n        var outerRef = this._outerRef;\n\n        if (typeof initialScrollLeft === 'number') {\n          outerRef.scrollLeft = initialScrollLeft;\n        }\n\n        if (typeof initialScrollTop === 'number') {\n          outerRef.scrollTop = initialScrollTop;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var direction = this.props.direction;\n      var _this$state2 = this.state,\n          scrollLeft = _this$state2.scrollLeft,\n          scrollTop = _this$state2.scrollTop,\n          scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n        // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n        // So we need to determine which browser behavior we're dealing with, and mimic it.\n        var outerRef = this._outerRef;\n\n        if (direction === 'rtl') {\n          switch (getRTLOffsetType()) {\n            case 'negative':\n              outerRef.scrollLeft = -scrollLeft;\n              break;\n\n            case 'positive-ascending':\n              outerRef.scrollLeft = scrollLeft;\n              break;\n\n            default:\n              var clientWidth = outerRef.clientWidth,\n                  scrollWidth = outerRef.scrollWidth;\n              outerRef.scrollLeft = scrollWidth - clientWidth - scrollLeft;\n              break;\n          }\n        } else {\n          outerRef.scrollLeft = Math.max(0, scrollLeft);\n        }\n\n        outerRef.scrollTop = Math.max(0, scrollTop);\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props4 = this.props,\n          children = _this$props4.children,\n          className = _this$props4.className,\n          columnCount = _this$props4.columnCount,\n          direction = _this$props4.direction,\n          height = _this$props4.height,\n          innerRef = _this$props4.innerRef,\n          innerElementType = _this$props4.innerElementType,\n          innerTagName = _this$props4.innerTagName,\n          itemData = _this$props4.itemData,\n          _this$props4$itemKey = _this$props4.itemKey,\n          itemKey = _this$props4$itemKey === void 0 ? defaultItemKey : _this$props4$itemKey,\n          outerElementType = _this$props4.outerElementType,\n          outerTagName = _this$props4.outerTagName,\n          rowCount = _this$props4.rowCount,\n          style = _this$props4.style,\n          useIsScrolling = _this$props4.useIsScrolling,\n          width = _this$props4.width;\n      var isScrolling = this.state.isScrolling;\n\n      var _this$_getHorizontalR = this._getHorizontalRangeToRender(),\n          columnStartIndex = _this$_getHorizontalR[0],\n          columnStopIndex = _this$_getHorizontalR[1];\n\n      var _this$_getVerticalRan = this._getVerticalRangeToRender(),\n          rowStartIndex = _this$_getVerticalRan[0],\n          rowStopIndex = _this$_getVerticalRan[1];\n\n      var items = [];\n\n      if (columnCount > 0 && rowCount) {\n        for (var _rowIndex = rowStartIndex; _rowIndex <= rowStopIndex; _rowIndex++) {\n          for (var _columnIndex = columnStartIndex; _columnIndex <= columnStopIndex; _columnIndex++) {\n            items.push(createElement(children, {\n              columnIndex: _columnIndex,\n              data: itemData,\n              isScrolling: useIsScrolling ? isScrolling : undefined,\n              key: itemKey({\n                columnIndex: _columnIndex,\n                data: itemData,\n                rowIndex: _rowIndex\n              }),\n              rowIndex: _rowIndex,\n              style: this._getItemStyle(_rowIndex, _columnIndex)\n            }));\n          }\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: this._onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: estimatedTotalHeight,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: estimatedTotalWidth\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      var _this$props5 = this.props,\n          columnCount = _this$props5.columnCount,\n          onItemsRendered = _this$props5.onItemsRendered,\n          onScroll = _this$props5.onScroll,\n          rowCount = _this$props5.rowCount;\n\n      if (typeof onItemsRendered === 'function') {\n        if (columnCount > 0 && rowCount > 0) {\n          var _this$_getHorizontalR2 = this._getHorizontalRangeToRender(),\n              _overscanColumnStartIndex = _this$_getHorizontalR2[0],\n              _overscanColumnStopIndex = _this$_getHorizontalR2[1],\n              _visibleColumnStartIndex = _this$_getHorizontalR2[2],\n              _visibleColumnStopIndex = _this$_getHorizontalR2[3];\n\n          var _this$_getVerticalRan2 = this._getVerticalRangeToRender(),\n              _overscanRowStartIndex = _this$_getVerticalRan2[0],\n              _overscanRowStopIndex = _this$_getVerticalRan2[1],\n              _visibleRowStartIndex = _this$_getVerticalRan2[2],\n              _visibleRowStopIndex = _this$_getVerticalRan2[3];\n\n          this._callOnItemsRendered(_overscanColumnStartIndex, _overscanColumnStopIndex, _overscanRowStartIndex, _overscanRowStopIndex, _visibleColumnStartIndex, _visibleColumnStopIndex, _visibleRowStartIndex, _visibleRowStopIndex);\n        }\n      }\n\n      if (typeof onScroll === 'function') {\n        var _this$state3 = this.state,\n            _horizontalScrollDirection = _this$state3.horizontalScrollDirection,\n            _scrollLeft = _this$state3.scrollLeft,\n            _scrollTop = _this$state3.scrollTop,\n            _scrollUpdateWasRequested = _this$state3.scrollUpdateWasRequested,\n            _verticalScrollDirection = _this$state3.verticalScrollDirection;\n\n        this._callOnScroll(_scrollLeft, _scrollTop, _horizontalScrollDirection, _verticalScrollDirection, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getHorizontalRangeToRender = function _getHorizontalRangeToRender() {\n      var _this$props6 = this.props,\n          columnCount = _this$props6.columnCount,\n          overscanColumnCount = _this$props6.overscanColumnCount,\n          overscanColumnsCount = _this$props6.overscanColumnsCount,\n          overscanCount = _this$props6.overscanCount,\n          rowCount = _this$props6.rowCount;\n      var _this$state4 = this.state,\n          horizontalScrollDirection = _this$state4.horizontalScrollDirection,\n          isScrolling = _this$state4.isScrolling,\n          scrollLeft = _this$state4.scrollLeft;\n      var overscanCountResolved = overscanColumnCount || overscanColumnsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getColumnStartIndexForOffset(this.props, scrollLeft, this._instanceProps);\n      var stopIndex = getColumnStopIndexForStartIndex(this.props, startIndex, scrollLeft, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || horizontalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || horizontalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(columnCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    _proto._getVerticalRangeToRender = function _getVerticalRangeToRender() {\n      var _this$props7 = this.props,\n          columnCount = _this$props7.columnCount,\n          overscanCount = _this$props7.overscanCount,\n          overscanRowCount = _this$props7.overscanRowCount,\n          overscanRowsCount = _this$props7.overscanRowsCount,\n          rowCount = _this$props7.rowCount;\n      var _this$state5 = this.state,\n          isScrolling = _this$state5.isScrolling,\n          verticalScrollDirection = _this$state5.verticalScrollDirection,\n          scrollTop = _this$state5.scrollTop;\n      var overscanCountResolved = overscanRowCount || overscanRowsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getRowStartIndexForOffset(this.props, scrollTop, this._instanceProps);\n      var stopIndex = getRowStopIndexForStartIndex(this.props, startIndex, scrollTop, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || verticalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || verticalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(rowCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return Grid;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    useIsScrolling: false\n  }, _class;\n}\n\nvar validateSharedProps = function validateSharedProps(_ref5, _ref6) {\n  var children = _ref5.children,\n      direction = _ref5.direction,\n      height = _ref5.height,\n      innerTagName = _ref5.innerTagName,\n      outerTagName = _ref5.outerTagName,\n      overscanColumnsCount = _ref5.overscanColumnsCount,\n      overscanCount = _ref5.overscanCount,\n      overscanRowsCount = _ref5.overscanRowsCount,\n      width = _ref5.width;\n  var instance = _ref6.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof overscanCount === 'number') {\n      if (devWarningsOverscanCount && !devWarningsOverscanCount.has(instance)) {\n        devWarningsOverscanCount.add(instance);\n        console.warn('The overscanCount prop has been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (typeof overscanColumnsCount === 'number' || typeof overscanRowsCount === 'number') {\n      if (devWarningsOverscanRowsColumnsCount && !devWarningsOverscanRowsColumnsCount.has(instance)) {\n        devWarningsOverscanRowsColumnsCount.add(instance);\n        console.warn('The overscanColumnsCount and overscanRowsCount props have been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName && !devWarningsTagName.has(instance)) {\n        devWarningsTagName.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    switch (direction) {\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    if (typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Grids must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    }\n\n    if (typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Grids must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE = 50;\n\nvar getEstimatedTotalHeight = function getEstimatedTotalHeight(_ref, _ref2) {\n  var rowCount = _ref.rowCount;\n  var rowMetadataMap = _ref2.rowMetadataMap,\n      estimatedRowHeight = _ref2.estimatedRowHeight,\n      lastMeasuredRowIndex = _ref2.lastMeasuredRowIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredRowIndex >= rowCount) {\n    lastMeasuredRowIndex = rowCount - 1;\n  }\n\n  if (lastMeasuredRowIndex >= 0) {\n    var itemMetadata = rowMetadataMap[lastMeasuredRowIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = rowCount - lastMeasuredRowIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedRowHeight;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getEstimatedTotalWidth = function getEstimatedTotalWidth(_ref3, _ref4) {\n  var columnCount = _ref3.columnCount;\n  var columnMetadataMap = _ref4.columnMetadataMap,\n      estimatedColumnWidth = _ref4.estimatedColumnWidth,\n      lastMeasuredColumnIndex = _ref4.lastMeasuredColumnIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredColumnIndex >= columnCount) {\n    lastMeasuredColumnIndex = columnCount - 1;\n  }\n\n  if (lastMeasuredColumnIndex >= 0) {\n    var itemMetadata = columnMetadataMap[lastMeasuredColumnIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = columnCount - lastMeasuredColumnIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedColumnWidth;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getItemMetadata = function getItemMetadata(itemType, props, index, instanceProps) {\n  var itemMetadataMap, itemSize, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    itemSize = props.columnWidth;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    itemSize = props.rowHeight;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    if (itemType === 'column') {\n      instanceProps.lastMeasuredColumnIndex = index;\n    } else {\n      instanceProps.lastMeasuredRowIndex = index;\n    }\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem = function findNearestItem(itemType, props, instanceProps, offset) {\n  var itemMetadataMap, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch(itemType, props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch(itemType, props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch = function findNearestItemBinarySearch(itemType, props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata(itemType, props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch = function findNearestItemExponentialSearch(itemType, props, instanceProps, index, offset) {\n  var itemCount = itemType === 'column' ? props.columnCount : props.rowCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata(itemType, props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch(itemType, props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getOffsetForIndexAndAlignment = function getOffsetForIndexAndAlignment(itemType, props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n  var size = itemType === 'column' ? props.width : props.height;\n  var itemMetadata = getItemMetadata(itemType, props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n  // To ensure it reflects actual measurements instead of just estimates.\n\n  var estimatedTotalSize = itemType === 'column' ? getEstimatedTotalWidth(props, instanceProps) : getEstimatedTotalHeight(props, instanceProps);\n  var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n  var minOffset = Math.max(0, itemMetadata.offset - size + scrollbarSize + itemMetadata.size);\n\n  if (align === 'smart') {\n    if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n      align = 'auto';\n    } else {\n      align = 'center';\n    }\n  }\n\n  switch (align) {\n    case 'start':\n      return maxOffset;\n\n    case 'end':\n      return minOffset;\n\n    case 'center':\n      return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n    case 'auto':\n    default:\n      if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n        return scrollOffset;\n      } else if (minOffset > maxOffset) {\n        // Because we only take into account the scrollbar size when calculating minOffset\n        // this value can be larger than maxOffset when at the end of the list\n        return minOffset;\n      } else if (scrollOffset < minOffset) {\n        return minOffset;\n      } else {\n        return maxOffset;\n      }\n\n  }\n};\n\nvar VariableSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(props, index, instanceProps) {\n    return getItemMetadata('column', props, index, instanceProps).offset;\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(props, scrollLeft, instanceProps) {\n    return findNearestItem('column', props, instanceProps, scrollLeft);\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(props, startIndex, scrollLeft, instanceProps) {\n    var columnCount = props.columnCount,\n        width = props.width;\n    var itemMetadata = getItemMetadata('column', props, startIndex, instanceProps);\n    var maxOffset = scrollLeft + width;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < columnCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('column', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  getColumnWidth: function getColumnWidth(props, index, instanceProps) {\n    return instanceProps.columnMetadataMap[index].size;\n  },\n  getEstimatedTotalHeight: getEstimatedTotalHeight,\n  getEstimatedTotalWidth: getEstimatedTotalWidth,\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('column', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('row', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getRowOffset: function getRowOffset(props, index, instanceProps) {\n    return getItemMetadata('row', props, index, instanceProps).offset;\n  },\n  getRowHeight: function getRowHeight(props, index, instanceProps) {\n    return instanceProps.rowMetadataMap[index].size;\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(props, scrollTop, instanceProps) {\n    return findNearestItem('row', props, instanceProps, scrollTop);\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(props, startIndex, scrollTop, instanceProps) {\n    var rowCount = props.rowCount,\n        height = props.height;\n    var itemMetadata = getItemMetadata('row', props, startIndex, instanceProps);\n    var maxOffset = scrollTop + height;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < rowCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('row', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref5 = props,\n        estimatedColumnWidth = _ref5.estimatedColumnWidth,\n        estimatedRowHeight = _ref5.estimatedRowHeight;\n    var instanceProps = {\n      columnMetadataMap: {},\n      estimatedColumnWidth: estimatedColumnWidth || DEFAULT_ESTIMATED_ITEM_SIZE,\n      estimatedRowHeight: estimatedRowHeight || DEFAULT_ESTIMATED_ITEM_SIZE,\n      lastMeasuredColumnIndex: -1,\n      lastMeasuredRowIndex: -1,\n      rowMetadataMap: {}\n    };\n\n    instance.resetAfterColumnIndex = function (columnIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        columnIndex: columnIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterRowIndex = function (rowIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        rowIndex: rowIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterIndices = function (_ref6) {\n      var columnIndex = _ref6.columnIndex,\n          rowIndex = _ref6.rowIndex,\n          _ref6$shouldForceUpda = _ref6.shouldForceUpdate,\n          shouldForceUpdate = _ref6$shouldForceUpda === void 0 ? true : _ref6$shouldForceUpda;\n\n      if (typeof columnIndex === 'number') {\n        instanceProps.lastMeasuredColumnIndex = Math.min(instanceProps.lastMeasuredColumnIndex, columnIndex - 1);\n      }\n\n      if (typeof rowIndex === 'number') {\n        instanceProps.lastMeasuredRowIndex = Math.min(instanceProps.lastMeasuredRowIndex, rowIndex - 1);\n      } // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref7) {\n    var columnWidth = _ref7.columnWidth,\n        rowHeight = _ref7.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'function') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      } else if (typeof rowHeight !== 'function') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL$1 = 150;\n\nvar defaultItemKey$1 = function defaultItemKey(index, data) {\n  return index;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsDirection = null;\nvar devWarningsTagName$1 = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsDirection = /*#__PURE__*/new WeakSet();\n    devWarningsTagName$1 = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createListComponent(_ref) {\n  var _class;\n\n  var getItemOffset = _ref.getItemOffset,\n      getEstimatedTotalSize = _ref.getEstimatedTotalSize,\n      getItemSize = _ref.getItemSize,\n      getOffsetForIndexAndAlignment = _ref.getOffsetForIndexAndAlignment,\n      getStartIndexForOffset = _ref.getStartIndexForOffset,\n      getStopIndexForStartIndex = _ref.getStopIndexForStartIndex,\n      initInstanceProps = _ref.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(List, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function List(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._outerRef = void 0;\n      _this._resetIsScrollingTimeoutId = null;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        scrollDirection: 'forward',\n        scrollOffset: typeof _this.props.initialScrollOffset === 'number' ? _this.props.initialScrollOffset : 0,\n        scrollUpdateWasRequested: false\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanStartIndex, overscanStopIndex, visibleStartIndex, visibleStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanStartIndex: overscanStartIndex,\n          overscanStopIndex: overscanStopIndex,\n          visibleStartIndex: visibleStartIndex,\n          visibleStopIndex: visibleStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollDirection, scrollOffset, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          scrollDirection: scrollDirection,\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (index) {\n        var _this$props = _this.props,\n            direction = _this$props.direction,\n            itemSize = _this$props.itemSize,\n            layout = _this$props.layout;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && itemSize, shouldResetStyleCacheOnItemSizeChange && layout, shouldResetStyleCacheOnItemSizeChange && direction);\n\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(index)) {\n          style = itemStyleCache[index];\n        } else {\n          var _offset = getItemOffset(_this.props, index, _this._instanceProps);\n\n          var size = getItemSize(_this.props, index, _this._instanceProps); // TODO Deprecate direction \"horizontal\"\n\n          var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n          var isRtl = direction === 'rtl';\n          var offsetHorizontal = isHorizontal ? _offset : 0;\n          itemStyleCache[index] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : offsetHorizontal,\n            right: isRtl ? offsetHorizontal : undefined,\n            top: !isHorizontal ? _offset : 0,\n            height: !isHorizontal ? size : '100%',\n            width: isHorizontal ? size : '100%'\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScrollHorizontal = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollLeft) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction;\n          var scrollOffset = scrollLeft;\n\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n            // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                scrollOffset = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                scrollOffset = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          scrollOffset = Math.max(0, Math.min(scrollOffset, scrollWidth - clientWidth));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._onScrollVertical = function (event) {\n        var _event$currentTarget2 = event.currentTarget,\n            clientHeight = _event$currentTarget2.clientHeight,\n            scrollHeight = _event$currentTarget2.scrollHeight,\n            scrollTop = _event$currentTarget2.scrollTop;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          var scrollOffset = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL$1);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1, null);\n        });\n      };\n\n      return _this;\n    }\n\n    List.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps$1(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = List.prototype;\n\n    _proto.scrollTo = function scrollTo(scrollOffset) {\n      scrollOffset = Math.max(0, scrollOffset);\n      this.setState(function (prevState) {\n        if (prevState.scrollOffset === scrollOffset) {\n          return null;\n        }\n\n        return {\n          scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: true\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(index, align) {\n      if (align === void 0) {\n        align = 'auto';\n      }\n\n      var _this$props2 = this.props,\n          itemCount = _this$props2.itemCount,\n          layout = _this$props2.layout;\n      var scrollOffset = this.state.scrollOffset;\n      index = Math.max(0, Math.min(index, itemCount - 1)); // The scrollbar size should be considered when scrolling an item into view, to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n      // This is an edge case for lists; normally they only scroll in the dominant direction.\n\n      var scrollbarSize = 0;\n\n      if (this._outerRef) {\n        var outerRef = this._outerRef;\n\n        if (layout === 'vertical') {\n          scrollbarSize = outerRef.scrollWidth > outerRef.clientWidth ? getScrollbarSize() : 0;\n        } else {\n          scrollbarSize = outerRef.scrollHeight > outerRef.clientHeight ? getScrollbarSize() : 0;\n        }\n      }\n\n      this.scrollTo(getOffsetForIndexAndAlignment(this.props, index, align, scrollOffset, this._instanceProps, scrollbarSize));\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          direction = _this$props3.direction,\n          initialScrollOffset = _this$props3.initialScrollOffset,\n          layout = _this$props3.layout;\n\n      if (typeof initialScrollOffset === 'number' && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          outerRef.scrollLeft = initialScrollOffset;\n        } else {\n          outerRef.scrollTop = initialScrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var _this$props4 = this.props,\n          direction = _this$props4.direction,\n          layout = _this$props4.layout;\n      var _this$state = this.state,\n          scrollOffset = _this$state.scrollOffset,\n          scrollUpdateWasRequested = _this$state.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // So we need to determine which browser behavior we're dealing with, and mimic it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                outerRef.scrollLeft = -scrollOffset;\n                break;\n\n              case 'positive-ascending':\n                outerRef.scrollLeft = scrollOffset;\n                break;\n\n              default:\n                var clientWidth = outerRef.clientWidth,\n                    scrollWidth = outerRef.scrollWidth;\n                outerRef.scrollLeft = scrollWidth - clientWidth - scrollOffset;\n                break;\n            }\n          } else {\n            outerRef.scrollLeft = scrollOffset;\n          }\n        } else {\n          outerRef.scrollTop = scrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props5 = this.props,\n          children = _this$props5.children,\n          className = _this$props5.className,\n          direction = _this$props5.direction,\n          height = _this$props5.height,\n          innerRef = _this$props5.innerRef,\n          innerElementType = _this$props5.innerElementType,\n          innerTagName = _this$props5.innerTagName,\n          itemCount = _this$props5.itemCount,\n          itemData = _this$props5.itemData,\n          _this$props5$itemKey = _this$props5.itemKey,\n          itemKey = _this$props5$itemKey === void 0 ? defaultItemKey$1 : _this$props5$itemKey,\n          layout = _this$props5.layout,\n          outerElementType = _this$props5.outerElementType,\n          outerTagName = _this$props5.outerTagName,\n          style = _this$props5.style,\n          useIsScrolling = _this$props5.useIsScrolling,\n          width = _this$props5.width;\n      var isScrolling = this.state.isScrolling; // TODO Deprecate direction \"horizontal\"\n\n      var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n      var onScroll = isHorizontal ? this._onScrollHorizontal : this._onScrollVertical;\n\n      var _this$_getRangeToRend = this._getRangeToRender(),\n          startIndex = _this$_getRangeToRend[0],\n          stopIndex = _this$_getRangeToRend[1];\n\n      var items = [];\n\n      if (itemCount > 0) {\n        for (var _index = startIndex; _index <= stopIndex; _index++) {\n          items.push(createElement(children, {\n            data: itemData,\n            key: itemKey(_index, itemData),\n            index: _index,\n            isScrolling: useIsScrolling ? isScrolling : undefined,\n            style: this._getItemStyle(_index)\n          }));\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalSize = getEstimatedTotalSize(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: isHorizontal ? '100%' : estimatedTotalSize,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: isHorizontal ? estimatedTotalSize : '100%'\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      if (typeof this.props.onItemsRendered === 'function') {\n        var itemCount = this.props.itemCount;\n\n        if (itemCount > 0) {\n          var _this$_getRangeToRend2 = this._getRangeToRender(),\n              _overscanStartIndex = _this$_getRangeToRend2[0],\n              _overscanStopIndex = _this$_getRangeToRend2[1],\n              _visibleStartIndex = _this$_getRangeToRend2[2],\n              _visibleStopIndex = _this$_getRangeToRend2[3];\n\n          this._callOnItemsRendered(_overscanStartIndex, _overscanStopIndex, _visibleStartIndex, _visibleStopIndex);\n        }\n      }\n\n      if (typeof this.props.onScroll === 'function') {\n        var _this$state2 = this.state,\n            _scrollDirection = _this$state2.scrollDirection,\n            _scrollOffset = _this$state2.scrollOffset,\n            _scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n        this._callOnScroll(_scrollDirection, _scrollOffset, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getRangeToRender = function _getRangeToRender() {\n      var _this$props6 = this.props,\n          itemCount = _this$props6.itemCount,\n          overscanCount = _this$props6.overscanCount;\n      var _this$state3 = this.state,\n          isScrolling = _this$state3.isScrolling,\n          scrollDirection = _this$state3.scrollDirection,\n          scrollOffset = _this$state3.scrollOffset;\n\n      if (itemCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getStartIndexForOffset(this.props, scrollOffset, this._instanceProps);\n      var stopIndex = getStopIndexForStartIndex(this.props, startIndex, scrollOffset, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || scrollDirection === 'backward' ? Math.max(1, overscanCount) : 1;\n      var overscanForward = !isScrolling || scrollDirection === 'forward' ? Math.max(1, overscanCount) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(itemCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return List;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    layout: 'vertical',\n    overscanCount: 2,\n    useIsScrolling: false\n  }, _class;\n} // NOTE: I considered further wrapping individual items with a pure ListItem component.\n// This would avoid ever calling the render function for the same index more than once,\n// But it would also add the overhead of a lot of components/fibers.\n// I assume people already do this (render function returning a class component),\n// So my doing it would just unnecessarily double the wrappers.\n\nvar validateSharedProps$1 = function validateSharedProps(_ref2, _ref3) {\n  var children = _ref2.children,\n      direction = _ref2.direction,\n      height = _ref2.height,\n      layout = _ref2.layout,\n      innerTagName = _ref2.innerTagName,\n      outerTagName = _ref2.outerTagName,\n      width = _ref2.width;\n  var instance = _ref3.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName$1 && !devWarningsTagName$1.has(instance)) {\n        devWarningsTagName$1.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    } // TODO Deprecate direction \"horizontal\"\n\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n\n    switch (direction) {\n      case 'horizontal':\n      case 'vertical':\n        if (devWarningsDirection && !devWarningsDirection.has(instance)) {\n          devWarningsDirection.add(instance);\n          console.warn('The direction prop should be either \"ltr\" (default) or \"rtl\". ' + 'Please use the layout prop to specify \"vertical\" (default) or \"horizontal\" orientation.');\n        }\n\n        break;\n\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    switch (layout) {\n      case 'horizontal':\n      case 'vertical':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"layout\" prop has been specified. ' + 'Value should be either \"horizontal\" or \"vertical\". ' + (\"\\\"\" + layout + \"\\\" was specified.\"));\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    if (isHorizontal && typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Horizontal lists must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    } else if (!isHorizontal && typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Vertical lists must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE$1 = 50;\n\nvar getItemMetadata$1 = function getItemMetadata(props, index, instanceProps) {\n  var _ref = props,\n      itemSize = _ref.itemSize;\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    instanceProps.lastMeasuredIndex = index;\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem$1 = function findNearestItem(props, instanceProps, offset) {\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch$1(props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch$1(props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch$1 = function findNearestItemBinarySearch(props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata$1(props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch$1 = function findNearestItemExponentialSearch(props, instanceProps, index, offset) {\n  var itemCount = props.itemCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata$1(props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch$1(props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getEstimatedTotalSize = function getEstimatedTotalSize(_ref2, _ref3) {\n  var itemCount = _ref2.itemCount;\n  var itemMetadataMap = _ref3.itemMetadataMap,\n      estimatedItemSize = _ref3.estimatedItemSize,\n      lastMeasuredIndex = _ref3.lastMeasuredIndex;\n  var totalSizeOfMeasuredItems = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredIndex >= itemCount) {\n    lastMeasuredIndex = itemCount - 1;\n  }\n\n  if (lastMeasuredIndex >= 0) {\n    var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n    totalSizeOfMeasuredItems = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = itemCount - lastMeasuredIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedItemSize;\n  return totalSizeOfMeasuredItems + totalSizeOfUnmeasuredItems;\n};\n\nvar VariableSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(props, index, instanceProps) {\n    return getItemMetadata$1(props, index, instanceProps).offset;\n  },\n  getItemSize: function getItemSize(props, index, instanceProps) {\n    return instanceProps.itemMetadataMap[index].size;\n  },\n  getEstimatedTotalSize: getEstimatedTotalSize,\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = props.direction,\n        height = props.height,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n    // To ensure it reflects actual measurements instead of just estimates.\n\n    var estimatedTotalSize = getEstimatedTotalSize(props, instanceProps);\n    var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n    var minOffset = Math.max(0, itemMetadata.offset - size + itemMetadata.size + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(props, offset, instanceProps) {\n    return findNearestItem$1(props, instanceProps, offset);\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(props, startIndex, scrollOffset, instanceProps) {\n    var direction = props.direction,\n        height = props.height,\n        itemCount = props.itemCount,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, startIndex, instanceProps);\n    var maxOffset = scrollOffset + size;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < itemCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata$1(props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref4 = props,\n        estimatedItemSize = _ref4.estimatedItemSize;\n    var instanceProps = {\n      itemMetadataMap: {},\n      estimatedItemSize: estimatedItemSize || DEFAULT_ESTIMATED_ITEM_SIZE$1,\n      lastMeasuredIndex: -1\n    };\n\n    instance.resetAfterIndex = function (index, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instanceProps.lastMeasuredIndex = Math.min(instanceProps.lastMeasuredIndex, index - 1); // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref5) {\n    var itemSize = _ref5.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'function') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(_ref, index) {\n    var columnWidth = _ref.columnWidth;\n    return index * columnWidth;\n  },\n  getColumnWidth: function getColumnWidth(_ref2, index) {\n    var columnWidth = _ref2.columnWidth;\n    return columnWidth;\n  },\n  getRowOffset: function getRowOffset(_ref3, index) {\n    var rowHeight = _ref3.rowHeight;\n    return index * rowHeight;\n  },\n  getRowHeight: function getRowHeight(_ref4, index) {\n    var rowHeight = _ref4.rowHeight;\n    return rowHeight;\n  },\n  getEstimatedTotalHeight: function getEstimatedTotalHeight(_ref5) {\n    var rowCount = _ref5.rowCount,\n        rowHeight = _ref5.rowHeight;\n    return rowHeight * rowCount;\n  },\n  getEstimatedTotalWidth: function getEstimatedTotalWidth(_ref6) {\n    var columnCount = _ref6.columnCount,\n        columnWidth = _ref6.columnWidth;\n    return columnWidth * columnCount;\n  },\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(_ref7, columnIndex, align, scrollLeft, instanceProps, scrollbarSize) {\n    var columnCount = _ref7.columnCount,\n        columnWidth = _ref7.columnWidth,\n        width = _ref7.width;\n    var lastColumnOffset = Math.max(0, columnCount * columnWidth - width);\n    var maxOffset = Math.min(lastColumnOffset, columnIndex * columnWidth);\n    var minOffset = Math.max(0, columnIndex * columnWidth - width + scrollbarSize + columnWidth);\n\n    if (align === 'smart') {\n      if (scrollLeft >= minOffset - width && scrollLeft <= maxOffset + width) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(width / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastColumnOffset + Math.floor(width / 2)) {\n          return lastColumnOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollLeft >= minOffset && scrollLeft <= maxOffset) {\n          return scrollLeft;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollLeft < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(_ref8, rowIndex, align, scrollTop, instanceProps, scrollbarSize) {\n    var rowHeight = _ref8.rowHeight,\n        height = _ref8.height,\n        rowCount = _ref8.rowCount;\n    var lastRowOffset = Math.max(0, rowCount * rowHeight - height);\n    var maxOffset = Math.min(lastRowOffset, rowIndex * rowHeight);\n    var minOffset = Math.max(0, rowIndex * rowHeight - height + scrollbarSize + rowHeight);\n\n    if (align === 'smart') {\n      if (scrollTop >= minOffset - height && scrollTop <= maxOffset + height) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(height / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastRowOffset + Math.floor(height / 2)) {\n          return lastRowOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollTop >= minOffset && scrollTop <= maxOffset) {\n          return scrollTop;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollTop < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(_ref9, scrollLeft) {\n    var columnWidth = _ref9.columnWidth,\n        columnCount = _ref9.columnCount;\n    return Math.max(0, Math.min(columnCount - 1, Math.floor(scrollLeft / columnWidth)));\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(_ref10, startIndex, scrollLeft) {\n    var columnWidth = _ref10.columnWidth,\n        columnCount = _ref10.columnCount,\n        width = _ref10.width;\n    var left = startIndex * columnWidth;\n    var numVisibleColumns = Math.ceil((width + scrollLeft - left) / columnWidth);\n    return Math.max(0, Math.min(columnCount - 1, startIndex + numVisibleColumns - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(_ref11, scrollTop) {\n    var rowHeight = _ref11.rowHeight,\n        rowCount = _ref11.rowCount;\n    return Math.max(0, Math.min(rowCount - 1, Math.floor(scrollTop / rowHeight)));\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(_ref12, startIndex, scrollTop) {\n    var rowHeight = _ref12.rowHeight,\n        rowCount = _ref12.rowCount,\n        height = _ref12.height;\n    var top = startIndex * rowHeight;\n    var numVisibleRows = Math.ceil((height + scrollTop - top) / rowHeight);\n    return Math.max(0, Math.min(rowCount - 1, startIndex + numVisibleRows - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref13) {\n    var columnWidth = _ref13.columnWidth,\n        rowHeight = _ref13.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'number') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      }\n\n      if (typeof rowHeight !== 'number') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(_ref, index) {\n    var itemSize = _ref.itemSize;\n    return index * itemSize;\n  },\n  getItemSize: function getItemSize(_ref2, index) {\n    var itemSize = _ref2.itemSize;\n    return itemSize;\n  },\n  getEstimatedTotalSize: function getEstimatedTotalSize(_ref3) {\n    var itemCount = _ref3.itemCount,\n        itemSize = _ref3.itemSize;\n    return itemSize * itemCount;\n  },\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(_ref4, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = _ref4.direction,\n        height = _ref4.height,\n        itemCount = _ref4.itemCount,\n        itemSize = _ref4.itemSize,\n        layout = _ref4.layout,\n        width = _ref4.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var lastItemOffset = Math.max(0, itemCount * itemSize - size);\n    var maxOffset = Math.min(lastItemOffset, index * itemSize);\n    var minOffset = Math.max(0, index * itemSize - size + itemSize + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        {\n          // \"Centered\" offset is usually the average of the min and max.\n          // But near the edges of the list, this doesn't hold true.\n          var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n          if (middleOffset < Math.ceil(size / 2)) {\n            return 0; // near the beginning\n          } else if (middleOffset > lastItemOffset + Math.floor(size / 2)) {\n            return lastItemOffset; // near the end\n          } else {\n            return middleOffset;\n          }\n        }\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(_ref5, offset) {\n    var itemCount = _ref5.itemCount,\n        itemSize = _ref5.itemSize;\n    return Math.max(0, Math.min(itemCount - 1, Math.floor(offset / itemSize)));\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(_ref6, startIndex, scrollOffset) {\n    var direction = _ref6.direction,\n        height = _ref6.height,\n        itemCount = _ref6.itemCount,\n        itemSize = _ref6.itemSize,\n        layout = _ref6.layout,\n        width = _ref6.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var offset = startIndex * itemSize;\n    var size = isHorizontal ? width : height;\n    var numVisibleItems = Math.ceil((size + scrollOffset - offset) / itemSize);\n    return Math.max(0, Math.min(itemCount - 1, startIndex + numVisibleItems - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref7) {\n    var itemSize = _ref7.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'number') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\n// Pulled from react-compat\n// https://github.com/developit/preact-compat/blob/7c5de00e7c85e2ffd011bf3af02899b63f699d3a/src/index.js#L349\nfunction shallowDiffers(prev, next) {\n  for (var attribute in prev) {\n    if (!(attribute in next)) {\n      return true;\n    }\n  }\n\n  for (var _attribute in next) {\n    if (prev[_attribute] !== next[_attribute]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar _excluded = [\"style\"],\n    _excluded2 = [\"style\"];\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-api.html#reactmemo\n\nfunction areEqual(prevProps, nextProps) {\n  var prevStyle = prevProps.style,\n      prevRest = _objectWithoutPropertiesLoose(prevProps, _excluded);\n\n  var nextStyle = nextProps.style,\n      nextRest = _objectWithoutPropertiesLoose(nextProps, _excluded2);\n\n  return !shallowDiffers(prevStyle, nextStyle) && !shallowDiffers(prevRest, nextRest);\n}\n\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-component.html#shouldcomponentupdate\n\nfunction shouldComponentUpdate(nextProps, nextState) {\n  return !areEqual(this.props, nextProps) || shallowDiffers(this.state, nextState);\n}\n\nexport { FixedSizeGrid, FixedSizeList, VariableSizeGrid, VariableSizeList, areEqual, shouldComponentUpdate };\n//# sourceMappingURL=index.esm.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.autoprefix = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar transforms = {\n  borderRadius: function borderRadius(value) {\n    return {\n      msBorderRadius: value,\n      MozBorderRadius: value,\n      OBorderRadius: value,\n      WebkitBorderRadius: value,\n      borderRadius: value\n    };\n  },\n  boxShadow: function boxShadow(value) {\n    return {\n      msBoxShadow: value,\n      MozBoxShadow: value,\n      OBoxShadow: value,\n      WebkitBoxShadow: value,\n      boxShadow: value\n    };\n  },\n  userSelect: function userSelect(value) {\n    return {\n      WebkitTouchCallout: value,\n      KhtmlUserSelect: value,\n      MozUserSelect: value,\n      msUserSelect: value,\n      WebkitUserSelect: value,\n      userSelect: value\n    };\n  },\n\n  flex: function flex(value) {\n    return {\n      WebkitBoxFlex: value,\n      MozBoxFlex: value,\n      WebkitFlex: value,\n      msFlex: value,\n      flex: value\n    };\n  },\n  flexBasis: function flexBasis(value) {\n    return {\n      WebkitFlexBasis: value,\n      flexBasis: value\n    };\n  },\n  justifyContent: function justifyContent(value) {\n    return {\n      WebkitJustifyContent: value,\n      justifyContent: value\n    };\n  },\n\n  transition: function transition(value) {\n    return {\n      msTransition: value,\n      MozTransition: value,\n      OTransition: value,\n      WebkitTransition: value,\n      transition: value\n    };\n  },\n\n  transform: function transform(value) {\n    return {\n      msTransform: value,\n      MozTransform: value,\n      OTransform: value,\n      WebkitTransform: value,\n      transform: value\n    };\n  },\n  absolute: function absolute(value) {\n    var direction = value && value.split(' ');\n    return {\n      position: 'absolute',\n      top: direction && direction[0],\n      right: direction && direction[1],\n      bottom: direction && direction[2],\n      left: direction && direction[3]\n    };\n  },\n  extend: function extend(name, otherElementStyles) {\n    var otherStyle = otherElementStyles[name];\n    if (otherStyle) {\n      return otherStyle;\n    }\n    return {\n      'extend': name\n    };\n  }\n};\n\nvar autoprefix = exports.autoprefix = function autoprefix(elements) {\n  var prefixed = {};\n  (0, _forOwn3.default)(elements, function (styles, element) {\n    var expanded = {};\n    (0, _forOwn3.default)(styles, function (value, key) {\n      var transform = transforms[key];\n      if (transform) {\n        expanded = _extends({}, expanded, transform(value));\n      } else {\n        expanded[key] = value;\n      }\n    });\n    prefixed[element] = expanded;\n  });\n  return prefixed;\n};\n\nexports.default = autoprefix;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.active = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar active = exports.active = function active(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Active, _React$Component);\n\n    function Active() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Active);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Active.__proto__ || Object.getPrototypeOf(Active)).call.apply(_ref, [this].concat(args))), _this), _this.state = { active: false }, _this.handleMouseDown = function () {\n        return _this.setState({ active: true });\n      }, _this.handleMouseUp = function () {\n        return _this.setState({ active: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseDown: _this.handleMouseDown, onMouseUp: _this.handleMouseUp },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Active;\n  }(_react2.default.Component);\n};\n\nexports.default = active;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hover = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar hover = exports.hover = function hover(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Hover, _React$Component);\n\n    function Hover() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Hover);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Hover.__proto__ || Object.getPrototypeOf(Hover)).call.apply(_ref, [this].concat(args))), _this), _this.state = { hover: false }, _this.handleMouseOver = function () {\n        return _this.setState({ hover: true });\n      }, _this.handleMouseOut = function () {\n        return _this.setState({ hover: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseOver: _this.handleMouseOver, onMouseOut: _this.handleMouseOut },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Hover;\n  }(_react2.default.Component);\n};\n\nexports.default = hover;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.flattenNames = undefined;\n\nvar _isString2 = require('lodash/isString');\n\nvar _isString3 = _interopRequireDefault(_isString2);\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _isPlainObject2 = require('lodash/isPlainObject');\n\nvar _isPlainObject3 = _interopRequireDefault(_isPlainObject2);\n\nvar _map2 = require('lodash/map');\n\nvar _map3 = _interopRequireDefault(_map2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar flattenNames = exports.flattenNames = function flattenNames() {\n  var things = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n  var names = [];\n\n  (0, _map3.default)(things, function (thing) {\n    if (Array.isArray(thing)) {\n      flattenNames(thing).map(function (name) {\n        return names.push(name);\n      });\n    } else if ((0, _isPlainObject3.default)(thing)) {\n      (0, _forOwn3.default)(thing, function (value, key) {\n        value === true && names.push(key);\n        names.push(key + '-' + value);\n      });\n    } else if ((0, _isString3.default)(thing)) {\n      names.push(thing);\n    }\n  });\n\n  return names;\n};\n\nexports.default = flattenNames;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReactCSS = exports.loop = exports.handleActive = exports.handleHover = exports.hover = undefined;\n\nvar _flattenNames = require('./flattenNames');\n\nvar _flattenNames2 = _interopRequireDefault(_flattenNames);\n\nvar _mergeClasses = require('./mergeClasses');\n\nvar _mergeClasses2 = _interopRequireDefault(_mergeClasses);\n\nvar _autoprefix = require('./autoprefix');\n\nvar _autoprefix2 = _interopRequireDefault(_autoprefix);\n\nvar _hover2 = require('./components/hover');\n\nvar _hover3 = _interopRequireDefault(_hover2);\n\nvar _active = require('./components/active');\n\nvar _active2 = _interopRequireDefault(_active);\n\nvar _loop2 = require('./loop');\n\nvar _loop3 = _interopRequireDefault(_loop2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.hover = _hover3.default;\nexports.handleHover = _hover3.default;\nexports.handleActive = _active2.default;\nexports.loop = _loop3.default;\nvar ReactCSS = exports.ReactCSS = function ReactCSS(classes) {\n  for (var _len = arguments.length, activations = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    activations[_key - 1] = arguments[_key];\n  }\n\n  var activeNames = (0, _flattenNames2.default)(activations);\n  var merged = (0, _mergeClasses2.default)(classes, activeNames);\n  return (0, _autoprefix2.default)(merged);\n};\n\nexports.default = ReactCSS;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar loopable = function loopable(i, length) {\n  var props = {};\n  var setProp = function setProp(name) {\n    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    props[name] = value;\n  };\n\n  i === 0 && setProp('first-child');\n  i === length - 1 && setProp('last-child');\n  (i === 0 || i % 2 === 0) && setProp('even');\n  Math.abs(i % 2) === 1 && setProp('odd');\n  setProp('nth-child', i);\n\n  return props;\n};\n\nexports.default = loopable;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mergeClasses = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _cloneDeep2 = require('lodash/cloneDeep');\n\nvar _cloneDeep3 = _interopRequireDefault(_cloneDeep2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mergeClasses = exports.mergeClasses = function mergeClasses(classes) {\n  var activeNames = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  var styles = classes.default && (0, _cloneDeep3.default)(classes.default) || {};\n  activeNames.map(function (name) {\n    var toMerge = classes[name];\n    if (toMerge) {\n      (0, _forOwn3.default)(toMerge, function (value, key) {\n        if (!styles[key]) {\n          styles[key] = {};\n        }\n\n        styles[key] = _extends({}, styles[key], toMerge[key]);\n      });\n    }\n\n    return name;\n  });\n  return styles;\n};\n\nexports.default = mergeClasses;","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var h=require(\"react\"),n=require(\"use-sync-external-store/shim\");function p(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var q=\"function\"===typeof Object.is?Object.is:p,r=n.useSyncExternalStore,t=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;\nexports.useSyncExternalStoreWithSelector=function(a,b,e,l,g){var c=t(null);if(null===c.current){var f={hasValue:!1,value:null};c.current=f}else f=c.current;c=v(function(){function a(a){if(!c){c=!0;d=a;a=l(a);if(void 0!==g&&f.hasValue){var b=f.value;if(g(b,a))return k=b}return k=a}b=k;if(q(d,a))return b;var e=l(a);if(void 0!==g&&g(b,e))return b;d=a;return k=e}var c=!1,d,k,m=void 0===e?null:e;return[function(){return a(b())},null===m?void 0:function(){return a(m())}]},[b,e,l,g]);var d=r(a,c[0],c[1]);\nu(function(){f.hasValue=!0;f.value=d},[d]);w(d);return d};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (_e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (_e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (_e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return [\n              true,\n              options.migrate(\n                deserializedStorageValue.state,\n                deserializedStorageValue.version\n              )\n            ];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n"],"names":["FullDateInterface","constructor","date","this","fullDate","getTimeInSec","dateString","substring","timeString","yyyy","parseInt","mm","length","undefined","dd","isNaN","Error","dateJS","Date","HH","MM","SS","fractionalStr","FFFFFF","Math","pow","timeInSec","getTime","getTimeInMicroSec","combineDateTime","time","hours","padStart","minutes","seconds","month","day","fractionalSeconds","padEnd","year","parseDA","d","m","y","daysInMonth","parseTM","hh","ss","ffffff","dateTimeToFullDateInterface","dateTime","calculateDecayCorrection","instances","RadionuclideTotalDose","RadionuclideHalfLife","RadiopharmaceuticalStartDateTime","RadiopharmaceuticalStartTime","SeriesDate","scanTimes","SeriesTime","GEPrivatePostInjectionDateTime","results","Array","seriesDateTime","earliestAcquisitionDateTime","timeError","forEach","instance","AcquisitionDate","AcquisitionTime","acquisitionDateTime","fill","calculateScanTimes","startTime","input","calculateStartTime","map","_","index","decayTimeInSec","deepEquals","a","b","isArray","every","val","calculateSUVScalingFactors","CorrectedImage","Units","PhilipsPETPrivateGroup","PatientWeight","PatientSex","PatientSize","includes","DecayCorrection","decayCorrectionArray","weightInGrams","value","hasValidSUVScaleFactor","_instance$PhilipsPETP","_instance$PhilipsPETP2","_instance$PhilipsPETP3","SUVScaleFactor","hasValidActivityConcentrationScaleFactor","_instance$PhilipsPETP4","_instance$PhilipsPETP5","_instance$PhilipsPETP6","ActivityConcentrationScaleFactor","JSON","stringify","suvbsaFactor","suvlbmFactor","suvlbmJenmaFactor","console","warn","inputs","calculateSUVbsaScalingFactor","suvlbmInputs","LBM","weightSizeFactor","calculateSUVlbmScalingFactor","bodyMassIndex","calculateSUVlbmJanmahasatianScalingFactor","result","factors","suvbw","suvbsa","suvlbm","suvlbmJanma","config","getConfig","setConfig","newConfig","polysegInitialized","getPolySeg","addons","polySeg","polyseg","init","DEFINED_CURSORS","Symbol","STANDARD_CURSORS","Set","MouseCursor","name","fallback","getName","addFallbackStyleProperty","style","getStyleProperty","getDefinedCursor","definedCursors","getDefinedCursors","mouseCursor","get","has","set","setDefinedCursor","cursor","context","symbol","Map","Object","defineProperty","standardCursorNames","values","ELEMENT_CURSORS_MAP","initElementCursor","element","_getElementCursors","_setElementCursor","cursors","resetElementCursor","hideElementCursor","WeakMap","ImageMouseCursor","url","x","super","getUniqueInstanceName","Number","prefix","utilities","BASE","iconContent","iconSize","viewBox","mousePoint","mousePointerGroupString","SEGMENTATION_CURSOR_BOUNDARIES","MINUS_RECT","PLUS_RECT","SCISSOR_ICON","RECTANGLE_ICON","CIRCLE_ICON","CursorSVG","Angle","extend","ArrowAnnotate","Bidirectional","CobbAngle","CircleROI","EllipticalROI","FreehandROI","FreehandROISculptor","Length","Height","Probe","RectangleROI","Label","Crosshairs","Eraser","Magnify","Pan","Rotate","StackScroll","WindowLevelRegion","WindowLevel","Zoom","SegmentationFreeHandEraseInside","SegmentationFreeHandFillInside","SegmentationFreeHandEraseOutside","SegmentationFreeHandFillOutside","SegmentationRectangleEraseInside","RectangleScissor","CircleScissor","base","assign","create","registerCursor","toolName","svgCursorNames","keys","STATE","AnnotationStyleStates","Highlighted","MODE","ToolModes","Active","SVGMouseCursor","pointer","color","urn","type","getCursorURN","descriptor","getDefinedSVGCursorDescriptor","options","blob","svgString","createSVGIconWithPointer","createSVGIcon","Blob","createSVGIconBlob","URL","createObjectURL","createSVGIconUrl","createSVGMouseCursor","format","template","dictionary","dict","defined","prototype","hasOwnProperty","bind","replace","match","key","svgSize","max","cursorName","log","setElementCursor","CursorNames","svgDrawingHelper","annotationUID","ellipseUID","corner1","corner2","dataId","top","bottom","left","right","canvasCoordinates","width","lineWidth","lineDash","strokeWidth","svgNodeHash","existingEllipse","getSvgNode","w","hypot","h","angle","atan2","PI","center","attributes","cx","cy","rx","ry","stroke","transform","setNodeTouched","svgEllipseElement","document","createElementNS","setAttribute","appendNode","handleGroupUID","handle","uniqueIndex","handleRadius","opacity","r","side","parseFloat","height","existingHandleElement","newHandleElement","drawLine","lineUID","start","end","markerStartId","markerEndId","shadow","existingLine","layerId","svgLayerElement","id","dropShadowStyle","x1","y1","x2","y2","newLine","drawPath","pathUID","points","pointsArrays","fillColor","fillOpacity","closePath","existingNode","pointsAttribute","i","numArrays","numPoints","j","point","toFixed","newNode","drawPolyline","polylineUID","existingPolyLine","firstPoint","newPolyLine","drawRectByCoordinates","rectangleUID","_width","existingRect","topLeft","topRight","bottomLeft","bottomRight","leftEdgeCenter","svgRectElement","_createTextSpan","text","textSpanElement","textContent","_drawTextBackground","group","querySelector","removeChild","getBBox","insertBefore","firstChild","bBox","textUID","textLines","position","padding","fontFamily","fontSize","background","textGroupBoundingBox","svgns","existingTextGroup","textElement","textSpans","from","children","textSpan","appendChild","textAttributes","textGroupAttributes","textGroup","noSelectStyle","combinedStyle","_createTextElement","_drawTextGroup","centerX","centerY","drawHeight","heightUID","midX","endfirstLine","endsecondLine","firstLine","secondLine","threeLine","drawArrow","arrowUID","viaMarker","markerSize","headLength","cos","sin","legacyDrawArrow","markerFullId","defs","arrowMarker","arrowPath","drawRedactionRect","_getHash","tlhc","min","abs","svgNode","currentValue","getAttribute","newValue","removeAttribute","enable","eventTarget","addEventListener","ANNOTATION_COMPLETED","handleAnnotationCompleted","ANNOTATION_MODIFIED","handleAnnotationUpdate","ANNOTATION_REMOVED","handleAnnotationDelete","disable","removeEventListener","Passive","Enabled","onCameraModified","evt","tool","Enums","CAMERA_MODIFIED","onCameraReset","onResetCamera","CAMERA_RESET","onImageRendered","detail","IMAGE_RENDERED","onImageSpacingCalibrated","IMAGE_SPACING_CALIBRATED","KEY_DOWN","KEY_UP","MOUSE_CLICK","MOUSE_DOWN","MOUSE_DOWN_ACTIVATE","MOUSE_DOUBLE_CLICK","MOUSE_DRAG","MOUSE_MOVE","MOUSE_UP","MOUSE_WHEEL","TOUCH_START","TOUCH_START_ACTIVATE","TOUCH_DRAG","TOUCH_END","TOUCH_TAP","TOUCH_PRESS","DEFAULT_CONTOUR_SEG_TOOL_NAME","async","contourSegmentationCompletedListener","sourceAnnotation","annotation","isContourSegmentationAnnotation","viewport","viewports","viewportWithToolRegistered","find","isFreehandContourSegToolRegisteredForViewport","getViewport","contourSegmentationAnnotations","sourceAnnotationUID","getAllAnnotations","filter","targetAnnotation","areSameSegment","isReferenceViewable","metadata","getValidContourSegmentationAnnotations","sourcePolyline","convertContourPolylineToCanvasSpace","data","contour","polyline","targetAnnotationInfo","sourceAABB","targetPolyline","targetAABB","aabbIntersect","lineSegmentsIntersect","isContourHole","findIntersectingContour","contourHoleProcessingEnabled","createPolylineHole","sourceStartPoint","mergePolylines","contourHolesData","getChildAnnotations","holeAnnotation","getContourHolesData","unassignedContourHolesSet","reassignedContourHolesMap","assignHoleToPolyline","parentPolyline","holeData","holes","push","delete","newPolylines","mergedPolyline","newPolyline","contourHolesDataArray","contourHoleData","clearParentAnnotation","enabledElement","getEnabledElement","handles","segmentation","textBox","removeAnnotation","startPoint","canvasToWorld","endPoint","newAnnotation","originalToolName","cachedStats","closed","spline","highlighted","invalidated","isLocked","isVisible","interpolationUID","interpolationCompleted","targetWindingDirection","Clockwise","addAnnotation","addContourSegmentationAnnotation","triggerAnnotationModified","addChildAnnotation","updatedTtoolNames","viewportIdsToRender","getViewportIdsWithToolToRender","Promise","resolve","window","requestAnimationFrame","updateViewports","combinePolylines","silent","toolGroup","getToolGroupForViewport","renderingEngineId","errorMessage","hasTool","getToolOptions","projectedPolyline","worldToCanvas","windingDirection","holeWindingDirection","removeContourSegmentationAnnotation","holeContour","holePolyline","updatedToolNames","mouseDoubleClickListener","mouseDownListener","mouseMoveListener","capture","preventGhostClick","touchStartListener","passive","wheelListener","segmentationId","modifiedSlicesToUse","representationData","getSegmentation","viewportIds","getViewportIdsWithSegmentation","hasVolumeViewport","some","viewportId","getEnabledElementByViewportId","VolumeViewport","hasStackViewport","StackViewport","hasBothStackAndVolume","segmentationVolume","cache","getVolume","volumeId","imageData","vtkOpenGLTexture","slicesToUpdate","numSlices","getDimensions","setUpdatedFrame","modified","performVolumeLabelmapUpdate","SegmentationRepresentations","Labelmap","representations","getSegmentationRepresentation","representation","actorEntries","actorEntry","segImageData","actor","getMapper","getInputData","currentSegmentationImageIds","segmentationImage","getImage","performStackLabelmapUpdate","_imageChangeEventListener","eventData","getEnabledElementByIds","labelmapRepresentations","actors","getActors","updateLabelmapSegmentationImageReferences","labelmapActors","flatMap","derivedImageIds","referencedId","removeActors","uid","currentImageId","getCurrentImageId","derivedImageId","derivedImage","segmentationActorInput","dimensions","spacing","direction","getImageDataMetadata","currentImage","imageId","origin","currentOrigin","originToUse","voxelManager","getConstructor","newPixelData","getScalarData","scalarArray","numberOfComponents","setDimensions","setSpacing","setDirection","setOrigin","getPointData","setScalars","addImages","representationUID","callback","imageActor","setInputData","segmentationImageData","setDerivedImage","render","BaseVolumeViewport","STACK_NEW_IMAGE","annotationCompletedListener","contourSegmentationCompleted","removed","getRenderingEngines","renderingEngine","getViewports","vp","triggerAnnotationRenderForViewportIds","t","annotationRemovedListener","csToolsInitialized","defaultConfiguration","_removeCornerstoneEventListeners","elementEnabledEvent","ELEMENT_ENABLED","elementDisabledEvent","ELEMENT_DISABLED","addEnabledElement","removeEnabledElement","_addCornerstoneEventListeners","_removeCornerstoneToolsEventListeners","ANNOTATION_SELECTION_CHANGE","SEGMENTATION_MODIFIED","SEGMENTATION_DATA_MODIFIED","SEGMENTATION_REPRESENTATION_MODIFIED","SEGMENTATION_REPRESENTATION_ADDED","destroy","annotationManager","getAnnotationManager","segmentationStateManager","restoreAnnotations","resetState","annotationRenderingEngine","_needsRender","_animationFrameSet","_animationFrameHandle","_renderFlaggedViewports","_throwIfDestroyed","elements","_viewportElements","_triggerRender","size","_render","addViewportElement","removeViewportElement","_reset","renderViewport","_setViewportsToBeRenderedNextFrame","hasBeenDestroyed","_setAllViewportsToBeRenderedNextFrame","add","elementsEnabled","indexOf","getRenderingEngine","enabledTools","eventDetail","draw","anyRendered","renderAnnotation","rendered","triggerEvent","Events","ANNOTATION_RENDERED","cancelAnimationFrame","clear","FrameOfReferenceSpecificAnnotationManager","getGroupKey","annotationGroupSelector","FrameOfReferenceUID","_imageVolumeModifiedHandler","frameOfReferenceSpecificAnnotations","annotations","getFramesOfReference","getAnnotations","groupKey","getAnnotation","frameOfReferenceUID","frameOfReferenceAnnotations","toolSpecificAnnotations","getNumberOfAnnotations","total","preprocessingFn","groupAnnotations","toolAnnotations","findIndex","splice","removeAnnotations","removedAnnotations","annotationsForTool","saveAnnotations","structuredClone","state","flat","getNumberOfAllAnnotations","count","removeAllAnnotations","IMAGE_VOLUME_MODIFIED","setPreprocessingFn","defaultFrameOfReferenceSpecificAnnotationManager","globalLockedAnnotationUIDsSet","setAnnotationLocked","locked","makeEventDetail","lockedAnnotationUIDsSet","added","lock","unlock","publish","unlockAllAnnotations","clearLockedAnnotationsSet","getAnnotationsLocked","isAnnotationLocked","getAnnotationsLockedCount","checkAndSetAnnotationLocked","freeze","item","ANNOTATION_LOCK_CHANGE","selectedAnnotationUIDs","setAnnotationSelected","selected","preserveSelected","clearSelectionSet","isSelected","selectAnnotation","deselectAnnotation","getAnnotationsSelected","getAnnotationsSelectedByToolName","isAnnotationSelected","getAnnotationsSelectedCount","selection","selectionSet","defaultManager","setAnnotationManager","manager","childUID","parentAnnotationUID","parentAnnotation","childUIDIndex","childAnnotationUIDs","childAnnotation","parentUID","getParentAnnotation","childAnnotationUID","HTMLDivElement","triggerAnnotationAddedForElement","triggerAnnotationAddedForFOR","triggerAnnotationRemoved","annotationManagerUID","invalidateAnnotation","currAnnotation","globalHiddenAnnotationUIDsSet","setAnnotationVisibility","visible","show","annotationUIDsSet","lastHidden","hide","showAllAnnotations","isAnnotationVisible","lastVisible","hidden","ANNOTATION_VISIBILITY_CHANGE","checkAndSetAnnotationVisibility","_initializeConfig","colorHighlighted","colorSelected","colorLocked","textBoxVisibility","textBoxFontFamily","textBoxFontSize","textBoxColor","textBoxColorHighlighted","textBoxColorSelected","textBoxColorLocked","textBoxBackground","textBoxLinkLineWidth","textBoxLinkLineDash","textBoxShadow","getAnnotationToolStyles","getViewportToolStyles","getToolGroupToolStyles","toolGroupId","toolGroups","getDefaultToolStyles","default","setAnnotationStyles","styles","annotationSpecificStyles","setViewportToolStyles","viewportSpecificStyles","setToolGroupToolStyles","toolGroupSpecificStyles","setDefaultToolStyles","toolStyle","specifications","_getToolStyle","property","annotationToolStyles","viewportToolStyles","global","toolGroupToolStyles","globalStyles","toolStyles","styleSpecifier","mode","alternatives","list","getHierarchalPropertyStyles","Selected","Locked","autoGenerated","AutoGenerated","Default","eventType","ANNOTATION_ADDED","getToolGroupsWithToolName","viewportsToRender","viewportsInfo","viewportInfo","changeType","ChangeTypes","HandlesUpdated","triggerAnnotationCompleted","_triggerAnnotationCompleted","triggerContourAnnotationCompleted","AnnotationGroup","annotationUIDs","_isVisible","visibleFilter","unboundVisibleFilter","setVisible","baseEvent","findNearby","uids","remove","annotationState","resetAnnotationManager","renderers","Contour","Surface","planarContourToolName","triggerSegmentationRender","segmentationRenderingEngine","renderSegmentationsForViewport","triggerSegmentationRenderBySegmentationId","renderSegmentation","_getAllViewports","_renderFlaggedSegmentations","_getViewportIdsForSegmentation","segmentationRepresentations","viewportRenderList","segmentationRenderList","_addPlanarFreeHandToolIfAbsent","display","error","allSettled","then","segmentationDetails","status","onSegmentationRender","SEGMENTATION_RENDERED","tools","addTool","setToolPassive","initialDefaultState","colorLUT","segmentations","viewportSegRepresentations","internalComputeVolumeLabelmapFromStack","imageIds","segmentationImageIds","volumeLoader","internalConvertStackToVolumeLabelmap","defaultSegmentationStateManager","getDefaultRenderingConfig","cfun","ofun","addPoint","_stackLabelmapImageIdReferenceMap","_labelmapImageIdReferenceMap","getState","updateState","updater","newState","getColorLUT","lutIndex","getNextColorLUTIndex","updateSegmentation","payload","draftState","triggerSegmentationModified","addSegmentation","newSegmentation","getLabelmapImageIds","removeSegmentation","filteredSegmentations","triggerSegmentationRemoved","addSegmentationRepresentation","renderingConfig","getSegmentationRepresentations","debug","setRenderInactiveSegmentations","addDefaultSegmentationRepresentation","addLabelmapRepresentation","triggerSegmentationRepresentationModified","segmentReps","segments","segmentIndex","active","colorLUTIndex","_setActiveSegmentation","processLabelmapRepresentationAddition","volumeViewport","isBaseVolumeSegmentation","_updateLabelmapSegmentationReferences","labelmapImageIds","updateCallback","referenceImageId","viewableLabelmapImageIdFound","labelmapImageId","referencedImageId","asOverlay","_updateLabelmapImageIdReferenceMap","stackViewport","_updateAllLabelmapSegmentationImageReferences","getImageIds","sliceIndex","withNavigation","labelmapData","getLabelmapImageIdsForImageId","_generateMapKey","getCurrentLabelmapImageIdsForViewport","getCurrentLabelmapImageIdForViewport","getStackSegmentationImageIdsForViewport","associatedReferenceImageAndLabelmapImageIds","removeSegmentationRepresentationsInternal","specifier","removedRepresentations","currentRepresentations","activeRepresentationRemoved","shouldRemove","removeSegmentationRepresentations","triggerSegmentationRepresentationRemoved","remainingRepresentations","removeSegmentationRepresentation","suppressEvent","currentValues","newValues","setActiveSegmentation","getActiveSegmentation","activeSegRep","segRep","viewportRepresentations","typeMatch","idMatch","getSegmentationRepresentationVisibility","viewportRepresentation","setSegmentationRepresentationVisibility","entries","segment","addColorLUT","removeColorLUT","_getStackIdForImageIds","slice","round","join","getAllViewportSegmentationRepresentations","getSegmentationRepresentationsBySegmentationId","viewportReps","filteredReps","indexToUse","colorLUTToUse","missingColorLUTs","addSegmentationRepresentations","segmentationInputArray","segmentationInput","addContourRepresentationToViewport","contourInputArray","addContourRepresentationToViewportMap","viewportInputMap","inputArray","addLabelmapRepresentationToViewport","labelmapInputArray","addLabelmapRepresentationToViewportMap","addSurfaceRepresentationToViewport","surfaceInputArray","addSurfaceRepresentationToViewportMap","inputData","contourData","geometryIds","annotationUIDsMap","normalizedSegments","segmentsConfig","label","surfaceData","geometryId","geometry","getGeometry","normalizeSurfaceSegments","normalizeSegments","addSegmentations","suppressEvents","setColorLUT","colorLUTsIndex","segmentationRepresentation","getSegmentIndexColor","colorValue","setSegmentIndexColor","colorReference","getActiveSegmentIndex","activeSegmentIndex","getSegmentations","viewportSegmentations","getViewportSegmentations","computeStackLabelmapFromVolume","convertVolumeToStackLabelmap","computeVolumeLabelmapFromStack","args","getActorEntry","filterFn","filteredActors","getLabelmapActorUID","getLabelmapActorEntry","getLabelmapActorEntries","getActorEntries","startsWith","getSurfaceActorEntry","getSurfaceRepresentationUID","getSurfaceActorUID","toString","updateSegmentations","segmentationUpdateArray","segmentationUpdate","visibility","setSegmentIndexVisibility","getSegmentIndexVisibility","getHiddenSegmentIndices","reduce","acc","getStyle","setStyle","renderInactiveSegmentations","getRenderInactiveSegmentations","resetToGlobalStyle","hasCustomStyle","clearSegmentValue","setAtIndex","triggerSegmentationDataModified","removeSegment","setNextSegmentAsActive","isThisSegmentActive","updatedSegments","segmentIndices","sort","currentIndex","nextSegmentIndex","previousSegmentIndex","setActiveSegmentIndex","helpers","convertStackToVolumeLabelmap","internalAddSegmentationRepresentation","representationInput","getColorLUTIndex","colorLUTOrIndex","parse","rep","removeAllSegmentations","immediate","_removeSegmentationRepresentations","labelmapDisplay","contourDisplay","removeRepresentation","surfaceDisplay","_removeRepresentationObject","removeAllSegmentationRepresentations","removeLabelmapRepresentation","removeContourRepresentation","removeSurfaceRepresentation","isSegmentIndexLocked","setSegmentIndexLocked","getLockedSegmentIndices","_getViewportIndex","arr","ar","_containsViewport","synchronizerId","eventName","eventHandler","_viewportOptions","_onEvent","_ignoreFiredEvents","_targetViewports","_eventSource","currentTarget","_sourceViewports","s","fireEvent","_enabled","_eventName","_eventHandler","_options","eventSource","_auxiliaryEvents","auxiliaryEvents","isDisabled","_hasSourceElements","setOptions","setEnabled","enabled","getOptions","addTarget","addSource","source","_updateDisableHandlers","getSourceViewports","getTargetViewports","removeSource","removeTarget","getViewportElement","hasSourceViewport","hasTargetViewport","sourceViewport","sourceEvent","promises","targetViewport","ex","vp1","vp2","unique","vps","concat","u","_getUniqueViewports","_remove","disableHandler","getEventSource","synchronizers","sync","synchronizer","pop","synchronizerIndex","synchronizersFilteredByIds","notDisabled","Disabled","PRIMARY_BINDINGS","mouseButton","MouseBindings","Primary","ToolGroup","toolOptions","currentActivePrimaryToolName","prevActivePrimaryToolName","restoreToolOptions","_toolInstances","getViewportIds","getViewportsInfo","getToolInstance","toolInstanceName","toolInstance","getToolInstances","configuration","toolDefinition","hasToolName","localToolInstance","toolClass","ToolClass","instantiatedTool","addToolInstance","parentClassName","ToolClassToUse","ParentClass","ToolInstance","addViewport","renderingEngineUIDToUse","_findRenderingEngine","vpId","getActivePrimaryMouseButtonTool","Settings","getRuntimeSettings","setViewportsCursorByToolName","TOOLGROUP_VIEWPORT_ADDED","removeViewports","indices","vpInfo","TOOLGROUP_VIEWPORT_REMOVED","setActiveStrategy","strategyName","setToolMode","setToolDisabled","setToolEnabled","setToolActive","toolBindingsOptions","bindings","binding","TouchBinding","numTouchPoints","MouseBinding","obj","hasSameBinding","useCursor","_hasMousePrimaryButtonBinding","_setCursorForViewports","onSetToolActive","_renderViewports","TOOL_ACTIVATED","_triggerToolModeChangedEvent","prevToolOptions","matchBindings","removeAllBindings","getDefaultPrimaryBindings","matchBinding","onSetToolPassive","onSetToolEnabled","onSetToolDisabled","toolOptionsForTool","_getCursor","setToolConfiguration","overwrite","_configuration","onSetToolConfiguration","getDefaultMousePrimary","getToolConfiguration","configurationPath","getPrevActivePrimaryToolName","setActivePrimaryTool","activeToolName","getCurrentActivePrimaryToolName","clone","newToolGroupId","fnToolFilter","sourceToolInstance","sourceToolOptions","sourceToolMode","primaryBindings","primary","TOOL_MODE_CHANGED","renderingEngines","matchingEngines","engine","binding1","binding2","modifierKey","tg","toolGroupIndex","MODES","toolGroupToolNames","svgLayer","svgLayerId","classList","pointerEvents","feOffset","feColorMatrix","feBlend","_createSvgAnnotationLayer","viewportUid","renderingEngineUid","dataset","elementHash","svgNodeCache","_setSvgNodeCache","enabledElements","hasToolByName","removeTool","cancelActiveManipulations","toolsWithData","cancel","VIEWPORT_ELEMENT","_removeViewportFromSynchronizers","_removeViewportFromToolGroup","_removeEnabledElement","foundElementIndex","el","elementDisabledEvt","_resetSvgNodeCache","internalViewportNode","_removeSvgNode","defaultState","isInteractingWithTool","isMultiPartToolActive","resetCornerstoneToolsState","resetSvgNodeCache","areViewportsCoplanar","viewport1","viewport2","viewPlaneNormal","viewPlaneNormal1","getCamera","viewPlaneNormal2","dotProducts","cameraSyncCallback","synchronizerInstance","cameraModifiedEvent","camera","tViewport","setCamera","getSpatialRegistration","targetId","sourceId","imageSliceSyncCallback","sViewport","disabled","imageId1","sourceImagePositionPatient","metaData","imagePositionPatient","targetImageIds","registrationMatrixMat4","getFrameOfReferenceUID","useInitialPosition","targetImagePositionPatientWithRegistrationMatrix","closestImageIdIndex2","targetPoint","closestImageIdIndex","distance","Infinity","imageIndexToSet","getCurrentImageIdIndex","imageIndex","presentationViewSyncCallback","_synchronizerInstance","_sourceEvent","presentationView","getViewPresentation","setViewPresentation","slabThicknessSyncCallback","slabThickness","getSlabThickness","setSlabThickness","voiSyncCallback","modifiedEvent","range","invertStateChanged","invert","colormap","tProperties","voiRange","syncInvertState","syncColormap","_actors","setProperties","zoomPanSyncCallback","syncZoom","srcZoom","getZoom","setZoom","syncPan","srcPan","getPan","setPan","createStackImageSynchronizer","createCameraPositionSynchronizer","synchronizerName","createSynchronizer","VOLUME_NEW_IMAGE","createImageSliceSynchronizer","createPresentationViewSynchronizer","viewPresentation","createVOISynchronizer","VOI_MODIFIED","COLORMAP_MODIFIED","createZoomPanSynchronizer","csEvents","isSegmentation","AdvancedMagnifyToolActions","PARALLEL_THRESHOLD","CONSTANTS","AdvancedMagnifyTool","Actions","toolProps","defaultToolProps","supportedInteractionTypes","magnifyingGlass","radius","zoomFactor","zoomFactorList","autoPan","actions","showZoomFactorsList","method","Secondary","KeyboardBindings","Shift","addNewAnnotation","currentPoints","worldPos","world","canvasPos","canvas","canvasHandlePoints","_getCanvasHandlePoints","viewUp","getReferencedImageId","magnifyViewportId","getToolName","sourceViewportId","isCanvasAnnotation","activeHandleIndex","magnifyViewportManager","createViewport","sourceEnabledElement","annotationPoints","canvasDelta","delta","len","preventDefault","dispose","isPointNearTool","canvasCoords","proximity","canvasTop","canvasBottom","canvasLeft","radiusPoint","getCanvasCircleRadius","toolSelectedCallback","editData","_activateModify","handleSelectedCallback","handleIndex","p","_endCallback","_deactivateModify","isDrawing","_dragDrawCallback","deltaPoints","hasMoved","_dragModifyCallback","_dragHandle","canvasCenter","currentCanvasPoints","newRadius","newCanvasHandlePoints","renderStatus","filteredAnnotations","filterInteractableAnnotationsForElement","activeHandleCanvasCoords","drawHandles","circleUID","drawCircle","magnifyViewport","update","canvasCenterPos","canvasRadius","AdvancedMagnifyViewportManager","getInstance","canvasPoint","viewportElement","currentZoomFactor","dropdown","_getZoomFactorsListDropdown","newZoomFactor","parentElement","focus","onChangeCallback","createElement","stopPropagation","keyCode","which","toLowerCase","option","title","defaultSelected","sourceElement","AdvancedMagnifyViewport","_addSourceElementEventListener","_magnifyViewportsMap","magnifyViewportInfo","_annotationRemovedCallback","destroyViewport","_newStackImageCallback","magnifyViewportsMapEntries","_getMagnifyViewportsMapEntriesBySourceViewportId","stackActorReInitialized","_newVolumeImageCallback","currentViewPlaneNormal","worldImagePlanePoint","vecHandleToImagePlane","worldDist","worldDelta","_initialize","_singleton","_removeEventListeners","_destroyViewports","magnifyViewportMapEntry","_removeSourceElementEventListener","newEnabledElement","_addEventListeners","newStackHandler","VIEWPORT_NEW_IMAGE_SET","newVolumeHandler","VOLUME_VIEWPORT_NEW_VOLUME","_enabledElement","_sourceToolGroup","_magnifyToolGroup","_isViewportReady","_radius","_resized","_canAutoPan","_viewportId","_sourceEnabledElement","_autoPan","_browserMouseDownCallback","_browserMouseUpCallback","_handleToolModeChanged","_mouseDragCallback","_resizeViewportAsync","_resizeViewport","_syncViewports","disableElement","parentNode","magnifyToolGroup","_inheritBorderRadius","magnifyElement","borderRadius","_createViewportNode","overflow","boxSizing","_convertZoomFactorToParallelScale","parallelScale","offsetWidth","_isStackViewport","_isVolumeViewport","_cloneToolGroups","sourceActors","magnifyToolGroupId","sourceToolGroup","_cloneStack","setStack","_cloneVolumes","volumeInputArray","setVolumes","_cloneViewport","sourceViewportOptions","viewportInput","defaultOptions","enableElement","_cancelMouseEventCallback","target","closest","canvasCurrent","magnifyRadius","dist","distanceToPoint","maxDist","panDist","canvasDeltaPos","newCanvasPosition","currentWorldPos","newWorldPos","worldDeltaPos","autoPanCallbackData","currentPosition","newPosition","_addBrowserEventListeners","_removeBrowserEventListeners","sourceCanvas","_syncViewportsCameras","focalPoint","sqrt","updatedFocalPoint","updatedPosition","_syncStackViewports","setImageIdIndex","sourceProperties","getProperties","getImageData","resize","AnnotationEraserTool","preMouseDownCallback","_deleteNearbyAnnotations","preTouchStartCallback","interactionType","annotationsToRemove","interactableAnnotations","createAnnotationMemo","deleting","RENDERING_DEFAULTS","defaultReferenceLineColor","defaultReferenceLineControllable","defaultReferenceLineDraggableRotatable","defaultReferenceLineSlabThicknessControlsOn","OPERATION","CrosshairsTool","viewportIndicators","viewportIndicatorsConfig","panSize","enableHDPIHandles","referenceLinesCenterGapRadius","filterActorUIDsToSetSlabThickness","slabThicknessBlendMode","MAXIMUM_INTENSITY_BLEND","mobile","toolCenter","initializeViewport","_getAnnotations","cameraPosition","cameraFocalPoint","rotationPoints","slabThicknessPoints","activeOperation","activeViewportIds","normal","clientWidth","clientHeight","_getViewportsInfo","getToolGroup","resetCrosshairs","resetPan","resetZoom","resetToCenter","resetRotation","resetCamera","resetSlabThickness","_computeToolCenter","computeToolCenter","firstViewport","secondViewport","thirdViewport","normal1","point1","normal2","point2","normal3","point3","firstPlane","secondPlane","thirdPlane","setToolCenter","jumpWorld","_jump","viewportIdArray","otherViewport","viewportControllable","_getReferenceLineControllable","viewportDraggableRotatable","_getReferenceLineDraggableRotatable","_pointNearTool","viewportAnnotation","currentCamera","oldCameraPosition","deltaCameraPosition","oldCameraFocalPoint","deltaCameraFocalPoint","isRotation","cameraModifiedInPlane","CROSSHAIR_TOOL_CENTER_CHANGED","_autoPanViewportIfNecessary","mouseMoveCallback","filteredToolAnnotations","imageNeedsUpdate","previousActiveOperation","previousActiveViewportIds","near","getHandleNearImagePoint","_areViewportIdArraysEqual","canvasDiagonalLength","canvasMinDimensionLength","crosshairCenterCanvas","otherViewportAnnotations","_filterAnnotationsByUniqueViewportOrientations","referenceLines","canvasBox","otherCamera","otherViewportControllable","otherViewportDraggableRotatable","otherViewportSlabThicknessControlsOn","_getReferenceLineSlabThicknessControlsOn","otherCanvasDiagonalLength","otherCanvasCenter","otherViewportCenterWorld","pointWorld0","pointWorld1","pointCanvas0","otherViewportCenterCanvas","canvasUnitVectorFromCenter","canvasVectorFromCenterLong","canvasVectorFromCenterMid","canvasVectorFromCenterShort","canvasVectorFromCenterStart","centerGap","refLinePointOne","refLinePointTwo","refLinePointThree","refLinePointFour","refLinesCenter","rotHandleOne","rotHandleTwo","stHandlesCenterCanvas","stHandlesCenterWorld","worldUnitVectorFromCenter","matrix","buildFromDegree","rotate","worldUnitOrthoVectorFromCenter","slabThicknessValue","worldOrthoVectorFromCenter","worldVerticalRefPoint","canvasVerticalRefPoint","canvasOrthoVectorFromCenter","stLinePointOne","stLinePointTwo","stLinePointThree","stLinePointFour","stHandleOne","stHandleTwo","stHandleThree","stHandleFour","newRtpoints","newStpoints","viewportColor","_getReferenceLineColor","line","lineIndex","viewportSlabThicknessControlsOn","selectedViewportId","lineActive","rotHandlesActive","rotationHandles","rotHandleWorldOne","rotHandleWorldTwo","slabThicknessHandlesActive","slabThicknessHandles","slabThicknessHandleWorldOne","slabThicknessHandleWorldTwo","slabThicknessHandleWorldThree","slabThicknessHandleWorldFour","devicePixelRatio","handleUID","referenceColorCoordinates","xOffset","yOffset","circleRadius","_onNewVolume","viewportIdArrayOne","viewportIdArrayTwo","itemFound","_getAnnotationsForViewportsWithDifferentCameras","viewportsWithDifferentCameras","cameraOfTarget","_filterViewportWithSameOrientation","referenceAnnotation","linkedViewportAnnotations","otherViewPlaneNormal","otherLinkedViewportAnnotationsFromSameScene","otherViewportsAnnotationsWithUniqueCameras","cameraFound","jj","cameraOfStocked","otherNonLinkedViewportAnnotationsFromSameScene","_checkIfViewportsRenderingSameScene","volumeIds","getAllVolumeIds","otherVolumeIds","viewportsAnnotationsToUpdate","sameScene","_applyDeltaShiftToSelectedViewportCameras","_dragCallback","dir1","dir2","centerCanvas","finalPointCanvas","originalPointCanvas","_isClockWise","rotationAxis","buildFromRadian","translate","otherViewportsIds","renderViewports","referenceAnnotations","viewportsIds","dotProd","projectedDelta","mod","currentPoint","lastPoints","currentCenter","otherViewportRotationPoints","dotProdDirection","projectedDirection","normalizedProjectedDirection","normalizedProjectedDelta","MINIMUM_SLAB_THICKNESS","_pointNearReferenceLine","lineViewport","lineSegment1","distanceToPoint1","lineSegment2","distanceToPoint2","getReferenceLineColor","getReferenceLineControllable","getReferenceLineDraggableRotatable","getReferenceLineSlabThicknessControlsOn","_unsubscribeToViewportNewVolumeSet","_subscribeToViewportNewVolumeSet","_getRotationHandleNearImagePoint","_getSlabThicknessHandleNearImagePoint","toolCenterCanvas","pan","visiblePointCanvas","visiblePointWorld","deltaPointsWorld","actorUIDs","blendModeToUse","COMPOSITE","setBlendMode","c","_applyDeltaShiftToViewportCamera","newFocalPoint","annotationCanvasCoordinate","stPointLineCanvas1","stPointLineCanvas2","stPointLineCanvas1Start","stPointLineCanvas2Start","MIPJumpToClickTool","targetViewportIds","mouseClickCallback","getVolumeId","maxIntensity","brightestPoint","getPointInLineOfSightWithCriteria","intensity","foundToolGroup","jumpToWorld","MAGNIFY_VIEWPORT_ID","MagnifyTool","magnifySize","magnifyWidth","magnifyHeight","_hasBeenRemoved","_getReferencedImageId","_createMagnificationViewport","_activateDraw","viewportProperties","rotation","originalViewportRotation","magnifyToolElement","STACK","_dragEndCallback","_deactivateDraw","getTargetId","split","OverlayMarkerType","OrientationMarkerTool","CUBE","AXIS","VTPFILE","OVERLAY_MARKER_TYPES","orientationWidget","viewportCorner","Corners","BOTTOM_RIGHT","viewportSize","minPixelSize","maxPixelSize","overlayMarkerType","ANNOTATED_CUBE","overlayConfiguration","faceProperties","xPlus","faceColor","faceRotation","xMinus","yPlus","fontColor","yMinus","zPlus","zMinus","defaultStyle","fontStyle","fontSizeScale","res","edgeThickness","edgeColor","resolution","AXES","CUSTOM","polyDataURL","_resizeObservers","initViewports","_subscribeToViewportEvents","cleanUpData","orientationMarker","orientationMarkers","updateViewport","updatingOrientationMarker","unsubscribe","unobserve","subscribeToElementResize","resizeObserver","ResizeObserver","setTimeout","observe","offscreenMultiRenderWindow","getRenderWindow","filterViewportsWithToolEnabled","widget","getWidget","isDeleted","addAxisActorInViewport","getRenderer","removeActor","createAnnotationCube","createCustomActor","renderer","renderWindow","interactor","getInteractor","parentRenderer","setViewportCorner","setViewportSize","setMinPixelSize","setMaxPixelSize","updateMarkerOrientation","addWidget","response","fetch","arrayBuffer","vtpReader","parseAsArrayBuffer","polyData","shallowCopy","getOutputData","setActiveScalars","mapper","setColorModeToDirectScalars","setMapper","rotateZ","setDefaultStyle","setXPlusFaceProperty","setXMinusFaceProperty","setYPlusFaceProperty","setYMinusFaceProperty","setZPlusFaceProperty","setZMinusFaceProperty","createAnnotatedCubeActor","axes","annotatedCube","methodName","charAt","toUpperCase","EPSILON","OverlayGridTool","A","sourceImageIds","_init","imagePlaneModule","pointSets","calculateImageIdPointSets","viewportData","rows","columns","rowCosines","columnCosines","rowPixelSpacing","columnPixelSpacing","pointSet1","pointSet2","imageIdNormal","getImageIdNormal","isParallel","targetViewportPlane","targetData","initializeViewportData","pointSetsToUse","pointSetToUse","topBottomVec","isPerpendicular","lineStartsWorld","lineEndsWorld","lineStartWorld","lineEndWorld","vec1","vec2","dot","imageOrientationPatient","rowCosineVec","colCosineVec","PanTool","touchDragCallback","mouseDragCallback","PlanarRotateTool","mouseWheelCallback","wheel","setAngle","startPoints","currentPointWorld","startPointWorld","centerWorld","v1","v2","cross","rotAngle","rotMat","Float32Array","rotatedViewUp","ReferenceCursors","preventHandleOutsideImage","displayThreshold","positionSync","disableCursor","isHandleOutsideImage","_elementWithCursor","_currentCursorWorldPosition","_currentCanvasPosition","_disableCursorEnabled","getActiveAnnotation","createInitialAnnotation","updateAnnotationPosition","worldPosition","worldBoundingBox","previousCamera","oldFocalPoint","cameraNormal","dotProduct","isElementWithCursor","updateViewportImage","lineWidthBase","e","crosshairUIDs","upper","lower","centerSpace","lineLength","plane","currentMousePosition","closestIndex","currentDistance","normalizedViewPlane","scaledPlaneNormal","ReferenceLines","enforceSameFrameOfReference","showFullDimension","sourceViewportCanvasCornersInWorld","sourceViewPlaneNormal","topRightVec","newNormal","handleFullDimension","targetImage","getTargetImageData","topLeftImageCoord","topRightImageCoord","bottomRightImageCoord","bottomLeftImageCoord","indexToWorld","lineStartImageCoord","lineEndImageCoord","intersectInfiniteLines","isInBound","err","line1Start","line1End","line2Start","line2End","x3","y3","x4","y4","a1","b1","c1","a2","b2","c2","viewportsWithAnnotations","ScaleOverlayTool","scaleLocation","viewportCanvasCornersInWorld","thisAnnotation","computeScaleSize","worldWidthViewport","worldHeightViewport","location","scaleSizes","currentScaleSize","scaleSize","computeEndScaleTicks","locationTickOffset","endTick1","endTick2","computeInnerScaleTicks","leftTick","rightTick","canvasScaleSize","tickIds","tickUIDs","tickCoordinates","numberSmallTicks","tickSpacing","locationOffset","computeWorldScaleCoordinates","pointSet","worldCoordinates","midpointLocation","midpoint","offset","computeCanvasScaleCoordinates","canvasSize","vscaleBounds","hscaleBounds","scaleCanvasCoordinates","worldDistanceOnCanvas","computeScaleBounds","horizontalReduction","verticalReduction","hReduction","vReduction","locationBounds","canvasBounds","scaleTicks","scaleId","leftTickId","rightTickId","locationTextOffest","textCanvasCoordinates","textBoxLines","_getTextLines","drawTextBox","scaleSizeDisplayValue","scaleSizeUnits","SculptorTool","minSpacing","referencedToolNames","toolShape","referencedToolName","registeredShapes","isActive","commonData","activeAnnotationUID","isEditingOpenContour","canvasLocation","configureToolSize","selectFreehandTool","activateModify","updateCursor","endCallback","deactivateModify","activeAnnotation","filterSculptableAnnotationsForElement","calculateStats","dragCallback","sculpt","registerShapes","shapeName","setToolShape","shapeClass","shape","cursorShape","selectedShape","sculptData","mouseCanvasPoint","maxSpacing","getMaxSpacing","pushedHandles","pushHandles","first","insertNewHandles","interpolatePointsWithinMaxSpacing","indicesToInsertAfter","nextHandleIndex","contourIndex","currentCanvasPoint","nextCanvasPoint","updateToolSize","sculptableAnnotations","findNewHandleIndices","newIndexModifier","insertIndex","insertHandleRadially","last","previousIndex","nextIndex","handleData","getInsertPosition","closestAnnotationUID","getClosestFreehandToolOnElement","canvasPoints","toolIndex","distanceFromTool","renderShape","SegmentationIntersectionTool","actorsWorldPointsMap","calculateSurfaceSegmentationIntersectionsForViewport","calculateSurfaceSegmentationIntersections","cacheId","getCacheId","clippingFilter","actorWorldPointMap","polyLineIdx","worldPointsSet","polyLineUID","actorWorldPointsMap","polyDataUtils","colorArray","colorComponentToString","component","componentString","floor","colorToString","getProperty","getColor","StackScrollTool","debounceIfNotLoaded","loop","deltaY","_scroll","_scrollDrag","deltaPointY","pixelsPerImage","_getPixelPerImage","imageIdIndexOffset","debounceLoading","scrollSlabs","numberOfSlices","getNumberOfSlices","offsetHeight","TrackballRotateTool","rotateIncrementDegrees","_hasResolutionChanged","getDefaultActor","originalSampleDistance","getSampleDistance","setSampleDistance","cleanUp","once","_viewportAddedListener","disconnect","rotateCamera","axis","vtkCamera","getVtkActiveCamera","getViewUp","getFocalPoint","getPosition","newViewUp","currentPointsCanvas","lastPointsCanvas","normalizedPosition","normalizedPreviousPosition","radsq","op","oe","opsq","oesq","lop","loe","nop","noe","angleX","acos","sign","upVec","atV","rightV","forwardV","angleY","DIRECTIONS","VolumeRotateTool","cz","ax","ay","az","WindowLevelRegionTool","minWindowWidth","applyWindowLevelRegion","bottomLeftCanvas","topRightCanvas","bottomRightCanvas","topLeftCanvas","bottomRightWorld","topLeftWorld","getAnnotationStyle","drawRect","windowLevel","startCanvas","endCanvas","pixelLuminanceData","minMaxMean","minPixelValue","maxPixelValue","windowWidth","windowCenter","mean","voiLutFunction","VOILUTFunction","WindowLevelTool","_getImageDynamicRangeFromMiddleSlice","scalarData","middleSliceIndex","frameLength","bytesPerVoxel","TypedArrayConstructor","Uint8Array","Uint16Array","Int16Array","frame","buffer","_getMinMax","modality","newRange","viewportsContainingVolumeUID","isPreScaled","properties","volume","Modality","scaling","preScale","scaled","scalingParameters","getPTScaledNewRange","deltaPointsCanvas","getNewRange","multiplier","_getMultiplierFromDynamicRange","wwDelta","wcDelta","imageDynamicRange","imageVolume","calculatedDynamicRange","getMiddleSliceData","pixel","BitsStored","metadataDynamicRange","_getImageDynamicRangeFromViewport","ratio","getRange","imageDataRange","getScalars","getData","voxel","ZoomTool","zoomToCenter","minZoomScale","maxZoomScale","pinchToZoom","initialMousePosWorld","dirVec","_dragParallelProjection","pinch","deltaDistance","k","parallelScaleToSet","focalPointToSet","positionToSet","distanceToCanvasCenter","scale","cappedParallelScale","thresholdExceeded","_dragPerspectiveProjection","zoomScale","directionOfProjection","tmp","_pinchCallback","currentPointsList","parallelProjection","_panCallback","AngleTool","getTextLines","defaultGetTextLines","angleStartedNotYetCompleted","getViewReference","movingTextBox","canvasPoint1","canvasPoint2","line1","canvasPoint3","line2","worldPosDelta","_throttledCalculateCachedStats","_calculateCachedStats","getLinkedTextBoxStyle","canvasTextBoxCoords","textBoxPosition","textBoxUID","boundingBox","drawLinkedTextBox","trailing","hydrate","hydrateBase","worldPos1","worldPos2","worldPos3","targetIds","StatsUpdated","cachedVolumeStats","String","fromCharCode","ArrowAnnotateTool","getTextCallback","changeTextCallback","arrowFirst","arrowHeadStyle","createMemo","memo","setAnnotationLabel","doneEditMemo","touchTapCallback","taps","doubleClickCallback","clickedAnnotation","_doneChangingTextCallback","stopImmediatePropagation","updatedText","_isInsideVolume","index1","index2","doneChangingTextCallback","prompt","transformWorldToIndex","BidirectionalTool","firstLineSegmentLength","longAxis","shortAxisPoint0","shortAxisPoint1","longAxisVector","counterClockWisePerpendicularToLongAxis","currentShortAxisVector","shortAxis","canvasCoordPoints","shortAxisDistFromCenter","dx","dy","vectorX","vectorY","xMid","yMid","startX","startY","endX","endY","_dragModifyHandle","movingHandleIndex","canvasCoordHandlesCurrent","firstLineSegment","secondLineSegment","proposedPoint","proposedCanvasCoord","fixedHandleCanvasCoord","fixedHandleToProposedCoordVec","fixedHandleToOldCoordVec","proposedFirstLineSegment","_movingLongAxisWouldPutItThroughShortAxis","centerOfRotation","_getSignedAngle","firstPointX","firstPointY","secondPointX","secondPointY","rotatedFirstPoint","rotatedFirstPointY","rotatedSecondPoint","rotatedSecondPointY","newFirstPoint","newSecondPoint","translateHandleIndex","canvasCoordsCurrent","longLineSegment","shortLineSegment","longLineSegmentVec","longLineSegmentVecNormalized","proposedToCurrentVec","movementLength","movementAlongLineSegmentLength","newTranslatedPoint","unit","dataId1","dataId2","secondLineUID","getTextBoxCoordsCanvas","vectorInSecondLineDirection","extendedSecondLineSegment","worldPos4","image","index3","index4","handles1","handles2","scale1","units1","scale2","units2","dist1","_calculateLength","dist2","widthUnit","vector1","vector2","majorAxis","minorAxis","major0","major1","minor0","minor1","pos1","pos2","dz","CircleROITool","storePointData","centerPointRadius","statsCalculator","BasicStatsCalculator","dXCanvas","dYCanvas","canvasEnd","canvasCorners","getCanvasCircleCorners","areaUnit","getStackViewports","referencedImageURI","hasImageURI","currentImageURI","area","stdDev","radiusUnit","perimeter","wasInvalidated","pos1Index","pos2Index","boundsIJK","ellipseObj","xRadius","yRadius","zRadius","worldWidth","worldHeight","isEmptyArea","aspect","pixelUnitsOptions","isSuvScaled","modalityUnit","pointsInShape","statsCallback","isInObject","pointLPS","pointInEllipse","fast","returnPoints","stats","getStatistics","statsArray","array","radiusLine","areaLine","CobbAngleTool","showArcLines","distanceToLines","isNearFirstLine","isNearSecondLine","_mouseDownCallback","arc1Angle","arc2Angle","arc1Start","arc1End","arc2Start","arc2End","mid1","mid2","arc1TextBoxUID","arc1TextLine","arch1TextPosCanvas","arc2TextBoxUID","arc2TextLine","arch2TextPosCanvas","point4","canvasPoint4","getArcsStartEndPoints","linkLine","arc1Side","arc2Side","midLinkLine","linkLineLength","midFirstLine","midSecondLine","directionVectorStartArc1","magnitudeStartArc1","normalizedDirectionStartArc1","directionVectorEndArc1","magnitudeEndArc1","normalizedDirectionEndArc1","directionVectorStartArc2","magnitudeStartArc2","normalizedDirectionStartArc2","directionVectorEndArc2","magnitudeEndArc2","normalizedDirectionEndArc2","seg1","seg2","minDist","MAX_VALUE","DragProbeTool","postMouseDownCallback","postTouchStartCallback","ETDRSGridTool","degrees","diameters","diametersCanvas","diameter","worldMeasureToCanvas","degreesRad","angleRadians","degree","measurement","p1","p2","p1Canvas","p2Canvas","EllipticalROITool","initialRotation","getRotation","getCanvasEllipseCorners","minorEllipse","majorEllipse","pointInMinorEllipse","_pointInEllipseCanvas","canvasWidth","canvasHeight","originalHandleCanvas","pointsCanvas","dX","dY","bottomCanvas","topCanvas","leftCanvas","rightCanvas","newHalfCanvasWidth","canvasRight","newHalfCanvasHeight","centerPoint","_getCanvasEllipseCenter","post2Index","ellipse","normalized","ellipseCanvasPoints","HeightTool","_calculateHeight","outside","KeyImageTool","dataSeries","seriesLevel","dataPoint","isPoint","canvasPosition","createAnnotationForViewport","eventDispatchDetail","it","setPoint","LabelTool","textGroupElement","bbox","translateX","translateY","matches","initialWorldPos","anchorWorldPos","LabelChange","LengthTool","undo","redo","LivewireContourSegmentationTool","updateInterpolatedAnnotation","interpolationSources","originalPolyline","queueMicrotask","setupBaseEditData","scissors","nearestEdge","repeatInterpolation","interpolation","originalPoints","worldToSlice","sliceToWorld","handleSmoothing","lastPoint","hIndex","testPoint","startSearch","findPathToPoint","minPoint","findMinNearby","acceptedPath","path","addPoints","updateAnnotation","scissorsNext","InterpolationUpdated","renderAnnotationInstance","renderContext","showInterpolationPolyline","polylineCanvasPoints","isContourSegmentationTool","LivewireContourTool","contourHoleAdditionModifierKey","snapHandleNearby","decimate","epsilon","cancelInProgress","proximitySquared","clearAnnotation","clearEditData","Completed","triggerChangeEvent","doubleClick","worldPosOriginal","controlPoints","currentPath","getControlPoints","closestHandlePoint","distSquared","worldControlPoint","canvasControlPoint","snapPoint","pathPoints","prependPath","confirmedPath","getLastPoint","addControlPoint","_mouseMoveCallback","lastCanvasPoint","imgWidth","imgHeight","slicePoint","editHandle","originalWorldPoint","deltaXPoint","deltaYPoint","deltaInX","deltaInY","getCalibratedLengthUnitsAndScale","maxX","canvasMaxX","maxY","canvasMaxY","minX","canvasMinX","minY","canvasMinY","topLeftBBWorld","topLeftBBIndex","bottomRightBBWorld","_renderStats","textboxStyle","throttle","nextPos","viewportImageData","vtkImageData","sliceImageData","sliceToIndexMatrix","indexToSliceMatrix","ijkPoint","startPos","createInstanceFromRawPixelData","currentPathNext","confirmedPathNext","createAnnotation","event","handlePoints","numHandles","previousHandle","nextHandle","slicePos","pathPointsLeft","pathPointsRight","reverse","appendPath","contourSegmentationAnnotation","annotationStyle","canvasHandles","textbox","livewirePath","pointArray","imagePoints","updateContourPolyline","ProbeTool","probeDefaults","mergeDefaultProps","ijk","getAtIJKPoint","imageURI","calibratedResults","hasEnhancedRegionValues","units","RegionSegmentPlusTool","isPartialVolume","positiveSeedVariance","negativeSeedVariance","subVolumePaddingPercentage","islandRemoval","mouseTimer","allowedToProceed","worldPoint","clearTimeout","onMouseStable","mouseStabilityDelay","refVolume","growCutData","referencedVolumeId","seeds","positiveSeedIndices","negativeSeedIndices","worldIslandPoints","runGrowCut","getRemoveIslandData","getGrowCutLabelmap","mergedOptions","growCut","RegionSegmentTool","currentWorldPoint","circleBorderPoint","circleCenterPoint","sphereInfo","segmentationData","canvasCenterPoint","canvasBorderPoint","vecCenterToBorder","getSegmentStyle","SplineContourSegmentationTool","DEFAULT_SPLINE_CONFIG","controlPointAdditionDistance","controlPointDeletionDistance","showControlPointsConnectors","controlPointAdditionEnabled","controlPointDeletionEnabled","SplineTypesEnum","SplineToolActions","SplineROITool","SplineTypes","Cardinal","Class","CatmullRom","Linear","BSpline","drawPreviewEnabled","lastControlPointDeletionKeys","AddControlPoint","DeleteControlPoint","Ctrl","fireChangeOnUpdate","isPointNearCurve","_keyDownCallback","controlPointIndex","_deleteControlPointByIndex","closeContour","addNewPoint","closestControlPoint","getClosestControlPointWithinDistance","moveAnnotation","addControlPointCallback","splineType","splineConfig","_getSplineConfig","closestPointInfo","getClosestPoint","addControlPointAtU","uValue","deleteControlPointCallback","cancelAnnotation","annotationLocked","childAnnotations","_isSplineROIAnnotation","splinePolylineCanvas","_updateSplineInstance","getPolylinePoints","updateWindingDirection","numControlPoints","previewPolylinePoints","getPreviewPolylinePoints","controlPointsConnectors","createInterpolatedSplineControl","increment","contourAnnotation","createSpline","onInterpolationComplete","splineConfigs","setControlPoints","fixedResolution","fixedScale","splineInstance","SplineClass","UltrasoundDirectionalTool","displayBothAxesDistances","startedDrawing","lineSegment","xValues","yValues","isHorizontal","isUnitless","drawHandle","canvasDeltaY","canvasDeltaX","projectedPointCanvas","imageIndex1","imageIndex2","values1","values2","VideoRedactionTool","toolConfiguration","viewportUIDsToRender","toolDataCanvasCoordinate","rect","_getRectangleImageCoordinates","bottomLeftWorld","topRightWorld","point0","viewportUID","renderingEngineUID","sceneUID","targetUIDs","targetUID","_getImageVolumeFromTargetUID","worldPos1Index","worldPos2Index","worldToIndexVec3","iMin","iMax","jMin","jMax","kMin","kMax","yMultiple","zMultiple","valueMinusMean","_getTargetVolumeUID","scene","volumeUID","volumeActors","getVolumeActors","coloneIndex","_getTargetStackUID","NEGATIVE_PIXEL_RANGE","POSITIVE_PIXEL_RANGE","ISLAND_PIXEL_RANGE","transformIndexToWorld","WholeBodySegmentTool","positivePixelRange","negativePixelRange","islandPixelRange","linePoints","_getHorizontalLineWorldPoints","horizontalLines","worldLine1P1","worldLine1P2","worldLine2P1","worldLine2P2","worldSquarePoints","referencedVolume","worldTopLeft","worldBottomRight","_getWorldBoundingBoxFromProjectedSquare","boundingBoxInfo","ijkTopLeft","ijkBottomRight","positiveSeedValue","negativeSeedValue","labelmapVolumeId","labelmapVolume","referencedVolumeData","getCompleteScalarDataArray","islandPointIndexes","pixelValue","_projectWorldPointAcrossSlices","worldEdgePoint","vecDirection","_getViewportVolume","n","ijkLineP1","ijkLineP2","_getCuboidIJKEdgePointsFromProjectedWorldPoint","_getWorldCuboidCornerPoints","cuboidPoints","worldSquarePoint","worldEdgePoints","worldCuboidPoints","_getHorizontalLineIJKPoints","ijkPoint1","ijkPoint2","TRANSFORM_MATRIX","getTransformMatrix","CardinalSpline","props","_scale","_fixedScale","s2","CatmullRomSpline","CubicSpline","getPreviewCurveSegments","controlPointPreview","closeSpline","previewNumCurveSegments","_getNumCurveSegments","startCurveSegIndex","endCurveSegIndex","transformMatrix","curveSegments","curveSegment","_getCurveSegment","getSplineCurves","numCurveSegments","previousCurveSegmentsLength","_getPoint","uInt","curveSegmentIndex","p0","p3","_getCurveSegmentPoints","tt","ttt","tValues","qValues","p0Index","p2Index","p3Index","_getLineSegments","numLineSegments","inc","maxU","lineSegments","previousLineSegmentsLength","aabb","curveSegmentLength","lineSegAABB","lineSegLength","LinearSpline","QuadraticBezier","hasTangentPoints","QuadraticSpline","getLineSegments","Spline","_controlPoints","_invalidated","_length","_resolution","_fixedResolution","_closed","_update","_aabb","addControlPoints","_getLineSegmentAt","_curveSegments","controlPointPos","deleteControlPointByIndex","minControlPoints","clearControlPoints","updateControlPoint","newControlPoint","controlPoint","getClosestControlPoint","minSquaredDist","closestPointIndex","squaredDist","curveSegmentsDistInfo","_getCurveSegmmentsDistanceSquaredInfo","closestPoint","csA","csB","distanceSquared","minDistCurveSegment","minDistLineSegment","closestPointCurveSegmentIndex","minDistSquared","curveSegmentDistInfo","lineSegPoint","lineSegDistSquared","getClosestPointOnControlPointLines","_convertCurveSegmentsToPolyline","closeDistance","previewCurveSegments","_getCurveSegmmentsWithinDistance","maxDistSquared","containsPoint","closingCurveSegment","_getClosingCurveSegmentWithStraightLineSegment","numIntersections","curveSegAABB","lineSegmentAABB","isVerticalLine","xIntersection","curveSegLength","polylinePoints","curveSegIndex","lineSegIndex","curveSegmentsDistanceSquared","curveSegmentsDistance","curveSegmentsWithinRange","curveSegmentDistSquared","pointLength","lengthEnd","startControlPoint","endControlPoint","closingLineSegment","AnnotationDisplayTool","arguments","frameOfReference","viewReference","DefaultHistoryMemo","BaseTool","defaults","strategies","defaultStrategy","activeStrategy","strategyOptions","mergedDefaults","initialProps","defaultProps","additionalProps","applyActiveStrategy","operationData","call","applyActiveStrategyCallback","callbackType","extraArgs","setConfiguration","newConfiguration","getViewReferenceId","createZoomPanMemo","zoom","zoomPanMemo","restoreMemo","currentPan","currentZoom","commitMemo","polySegConversionInProgress","contourRepresentation","canComputeRequestedRepresentation","computeContourData","renderImmediate","MAX_NUMBER_COLORS","labelMapConfigCache","_setLabelmapColorAndOpacity","labelmapActorEntry","activeSegmentation","isActiveLabelmap","labelmapStyle","numColors","outlineWidth","renderOutline","outlineOpacity","activeSegmentOutlineWidthDelta","_getLabelmapConfig","segmentsHidden","segmentColor","segmentSpecificLabelmapConfig","fillAlpha","renderFill","forceOpacityUpdate","forceColorUpdate","_needsTransferFunctionUpdate","addRGBPoint","segmentOpacity","removePoint","addPointLong","setClamping","labelmapActor","preLoad","setRGBTransferFunction","setScalarOpacity","setInterpolationTypeToNearest","setUseLabelOutline","setLabelOutlineOpacity","outlineWidths","setLabelOutlineThickness","setVisibility","labelmapConfig","segmentsLabelmapConfig","configToUse","fillAlphaInactive","outlineWidthInactive","renderFillInactive","renderOutlineInactive","outlineOpacityInactive","cacheUID","oldConfig","cfunMTime","getMTime","ofunMTime","oldFillAlpha","oldRenderFill","oldRenderOutline","oldOutlineWidth","oldSegmentColor","oldSegmentsHidden","oldCfunMTime","oldOfunMTime","_addLabelmapToViewport","labelmapActorEntries","computeLabelmapData","SurfaceData","computeSurfaceData","updateSurfaceData","surfaces","isHidden","surface","BrushTool","FILL_INSIDE_CIRCLE","ERASE_INSIDE_CIRCLE","FILL_INSIDE_SPHERE","ERASE_INSIDE_SPHERE","THRESHOLD_INSIDE_CIRCLE","THRESHOLD_INSIDE_SPHERE","THRESHOLD_INSIDE_SPHERE_WITH_ISLAND_REMOVAL","brushSize","useCenterSegmentIndex","preview","previewColors","previewTimeMs","previewMoveDistance","dragMoveDistance","dragTimeMs","StrategyCallbacks","AcceptPreview","RejectPreview","Interpolate","useBallStructuringElement","noUseDistanceTransform","noUseExtrapolation","interpolateExtrapolation","_editData","createEditData","_previewData","isDrag","timerStart","now","hoverData","_hoverData","createHoverData","getOperationData","OnInteractionStart","timer","rejectPreview","previewCallback","strategyData","strategy","segmentationVoxelManager","Preview","OnInteractionEnd","acceptPreview","_calculateCursor","viewRight","centerCursorInWorld","bottomCursorInWorld","topCursorInWorld","leftCursorInWorld","rightCursorInWorld","brushCursor","computeInnerCircleRadius","GetStatistics","interpolate","invalidateBrushCursor","getActiveSegmentationData","toolMetadata","brushCursorUID","centerSegmentIndexInfo","dynamicRadiusInCanvas","threshold","circleUID1","CircleROIStartEndThresholdTool","numSlicesToPropagate","calculatePointsInsideVolume","showTextBox","spacingInNormal","startCoord","_getStartCoordinate","endCoord","_getEndCoordinate","startCoordinate","endCoordinate","pointsInVolume","projectionPoints","statistics","labelmapUID","_computeProjectionPoints","_computePointsInsideVolume","filterAnnotationsWithinSamePlane","viewplaneNormal","tempStartCoordinate","tempEndCoordinate","_getCoordinateForViewplaneNormal","roundedStartCoordinate","roundedEndCoordinate","cameraCoordinate","roundedCameraCoordinate","middleCoordinate","isMiddleSlice","_getIndexOfCoordinatesForViewplaneNormal","lineWidthToUse","lineDashToUse","_calculateCachedStatsTool","startIJK","endIJK","handlesToStart","startWorld","indexToWorldVec3","endWorld","newProjectionPoints","newPoint","pointsInsideVolume","measureInfo","modalityUnitOptions","worldProjectionPointIndex","indexOfProjection","numSlicesToPropagateFromStart","numSlicesToPropagateToEnd","endPos","viewplaneNormalAbs","pos","_context","CircleScissorsTool","FILL_INSIDE","ERASE_INSIDE","activeLabelmapSegmentation","segmentsLocked","segmentLocking","segmentationImageId","isEqual","PaintFillTool","activeSegmentationRepresentation","currentSegmentationImageId","getDirection","fixedDimension","getFixedDimension","floodFillGetter","getLabelValue","getScalarDataPositionFromPlane","inPlaneSeedPoint","fixedDimensionValue","generateHelpers","clickedLabelValue","floodFillResult","flooded","scalarDataIndex","framesModified","getFramesModified","boundaries","minJ","maxJ","seedIndex3D","z","getAtIJK","generateFloodFillGetter","generateGetScalarDataPositionFromPlane","toIndex","getScalarDataPosition","xDirection","yDirection","zDirection","absoluteOfViewPlaneNormal","absoluteOfXDirection","absoluteOfYDirection","absoluteOfZDirection","RectangleROIStartEndThresholdTool","computePointsInsideVolume","projectionPointsImageIds","roundedStartCoord","roundedEndCoord","coord","roundedCoord","firstOrLastSlice","habdles","projectionPoint","RectangleROIThresholdTool","RectangleScissorsTool","SegmentBidirectionalTool","existingAnnotation","SegmentSelectTool","SelectMode","Inside","Border","hoverTimeout","searchRadius","hoverTimer","_setActiveSegment","_setActiveSegmentForType","hoveredSegmentIndex","getSegmentIndexAtWorldPoint","getSegmentIndexAtLabelmapBorder","getHoveredContourSegmentationAnnotation","v","SphereScissorsTool","getEditData","EnsureImageVolumeFor3DManipulation","referencedImageIds","imageVoxelManager","EnsureSegmentationVolumeFor3DManipulation","segImageIds","segVolume","initializeCircle","Initialize","centerIJK","circleCornersIJK","getBoundingBoxAroundShapeIJK","createPointInEllipse","isInObjectBoundsIJK","worldInfo","sphereObj","radius2","precalculated","precalculatePointInEllipse","CIRCLE_STRATEGY","regionFill","setValue","determineSegmentIndex","labelmapStatistics","CIRCLE_THRESHOLD_STRATEGY","dynamicThreshold","fillInsideCircle","strategyFunction","thresholdInsideCircle","fillOutsideCircle","initializeRectangle","pointInShapeFn","rectangleCornersIJK","isStackViewport","isAligned","getSpacing","EPS","pointsBoundsLPS","getBoundingBoxAroundShapeWorld","xMin","xMax","yMin","yMax","zMin","zMax","createPointInRectangle","RECTANGLE_STRATEGY","RECTANGLE_THRESHOLD_STRATEGY","fillInsideRectangle","thresholdInsideRectangle","ContourWindingDirection","AnnotationMultiSlice","setStartRange","startRange","setRange","setEndRange","endRange","rangeEndSliceIndex","getSliceIndexForImage","multiSliceReference","MetadataReferenceModified","setViewportFrameRange","setSingle","current","getFrameRange","getFrameRangeStr","setFrameRange","annotationHydration","worldPoints","getClosestImageIdForStackViewport","getClassName","getTargetVolumeId","distanceImagePairs","ImagePositionPatient","dir","calculateDistanceToImage","numSlicesToProject","sliceNormalIndex","calculateBoundingBox","isWorld","is3D","clipBounds","calibratedPixelSpacingMetadataProvider","calibrateImageSpacing","calibrationOrScale","USER","calibrateSpacing","ViewportStatus","debounced","dynamicVolumesPlayingMap","playClip","playClipOptions","playClipTimeouts","playClipIsTimeVarying","dynamicCineEnabled","playClipContext","waitForRendered","numScrollSteps","currentStepIndex","getTargetImageIdIndex","frameTimeVectorEnabled","waitForRenderedCount","scroll","viewportStatus","RENDERED","_createStackViewportCinePlayContext","_getVolumeFromViewport","isDynamicVolume","numDimensionGroups","dimensionGroupNumber","_createDynamicVolumeViewportCinePlayContext","cachedScrollInfo","scrollInfo","getScrollInfo","volumeViewPlaneNormal","_createVolumeViewportCinePlayContext","VideoViewport","getSliceIndex","play","fps","setPlaybackRate","getFrameRate","_createVideoViewportCinePlayContext","_createCinePlayContext","playClipData","isDynamicCinePlaying","_stopDynamicVolumeCine","_stopClip","stopDynamicCine","intervalId","framesPerSecond","lastFrameTimeStamp","ignoreFrameTimeVector","usingFrameTimeVector","frameTimeVector","speed","frameTimeVectorSpeedMultiplier","timeouts","isTimeVarying","vector","sample","delay","sum","limit","_getPlayClipTimeouts","playClipAction","newStepIndex","newStepIndexOutOfRange","CLIP_STOPPED","_stopClipWithData","playClipTimeoutHandler","setInterval","CLIP_STARTED","stopClip","toolState","pause","dynamicCineElement","clearInterval","dynamicVolumeId","addToolState","getToolState","getToolStateByViewportId","firstAnnotation","secondAnnotation","firstSegmentation","secondSegmentation","annotationsUIDsSet","findNextLink","lines","contourPoints","cell","nextLine","remainingLines","findContours","firstCell","shift","extraContours","findContoursFromReducedSet","findHandlePolylineIndex","closestDistance","testIndex","getContourHolesDataCanvas","worldHoleContours","canvasHoleContours","worldHoleContour","canvasHoleContour","getContourHolesDataWorld","getDeduplicatedVTKPolyDataPoints","bypass","getPoints","getLines","pointsArray","getNumberOfPoints","getPoint","linesArray","getNumberOfCells","getCell","newPoints","pt","newIndex","areCoplanarContours","firstViewPlaneNormal","secondViewPlaneNormal","firstPolyline","secondPolyline","firstDistance","secondDistance","getIsPointInsidePolygon","vertices","inside","xi","yi","xj","yj","processContourHoles","contours","useXOR","retContours","closedContours","contourWithHoles","contourWithoutHoles","hContour","outerContour","innerContour","pointsNotEnclosed","checkEnclosed","contourHoleSet","holeIndex","generateContourSetsFromLabelmap","segVolumeId","vol","segData","pixelsPerSlice","ContourSets","numSegments","segIndex","sliceContours","scalars","dataType","containedSegmentIndices","isSliceEmptyForSegment","frameStart","mSquares","imageDataCopy","cValues","setContourValues","setMergePoints","msOutput","reducedSet","FrameNumber","ContourSet","startIdx","endIdx","AnnotationToPointData","TOOL_NAMES","convert","metadataProvider","validateAnnotation","ContourSequence","getContourSequence","ReferencedROINumber","ROIDisplayColor","random","register","RectangleROIStartEndThreshold","acceptAutogeneratedInterpolations","selector","InterpolationManager","acceptAutoGenerated","polylineData","transforms","polylineWorldPoints","currentClosedState","lastToFirstDist","updatedWindingDirection","sumOverDimensionGroups","dimensionGroups","arrayLength","getScalarDataLength","resultArray","getDimensionGroupScalarData","operationFunctions","SUM","AVERAGE","sumArray","averageOverDimensionGroups","SUBTRACT","scalarData1","scalarData2","generateImageFromTimeData","dynamicVolume","operation","dimensionGroupNumbers","frameNumbers","operationFunction","updateVolumeFromTimeData","targetVolume","targetVoxelManager","resetModifiedSlices","modifiedSlices","maskVolumeId","worldCoordinate","dataInTime","ijkCoords","maskImageData","segVoxelManager","scalarDataLength","nonZeroVoxelIndices","actualLen","getAtIndex","nonZeroVoxelValuesInTime","isSameVolume","valuesInTime","getAtIndexAndDimensionGroup","toIJK","segPointLPS","segValue","pointIJK","segPointIJK","overlapIJKMinMax","perDimensionGroupSum","averageCallback","averageValues","_getDimensionGroupDataMask","coordinate","worldToIndex","scalarIndex","_getDimensionGroupDataCoordinate","getAnnotationNearPoint","getAnnotationNearPointOnEnabledElement","found","findAnnotationNearPointByTool","currentId","CalibrationTypes","PIXEL_UNITS","VOXEL_UNITS","SUPPORTED_REGION_DATA_TYPES","SUPPORTED_LENGTH_VARIANT","SUPPORTED_PROBE_VARIANT","UNIT_MAPPING","SQUARE","calibration","hasPixelSpacing","volumeUnit","calibrationType","sequenceOfUltrasoundRegions","UNCALIBRATED","regions","region","regionLocationMinX0","regionLocationMaxX1","regionLocationMinY0","regionLocationMaxY1","regionDataType","physicalUnitsXDirection","physicalUnitsYDirection","physicalDeltaX","physicalDeltaY","ERMF","ERROR","PROJECTION","getCalibratedProbeUnitsAndValue","supportedRegionsMetadata","referencePixelX0","referencePixelY0","yValue","getCalibratedAspect","getPixelValueUnitsImageId","getPixelValueUnits","generalSeriesModule","petSeriesModule","_handlePTModality","_getSphereBoundsInfo","circlePoints","directionVectors","radiusWorld","row","rowCosine","column","columnCosine","vecNormal","topLeftIJK","bottomRightIJK","pointsIJK","_computeBoundsIJK","getSphereBoundsInfo","scanAxis","getSphereBoundsInfoFromViewport","getViewportsForAnnotation","getEnabledElements","roundNumber","findClosestPoint","sourcePoints","minDistance","MAX_SAFE_INTEGER","sourcePoint","_distanceBetween","moveAnnotationToViewPlane","projectedDistance","acquisitionMapping","ijkPrime","fromIJK","jkMapping","ikMapping","normalizeViewportPlane","boundsIJKPrime","mapping","getOrientationStringLPS","orientation","orientationX","orientationY","orientationZ","MIN","invertOrientationStringLPS","orientationString","inverted","smoothAnnotation","pointInSurroundingSphereCallback","spacings","maxRadiusIJK","ceil","sphereCornersIJK","getBoundingBoxAroundShape","_computeBoundsIJKWithCamera","_getBounds","createScalarVolumeVoxelManager","pointToString","decimals","idx","idx3","getPolyDataPointIndexes","linesData","segmentSize","findStartingPoint","nextPoint","getPolyDataPoints","contoursIndexes","rawPointsData","contourIndexes","referenceVolume","AllBoundsIJK","pointsToUse","g","accumulator","registered","registerComputeWorker","workerManager","getWebWorkerManager","computeWorkerConfig","computeWorker","maxWorkerInstances","autoTerminateOnIdle","idleTimeThreshold","registerWorker","Worker","uuidv4","ChangeTypesForInterpolation","toolNames","sliceData","getSliceData","hasInterpolationUID","filterData","parentKey","interpolationAnnotations","skipUIDs","interpolationAnnotation","isInterpolationUpdate","SegmentStatsCalculator","calculators","statsInit","statsData","calculator","volumetricStatsCallback","maxIJKs","dataCopy","volumetricGetStatistics","volumeScale","entry","VolumetricCalculator","volumetricState","optionsWithUnit","InstanceVolumetricCalculator","setBrushSizeForToolGroup","viewportsInfoArray","getBrushSizeForToolGroup","toolInstances","brushToolInstance","setBrushThresholdForToolGroup","getBrushThresholdForToolGroup","computeMetabolicStats","segmentationIds","WorkerTypes","COMPUTE_STATISTICS","labelmapVolumes","getOrCreateSegmentationVolume","mergedLabelmap","createMergedLabelmapForIndex","segmentationInfo","referenceImageIds","labelmap","firstImage","volumeInfo","getVolumeContainingImageId","getOrCreateImageVolume","getReferenceVolumeForSegmentation","imageInfo","executeTask","calculateForVolume","contourAndFindLargestBidirectional","createBidirectionalToolData","bidirectionalData","VoxelManager","RLEVoxelMap","createLabelmapMemo","createRleMemo","isUndo","undoVoxelManager","redoVoxelManager","useVoxelManager","setAtIJKPoint","slices","getArrayOfModifiedSlices","createRLEHistoryVoxelManager","operationType","copyMap","createRLEVolumeVoxelManager","createLabelmapVolumeForViewport","labelmaps","outputData","cachedVolume","mergedVolume","setCompleteScalarDataArray","findLargestBidirectional","maxBidirectional","isInSegment","sliceContour","bidirectional","createBidirectionalForSlice","currentMax","maxMajor","maxMinor","currentMaxMinor","currentMaxMajor","maxMajorPoints","distance2","testCenter","handle0","handle1","unitMajor","maxMinorPoints","lpad","string","character","getter","seed","onFlood","onBoundary","equals","diagonals","startNode","permutations","perms","permutation","permute","perm","countNonZeroes","prunedPermutations","stack","visits","bounds","currentArgs","flood","job","getArgs","prevArgs","previousArgs","visited","iKey","markAsVisited","node","member","markAsFlooded","nextArgs","pushAdjacent","markAsBoundary","getBrushToolInstances","generateVolumeId","getReferenceVolumeForSegmentationVolume","segmentationVolumeId","indexIJK","onEdge","getNeighborIndex","deltaI","deltaJ","neighborCanvas","isSegmentOnEdge","isSegmentOnEdgeCanvas","segmentationActorEntry","deltaK","neighborIJK","isSegmentOnEdgeIJK","neighborRange","neighborIndex","desiredRepresentation","representationType","getScalarValueFromWorld","getSegmentIndexAtWorldForLabelmap","annotationsSet","isPointInsidePolyline3D","getSegmentIndexAtWorldForContour","getSegmentLargestBidirectional","COMPUTE_LARGEST_BIDIRECTIONAL","reconstructableVolume","getOrigin","calculateVolumeBidirectional","isStack","calculateStackBidirectional","radiusForVol1","updateStatsArray","newStat","existingIndex","stat","processSegmentationStatistics","radiusIJK","testMax","testStats","getSphereStats","peakValue","peakPoint","mtv","suvMean","lesionGlycolysis","imageVoxels","centerLPS","_pointLPS","refImageId","boundsOrig","finalStats","calculateVolumeStatistics","calculateStackStatistics","getUniqueSegmentIndices","cachedResult","keySet","addImageSegmentIndices","addVolumeSegmentIndices","handleLabelmapSegmentation","handleContourSegmentation","handleSurfaceSegmentation","WEBGPU_MEMORY_LIMIT","DEFAULT_GROWCUT_OPTIONS","windowSize","maxProcessingTime","inspection","numCyclesInterval","numCyclesBelowThreshold","referenceVolumeId","workGroupSize","numIterations","volumePixelData","requiredLimits","maxStorageBufferBindingSize","maxBufferSize","adapter","navigator","gpu","requestAdapter","device","requestDevice","BUFFER_SIZE","byteLength","UPDATED_VOXELS_COUNTER_BUFFER_SIZE","Uint32Array","BYTES_PER_ELEMENT","BOUNDS_BUFFER_SIZE","Int32Array","shaderModule","createShaderModule","code","paramsArrayValues","gpuParamsBuffer","createBuffer","usage","GPUBufferUsage","UNIFORM","COPY_DST","gpuVolumePixelDataBuffer","STORAGE","queue","writeBuffer","gpuLabelmapBuffers","COPY_SRC","gpuStrengthBuffers","gpuCounterBuffer","gpuBoundsBuffer","initialBounds","bindGroupLayout","createBindGroupLayout","GPUShaderStage","COMPUTE","bindGroups","outputLabelmapBuffer","outputStrengthBuffer","previouLabelmapBuffer","previousStrengthBuffer","createBindGroup","layout","resource","pipeline","createComputePipeline","createPipelineLayout","bindGroupLayouts","compute","module","entryPoint","constants","workGroupSizeX","workGroupSizeY","workGroupSizeZ","numWorkGroups","gpuUpdatedVoxelsCounterStagingBuffer","MAP_READ","limitProcessingTime","performance","currentInspectionNumCyclesInterval","belowThresholdCounter","commandEncoder","createCommandEncoder","passEncoder","beginComputePass","setPipeline","setBindGroup","dispatchWorkgroups","copyBufferToBuffer","submit","finish","mapAsync","GPUMapMode","READ","updatedVoxelsCounterResultBuffer","getMappedRange","updatedVoxelsRatio","unmap","outputLabelmapBufferIndex","labelmapStagingBuffer","boundsStagingBuffer","labelmapResultBuffer","labelmapResult","boundsResultBuffer","boundsResult","minZ","maxZ","clearBounds","setBounds","POSITIVE_SEED_VALUE","NEGATIVE_SEED_VALUE","_createAndCacheSegmentationSubVolumeForBoundingBox","subVolume","subVolPixelData","startSliceIndex","stopSliceIndex","zOffset","_setPositiveSeedValues","sliceOffset","bfs","slicePixelIndex","volumeVoxelIndex","volumeVoxelValue","scanLine","limitX","incX","_setNegativeSeedValues","runGrowCutForBoundingBox","subVolumeBoundsIJK","targetBuffer","POSITIVE_SEED_VARIANCE","NEGATIVE_SEED_VARIANCE","vecColumn","sphereCenterPoint","sphereRadius","refVolImageData","topCirclePoint","bottomCirclePoint","sphereBoundsInfo","_getGrowCutSphereBoundsInfo","_createAndCacheSegmentationSubVolumeForSphere","refVolumePixelData","worldStartPos","numPixelsPerSlice","ijkStartPosition","referencePixelValue","positiveSeedVarianceValue","minPositivePixelValue","maxPositivePixelValue","neighborsCoordDelta","startVoxelIndex","ijkVoxel","neighborCoordDelta","nx","ny","nz","neighborVoxelIndex","neighborPixelValue","worldVecRowDir","worldVecSliceDir","ijkSphereCenter","negativeSeedVarianceValue","minNegativePixelValue","maxNegativePixelValue","rotationAngle","worldQuat","vecRotation","worldCircleBorderPoint","ijkCircleBorderPoint","runGrowCutForSphere","ijkVecRowDir","ijkVecColDir","vec","sphereBoundsIJK","_createSubVolumeFromSphere","MAX_POSITIVE_SEEDS","calculateGrowCutSeeds","refImageData","referenceVolumeVoxelManager","neighborhoodRadius","initialNeighborhoodRadius","positiveK","positiveStdDevMultiplier","negativeK","negativeStdDevMultiplier","negativeSeedMargin","negativeSeedsTargetPatches","ijkStart","startIndex","initialStats","positiveIntensityMin","positiveIntensityMax","startValue","currentQueueIndex","neighborValue","positiveSum","positiveSumSq","positiveCount","positiveMean","positiveVariance","negativeDiffThreshold","minXm","minYm","minZm","maxXm","maxYm","maxZm","attempts","patchesAdded","maxAttempts","rz","centerIndex","centerValue","patchContributed","runOneClickGrowCut","positiveSeedLabel","negativeSeedLabel","isLineInSegment","ijk1","ijk2","testIJK","testSize","unitDelta","createIsInSegment","createIsInSegmentMetadata","SegmentationEnum","IslandRemoval","fillInternalEdge","maxInternalRemove","initialize","segmentationVoxels","hasSource","sourceVoxelManager","previewVoxelManager","previewSegmentIndex","clickedPoints","getBoundsIJK","bound","depth","segmentSet","fillFrom","oldVal","SEGMENT","normalizer","selectedPoints","floodFillSegmentIsland","floodedCount","clickedPoint","iPrime","jPrime","kPrime","floodFill","ISLAND","removeExternalIslands","rle","clearPoint","rowModified","removeInternalIslands","forEachRow","baseIndex","lastRle","INTERIOR","rowPrev","getRun","rowNext","isLast","isFirst","prevCovers","covers","nextCovers","EXTERIOR","singlePlane","newType","INTERIOR_TEST","INTERIOR_SMALL","rowRle","thresholdVolumeInformation","validToolNames","_validateAnnotations","outputSegmentationVolume","segmentContourAction","configurationData","getSegment","defaultGetSegment","segmentationsList","bidirectionals","hasExistingActiveSegment","existingLargestBidirectionals","existingBidirectionalItem","newBidirectional","existingLargestBidirectional","updateSegment","bidirectionalToolData","segmentData","segmentationIndex","overlapType","baseVolumeIdx","volumeInfoList","refVoxelManager","volumeSize","_handleSameSizeVolume","overlaps","segScalarDataLength","overlapBounds","callbackOverlap","overlapTest","_handleDifferentSizeVolume","testOverlapRange","voxelSpacing","voxelCenter","testRange","insert","equalsCheck","getVoxelOverlap","halfSpacingX","halfSpacingY","halfSpacingZ","voxelCornersIJK","offsets","xOff","yOff","zOff","processVolumes","segmentationSpacing","segmentIndicesCache","setSegmentationDirty","cached","isDirty","getCachedSegmentIndices","setCachedSegmentIndices","triggerWorkerProgress","workerType","progress","WEB_WORKER_PROGRESS","getSegmentationDataForWorker","refImageIds","prepareVolumeStrategyDataForWorker","ensureSegmentationVolumeFor3DManipulation","ensureImageVolumeFor3DManipulation","prepareStackDataForWorker","segImageId","segImage","segPixelData","getPixelData","refImage","refPixelData","refSpacing","getImageReferenceInfo","cachedImage","scalingModule","Boolean","validateRepresentationData","segmentationRepresentationData","validatePublic","validate","updatedLabel","resetPrefetchTimeout","maxImagesToPrefetch","minBefore","maxAfter","directionExtraImages","preserveExistingPool","resetPrefetchDelay","prefetch","stackPrefetchData","stackPrefetch","indicesToRequest","removeFromList","imageIdIndex","indicesToRequestCopy","currentImageIdIndex","getImageLoadObject","isLoaded","imageLoadPoolManager","filterRequests","requestFn","imageLoader","getCachedImageBasedOnImageURI","decodeTimeInMS","loadTimeInMS","sizeInBytes","getMaxCacheSize","cacheFill","fillTime","fillSize","initialTime","initialSize","updateToolState","doneCallback","requestType","addRequest","onImageUpdated","stackCount","totalBytes","positionFraction","minIndex","maxIndex","promiseRemovedHandler","IMAGE_CACHE_IMAGE_REMOVED","getConfiguration","clearRequestStack","nearest","nextImageIdIndex","lowerIndex","low","higherIndex","high","imageIdsToPrefetch","shouldLoadLower","shouldLoadHigher","indexOfCurrentImage","getDeltaPoints","curr","getMeanPoints","page","_subtractPoints2D","client","getDeltaDistance","_getDistance2D","_getDistance3D","getDeltaRotation","getDeltaDistanceBetweenIPoints","_getMeanDistanceBetweenAllIPoints","lastDistance","copyPointsList","copyPoints","prev","getMeanTouchPoints","touch","identifier","radiusX","radiusY","force","pairedDistance","triggerAnnotationRenderForToolGroupIds","toolGroupIds","filterViewportsWithFrameOfReferenceUID","numViewports","viewportsWithFrameOfReferenceUID","vpCamera","viewportsWithToolEnabled","_toolGroupHasActiveEnabledOrPassiveTool","toolMode","DEFAULTS","MULTIPLIER","RANGE_TEXT_POSITION","Right","TICKS_BAR_SIZE","Colorbar","_isMouseOver","_isInteracting","_mouseOverCallback","showTicks","_mouseOutCallback","hideTicks","_addVOIEventListeners","initialState","multipliers","getVOIMultipliers","_getPointsFromMouseEvent","startVOIRange","local","voiLower","voiUpper","newVoiRange","_mouseUpCallback","_removeVOIEventListeners","_eventListenersManager","_colormaps","getColormapsMap","_activeColormapName","getInitialColormapName","_canvas","_createCanvas","_ticksBar","_createTicksBar","_rangeTextPosition","ticks","appendTo","rootElement","_addRootElementEventListeners","activeColormapName","colormapName","imageRange","currentVoiRange","onVoiChange","showFullImageRange","showFullPixelValueRange","reset","createRootElement","onContainerResize","updateTicksBar","containerSize","colormaps","items","Name","cm","ticksProps","clientPoint","clientX","clientY","pagePoint","pageX","pageY","getBoundingClientRect","pageXOffset","pageYOffset","containerWidth","containerHeight","ticksBar","rangeTextPosition","ticksBarTop","ticksBarLeft","Top","Left","initialDragState","defaultImageRange","ViewportColorbar","_getImageRange","_getVOIRange","autoHideTicks","_hideTicksTimeoutId","timeLeft","_hideTicksTime","_stackNewImageCallback","_element","_imageVolumeModifiedCallback","_volumeId","_viewportVOIModifiedCallback","showAndAutoHideTicks","_viewportColormapModifiedCallback","_addCornerstoneEventListener","getImageActor","minValue","maxValue","getRGBTransferFunction","interval","ColorbarRangeTextPosition","calculateMinMaxMean","pixelLuminance","globalMin","globalMax","numPixels","spv","extractWindowLevelRegionToolData","extractImageDataVolume","getCornerstoneImage","extractImageDataStack","getLuminanceFromRegion","luminance","pixelData","spIndex","red","green","blue","_extends","_react","_react2","__esModule","exports","_ref","_ref$fill","_ref$width","_ref$height","_ref$style","_objectWithoutProperties","vtkErrorMacro","vtkDebugMacro","vtkImageMarchingSquares","publicAPI","model","classHierarchy","getContourValues","contourValues","ids","pixelScalars","pixelPts","edgeLocator","newInstance","getPixelScalars","dims","increments","kernelX","kernelY","ii","getPixelPoints","produceLines","cVal","slicingMode","CASE_MASK","xyz","pId","pixelLines","getCase","eid","edgeVerts","getEdge","mergePoints","isInsertedEdge","x0","insertEdge","requestData","inData","outData","extent","getExtent","computeIncrements","getKernels","cv","polydata","setData","timeEnd","DEFAULT_VALUES","initialValues","algo","setGet","vtkImageMarchingSquares$1","_typeof","iterator","_defineProperties","enumerable","configurable","writable","arg","hint","prim","toPrimitive","TypeError","_toPrimitive","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","o","minLen","test","_unsupportedIterableToArray","_nonIterableSpread","arr2","stringToUint8Array","str","charCodeAt","containsToken","message","token","findToken","maxSearchLength","searchLength","multipartEncode","datasets","boundary","s4","guid","contentTypeString","header","footer","headerArray","footerArray","headerLength","footerLength","contentArrays","datasetBuffer","contentArray","contentLength","multipartArray","multipartDecode","ArrayBuffer","isView","separator","headerIndex","itemLimit","uint8ArrayToString","boundaryString","parts","substr","identifyBoundary","boundaryIndex","boundaryLength","components","headerTokenIndex","isObject","isEmptyObject","getFirstResult","MEDIATYPES","DICOM","DICOM_JSON","OCTET_STREAM","PDF","JPEG","PNG","debugLog","api","DICOMwebClient","Constructor","_classCallCheck","baseURL","username","password","qidoURLPrefix","qidoURL","wadoURLPrefix","wadoURL","stowURLPrefix","stowURL","singlepart","requestHooks","headers","errorInterceptor","verbose","setDebug","protoProps","staticProps","debugLevel","debugLogFunction","_this","reject","request","XMLHttpRequest","open","responseType","setRequestHeader","functions","userHeaders","onloadstart","onloadend","onreadystatechange","readyState","contentType","getResponseHeader","progressCallback","onprogress","isValid","requestHook","areValidRequestHooks","combinedHeaders","pipedRequest","fn","withCredentials","send","_httpRequest","params","urlWithQueryParams","_parseQueryParameters","Accept","_httpGet","mediaTypes","_buildAcceptHeaderFieldValue","byteRange","supportedMediaTypes","Range","_buildRangeHeaderFieldValue","_buildMultipartAcceptHeaderFieldValue","defaultMediaType","acceptableMediaTypes","mediaType","_httpPost","queryParams","_httpGetApplicationJson","studyInstanceUID","seriesInstanceUID","transferSyntax","sopInstanceUID","paramString","_httpGetMultipartApplicationOctetStream","_getSharedMediaTypes","commonMediaType","_getCommonMediaType","_httpGetMultipartImage","_httpGetMultipartVideo","_httpGetImage","_httpGetVideo","_httpGetText","_httpGetApplicationPdf","_options$withCredenti","_options$progressCall","_httpGetMultipartApplicationDicom","_options$withCredenti2","_options$progressCall2","BulkDataURI","_options$withCredenti3","_options$progressCall3","_multipartEncode","_options$withCredenti4","queryString","encodeURIComponent","sepIndex","mediaTypeType","_assertMediaTypeIsValid","_this2","fieldValueParts","transferSyntaxUID","fieldValue","endsWith","expectedMediaTypes","actualType","_parseMediaType","expectedMediaType","expectedType","types","sharedMediaTypes","HASH_UNDEFINED","INFINITY","funcTag","genTag","symbolTag","reIsDeepProp","reIsPlainProp","reLeadingDot","rePropName","reEscapeChar","reIsHostCtor","freeGlobal","freeSelf","self","root","Function","arrayProto","funcProto","objectProto","coreJsData","maskSrcKey","exec","IE_PROTO","funcToString","objectToString","reIsNative","RegExp","getNative","nativeCreate","symbolProto","symbolToString","Hash","ListCache","MapCache","assocIndexOf","other","baseGet","object","isSymbol","isKey","stringToPath","toKey","baseIsNative","func","pattern","tag","isFunction","isHostObject","toSource","getMapData","__data__","getValue","memoize","baseToString","number","quote","resolver","memoized","apply","Cache","isObjectLike","defaultValue","LARGE_ARRAY_SIZE","UNORDERED_COMPARE_FLAG","PARTIAL_COMPARE_FLAG","argsTag","arrayTag","boolTag","dateTag","errorTag","mapTag","numberTag","objectTag","promiseTag","regexpTag","setTag","stringTag","weakMapTag","arrayBufferTag","dataViewTag","reIsUint","typedArrayTags","freeExports","nodeType","freeModule","freeProcess","process","nodeUtil","nodeIsTypedArray","isTypedArray","arrayIncludes","fromIndex","predicate","fromRight","baseFindIndex","baseIsNaN","baseIndexOf","arrayIncludesWith","comparator","arraySome","cacheHas","mapToArray","setToArray","propertyIsEnumerable","nativeKeys","DataView","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolValueOf","valueOf","SetCache","Stack","arrayLikeKeys","inherited","isArguments","iteratee","baseTimes","skipIndexes","isIndex","eq","castPath","baseHasIn","baseIsEqual","customizer","bitmask","equalFunc","objIsArr","othIsArr","objTag","othTag","getTag","objIsObj","othIsObj","isSameTag","equalArrays","byteOffset","isPartial","stacked","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","othProps","othLength","skipCtor","objValue","othValue","compared","objCtor","othCtor","equalObjects","baseIsEqualDeep","isMasked","baseIteratee","identity","srcValue","isStrictComparable","matchesStrictComparable","hasFunc","isLength","hasPath","hasIn","baseMatchesProperty","matchData","getMatchData","noCustomizer","baseIsMatch","baseMatches","basePropertyDeep","baseKeys","Ctor","proto","pairs","createSet","arrLength","seen","arrValue","othIndex","ctorString","isArrayLike","isArrayLikeObject","baseUnary","isCommon","outer","computed","seenIndex","baseUniq","hashClear","hashDelete","hashGet","hashHas","hashSet","listCacheClear","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","mapCacheClear","mapCacheDelete","mapCacheGet","mapCacheHas","mapCacheSet","setCacheAdd","setCacheHas","stackClear","stackDelete","stackGet","stackHas","stackSet","resIndex","isBuffer","isArr","isArg","isBuff","isType","baseAssignValue","copyObject","keysIn","arrayEach","assignValue","baseAssign","baseAssignIn","cloneBuffer","copyArray","copySymbols","copySymbolsIn","getAllKeys","getAllKeysIn","initCloneArray","initCloneByTag","initCloneObject","isMap","isSet","cloneableTags","baseClone","isDeep","isFlat","isFull","isFunc","subValue","objectCreate","baseCreate","baseForOwn","baseEach","createBaseEach","baseFor","createBaseFor","arrayPush","keysFunc","symbolsFunc","baseGetTag","COMPARE_PARTIAL_FLAG","isPrototype","nativeKeysIn","isProto","collection","arrayMap","Buffer","allocUnsafe","copy","cloneArrayBuffer","dataView","reFlags","regexp","lastIndex","typedArray","isNew","getSymbols","getSymbolsIn","eachFunc","iterable","arrStacked","othStacked","objStacked","baseGetAllKeys","isKeyable","getPrototype","overArg","getPrototypeOf","arrayFilter","stubArray","nativeGetSymbols","getOwnPropertySymbols","cloneDataView","cloneRegExp","cloneSymbol","cloneTypedArray","require","memoizeCapped","subString","CLONE_DEEP_FLAG","castFunction","baseIsArguments","stubFalse","baseIsMap","nodeIsMap","objectCtorString","baseIsSet","nodeIsSet","baseIsTypedArray","baseKeysIn","baseMap","baseProperty","checkboardCache","serverCanvas","checkboard","ctx","getContext","fillStyle","fillRect","toDataURL","Checkboard","white","grey","boxShadow","grid","absolute","isValidElement","_createClass","defineProperties","_possibleConstructorReturn","ReferenceError","Alpha","_ref2","_temp","_len","_key","__proto__","handleChange","change","hsl","initialA","container","touches","l","_a","onChange","handleMouseDown","handleMouseUp","unbindEventListeners","subClass","superClass","setPrototypeOf","_inherits","rgb","alpha","gradient","margin","slider","marginTop","vertical","ref","onMouseDown","onTouchMove","onTouchStart","PureComponent","Component","VALID_KEY_CODES","idCounter","EditableInput","handleBlur","blurValue","setState","setUpdatedValue","handleKeyDown","getNumberValue","getArrowOffset","updatedValue","handleDrag","dragLabel","movementX","dragMax","getValueObjectWithLabel","inputId","prevProps","prevState","activeElement","_defineProperty","arrowOffset","onChangeValue","wrap","onKeyDown","onBlur","placeholder","spellCheck","hideLabel","htmlFor","Hue","_h","_props$direction","hue","className","nativeObjectToString","symToStringTag","toStringTag","isOwn","unmasked","srcIndex","mergeFunc","isTyped","baseMerge","thisArg","nativeMax","otherArgs","nativeNow","lastCalled","stamp","remaining","assigner","sources","guard","Raised","zDepth","_ref$styles","passedStyles","content","bg","propTypes","reWhitespace","reTrimStart","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","nativeMin","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","invokeFunc","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","isInvoking","leadingEdge","flush","Saturation","_container$getBoundin","saturation","bright","getContainerRenderWindow","contains","parent","black","circle","hsv","trimLeft","trimRight","tinycolor","opts","ok","named","names","matchers","rgba","hsla","hsva","hex8","parseIntFromHex","convertHexToDecimal","hex6","hex4","hex3","stringInputToObject","isValidCSSUnit","bound01","convertToPercentage","f","q","hsvToRgb","hue2rgb","hslToRgb","boundAlpha","inputToRGB","_originalInput","_r","_g","_b","_roundA","_format","_gradientType","gradientType","_ok","rgbToHsl","rgbToHsv","rgbToHex","allow3Char","hex","pad2","rgbaToArgbHex","convertDecimalToHex","_desaturate","amount","toHsl","clamp01","_saturate","_greyscale","desaturate","_lighten","_brighten","toRgb","_darken","_spin","_complement","polyad","step","_splitcomplement","_analogous","part","ret","_monochromatic","toHsv","modification","isDark","getBrightness","isLight","getOriginalInput","getFormat","getAlpha","getLuminance","RsRGB","GsRGB","BsRGB","setAlpha","toHsvString","toHslString","toHex","toHexString","toHex8","allow4Char","rgbaToHex","toHex8String","toRgbString","toPercentageRgb","toPercentageRgbString","toName","hexNames","toFilter","secondColor","hex8String","secondHex8String","formatSet","formattedString","hasAlpha","_applyModification","lighten","brighten","darken","saturate","greyscale","spin","_applyCombination","analogous","complement","monochromatic","splitcomplement","triad","tetrad","fromRatio","newColor","color1","color2","mix","rgb1","rgb2","readability","isReadable","wcag2","wcag2Parms","out","parms","level","validateWCAG2Parms","mostReadable","baseColor","colorList","includeFallbackColors","bestColor","bestScore","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","burntsienna","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellow","yellowgreen","flipped","flip","isOnePointZero","processPercent","isPercentage","CSS_UNIT","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","simpleCheckForValidColor","checked","passed","letter","toState","oldHue","isValidHex","lh","getContrastingColor","col","isvalidColorString","Picker","ColorPicker","colors","onChangeComplete","debounce","handleSwatchHover","onSwatchHover","optionalEvents","nextProps","Span","_React$Component","Focus","handleFocus","onFocus","_ref$onClick","onClick","onHover","_ref$title","_ref$focusStyle","focusStyle","transparent","swatch","outline","onMouseOver","tabIndex","picker","backgroundColor","AlphaPicker","_ref$className","swatches","marginRight","float","marginBottom","Block","triangle","hexCode","card","head","alignItems","justifyContent","body","borderStyle","borderWidth","borderColor","marginLeft","border","deepPurple","lightBlue","lightGreen","amber","deepOrange","blueGrey","CircleSwatch","hover","circleSize","circleSpacing","transition","Swatch","Circle","flexWrap","ChromeFields","toggleViews","view","showHighlight","hideHighlight","paddingTop","fields","flex","field","paddingLeft","toggle","textAlign","icon","iconHighlight","textTransform","lineHeight","svg","UnfoldMoreHorizontalIcon","onMouseEnter","onMouseOut","Chrome","disableAlpha","defaultView","paddingBottom","controls","zIndex","toggles","paddingRight","HEXwrap","HEXinput","HEXlabel","RGBwrap","RGBinput","RGBlabel","Compact","compact","hoverSwatch","Github","borderBottomColor","triangleShadow","HuePicker","HuePointer","material","borderBottom","Hex","third","divider","fieldSymbols","triangleBorder","Extend","leftInside","rightInside","button","backgroundImage","currentColor","new","Photoshop","_props","_props$styles","_props$className","previews","PhotoshopPointer","onAccept","onCancel","PhotoshopFields","single","double","SketchPresetColors","borderTop","swatchWrap","handleClick","colorObjOrString","isRequired","Sketch","presetColors","sliders","activeColor","Slider","check","CheckIcon","Swatches","overflowY","Twitter","hash","hexcode","GooglePointerCircle","GooglePointer","_values","_values2","hsvValue","input2","label2","flexGrow","rgbValue","hslValue","Google","cancelTimeout","timeoutID","requestTimeout","tick","getScrollbarSize","recalculate","div","cachedRTLResult","getRTLOffsetType","outerDiv","outerStyle","innerDiv","innerStyle","scrollLeft","defaultItemKey$1","createListComponent","_class","getItemOffset","getEstimatedTotalSize","getItemSize","getOffsetForIndexAndAlignment","getStartIndexForOffset","getStopIndexForStartIndex","initInstanceProps","shouldResetStyleCacheOnItemSizeChange","validateProps","_PureComponent","List","_instanceProps","_outerRef","_resetIsScrollingTimeoutId","isScrolling","scrollDirection","scrollOffset","initialScrollOffset","scrollUpdateWasRequested","_callOnItemsRendered","overscanStartIndex","overscanStopIndex","visibleStartIndex","visibleStopIndex","onItemsRendered","_callOnScroll","onScroll","_getItemStyle","_this$props","itemSize","itemStyleCache","_getItemStyleCache","_offset","isRtl","offsetHorizontal","__","___","_onScrollHorizontal","_event$currentTarget","scrollWidth","_resetIsScrollingDebounced","_onScrollVertical","_event$currentTarget2","scrollHeight","scrollTop","_outerRefSetter","outerRef","_resetIsScrolling","getDerivedStateFromProps","validateSharedProps$1","_proto","scrollTo","scrollToItem","align","_this$props2","itemCount","scrollbarSize","componentDidMount","_this$props3","_callPropsCallbacks","componentDidUpdate","_this$props4","_this$state","componentWillUnmount","_this$props5","innerRef","innerElementType","innerTagName","itemData","_this$props5$itemKey","itemKey","outerElementType","outerTagName","useIsScrolling","_this$_getRangeToRend","_getRangeToRender","stopIndex","_index","estimatedTotalSize","WebkitOverflowScrolling","willChange","_this$_getRangeToRend2","_overscanStartIndex","_overscanStopIndex","_visibleStartIndex","_visibleStopIndex","_this$state2","_scrollDirection","_scrollOffset","_scrollUpdateWasRequested","_this$props6","overscanCount","_this$state3","overscanBackward","overscanForward","_ref3","getItemMetadata$1","instanceProps","itemMetadataMap","lastMeasuredIndex","itemMetadata","findNearestItemBinarySearch$1","middle","currentOffset","findNearestItemExponentialSearch$1","estimatedItemSize","totalSizeOfMeasuredItems","VariableSizeList","maxOffset","minOffset","findNearestItem$1","resetAfterIndex","shouldForceUpdate","forceUpdate","_ref5","autoprefix","_forOwn2","_forOwn3","msBorderRadius","MozBorderRadius","OBorderRadius","WebkitBorderRadius","msBoxShadow","MozBoxShadow","OBoxShadow","WebkitBoxShadow","userSelect","WebkitTouchCallout","KhtmlUserSelect","MozUserSelect","msUserSelect","WebkitUserSelect","WebkitBoxFlex","MozBoxFlex","WebkitFlex","msFlex","flexBasis","WebkitFlexBasis","WebkitJustifyContent","msTransition","MozTransition","OTransition","WebkitTransition","msTransform","MozTransform","OTransform","WebkitTransform","otherElementStyles","otherStyle","prefixed","expanded","onMouseUp","Hover","handleMouseOver","handleMouseOut","flattenNames","_isString3","_interopRequireDefault","_isPlainObject3","_map3","things","thing","_flattenNames2","_mergeClasses2","_autoprefix2","_hover3","_active2","_loop3","ReactCSS","classes","activations","activeNames","merged","setProp","mergeClasses","_cloneDeep3","toMerge","is","useState","useEffect","useLayoutEffect","useDebugValue","getSnapshot","inst","useSyncExternalStore","useRef","useMemo","useSyncExternalStoreWithSelector","hasValue","createStoreImpl","createState","listeners","partial","nextState","previousState","listener","getInitialState","subscribe","createStore","didWarnAboutEqualityFn","createImpl","useBoundStore","equalityFn","getServerState","useStore","trackedConnections","getTrackedConnectionState","fromEntries","stores","api2","devtools","devtoolsOptions","anonymousActionType","store","extensionConnector","__REDUX_DEVTOOLS_EXTENSION__","_e","connection","connectionInformation","connect","existingConnection","newConnection","extractConnectionInformation","isRecording","nameOrAction","action","setStateFromDevtools","originalIsRecording","store2","dispatchFromDevtools","dispatch","didWarnAboutReservedActionType","originalDispatch","parseJsonThen","stateFromDevtools","nextLiftedState","lastComputedState","computedStates","stringified","parsed"],"sourceRoot":""}